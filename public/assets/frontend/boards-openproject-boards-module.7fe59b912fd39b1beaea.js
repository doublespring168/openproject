(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{lrTx:function(t,e,i){"use strict";i.r(e),i.d(e,"OpenprojectBoardsModule",(function(){return kn}));var n=i("u4T9"),o=i("VpST"),s=i("0loS"),a=i("mrSG"),r=i("fXoL"),c=i("0bag"),l=i("Y0Nk"),d=i("FDFi"),h=i("VgZ9"),u=i("E2tj"),b=i("kTsZ"),g=i("Jui0"),p=i("wZYP"),m=i("XNiG"),f=i("LRne"),v=i("Kj3r"),C=i("/uUt"),y=i("vkgz"),w=i("eIep"),k=i("lJxs"),x=i("JIr8"),I=i("ZOsW"),S=i("sjKJ"),O=i("RhL0"),j=i("dMmB"),T=i("87fy"),B=i("qc15"),M=i("pL6k"),P=i("ofXK");function D(t,e){if(1&t&&r.ad(0),2&t){const t=e.item;r.ed(" ",t.type.name," #",t.id," ",t.subject," ")}}function A(t,e){if(1&t&&r.ad(0),2&t){const t=e.item;r.ed(" ",t.type.name," #",t.id," ",t.subject," ")}}class R{constructor(t,e,i,n,o,s,a,c,l,d){this.querySpace=t,this.pathHelper=e,this.urlParamsHelper=i,this.notificationService=n,this.CurrentProject=o,this.halResourceService=s,this.schemaCacheService=a,this.cdRef=c,this.I18n=l,this.wpCardDragDrop=d,this.text={placeholder:this.I18n.t("js.relations_autocomplete.placeholder")},this.appendToContainer=".work-packages-partitioned-query-space--container",this.onCancel=new r.s,this.onReferenced=new r.s,this.isLoading=!1,this.searchInput$=new m.a,this.results$=this.searchInput$.pipe(Object(v.a)(250),Object(C.a)(),Object(y.a)(()=>this.isLoading=!0),Object(w.a)(t=>this.autocompleteWorkPackages(t)))}ngAfterViewInit(){this.ngSelectComponent&&(this.ngSelectComponent.open(),setTimeout(()=>{this.ngSelectComponent.focus()},25),this.wpCardDragDrop.removeReferenceWorkPackageForm())}cancel(){this.onCancel.emit()}addWorkPackageToQuery(t){t&&this.schemaCacheService.ensureLoaded(t).then(()=>{this.onReferenced.emit(t),this.ngSelectComponent.close()})}autocompleteWorkPackages(t){var e;if(0===t.length)return this.isLoading=!1,Object(f.a)([]);const i=this.pathHelper.api.v3.withOptionalProject(this.CurrentProject.id).work_packages,n=new O.a,o=this.querySpace.results.value;n.add("subjectOrId","**",[t]),o&&o.elements.length>0&&n.add("id","!",o.elements.map(t=>t.id));const s=this.querySpace.query.value;if(null===(e=s)||void 0===e?void 0:e.filters){const t=this.urlParamsHelper.buildV3GetFilters(s.filters);n.merge(t,"subprojectId")}return this.halResourceService.get(i.filtered(n)).pipe(Object(k.a)(t=>t.elements),Object(x.a)(t=>(this.notificationService.handleRawError(t),Object(f.a)([]))),Object(y.a)(()=>this.isLoading=!1))}}R.\u0275fac=function(t){return new(t||R)(r.gc(u.a),r.gc(g.a),r.gc(M.a),r.gc(B.a),r.gc(S.a),r.gc(b.a),r.gc(j.a),r.gc(r.i),r.gc(p.a),r.gc(T.a))},R.\u0275cmp=r.ac({type:R,selectors:[["board-inline-add-autocompleter"]],viewQuery:function(t,e){var i;(1&t&&r.fd(I.a,!0),2&t)&&(r.Nc(i=r.vc())&&(e.ngSelectComponent=i.first))},inputs:{appendToContainer:"appendToContainer"},outputs:{onCancel:"onCancel",onReferenced:"onReferenced"},decls:4,vars:8,consts:[["ngClass","wp-inline-create--reference-autocompleter",3,"items","appendTo","multiple","loading","typeahead","closeOnSelect","close","change"],["ng-label-tmp",""],["ng-option-tmp",""]],template:function(t,e){1&t&&(r.mc(0,"ng-select",0),r.uc("close",(function(){return e.cancel()}))("change",(function(t){return e.addWorkPackageToQuery(t)})),r.xc(1,"async"),r.Yc(2,D,1,3,"ng-template",1),r.Yc(3,A,1,3,"ng-template",2),r.lc()),2&t&&r.Bc("items",r.yc(1,6,e.results$))("appendTo",e.appendToContainer)("multiple",!1)("loading",e.isLoading)("typeahead",e.searchInput$)("closeOnSelect",!1)},directives:[I.a,P.n,I.e,I.c],pipes:[P.a],styles:["ng-select.wp-inline-create--reference-autocompleter{border:none}ng-select.wp-inline-create--reference-autocompleter .ng-clear-wrapper{display:none}"],encapsulation:2});var q=i("DHgU");class F extends d.a{constructor(t,e,i,n,o,s){super(t),this.injector=t,this.querySpace=e,this.halResourceService=i,this.pathHelperService=n,this.Gon=o,this.wpRelationsHierarchyService=s,this.referenceComponentClass=R,this.referenceTarget=null,this.buttonTexts={reference:this.I18n.t("js.relation_buttons.add_existing_child"),create:this.I18n.t("js.relation_buttons.add_new_child")}}get canAdd(){return this.authorisationService.can("work_packages","createWorkPackage")}get canReference(){return this.authorisationService.can("work_packages","editWorkPackage")}}F.\u0275fac=function(t){return new(t||F)(r.qc(r.A),r.qc(u.a),r.qc(b.a),r.qc(g.a),r.qc(q.a),r.qc(h.a))},F.\u0275prov=r.cc({token:F,factory:F.\u0275fac});var L=i("CejQ"),Q=i("Wi9d"),$=i("d/TE"),V=(i("Bz7v"),i("Kg8T")),E=i("RGDJ"),N=i("hvpr"),H=i("+oAL"),Y=i("XV4z"),U=i("fMMW"),W=i("SKFm"),z=i("ug4p"),G=i("POAS"),J=i("AAic"),K=i("x5It"),X=i("IaZ+"),Z=i("AdL0");function tt(t,e){if(1&t&&(r.kc(0,1),r.hc(1,"icon-triggered-context-menu",2),r.jc()),2&t){const t=r.wc();r.Tb(1),r.Bc("menu-items",t.menuItems)}}class et{constructor(t,e,i,n,o,s){this.opModalService=t,this.authorisationService=e,this.querySpace=i,this.boardService=n,this.boardActionRegistry=o,this.I18n=s,this.onRemove=new r.s}get menuItems(){return()=>Object(a.b)(this,void 0,void 0,(function*(){let t=[{disabled:!this.canDelete,linkText:this.I18n.t("js.boards.lists.delete"),onClick:()=>(this.onRemove.emit(),!0)}];if(this.board.isAction){const e=yield this.actionService.getAdditionalListMenuItems(this.query);return t.concat(e)}return t}))}get actionService(){return this.boardActionRegistry.get(this.board.actionAttribute)}get canManage(){return this.boardService.canManage(this.board)}canDelete(){return this.canManage&&!!this.query.delete}get query(){return this.querySpace.query.value}}et.\u0275fac=function(t){return new(t||et)(r.gc(X.b),r.gc(V.a),r.gc(u.a),r.gc(Y.a),r.gc(J.a),r.gc(p.a))},et.\u0275cmp=r.ac({type:et,selectors:[["board-list-menu"]],inputs:{board:"board"},outputs:{onRemove:"onRemove"},decls:1,vars:1,consts:[["class","board-list--more-menu",4,"ngIf"],[1,"board-list--more-menu"],[3,"menu-items"]],template:function(t,e){1&t&&r.Yc(0,tt,2,1,"ng-container",0),2&t&&r.Bc("ngIf",e.canDelete())},directives:[P.q,Z.a],encapsulation:2});var it=i("qHU1"),nt=i("Hg4z"),ot=i("FnNU");class st{constructor(){this.filters=Object(ot.f)([])}get current(){return this.filters.getValueOr([])}}var at=i("iB+3"),rt=i("Y/CA"),ct=i("eyhC"),lt=i("pLZG");class dt{constructor(){this.selections$=new m.a}updateSelection(t){this.selections$.next(t)}selectionsForQuery(t){return this.selections$.pipe(Object(lt.a)(e=>e.withinQuery!==t))}selections(){return this.selections$}}var ht=i("/C7M");const ut=["loadingIndicator"];function bt(t,e){if(1&t&&r.hc(0,"div",14),2&t){const t=r.wc(2);r.Bc("ngClass",t.actionResourceClass)}}const gt=function(t){return{resource:t}};function pt(t,e){if(1&t&&r.hc(0,"ndc-dynamic",15),2&t){const t=r.wc(2);r.Bc("ndcDynamicComponent",t.headerComponent)("ndcDynamicInputs",r.Gc(2,gt,t.actionResource))}}function mt(t,e){if(1&t){const t=r.nc();r.mc(0,"editable-toolbar-title",16),r.uc("onSave",(function(e){r.Qc(t);const i=r.wc(2);return i.renameQuery(i.query,e)})),r.lc()}if(2&t){const t=r.wc(2);r.Bc("title",t.query.name)("smallHeader",!0)("inFlight",t.inFlight)("editable",t.canRename)("initialFocus",t.initiallyFocused)}}function ft(t,e){if(1&t&&(r.mc(0,"span"),r.ad(1),r.lc()),2&t){const t=r.wc(3);r.Tb(1),r.cd(" ",t.buttonPlaceholder.text," ")}}function vt(t,e){if(1&t){const t=r.nc();r.mc(0,"button",17),r.uc("accessibleClick",(function(){return r.Qc(t),r.wc(2).addNewCard()})),r.hc(1,"op-icon",18),r.Yc(2,ft,2,1,"span",2),r.lc()}if(2&t){const t=r.wc(2);r.Bc("title",t.text.addCard)("disabled",!t.showAddButton),r.Tb(1),r.Dc("icon-classes","icon-",t.buttonPlaceholder?t.buttonPlaceholder.icon:"add",""),r.Tb(1),r.Bc("ngIf",t.buttonPlaceholder)}}function Ct(t,e){if(1&t&&(r.mc(0,"button",19),r.hc(1,"op-icon",20),r.lc()),2&t){const t=r.wc(2);r.Bc("title",t.text.addCard)}}const yt=function(t){return{"-with-create-button":t}};function wt(t,e){if(1&t){const t=r.nc();r.kc(0),r.Yc(1,bt,1,1,"div",4),r.mc(2,"div",5),r.Yc(3,pt,1,4,"ndc-dynamic",6),r.Yc(4,mt,1,5,"editable-toolbar-title",7),r.mc(5,"board-list-menu",8),r.uc("onRemove",(function(){return r.Qc(t),r.wc().deleteList()})),r.lc(),r.lc(),r.mc(6,"div",9),r.mc(7,"div",10),r.Yc(8,vt,3,4,"button",11),r.Yc(9,Ct,2,1,"button",12),r.lc(),r.hc(10,"wp-card-view",13),r.lc(),r.jc()}if(2&t){const t=r.wc();r.Tb(1),r.Bc("ngIf",t.board.isAction),r.Tb(2),r.Bc("ngIf",t.headerComponent),r.Tb(1),r.Bc("ngIf",!t.headerComponent),r.Tb(1),r.Bc("board",t.board),r.Tb(1),r.Bc("ngClass",r.Gc(14,yt,t.board.isAction||t.showAddButton)),r.Tb(2),r.Bc("ngIf",t.board.isAction),r.Tb(1),r.Bc("ngIf",!t.board.isAction&&t.showAddButton),r.Tb(1),r.Bc("dragOutOfHandler",t.canDragOutOfHandler)("dragInto",t.canDragInto)("workPackageAddedHandler",t.workPackageAddedHandler)("cardsRemovable",t.board.isFree&&t.canDragOutOf)("showInfoButton",!0)("highlightingMode",t.board.highlightingMode)("showStatusButton",t.showCardStatusButton())}}function _t(t,e){if(1&t){const t=r.nc();r.mc(0,"div",21),r.mc(1,"p"),r.hc(2,"span",22),r.ad(3," "),r.mc(4,"a",23),r.uc("accessibleClick",(function(){return r.Qc(t),r.wc().onRemove.emit()})),r.hc(5,"span",22),r.lc(),r.lc(),r.lc()}if(2&t){const t=r.wc();r.Tb(2),r.Bc("textContent",t.errorMessage),r.Tb(3),r.Bc("textContent",t.text.click_to_remove)}}const kt=function(t){return{"-action-list":t}};class xt extends L.a{constructor(t,e,i,n,o,s,a,c,l,d,h,u,b,g,p,m,f,v,C,y,w,_,k,x){super(e,v),this.QueryDm=t,this.I18n=e,this.state=i,this.cdRef=n,this.transitions=o,this.boardCache=s,this.boardFilters=a,this.notifications=c,this.querySpace=l,this.halNotification=d,this.halEvents=h,this.wpStatesInitialization=u,this.wpViewFocusService=b,this.wpViewSelectionService=g,this.boardListCrossSelectionService=p,this.authorisationService=m,this.wpInlineCreate=f,this.injector=v,this.halEditing=C,this.loadingIndicator=y,this.wpCacheService=w,this.boardService=_,this.boardActionRegistry=k,this.causedUpdates=x,this.onRemove=new r.s,this.actionResourceClass="",this.showAddButton=!1,this.text={addCard:this.I18n.t("js.boards.add_card"),updateSuccessful:this.I18n.t("js.notice_successful_update"),areYouSure:this.I18n.t("js.text_are_you_sure"),unnamed_list:this.I18n.t("js.boards.label_unnamed_list"),click_to_remove:this.I18n.t("js.boards.click_to_remove_list")},this.canDragInto=!1,this.initiallyFocused=!1,this.workPackageAddedHandler=t=>this.addWorkPackage(t),this.canDragOutOf=!1,this.canDragOutOfHandler=t=>this.canMove(t)}ngOnInit(){if(this.initiallyFocused=this.resource.isNewWidget,this.resource.isNewWidget=!1,this.state.includes(this.state.current.data.baseRoute+".details")){let t=this.state.params.workPackageId;this.wpViewSelectionService.initializeSelection([t])}this.authorisationService.observeUntil(Object(nt.b)(this)).subscribe(()=>{this.board.isAction||(this.showAddButton=this.canDragInto&&(this.wpInlineCreate.canAdd||this.canReference),this.cdRef.detectChanges())}),this.wpViewSelectionService.updates$().pipe(Object(v.a)(100),this.untilDestroyed()).subscribe(t=>{let e=Object.keys(_.pickBy(t.selected,(t,e)=>!0===t));const i=this.wpViewFocusService.focusedWorkPackage;this.boardListCrossSelectionService.updateSelection({withinQuery:this.queryId,focusedWorkPackage:i,allSelected:e})}),this.boardListCrossSelectionService.selectionsForQuery(this.queryId).pipe(this.untilDestroyed()).subscribe(t=>{this.wpViewSelectionService.initializeSelection(t.allSelected)}),this.boardFilters.filters.values$().pipe(this.untilDestroyed()).subscribe(()=>this.updateQuery(!0)),this.listenToActionAttributeChanges(),this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe(t=>{this.query=t,this.canDragOutOf=!!this.query.updateOrderedWorkPackages,this.loadActionAttribute(t),this.cdRef.detectChanges()}),this.updateQuery()}ngOnDestroy(){super.ngOnDestroy()}get errorMessage(){return this.I18n.t("js.boards.error_loading_the_list",{error_message:this.loadingError})}canMove(t){if(this.board.isAction){const e=t.schema[this.board.actionAttribute];return this.canDragOutOf&&e.writable}return this.canDragOutOf}get canReference(){return this.wpInlineCreate.canReference}get canManage(){return this.boardService.canManage(this.board)}get canRename(){return this.canManage&&!!this.query.updateImmediately&&this.board.isFree}addReferenceCard(){this.cardView.setReferenceMode(!0)}addNewCard(){this.cardView.addNewCard()}deleteList(t){t=t||this.query,window.confirm(this.text.areYouSure)&&this.QueryDm.delete(t).then(()=>this.onRemove.emit())}renameQuery(t,e){this.inFlight=!0,this.query.name=e,this.QueryDm.patch(this.query.id,{name:e}).toPromise().then(()=>{this.inFlight=!1,this.notifications.addSuccess(this.text.updateSuccessful)}).catch(()=>this.inFlight=!1)}boardListActionColorClass(t){const e=this.board.actionAttribute;return t&&t.id?E.a.backgroundClass(e,t.id):""}get listName(){return this.query&&this.query.name}showCardStatusButton(){return this.board.showStatusButton()}refreshQueryUnlessCaused(t,e=!0){this.causedUpdates.includes(t)||(Object(it.a)(`Refreshing ${t.name} visibly due to external changes`),this.updateQuery(e))}updateQuery(t=!0){this.setQueryProps(this.boardFilters.current),this.loadQuery(t)}loadActionAttribute(t){if(!this.board.isAction)return this.actionResource=void 0,this.headerComponent=void 0,void(this.canDragInto=!!t.updateOrderedWorkPackages);const e=this.actionService.getFilterHref(t);this.actionResource&&e===this.actionResource.href||this.actionService.getLoadedFilterValue(t).then(e=>Object(a.b)(this,void 0,void 0,(function*(){this.actionResource=e,this.headerComponent=this.actionService.headerComponent(),this.buttonPlaceholder=this.actionService.disabledAddButtonPlaceholder(e),this.actionResourceClass=this.boardListActionColorClass(e),this.canDragInto=this.actionService.dragIntoAllowed(t,e);const i=yield this.actionService.canAddToQuery(t);this.showAddButton=this.canDragInto&&this.wpInlineCreate.canAdd&&i,this.cdRef.detectChanges()})))}get actionService(){return this.boardActionRegistry.get(this.board.actionAttribute)}addWorkPackage(t){let e=this.querySpace.query.value;const i=this.halEditing.changeFor(t),n=this.board.actionAttribute;if(n&&!i.isWritable(n))throw this.I18n.t("js.boards.error_attribute_not_writable",{attribute:i.humanName(n)});return new U.a(this.injector,i,e.filters).applyDefaultsFromFilters(),i.isEmpty()?this.wpCacheService.updateWorkPackage(t):this.halEditing.save(i)}get queryId(){return this.resource.options.queryId.toString()}loadQuery(t=!0){let e=this.QueryDm.stream(this.columnsQueryProps,this.queryId);t&&(e=e.pipe(Object(l.c)(this.indicatorInstance,50))),e.subscribe(t=>this.wpStatesInitialization.updateQuerySpace(t,t.results),t=>this.loadingError=this.halNotification.retrieveErrorMessage(t))}get indicatorInstance(){return this.loadingIndicator.indicator(jQuery(this.indicator.nativeElement))}setQueryProps(t){const e=(this.resource.options.filters||[]).concat(t),i={"columns[]":["id","subject"],showHierarchies:!1,pageSize:500,filters:JSON.stringify(e)};this.columnsQueryProps=i}listenToActionAttributeChanges(){this.board.actionAttribute&&this.halEvents.events$.pipe(Object(lt.a)(t=>"WorkPackage"===t.resourceType),Object(lt.a)(t=>"updated"===t.eventType),Object(k.a)(t=>{var e;return null===(e=t.commit)||void 0===e?void 0:e.changes[this.board.actionAttribute]}),Object(lt.a)(t=>!!t),Object(lt.a)(t=>{var e,i,n;const o=null===(e=this.actionResource)||void 0===e?void 0:e.href,s=null===(i=t.to)||void 0===i?void 0:i.href,a=null===(n=t.from)||void 0===n?void 0:n.href;return!!o&&(o===s||o===a)})).subscribe(t=>{this.updateQuery(!0)})}}xt.\u0275fac=function(t){return new(t||xt)(r.gc(c.a),r.gc(p.a),r.gc(at.G),r.gc(r.i),r.gc(at.O),r.gc(Q.a),r.gc(st),r.gc($.a),r.gc(u.a),r.gc(G.a),r.gc(ht.a),r.gc(H.a),r.gc(rt.a),r.gc(ct.a),r.gc(dt),r.gc(V.a),r.gc(d.a),r.gc(r.A),r.gc(W.a),r.gc(l.a),r.gc(z.a),r.gc(Y.a),r.gc(J.a),r.gc(K.a))},xt.\u0275cmp=r.ac({type:xt,selectors:[["board-list"]],viewQuery:function(t,e){var i;(1&t&&(r.Wc(ut,!0),r.fd(N.a,!0)),2&t)&&(r.Nc(i=r.vc())&&(e.indicator=i.first),r.Nc(i=r.vc())&&(e.cardView=i.first))},inputs:{board:"board"},outputs:{onRemove:"onRemove"},features:[r.Sb([{provide:d.a,useClass:F},et,T.a]),r.Qb],decls:4,vars:6,consts:[[1,"board-list--container","loading-indicator--location",3,"ngClass"],["loadingIndicator",""],[4,"ngIf"],["class","notification-box -error",4,"ngIf"],["class","board-list--action-bar",3,"ngClass",4,"ngIf"],[1,"board-list--header"],[3,"ndcDynamicComponent","ndcDynamicInputs",4,"ngIf"],["class","-small",3,"title","smallHeader","inFlight","editable","initialFocus","onSave",4,"ngIf"],[1,"board-list--menu",3,"board","onRemove"],[1,"board-list--query-container","drop-zone",3,"ngClass"],[1,"board-list--button-container"],["class","board-list--add-button board-list--card-add-button button",3,"title","disabled","accessibleClick",4,"ngIf"],["class","board-list--add-button board-list--card-dropdown-button button","addCardDropdown","",3,"title",4,"ngIf"],[3,"dragOutOfHandler","dragInto","workPackageAddedHandler","cardsRemovable","showInfoButton","highlightingMode","showStatusButton"],[1,"board-list--action-bar",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs"],[1,"-small",3,"title","smallHeader","inFlight","editable","initialFocus","onSave"],[1,"board-list--add-button","board-list--card-add-button","button",3,"title","disabled","accessibleClick"],[3,"icon-classes"],["addCardDropdown","",1,"board-list--add-button","board-list--card-dropdown-button","button",3,"title"],["icon-classes","icon-small icon-add"],[1,"notification-box","-error"],[3,"textContent"],["role","button",3,"accessibleClick"]],template:function(t,e){1&t&&(r.mc(0,"div",0,1),r.Yc(2,wt,11,16,"ng-container",2),r.Yc(3,_t,6,2,"div",3),r.lc()),2&t&&(r.Bc("ngClass",r.Gc(4,kt,e.board.isAction)),r.Ub("data-query-name",e.listName),r.Tb(2),r.Bc("ngIf",e.query),r.Tb(1),r.Bc("ngIf",e.loadingError))},styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.board-list--query-container[_ngcontent-%COMP%]{max-width:inherit;overflow:hidden;height:100%}.board-list--query-container.-with-create-button[_ngcontent-%COMP%]{display:grid;grid-template:34px minmax(0,1fr)/1fr}.board-list--button-container[_ngcontent-%COMP%]{background-color:var(--body-background);position:-webkit-sticky;position:sticky;top:0;z-index:1}.board-list--container[_ngcontent-%COMP%]{height:100%;max-width:300px;display:flex;flex-direction:column}.board-list--container[_ngcontent-%COMP%]:hover   .board-list--menu[_ngcontent-%COMP%]{visibility:visible}.board-list--action-bar[_ngcontent-%COMP%]{width:calc(100% - 30px);height:5px;margin:auto}.board-list--header[_ngcontent-%COMP%]{padding:5px 15px;display:flex;align-items:center;max-height:52px}.board-list--header[_ngcontent-%COMP%]   editable-toolbar-title[_ngcontent-%COMP%]{flex:1;margin-bottom:0;margin-right:.25rem}.notification-box[_ngcontent-%COMP%]{margin-top:0;z-index:100}.board-list--add-button[_ngcontent-%COMP%]{background-color:var(--body-background);width:calc(100% - 40px);margin:0 15px;box-shadow:1px 1px 3px 0 #d3d3d3}.board-list--add-button[_ngcontent-%COMP%]:hover{background-color:hsla(0,0%,93.3%,.31)}.board-list--add-button[_ngcontent-%COMP%]:disabled{background-color:hsla(0,0%,80%,.31)}.board-list--menu[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0});var It=i("3Pt+");class St{constructor(t,e,i){this.injector=t,this.locals=e,this.I18n=i,this.highlightingMode="none",this.entireCardMode=!1,this.lastEntireCardAttribute="type",this.text={highlighting_mode:{description:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.description"),none:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.none"),type:this.I18n.t("js.work_packages.properties.type"),priority:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.priority"),entire_card_by:this.I18n.t("js.card.highlighting.entire_card_by")}}}onSave(){this.updateMode(this.highlightingMode),this.board.highlightingMode=this.highlightingMode}ngOnInit(){this.board=this.locals.board,this.highlightingMode=this.board.highlightingMode,this.updateMode(this.highlightingMode)}updateMode(t){this.highlightingMode="inline"===t?this.lastEntireCardAttribute:t,-1!==["priority","type"].indexOf(this.highlightingMode)?(this.lastEntireCardAttribute=this.highlightingMode,this.entireCardMode=!0):this.entireCardMode=!1}}St.\u0275fac=function(t){return new(t||St)(r.gc(r.A),r.gc(X.a),r.gc(p.a))},St.\u0275cmp=r.ac({type:St,selectors:[["ng-component"]],decls:17,vars:10,consts:[[3,"textContent"],[1,"form--field","-full-width"],[1,"form--field-container"],[1,"option-label"],["type","radio","name","entire_card_switch",3,"ngModel","value","ngModelChange","change"],["id","selected_attribute","name","selected_attribute",1,"form--select","form--inline-select",3,"change"],["value","type",3,"textContent","selected"],["value","priority",3,"textContent","selected"],["type","radio","value","none","name","highlighting_mode_switch",3,"ngModel","ngModelChange","change"]],template:function(t,e){1&t&&(r.mc(0,"div"),r.mc(1,"form"),r.hc(2,"p",0),r.mc(3,"div",1),r.mc(4,"div",2),r.mc(5,"label",3),r.mc(6,"input",4),r.uc("ngModelChange",(function(t){return e.entireCardMode=t}))("change",(function(){return e.updateMode("inline")})),r.lc(),r.hc(7,"span",0),r.ad(8," "),r.mc(9,"select",5),r.uc("change",(function(t){return e.updateMode(t.target.value)})),r.hc(10,"option",6),r.hc(11,"option",7),r.lc(),r.lc(),r.lc(),r.lc(),r.mc(12,"div",1),r.mc(13,"div",2),r.mc(14,"label",3),r.mc(15,"input",8),r.uc("ngModelChange",(function(t){return e.highlightingMode=t}))("change",(function(t){return e.updateMode(t.target.value)})),r.lc(),r.hc(16,"span",0),r.lc(),r.lc(),r.lc(),r.lc(),r.lc()),2&t&&(r.Tb(2),r.Bc("textContent",e.text.highlighting_mode.description),r.Tb(4),r.Bc("ngModel",e.entireCardMode)("value",!0),r.Tb(1),r.Bc("textContent",e.text.highlighting_mode.entire_card_by),r.Tb(3),r.Bc("textContent",e.text.highlighting_mode.type)("selected","type"===e.lastEntireCardAttribute),r.Tb(1),r.Bc("textContent",e.text.highlighting_mode.priority)("selected","priority"===e.lastEntireCardAttribute),r.Tb(4),r.Bc("ngModel",e.highlightingMode),r.Tb(1),r.Bc("textContent",e.text.highlighting_mode.none))},directives:[It.C,It.n,It.o,It.u,It.c,It.m,It.p,It.r,It.B],encapsulation:2});class Ot{constructor(t){this.I18n=t,this._tabs=[{name:"highlighting",title:this.I18n.t("js.work_packages.table_configuration.highlighting"),componentClass:St}]}get tabs(){return this._tabs}}Ot.\u0275fac=function(t){return new(t||Ot)(r.qc(p.a))},Ot.\u0275prov=r.cc({token:Ot,factory:Ot.\u0275fac});var jt=i("sBdf"),Tt=i("DP6S"),Bt=i("Mo6U"),Mt=i("t8SH"),Pt=i("UD+K"),Dt=i("iMRi");class At extends Pt.a{constructor(t,e){super(),this.states=t,this.statusDm=e}load(t){return this.statusDm.one(t)}loadAll(t){return this.statusDm.list()}get multiState(){return this.states.statuses}}At.\u0275fac=function(t){return new(t||At)(r.qc(Dt.a),r.qc(Tt.a))},At.\u0275prov=r.cc({token:At,factory:At.\u0275fac,providedIn:"root"});class Rt{constructor(t,e,i,n){this.boardListsService=t,this.I18n=e,this.statusCache=i,this.statusDm=n}get localizedName(){return this.I18n.t("js.work_packages.properties.status")}getFilterHref(t){const e=_.find(t.filters,t=>"status"===t.id);if(e){const t=e.values[0];return t instanceof Bt.a?t.href:t}}getLoadedFilterValue(t){const e=this.getFilterHref(t);if(e){const t=Bt.a.idFromLink(e);return this.statusCache.require(t)}return Promise.resolve(void 0)}canAddToQuery(t){return Promise.resolve(!0)}addActionQueries(t){return this.getStatuses().then(e=>Promise.all(e.map(e=>e.isDefault?this.addActionQuery(t,e):Promise.resolve(t))).then(()=>t))}addActionQuery(t,e){let i={name:e.name},n={status:{operator:"=",values:[e.id]}};return this.boardListsService.addQuery(t,i,[n])}getAvailableValues(t,e){return this.getStatuses().then(t=>t.filter(t=>!e.has(t.id)))}getAdditionalListMenuItems(t){return Promise.resolve([])}dragIntoAllowed(t,e){return!0}autocompleterComponent(){return Mt.a}headerComponent(){}disabledAddButtonPlaceholder(t){}warningTextWhenNoOptionsAvailable(){return Promise.resolve(this.I18n.t("js.boards.add_list_modal.warning.status"))}getStatuses(){return this.statusDm.list().then(t=>t.elements)}}Rt.\u0275fac=function(t){return new(t||Rt)(r.qc(jt.a),r.qc(p.a),r.qc(At),r.qc(Tt.a))},Rt.\u0275prov=r.cc({token:Rt,factory:Rt.\u0275fac});var qt=i("Nnhs"),Ft=i("VQC/"),Lt=i("mg4W"),Qt=i("13ri");class $t extends Pt.a{constructor(t,e){super(),this.states=t,this.versionDm=e}load(t){return this.versionDm.one(t)}loadAll(t){return this.versionDm.list()}get multiState(){return this.states.versions}}$t.\u0275fac=function(t){return new(t||$t)(r.qc(Dt.a),r.qc(Ft.a))},$t.\u0275prov=r.cc({token:$t,factory:$t.\u0275fac,providedIn:"root"});const Vt=function(t,e){return{"-closed":t,"-locked":e}};function Et(t,e){if(1&t&&(r.mc(0,"div",1),r.hc(1,"h2",2),r.mc(2,"span",3),r.ad(3),r.lc(),r.lc()),2&t){const t=r.wc();r.Bc("ngClass",r.Hc(3,Vt,t.version.isClosed(),t.version.isLocked())),r.Tb(1),r.Bc("textContent",t.version.name),r.Tb(2),r.cd(" ",t.version.endDate," ")}}class Nt{constructor(t){this.I18n=t,this.text={isLocked:this.I18n.t("js.boards.version.is_locked"),isClosed:this.I18n.t("js.boards.version.is_closed")}}}Nt.\u0275fac=function(t){return new(t||Nt)(r.gc(p.a))},Nt.\u0275cmp=r.ac({type:Nt,selectors:[["ng-component"]],hostAttrs:[1,"title-container","-small"],inputs:{version:["resource","version"]},decls:1,vars:1,consts:[["class","version-board-header",3,"ngClass",4,"ngIf"],[1,"version-board-header",3,"ngClass"],[1,"editable-toolbar-title--fixed",3,"textContent"],[1,"version-board-header--info-row","-italic","-small-font"]],template:function(t,e){1&t&&r.Yc(0,Et,4,6,"div",0),2&t&&r.Bc("ngIf",e.version)},directives:[P.q,P.n],styles:[".version-board-header[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]});class Ht extends Pt.a{constructor(t){super(),this.halResourceService=t,this.$formCache=Object(ot.g)()}load(t){return this.halResourceService.post(t,{}).toPromise()}loadAll(t){return Promise.all(t.map(t=>this.load(t))).then(t=>{})}get multiState(){return this.$formCache}}Ht.\u0275fac=function(t){return new(t||Ht)(r.qc(b.a))},Ht.\u0275prov=r.cc({token:Ht,factory:Ht.\u0275fac,providedIn:"root"});class Yt{constructor(t,e,i,n,o,s,a,r,c){this.boardListsService=t,this.I18n=e,this.versionDm=i,this.versionCache=n,this.currentProject=o,this.halNotification=s,this.state=a,this.formCache=r,this.pathHelper=c}get localizedName(){return this.I18n.t("js.work_packages.properties.version")}getFilterHref(t){const e=_.find(t.filters,t=>"version"===t.id);if(e){const t=e.values[0];return t instanceof Bt.a?t.href:t}}getLoadedFilterValue(t){const e=this.getFilterHref(t);if(e){const t=Bt.a.idFromLink(e);return this.versionCache.require(t)}return Promise.resolve(void 0)}canAddToQuery(t){const e=_.get(t,"results.createWorkPackage.href",null);return e?this.formCache.require(e).then(t=>t.schema.version.writable):Promise.resolve(!1)}addActionQueries(t){return this.getVersions().then(e=>Promise.all(e.map(e=>{const i=_.get(e,"definingProject.name",null);return e.isOpen()&&i&&i===this.currentProject.name?this.addActionQuery(t,e):Promise.resolve(t)})).then(()=>t))}addActionQuery(t,e){let i={name:e.name},n={version:{operator:"=",values:[e.id]}};return this.boardListsService.addQuery(t,i,[n])}getAvailableValues(t,e){return this.getVersions().then(t=>t.filter(t=>!e.has(t.id)))}getAdditionalListMenuItems(t){return this.getLoadedFilterValue(t).then(t=>t?this.buildItemsForVersion(t):[])}autocompleterComponent(){return Lt.a}headerComponent(){return Nt}disabledAddButtonPlaceholder(t){return t.isLocked()?{icon:"locked",text:this.I18n.t("js.boards.version.locked")}:t.isClosed()?{icon:"not-supported",text:this.I18n.t("js.boards.version.closed")}:void 0}dragIntoAllowed(t,e){return e instanceof qt.a&&e.isOpen()}warningTextWhenNoOptionsAvailable(){return Promise.resolve(void 0)}getVersions(){return null===this.currentProject.id?Promise.resolve([]):this.versionDm.listForProject(this.currentProject.id).then(t=>t.elements)}patchVersionStatus(t,e){this.versionDm.patch(t,{status:e}).then(t=>{this.versionCache.updateValue(t.id,t),this.state.go(".",{},{reload:!0})}).catch(t=>this.halNotification.handleRawError(t))}buildItemsForVersion(t){const e=t.id;return[{hidden:!t.isOpen()||t.isLocked()&&!t.$links.update,linkText:this.I18n.t("js.boards.version.lock_version"),onClick:()=>(this.patchVersionStatus(t,"locked"),!0)},{hidden:!t.isLocked()||t.isOpen()&&!t.$links.update,linkText:this.I18n.t("js.boards.version.unlock_version"),onClick:()=>(this.patchVersionStatus(t,"open"),!0)},{hidden:t.isClosed()||!t.isClosed()&&!t.$links.update,linkText:this.I18n.t("js.boards.version.close_version"),onClick:()=>(this.patchVersionStatus(t,"closed"),!0)},{hidden:!t.isClosed()||t.isClosed()&&!t.$links.update,linkText:this.I18n.t("js.boards.version.open_version"),onClick:()=>(this.patchVersionStatus(t,"open"),!0)},{linkText:this.I18n.t("js.boards.version.show_version"),href:this.pathHelper.versionShowPath(e),onClick:t=>!Qt.a.isClickedWithModifier(t)&&(window.open(this.pathHelper.versionShowPath(e),"_blank"),!0)},{hidden:!t.$links.update,linkText:this.I18n.t("js.boards.version.edit_version"),href:this.pathHelper.versionEditPath(e),onClick:t=>!Qt.a.isClickedWithModifier(t)&&(window.open(this.pathHelper.versionEditPath(e),"_blank"),!0)}]}}Yt.\u0275fac=function(t){return new(t||Yt)(r.qc(jt.a),r.qc(p.a),r.qc(Ft.a),r.qc($t),r.qc(S.a),r.qc(G.a),r.qc(at.G),r.qc(Ht),r.qc(g.a))},Yt.\u0275prov=r.cc({token:Yt,factory:Yt.\u0275fac});var Ut=i("l5mm"),Wt=i("JX91");class zt{constructor(t){this.queryDm=t}monitor(t){let e=new Date;return Object(Ut.a)(2e3).pipe(Object(Wt.a)(0),Object(w.a)(()=>{let i=this.queryForUpdates(t,e);return e=new Date,i}),Object(lt.a)(t=>t.count>0))}queryForUpdates(t,e){return this.queryDm.list({filters:[["id","=",t],["updatedAt","<>d",[e.toISOString()]]]})}}zt.\u0275fac=function(t){return new(t||zt)(r.qc(c.a))},zt.\u0275prov=r.cc({token:zt,factory:zt.\u0275fac});i("y2Tr");var Gt=i("u8Ab");function Jt(t,e){if(1&t&&(r.mc(0,"div",1),r.hc(1,"user-avatar",2),r.hc(2,"h2",3),r.lc()),2&t){const t=r.wc();r.Tb(1),r.Bc("user",t.user),r.Tb(1),r.Bc("textContent",t.user.name)}}class Kt{}Kt.\u0275fac=function(t){return new(t||Kt)},Kt.\u0275cmp=r.ac({type:Kt,selectors:[["ng-component"]],hostAttrs:[1,"title-container","-small"],inputs:{user:["resource","user"]},decls:1,vars:1,consts:[["class","assignee-board-header",4,"ngIf"],[1,"assignee-board-header"],["data-class-list","avatar-mini",3,"user"],[1,"editable-toolbar-title--fixed",3,"textContent"]],template:function(t,e){1&t&&r.Yc(0,Jt,3,2,"div",0),2&t&&r.Bc("ngIf",e.user)},directives:[P.q,Gt.a],styles:[".assignee-board-header[_ngcontent-%COMP%]{display:flex}.assignee-board-header[_ngcontent-%COMP%]   user-avatar[_ngcontent-%COMP%]{align-self:center;padding-right:5px}"]});var Xt=i("IzEk"),Zt=i("r0MM"),te=i("Ywds");class ee{constructor(t,e,i,n,o,s){this.boardListsService=t,this.I18n=e,this.halResourceService=i,this.pathHelper=n,this.currentProject=o,this.injector=s,this.assignees=Object(ot.f)()}get localizedName(){return this.I18n.t("js.work_packages.properties.assignee")}getFilterHref(t){const e=_.find(t.filters,t=>"assignee"===t.id);if(e){const t=e.values[0];return t instanceof Bt.a?t.href:t}}getLoadedFilterValue(t){const e=this.getFilterHref(t);return e?this.getAssignees().then(t=>t.find(t=>t.href===e)):Promise.resolve(void 0)}canAddToQuery(t){return Promise.resolve(!0)}addActionQueries(t){return Promise.resolve(t)}addActionQuery(t,e){let i={name:e.name},n={assignee:{operator:"=",values:[e.id]}};return this.boardListsService.addQuery(t,i,[n])}getAvailableValues(t,e){return this.getAssignees().then(t=>t.filter(t=>!e.has(t.id)))}getAdditionalListMenuItems(t){return Promise.resolve([])}dragIntoAllowed(t,e){return!0}autocompleterComponent(){return Mt.a}headerComponent(){return Kt}disabledAddButtonPlaceholder(t){}warningTextWhenNoOptionsAvailable(){let t=this.I18n.t("js.boards.add_list_modal.warning.assignee");return this.projectDmService.one(parseInt(this.currentProject.id)).then(e=>(e.memberships&&(t=t.concat(this.I18n.t("js.boards.add_list_modal.warning.add_members",{link:this.pathHelper.projectMembershipsPath(this.currentProject.identifier)}))),t))}getAssignees(){const t=this.currentProject.identifier;return this.assignees.putFromPromiseIfPristine(()=>this.halResourceService.get(this.pathHelper.api.v3.projects.id(t).available_assignees).toPromise().then(t=>t.elements)),this.assignees.values$().pipe(Object(Xt.a)(1)).toPromise()}}ee.\u0275fac=function(t){return new(t||ee)(r.qc(jt.a),r.qc(p.a),r.qc(b.a),r.qc(g.a),r.qc(S.a),r.qc(r.A))},ee.\u0275prov=r.cc({token:ee,factory:ee.\u0275fac}),Object(a.c)([Object(Zt.a)(),Object(a.e)("design:type",te.a)],ee.prototype,"projectDmService",void 0);var ie=i("HEQ6");class ne{constructor(t){this.injector=t;const e=t.get(J.a),i=t.get(Rt),n=t.get(Yt),o=t.get(ee);e.add("status",i),e.add("assignee",o),e.add("version",n)}}ne.\u0275fac=function(t){return new(t||ne)(r.gc(r.A))},ne.\u0275cmp=r.ac({type:ne,selectors:[["boards-entry"]],features:[r.Sb([Ot,Rt,Yt,ee,zt])],decls:1,vars:0,consts:[["wp-isolated-query-space",""]],template:function(t,e){1&t&&r.hc(0,"ui-view",0)},directives:[s.UIView,ie.a],encapsulation:2});var oe=i("PUHT"),se=i("4lR/"),ae=i("SqdZ"),re=i("H3ou");const ce=["tabContentOutlet"],le=function(t){return{selected:t}},de=function(t,e){return{"-disabled":t,selected:e}};function he(t,e){if(1&t){const t=r.nc();r.mc(0,"li",15),r.mc(1,"a",16),r.uc("click",(function(){r.Qc(t);const i=e.$implicit;return r.wc(2).switchTo(i.name)})),r.lc(),r.lc()}if(2&t){const t=e.$implicit,i=r.wc(2);r.Bc("ngClass",r.Gc(4,le,i.currentTab&&t.name===i.currentTab.name)),r.Tb(1),r.Bc("ngClass",r.Hc(6,de,null!=t.disableBecause,i.currentTab&&t.name===i.currentTab.name))("textContent",t.title),r.Ub("title",t.disableBecause||t.title)}}function ue(t,e){if(1&t&&(r.mc(0,"div",12),r.mc(1,"ul",13),r.Yc(2,he,2,9,"li",14),r.lc(),r.lc()),2&t){const t=r.wc();r.Tb(2),r.Bc("ngForOf",t.availableTabs)}}class be extends ae.a{constructor(t,e,i,n,o,s,a,r,c,l){super(t,c,l),this.locals=t,this.I18n=e,this.boardService=i,this.boardCache=n,this.boardConfigurationService=o,this.injector=s,this.appRef=a,this.componentFactoryResolver=r,this.cdRef=c,this.elementRef=l,this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.text={title:this.I18n.t("js.boards.configuration_modal.title"),closePopup:this.I18n.t("js.close_popup_title"),applyButton:this.I18n.t("js.modals.button_apply"),cancelButton:this.I18n.t("js.modals.button_cancel")}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.tabPortalHost=new re.a(this.boardConfigurationService.tabs,this.tabContentOutlet.nativeElement,this.componentFactoryResolver,this.appRef,this.injector),setTimeout(()=>{const t=this.availableTabs[0].name;this.switchTo(t)})}ngOnDestroy(){this.tabPortalHost.dispose()}get availableTabs(){return this.tabPortalHost.availableTabs}get currentTab(){return this.tabPortalHost.currentTab}switchTo(t){this.tabPortalHost.switchTo(t)}saveChanges(){this.tabPortalHost.activeComponents.forEach(t=>{t.onSave()});const t=this.locals.board;this.boardService.save(t).then(t=>{this.boardCache.update(t),this.service.close()})}onClose(){return this.afterFocusOn.focus(),!0}get afterFocusOn(){return this.$element}}be.\u0275fac=function(t){return new(t||be)(r.gc(X.a),r.gc(p.a),r.gc(Y.a),r.gc(Q.a),r.gc(Ot),r.gc(r.A),r.gc(r.f),r.gc(r.l),r.gc(r.i),r.gc(r.q))},be.\u0275cmp=r.ac({type:be,selectors:[["ng-component"]],viewQuery:function(t,e){var i;(1&t&&r.Wc(ce,!0),2&t)&&(r.Nc(i=r.vc())&&(e.tabContentOutlet=i.first))},features:[r.Qb],decls:12,vars:5,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","-wide","wp-table--configuration-modal","loading-indicator--location"],[1,"op-modal--modal-header"],[3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],["class","content--tabs scrollable-tabs",4,"ngIf"],[1,"tab-content"],["tabContentOutlet",""],[1,"modal--form-actions"],[1,"button","-highlight",3,"textContent","click"],[1,"button",3,"textContent","click"],[1,"content--tabs","scrollable-tabs"],[1,"tabrow"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["role","button","href","",1,"tab-show",3,"ngClass","textContent","click"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"div",1),r.mc(2,"div",2),r.hc(3,"h3",3),r.mc(4,"a",4),r.mc(5,"i",5),r.uc("click",(function(t){return e.closeMe(t)})),r.lc(),r.lc(),r.lc(),r.Yc(6,ue,3,1,"div",6),r.hc(7,"div",7,8),r.mc(9,"div",9),r.mc(10,"button",10),r.uc("click",(function(){return e.saveChanges()})),r.lc(),r.mc(11,"button",11),r.uc("click",(function(t){return e.closeMe(t)})),r.lc(),r.lc(),r.lc(),r.lc()),2&t&&(r.Tb(3),r.Bc("textContent",e.text.title),r.Tb(2),r.Ub("title",e.text.closePopup),r.Tb(1),r.Bc("ngIf",!!e.tabPortalHost),r.Tb(4),r.Bc("textContent",e.text.applyButton),r.Tb(1),r.Bc("textContent",e.text.cancelButton))},directives:[P.q,P.p,P.n],encapsulation:2});var ge=i("CV67");class pe extends oe.a{constructor(t,e,i,n,o,s,a,r,c){super(t,e),this.elementRef=t,this.opContextMenu=e,this.opModalService=i,this.boardService=n,this.BoardCache=o,this.Notifications=s,this.State=a,this.injector=r,this.I18n=c,this.text={deleteSuccessful:this.I18n.t("js.notice_successful_delete")}}get locals(){return{contextMenuId:"boardsToolbarMenu",items:this.items}}open(t){this.buildItems(),this.opContextMenu.show(this,t)}buildItems(){this.items=[{linkText:this.I18n.t("js.toolbar.settings.configure_view"),icon:"icon-settings",onClick:t=>(this.opContextMenu.close(),this.opModalService.show(be,this.injector,{board:this.board}),!0)},{linkText:this.I18n.t("js.toolbar.settings.page_settings"),icon:"icon-edit",onClick:t=>(this.board.grid.updateImmediately&&jQuery(".toolbar-container .editable-toolbar-title--input").trigger(ge.c),!0)},{linkText:this.I18n.t("js.toolbar.settings.delete"),icon:"icon-delete",onClick:t=>(this.board.grid.delete&&window.confirm(this.I18n.t("js.text_query_destroy_confirmation"))&&this.boardService.delete(this.board).then(()=>{this.BoardCache.clearSome(this.board.id),this.State.go("^",{flash_message:{type:"success",message:this.text.deleteSuccessful}})}),!0)}]}}pe.\u0275fac=function(t){return new(t||pe)(r.gc(r.q),r.gc(se.a),r.gc(X.b),r.gc(Y.a),r.gc(Q.a),r.gc($.a),r.gc(at.G),r.gc(r.A),r.gc(p.a))},pe.\u0275dir=r.bc({type:pe,selectors:[["","boardsToolbarMenu",""]],inputs:{board:["boardsToolbarMenu-resource","board"]},features:[r.Qb]});var me=i("kor4"),fe=i("N5AO");const ve=["actionAttributeSelect"];function Ce(t,e){if(1&t){const t=r.nc();r.mc(0,"a",16),r.mc(1,"i",17),r.uc("click",(function(e){return r.Qc(t),r.wc().closeMe(e)})),r.lc(),r.lc()}if(2&t){const t=r.wc();r.Tb(1),r.Ub("title",t.text.close_popup)}}function ye(t,e){if(1&t&&r.hc(0,"option",18),2&t){const t=e.$implicit;r.Bc("value",t.attribute)("textContent",t.text)}}class we extends ae.a{constructor(t,e,i,n,o,s,a,r,c,l){super(e,i,t),this.elementRef=t,this.locals=e,this.cdRef=i,this.state=n,this.boardService=o,this.boardActions=s,this.boardCache=a,this.halNotification=r,this.loadingIndicatorService=c,this.I18n=l,this.showClose=!0,this.confirmed=!1,this.available=this.boardActions.available(),this.inFlight=!1,this.text={close_popup:this.I18n.t("js.close_popup_title"),free_board:this.I18n.t("js.boards.board_type.free"),free_board_text:this.I18n.t("js.boards.board_type.free_text"),action_board:this.I18n.t("js.boards.board_type.action"),action_board_text:this.I18n.t("js.boards.board_type.action_text"),select_attribute:this.I18n.t("js.boards.board_type.select_attribute"),placeholder:this.I18n.t("js.placeholders.selection")}}createFree(){this.create({type:"free"})}createAction(){this.create({type:"action",attribute:this.actionAttributeSelect.nativeElement.value})}create(t){this.inFlight=!0,this.loadingIndicatorService.modal.promise=this.boardService.create(t).then(t=>{this.inFlight=!1,this.closeMe(),this.boardCache.update(t),this.state.go("boards.partitioned.show",{board_id:t.id,isNew:!0})}).catch(t=>{this.inFlight=!1,this.halNotification.handleRawError(t)})}}we.\u0275fac=function(t){return new(t||we)(r.gc(r.q),r.gc(X.a),r.gc(r.i),r.gc(at.G),r.gc(Y.a),r.gc(J.a),r.gc(Q.a),r.gc(G.a),r.gc(l.a),r.gc(p.a))},we.\u0275cmp=r.ac({type:we,selectors:[["ng-component"]],viewQuery:function(t,e){var i;(1&t&&r.Wc(ve,!0),2&t)&&(r.Nc(i=r.vc())&&(e.actionAttributeSelect=i.first))},features:[r.Qb],decls:24,vars:11,consts:[[1,"op-modal--portal","confirm-form-submit--modal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","confirm-dialog--modal","loading-indicator--location"],[1,"op-modal--modal-header"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"ngdialog-body","op-modal--modal-body"],[1,"new-board--section"],[3,"textContent"],[1,"button",3,"disabled","accessibleClick"],["icon-classes","icon4 icon-add"],[1,"form--field"],[1,"form--field-container"],[1,"form--select-container","-slim"],["for","new_board_action_select",1,"form--label",3,"textContent"],["name","new_board_action_select","id","new_board_action_select",1,"new-board--action-select"],["actionAttributeSelect",""],[3,"value","textContent",4,"ngFor","ngForOf"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[3,"value","textContent"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"div",1),r.mc(2,"div",2),r.Yc(3,Ce,2,1,"a",3),r.lc(),r.mc(4,"div",4),r.mc(5,"section",5),r.hc(6,"h3",6),r.hc(7,"p",6),r.mc(8,"button",7),r.uc("accessibleClick",(function(){return e.createFree()})),r.hc(9,"op-icon",8),r.hc(10,"span",6),r.lc(),r.lc(),r.mc(11,"section",5),r.hc(12,"h3",6),r.hc(13,"p",6),r.mc(14,"div",9),r.mc(15,"div",10),r.mc(16,"div",11),r.hc(17,"label",12),r.mc(18,"select",13,14),r.Yc(20,ye,1,2,"option",15),r.lc(),r.lc(),r.lc(),r.lc(),r.mc(21,"button",7),r.uc("accessibleClick",(function(){return e.createAction()})),r.hc(22,"op-icon",8),r.hc(23,"span",6),r.lc(),r.lc(),r.lc(),r.lc(),r.lc()),2&t&&(r.Tb(3),r.Bc("ngIf",e.showClose),r.Tb(3),r.Bc("textContent",e.text.free_board),r.Tb(1),r.Bc("textContent",e.text.free_board_text),r.Tb(1),r.Bc("disabled",e.inFlight),r.Tb(2),r.Bc("textContent",e.text.free_board),r.Tb(2),r.Bc("textContent",e.text.action_board),r.Tb(1),r.Bc("textContent",e.text.action_board_text),r.Tb(4),r.Bc("textContent",e.text.select_attribute),r.Tb(3),r.Bc("ngForOf",e.available),r.Tb(1),r.Bc("disabled",e.inFlight),r.Tb(2),r.Bc("textContent",e.text.action_board))},directives:[P.q,me.a,fe.a,P.p,It.r,It.B],encapsulation:2});var _e=i("fbLK"),ke=i("Qs0b");var xe=i("AEvm"),Ie=i("jhN1"),Se=i("HN1l"),Oe=i("QihR"),je=i("/Rze");function Te(t,e){if(1&t){const t=r.nc();r.mc(0,"li",10),r.mc(1,"a",11),r.uc("click",(function(){return r.Qc(t),r.wc(2).newBoard()})),r.hc(2,"op-icon",12),r.hc(3,"span",13),r.lc(),r.lc()}if(2&t){const t=r.wc(2);r.Tb(3),r.Bc("textContent",t.text.board)}}function Be(t,e){if(1&t&&(r.mc(0,"ul",8),r.Yc(1,Te,4,1,"li",9),r.lc()),2&t){const t=r.wc();r.Tb(1),r.Bc("ngIf",t.canAdd)}}function Me(t,e){if(1&t&&(r.mc(0,"tr",23),r.mc(1,"td",24),r.mc(2,"span"),r.hc(3,"op-icon",25),r.mc(4,"span"),r.hc(5,"strong",3),r.lc(),r.lc(),r.lc(),r.lc()),2&t){const t=r.wc(2);r.Tb(5),r.Bc("textContent",t.text.noResults)}}function Pe(t,e){if(1&t&&r.hc(0,"span",3),2&t){const t=r.wc(3);r.Bc("textContent",t.text.type_free)}}function De(t,e){if(1&t&&r.hc(0,"span",3),2&t){const t=r.wc().$implicit,e=r.wc(2);r.Bc("textContent",e.text.action_by_attribute(t.actionAttribute))}}function Ae(t,e){if(1&t){const t=r.nc();r.mc(0,"accessible-by-keyboard",32),r.uc("execute",(function(){r.Qc(t);const e=r.wc().$implicit;return r.wc(2).destroyBoard(e)})),r.ad(1),r.lc()}if(2&t){const t=r.wc(3);r.Tb(1),r.cd(" ",t.text.delete," ")}}const Re=function(t){return{board_id:t}};function qe(t,e){if(1&t&&(r.mc(0,"tr"),r.mc(1,"td",26),r.hc(2,"a",27),r.lc(),r.mc(3,"td"),r.Yc(4,Pe,1,1,"span",28),r.Yc(5,De,1,1,"span",28),r.lc(),r.mc(6,"td"),r.hc(7,"op-date-time",29),r.lc(),r.mc(8,"td",30),r.Yc(9,Ae,2,1,"accessible-by-keyboard",31),r.lc(),r.lc()),2&t){const t=e.$implicit;r.Tb(2),r.Bc("textContent",t.name)("uiParams",r.Gc(6,Re,t.id)),r.Tb(2),r.Bc("ngIf",t.isFree),r.Tb(1),r.Bc("ngIf",t.isAction),r.Tb(2),r.Bc("dateTimeValue",t.createdAt),r.Tb(2),r.Bc("ngIf",t.editable)}}function Fe(t,e){if(1&t&&(r.mc(0,"div",14),r.mc(1,"div",15),r.mc(2,"table",16),r.mc(3,"colgroup"),r.hc(4,"col",17),r.hc(5,"col",17),r.hc(6,"col",17),r.hc(7,"col",17),r.hc(8,"col"),r.lc(),r.mc(9,"thead"),r.mc(10,"tr"),r.mc(11,"th"),r.mc(12,"div",18),r.mc(13,"div",19),r.hc(14,"span",3),r.lc(),r.lc(),r.lc(),r.mc(15,"th"),r.mc(16,"div",18),r.mc(17,"div",19),r.hc(18,"span",3),r.lc(),r.lc(),r.lc(),r.mc(19,"th"),r.mc(20,"div",18),r.mc(21,"div",19),r.hc(22,"span",3),r.lc(),r.lc(),r.lc(),r.mc(23,"th"),r.hc(24,"div",20),r.lc(),r.lc(),r.lc(),r.mc(25,"tbody"),r.Yc(26,Me,6,1,"tr",21),r.Yc(27,qe,10,8,"tr",22),r.lc(),r.lc(),r.lc(),r.lc()),2&t){const t=e.ngIf,i=r.wc();r.Tb(14),r.Bc("textContent",i.text.name),r.Tb(4),r.Bc("textContent",i.text.type),r.Tb(4),r.Bc("textContent",i.text.createdAt),r.Tb(4),r.Bc("ngIf",0===t.length),r.Tb(1),r.Bc("ngForOf",t)}}function Le(t,e){if(1&t&&(r.mc(0,"div",33),r.mc(1,"p"),r.ad(2),r.lc(),r.mc(3,"p"),r.ad(4),r.lc(),r.mc(5,"a",34),r.ad(6),r.lc(),r.mc(7,"a",35),r.ad(8),r.lc(),r.mc(9,"div",36),r.hc(10,"iframe",37),r.lc(),r.lc()),2&t){const t=r.wc();r.Tb(2),r.bd(t.text.teaser_text),r.Tb(2),r.bd(t.text.enterprise),r.Tb(1),r.Bc("href",t.eeLink(),r.Tc),r.Tb(1),r.cd(" ",t.text.upgrade," "),r.Tb(1),r.Bc("href",t.demoLink(),r.Tc),r.Tb(1),r.cd(" ",t.text.personal_demo," "),r.Tb(2),r.Bc("src",t.teaserVideoURL,r.Sc)}}class Qe extends xe.a{constructor(t,e,i,n,o,s,a,r,c,l){super(),this.boardService=t,this.boardCache=e,this.I18n=i,this.notifications=n,this.opModalService=o,this.loadingIndicatorService=s,this.authorisationService=a,this.injector=r,this.bannerService=c,this.domSanitizer=l,this.text={name:this.I18n.t("js.modals.label_name"),board:this.I18n.t("js.label_board"),boards:this.I18n.t("js.label_board_plural"),type:this.I18n.t("js.boards.label_board_type"),type_free:this.I18n.t("js.boards.board_type.free"),action_by_attribute:t=>this.I18n.t("js.boards.board_type.action_by_attribute",{attribute:this.I18n.t("js.boards.board_type.action_type."+t)}),createdAt:this.I18n.t("js.label_created_on"),delete:this.I18n.t("js.button_delete"),areYouSure:this.I18n.t("js.text_are_you_sure"),deleteSuccessful:this.I18n.t("js.notice_successful_delete"),noResults:this.I18n.t("js.notice_no_results_to_display"),teaser_text:this.I18n.t("js.boards.upsale.teaser_text"),enterprise:this.I18n.t("js.boards.upsale.upgrade_to_ee_text"),upgrade:this.I18n.t("js.boards.upsale.upgrade"),personal_demo:this.I18n.t("js.boards.upsale.personal_demo")},this.canAdd=!1,this.boards$=this.boardCache.observeAll(),this.teaserVideoURL=this.domSanitizer.bypassSecurityTrustResourceUrl("https://player.vimeo.com/video/337280106")}ngOnInit(){this.authorisationService.observeUntil(Object(nt.b)(this)).subscribe(()=>{this.canAdd=this.authorisationService.can("boards","create")})}ngAfterViewInit(){this.loadingIndicatorService.indicator("boards-module").promise=this.boardService.loadAllBoards()}newBoard(){this.opModalService.show(we,this.injector)}destroyBoard(t){window.confirm(this.text.areYouSure)&&this.boardService.delete(t).then(()=>{this.boardCache.clearSome(t.id),this.notifications.addSuccess(this.text.deleteSuccessful)}).catch(t=>this.notifications.addError("Deletion failed: "+t))}showBoardIndexView(){return!this.bannerService.eeShowBanners}eeLink(){return ke.b+"&op_referrer=boards"}demoLink(){return ke.a}}Qe.\u0275fac=function(t){return new(t||Qe)(r.gc(Y.a),r.gc(Q.a),r.gc(p.a),r.gc($.a),r.gc(X.b),r.gc(l.a),r.gc(V.a),r.gc(r.A),r.gc(_e.a),r.gc(Ie.b))},Qe.\u0275cmp=r.ac({type:Qe,selectors:[["ng-component"]],features:[r.Qb],decls:9,vars:6,consts:[[1,"toolbar-container"],[1,"toolbar"],[1,"title-container"],[3,"textContent"],["class","toolbar-items",4,"ngIf"],["data-indicator-name","boards-module",1,"boards--listing-group","loading-indicator--location"],["class","generic-table--container",4,"ngIf"],["class","boards--teaser-container",4,"ngIf"],[1,"toolbar-items"],["class","toolbar-item",4,"ngIf"],[1,"toolbar-item"],[1,"button","-alt-highlight",3,"click"],["icon-classes","button--icon icon-add"],[1,"button--text",3,"textContent"],[1,"generic-table--container"],[1,"generic-table--results-container"],[1,"generic-table"],["highlight-col",""],[1,"generic-table--sort-header-outer"],[1,"generic-table--sort-header"],[1,"generic-table--empty-header"],["id","empty-row-notification",4,"ngIf"],[4,"ngFor","ngForOf"],["id","empty-row-notification"],["colspan","4"],["icon-classes","icon-info1 icon-context"],[1,"name"],["uiSref","boards.partitioned.show",3,"textContent","uiParams"],[3,"textContent",4,"ngIf"],[3,"dateTimeValue"],[1,"buttons"],["linkClass","icon icon-delete",3,"execute",4,"ngIf"],["linkClass","icon icon-delete",3,"execute"],[1,"boards--teaser-container"],["target","blank",1,"button","-alt-highlight","-with-icon","icon-checkmark",3,"href"],[1,"button","-highlight-inverted",3,"href"],[1,"boards--teaser-video-container"],["frameborder","0","allow","autoplay; fullscreen","allowfullscreen","",1,"boards--teaser-video",3,"src"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"div",1),r.mc(2,"div",2),r.hc(3,"h2",3),r.lc(),r.Yc(4,Be,2,1,"ul",4),r.lc(),r.lc(),r.mc(5,"div",5),r.Yc(6,Fe,28,5,"div",6),r.xc(7,"async"),r.lc(),r.Yc(8,Le,11,7,"div",7)),2&t&&(r.Tb(3),r.Bc("textContent",e.text.boards),r.Tb(1),r.Bc("ngIf",e.showBoardIndexView()),r.Tb(2),r.Bc("ngIf",e.showBoardIndexView()&&r.yc(7,4,e.boards$)),r.Tb(2),r.Bc("ngIf",!e.showBoardIndexView()))},directives:[P.q,fe.a,Se.a,P.p,s.AnchorUISref,s.UISref,Oe.a,je.a],pipes:[P.a],styles:[".boards--listing-group[_ngcontent-%COMP%]{position:relative}.boards--teaser-video-container[_ngcontent-%COMP%]{height:50vh;text-align:center}.boards--teaser-video-container[_ngcontent-%COMP%]   .boards--teaser-video[_ngcontent-%COMP%]{width:100%;height:100%}"]});var $e=i("yCBR"),Ve=i("4EDS"),Ee=i("CS/5");function Ne(t,e){if(1&t){const t=r.nc();r.mc(0,"a",15),r.mc(1,"i",16),r.uc("click",(function(e){return r.Qc(t),r.wc().closeMe(e)})),r.lc(),r.lc()}if(2&t){const t=r.wc();r.Tb(1),r.Ub("title",t.text.close_popup)}}function He(t,e){if(1&t&&(r.mc(0,"div",17),r.mc(1,"div",18),r.hc(2,"p",19),r.lc(),r.lc()),2&t){const t=r.wc();r.Tb(2),r.Bc("innerHTML",t.warningText,r.Rc)}}const Ye=function(t){return{availableValues:t,appendTo:"body",model:"",classes:"new-list--action-select",finishedLoading:!0}};class Ue extends ae.a{constructor(t,e,i,n,o,s,a,r){super(e,i,t),this.elementRef=t,this.locals=e,this.cdRef=i,this.boardActions=n,this.state=o,this.boardService=s,this.boardCache=a,this.I18n=r,this.confirmed=!1,this.availableValues=[],this.inFlight=!1,this.trackByHref=Ve.a.trackByHref,this.closeOnOutsideClick=!1,this.valuesAvailable=!0,this.text={title:this.I18n.t("js.boards.add_list"),button_add:this.I18n.t("js.button_add"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title"),free_board:this.I18n.t("js.boards.board_type.free"),free_board_text:this.I18n.t("js.boards.board_type.free_text"),action_board:this.I18n.t("js.boards.board_type.action"),action_board_text:this.I18n.t("js.boards.board_type.action_text"),select_attribute:this.I18n.t("js.boards.board_type.select_attribute"),placeholder:this.I18n.t("js.placeholders.selection")},this.referenceOutputs={onCreate:t=>this.onNewActionCreated(t),onChange:t=>this.onModelChange(t),onAfterViewInit:t=>t.focusInputField()}}ngOnInit(){super.ngOnInit(),this.board=this.locals.board,this.active=new Set(this.locals.active),this.actionService=this.boardActions.get(this.board.actionAttribute),this.actionService.getAvailableValues(this.board,this.active).then(t=>{this.availableValues=t,0===this.availableValues.length&&this.actionService.warningTextWhenNoOptionsAvailable().then(t=>{this.warningText=t,this.valuesAvailable=!1})})}onModelChange(t){this.selectedAttribute=t}create(){this.inFlight=!0,this.actionService.addActionQuery(this.board,this.selectedAttribute).then(t=>this.boardService.save(t)).then(t=>{this.inFlight=!1,this.closeMe(),this.boardCache.update(t),this.state.go("boards.partitioned.show",{board_id:t.id,isNew:!0})}).catch(()=>this.inFlight=!1)}onNewActionCreated(t){this.selectedAttribute=t,this.create()}autocompleterComponent(){return this.actionService.autocompleterComponent()}}Ue.\u0275fac=function(t){return new(t||Ue)(r.gc(r.q),r.gc(X.a),r.gc(r.i),r.gc(J.a),r.gc(at.G),r.gc(Y.a),r.gc(Q.a),r.gc(p.a))},Ue.\u0275cmp=r.ac({type:Ue,selectors:[["ng-component"]],features:[r.Qb],decls:15,vars:14,consts:[[1,"op-modal--portal","confirm-form-submit--modal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","confirm-dialog--modal","loading-indicator--location","-slim"],[1,"op-modal--modal-header"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"icon-context","icon-add",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[1,"form--field"],[1,"form--field-container"],[1,"form--select-container"],[1,"form--label",3,"textContent"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"],["class","notification-box -warning",4,"ngIf"],[1,"op-modal--modal-footer"],[1,"button","-highlight",3,"disabled","textContent","click"],[1,"confirm-form-submit--cancel","button",3,"textContent","click"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[1,"notification-box","-warning"],[1,"notification-box--content"],[3,"innerHTML"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"div",1),r.mc(2,"div",2),r.Yc(3,Ne,2,1,"a",3),r.hc(4,"h3",4),r.lc(),r.mc(5,"div",5),r.mc(6,"div",6),r.mc(7,"div",7),r.mc(8,"div",8),r.hc(9,"label",9),r.hc(10,"ndc-dynamic",10),r.lc(),r.lc(),r.lc(),r.Yc(11,He,3,1,"div",11),r.lc(),r.mc(12,"div",12),r.mc(13,"button",13),r.uc("click",(function(){return e.create()})),r.lc(),r.mc(14,"button",14),r.uc("click",(function(t){return e.closeMe(t)})),r.lc(),r.lc(),r.lc(),r.lc()),2&t&&(r.Tb(3),r.Bc("ngIf",e.showClose),r.Tb(1),r.Bc("textContent",e.text.title),r.Tb(5),r.Bc("textContent",e.actionService.localizedName),r.Tb(1),r.Bc("ndcDynamicComponent",e.autocompleterComponent())("ndcDynamicInputs",r.Gc(12,Ye,e.availableValues))("ndcDynamicOutputs",e.referenceOutputs),r.Tb(1),r.Bc("ngIf",!e.valuesAvailable&&e.warningText),r.Tb(2),r.Bc("disabled",!e.selectedAttribute||e.inFlight)("textContent",e.text.button_add),r.Ub("title",e.text.button_add),r.Tb(1),r.Bc("textContent",e.text.button_cancel),r.Ub("title",e.text.button_cancel))},directives:[P.q,Ee.c,Ee.d],encapsulation:2});class We extends oe.a{constructor(t,e,i,n,o,s,a,r,c,l){super(t,e),this.elementRef=t,this.opContextMenu=e,this.opModalService=i,this.authorisationService=n,this.wpInlineCreate=o,this.boardList=s,this.injector=a,this.querySpace=r,this.cdRef=c,this.I18n=l,this.focusAfterClose=!0}open(t){this.items=this.buildItems(),this.opContextMenu.show(this,t)}positionArgs(t){let e=super.positionArgs(t);return _.assign(e,{my:"left top",at:"left bottom"}),e}buildItems(){return[{disabled:!this.wpInlineCreate.canAdd,linkText:this.I18n.t("js.card.add_new"),onClick:()=>(this.boardList.addNewCard(),!0)},{disabled:!this.wpInlineCreate.canReference,linkText:this.I18n.t("js.relation_buttons.add_existing"),onClick:()=>(this.boardList.addReferenceCard(),!0)}]}}We.\u0275fac=function(t){return new(t||We)(r.gc(r.q),r.gc(se.a),r.gc(X.b),r.gc(V.a),r.gc(d.a),r.gc(xt),r.gc(r.A),r.gc(u.a),r.gc(r.i),r.gc(p.a))},We.\u0275dir=r.bc({type:We,selectors:[["","addCardDropdown",""]],features:[r.Qb]});var ze=i("OGNV"),Ge=i("B4Ei"),Je=i("F5Dh"),Ke=i("yrbL"),Xe=i("eaMR");class Ze extends xe.a{constructor(t,e,i,n,o,s,a,r,c){super(),this.currentProjectService=t,this.querySpace=e,this.halResourceService=i,this.wpStatesInitialization=n,this.wpTableFilters=o,this.urlParamsHelper=s,this.boardFilters=a,this.$state=r,this.queryFormDm=c,this.initialized=!1}ngAfterViewInit(){this.board$&&this.board$.pipe(Object(Ke.take)(1)).subscribe(t=>{this.loadQueryForm(),this.updateChecksumOnFilterChanges(),t.isAction&&this.wpTableFilters.hidden.push(t.actionAttribute)})}updateChecksumOnFilterChanges(){this.wpTableFilters.live$().pipe(this.untilDestroyed(),Object(Ke.skip)(1),Object(Ke.debounceTime)(250)).subscribe(()=>{const t=this.wpTableFilters.current;let e=this.urlParamsHelper.buildV3GetFilters(t),i=JSON.stringify(e);this.boardFilters.filters.putValue(e),this.$state.go(".",{query_props:i},{custom:{notify:!1}})})}loadQueryForm(){this.queryFormDm.loadWithParams({filters:JSON.stringify(this.boardFilters.current)},void 0,this.currentProjectService.id).then(t=>{const e=this.halResourceService.createHalResourceOfClass(Ge.a,t.payload.$source);this.querySpace.query.putValue(e),this.wpStatesInitialization.updateStatesFromForm(e,t)})}}Ze.\u0275fac=function(t){return new(t||Ze)(r.gc(S.a),r.gc(u.a),r.gc(b.a),r.gc(H.a),r.gc(Je.a),r.gc(M.a),r.gc(st),r.gc(at.G),r.gc(ze.a))},Ze.\u0275cmp=r.ac({type:Ze,selectors:[["board-filter"]],inputs:{board$:"board$"},features:[r.Qb],decls:1,vars:0,template:function(t,e){1&t&&r.hc(0,"filter-container")},directives:[Xe.a],encapsulation:2});var ti=i("5+WD"),ei=i("2Vo4"),ii=i("xgIS"),ni=i("1G5W");class oi{constructor(t,e){this.container=t,this.scrollCallback=e,this.margin=30,this.maxSpeed=25,this.point={x:0,y:0},this.boundaryRect=this.container.getBoundingClientRect()}onMove(t){this.point=t,cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(()=>this.scrollTick())}scrollTick(){cancelAnimationFrame(this.animationFrame),this.autoScroll()&&(this.animationFrame=requestAnimationFrame(()=>this.scrollTick()))}autoScroll(){let t,e;return t=this.point.x<this.boundaryRect.left+this.margin?Math.floor(Math.max(-1,(this.point.x-this.boundaryRect.left)/this.margin-1)*this.maxSpeed):this.point.x>this.boundaryRect.right-this.margin?Math.ceil(Math.min(1,(this.point.x-this.boundaryRect.right)/this.margin+1)*this.maxSpeed):0,e=this.point.y<this.boundaryRect.top+this.margin?Math.floor(Math.max(-1,(this.point.y-this.boundaryRect.top)/this.margin-1)*this.maxSpeed):this.point.y>this.boundaryRect.bottom-this.margin?Math.ceil(Math.min(1,(this.point.y-this.boundaryRect.bottom)/this.margin+1)*this.maxSpeed):0,setTimeout(()=>{e&&this.scrollY(e),t&&this.scrollX(t)}),t||e}scrollY(t){this.container.scrollTop+=t,this.scrollCallback&&this.scrollCallback({x:0,y:t})}scrollX(t){this.container.scrollLeft+=t,this.scrollCallback&&this.scrollCallback({x:t,y:0})}destroy(){cancelAnimationFrame(this.animationFrame)}}class si{constructor(){this.debugInfo=new ei.a(null),this.enabled=!1}log(t){this.debugInfo.next(t)}reset(){this.debugInfo.next(null)}}si.\u0275fac=function(t){return new(t||si)},si.\u0275prov=r.cc({token:si,factory:si.\u0275fac,providedIn:"root"}),si.ctorParameters=()=>[],si.ngInjectableDef=Object(r.cc)({factory:function(){return new si},token:si,providedIn:"root"});class ai{constructor(t,e,i,n){this.cdkDrag=t,this.dragDebugService=e,this.zone=i,this.changeDetectorRef=n,this.destroy$=new m.a,this.stopDragging$=new m.a,this.lastScroll={top:0,left:0},this.dragRef=this.cdkDrag._dragRef,this.dragRef?this.zone.runOutsideAngular(()=>{this.dragRef.started.pipe(Object(ni.a)(this.destroy$)).subscribe(t=>{this.log("Started",t,this.dragRef.isDragging()),this.started()}),this.dragRef.ended.pipe(Object(ni.a)(this.destroy$)).subscribe(t=>{this.log("Ended",t),this.ended()}),this.dragRef.entered.pipe(Object(ni.a)(this.destroy$)).subscribe(t=>{this.log("Entered",t),this.entered()}),this.dragRef.exited.pipe(Object(ni.a)(this.destroy$)).subscribe(t=>{this.log("Exited",t),this.exited()})}):this.log("CdkDrag not found",this.cdkDrag,this.dragRef)}ngOnChanges(t){t.dragConnectedIds&&this.dragRef.isDragging()&&setTimeout(()=>{this.syncSiblings()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.stopDragging$.next(),this.stopDragging$.complete(),this.destroyAutoScroll()}started(){this.scrollContainer&&(this.destroyAutoScroll(),this.addDebugInfo(),this.autoScroll=new oi(this.scrollContainer),this.lastScroll.top=this.scrollContainer.scrollTop,this.lastScroll.left=this.scrollContainer.scrollLeft,Object(ii.a)(this.scrollContainer,"scroll").pipe(Object(ni.a)(this.stopDragging$)).subscribe(()=>{const t=this.scrollContainer.scrollLeft-this.lastScroll.left,e=this.scrollContainer.scrollTop-this.lastScroll.top;(t||e)&&this.handleScroll(t,e),this.lastScroll.top=this.scrollContainer.scrollTop,this.lastScroll.left=this.scrollContainer.scrollLeft}),this.dragRef.moved.pipe(Object(v.a)(10),Object(ni.a)(this.stopDragging$)).subscribe(t=>{this.autoScroll.onMove(t.pointerPosition)}))}ended(){this.destroyAutoScroll(),this.stopDragging$.next(),this.dragDebugService.reset()}entered(){this.dragFixContainer()}exited(){this.dragFixContainer()}handleScroll(t,e){const i=this.getDropListRef();this.adjustContainers(),this.adjustItems(t,e),i._draggables.length>i._itemPositions.length&&this.syncItems(),this.addDebugInfo()}destroyAutoScroll(){this.autoScroll&&(this.autoScroll.destroy(),this.autoScroll=null)}getDropListRef(){return this.dragRef._dropContainer}addDebugInfo(){if(!this.dragDebugService.enabled)return;const t=this.getDropListRef(),e=[...t._itemPositions.map(t=>({clientRect:t.clientRect,color:"blue",id:t.drag.data.data.name})),...t._siblings.map(t=>({clientRect:t._clientRect,color:"green",id:""})),{clientRect:t._clientRect,color:"#2FD1BB",id:""}];this.dragDebugService.log(e.filter(t=>t.clientRect))}dragFixContainer(){setTimeout(()=>{this.getDropListRef()._cacheOwnPosition(),this.addDebugInfo()}),this.changeDetectorRef.markForCheck()}syncSiblings(){const t=this.getDropListRef();this.log("syncSiblings before",t._siblings.length),t.beforeStarted.next(),this.log("syncSiblings after",t._siblings.length),this.adjustContainers()}syncItems(){const t=this.getDropListRef(),e=t._itemPositions;t._activeDraggables=t._draggables.slice(),t._cacheItemPositions();const i=t._itemPositions;t._itemPositions=[...e],i.forEach(i=>{e.find(t=>i.drag===t.drag)||t._itemPositions.push(i)}),t._activeDraggables.push(this.dragRef)}adjustContainers(){const t=this.getDropListRef();t._cacheOwnPosition(),t._siblings.forEach(t=>{t._cacheOwnPosition()})}adjustItems(t,e){this.getDropListRef()._itemPositions.forEach(i=>{i.originalRect=i.originalRect||i.clientRect,i.clientRect=Object.assign({},i.clientRect,{left:i.clientRect.left-t,right:i.clientRect.right-t,top:i.clientRect.top-e,bottom:i.clientRect.bottom-e})})}log(t,...e){this.dragDebugService.enabled&&console.log(t,e)}}ai.\u0275fac=function(t){return new(t||ai)(r.gc(ti.a),r.gc(si),r.gc(r.K),r.gc(r.i))},ai.\u0275dir=r.bc({type:ai,selectors:[["","vsDragScroll",""]],inputs:{dragConnectedIds:["vsDragScrollConnectedTo","dragConnectedIds"],scrollContainer:["vsDragScrollContainer","scrollContainer"]},exportAs:["vsDragScroll"],features:[r.Rb]}),ai.ctorParameters=()=>[{type:ti.a},{type:si},{type:r.K},{type:r.i}],ai.propDecorators={dragConnectedIds:[{type:r.B,args:["vsDragScrollConnectedTo"]}],scrollContainer:[{type:r.B,args:["vsDragScrollContainer"]}]};class ri{}ri.\u0275mod=r.ec({type:ri}),ri.\u0275inj=r.dc({factory:function(t){return new(t||ri)},imports:[[ti.g]]});var ci=i("tmNb"),li=i("p5fp"),di=i("qvi4");class hi{constructor(t){this.I18n=t,this.text={button_more:this.I18n.t("js.button_more")}}}hi.\u0275fac=function(t){return new(t||hi)(r.gc(p.a))},hi.\u0275cmp=r.ac({type:hi,selectors:[["ng-component"]],inputs:{board$:"board$"},decls:3,vars:4,consts:[["boardsToolbarMenu","",1,"button","last","board--settings-dropdown","toolbar-icon",3,"title","boardsToolbarMenu-resource"],["icon-classes","button--icon icon-show-more"]],template:function(t,e){1&t&&(r.mc(0,"button",0),r.xc(1,"async"),r.hc(2,"op-icon",1),r.lc()),2&t&&(r.Cc("title",e.text.button_more),r.Bc("boardsToolbarMenu-resource",r.yc(1,2,e.board$)))},directives:[pe,fe.a],pipes:[P.a],encapsulation:2});class ui{constructor(t){this.handler=t,this.requests=new m.a,this.responses$=this.requests.pipe(Object(w.a)(this.handler))}request(t){this.requests.next(t)}observe(t){return this.responses$.pipe(Object(ni.a)(t))}}var bi=i("Cfvw"),gi=(i("Wcm6"),i("DLfB"));function pi(t,e){if(1&t&&r.hc(0,"back-button",11),2&t){const t=r.wc();r.Bc("customBackMethod",t.backButtonCallback)}}function mi(t,e){if(1&t&&(r.mc(0,"li",15),r.hc(1,"ndc-dynamic",16),r.lc()),2&t){const t=r.wc().$implicit,e=r.wc(2);r.Bc("ngClass",t.containerClasses),r.Tb(1),r.Bc("ndcDynamicComponent",t.component)("ndcDynamicInputs",t.inputs)("ndcDynamicInjector",e.injector)("ndcDynamicOutputs",t.outputs)}}function fi(t,e){if(1&t&&(r.kc(0),r.Yc(1,mi,2,5,"li",14),r.jc()),2&t){const t=e.$implicit;r.Tb(1),r.Bc("ngIf",!t.show||t.show())}}function vi(t,e){if(1&t&&(r.mc(0,"ul",12),r.Yc(1,fi,2,1,"ng-container",13),r.lc()),2&t){const t=r.wc();r.Tb(1),r.Bc("ngForOf",t.toolbarButtonComponents)}}class Ci extends xe.a{constructor(t,e,i,n,o,s,a,r,c,l){super(),this.I18n=t,this.cdRef=e,this.$transitions=i,this.state=n,this.notifications=o,this.halNotification=s,this.injector=a,this.BoardCache=r,this.boardFilters=c,this.Boards=l,this.text={button_more:this.I18n.t("js.button_more"),delete:this.I18n.t("js.button_delete"),areYouSure:this.I18n.t("js.text_are_you_sure"),deleteSuccessful:this.I18n.t("js.notice_successful_delete"),updateSuccessful:this.I18n.t("js.notice_successful_update"),unnamedBoard:this.I18n.t("js.boards.label_unnamed_board"),loadingError:"No such board found",addList:this.I18n.t("js.boards.add_list"),upsaleBoards:this.I18n.t("js.boards.upsale.teaser_text"),upsaleCheckOutLink:this.I18n.t("js.work_packages.table_configuration.upsale.check_out_link"),unnamed_list:this.I18n.t("js.boards.label_unnamed_list")},this.board$=this.BoardCache.observe(this.state.params.board_id.toString()),this.isNew=!!this.state.params.isNew,this.backButtonCallback=()=>this.state.go("boards"),this.toolbarDisabled=!1,this.showToolbar=!0,this.filterAllowed=!0,this.currentPartition="-split",this.filterContainerDefinition={component:Ze,inputs:{board$:this.board$}},this.boardSaver=new ui(t=>{this.toolbarDisabled=!0;const e=this.Boards.save(t).then(t=>(this.toolbarDisabled=!1,t)).catch(t=>{throw this.toolbarDisabled=!1,t});return Object(bi.a)(e)}),this.toolbarButtonComponents=[{component:li.a,containerClasses:"hidden-for-mobile"},{component:di.a,containerClasses:"hidden-for-mobile"},{component:hi,containerClasses:"hidden-for-mobile",show:()=>this.editable,inputs:{board$:this.board$}}]}ngOnInit(){this.Boards.loadAllBoards(),this.boardSaver.observe(Object(nt.b)(this)).subscribe(t=>{this.BoardCache.update(t),this.notifications.addSuccess(this.text.updateSuccessful)},t=>this.halNotification.handleRawError(t)),this.removeTransitionSubscription=this.$transitions.onSuccess({},t=>{const e=t.to(),i=t.params("to");this.showToolbarSaveButton=!!i.query_props,this.setPartition(e),this.cdRef.detectChanges()}),this.board$.pipe(this.untilDestroyed()).subscribe(t=>{let e=this.state.params.query_props;this.editable=t.editable,this.selectedTitle=t.name,this.boardFilters.filters.putValue(e?JSON.parse(e):t.filters),this.cdRef.detectChanges()})}ngOnDestroy(){super.ngOnDestroy(),this.removeTransitionSubscription()}changeChangesFromTitle(t){this.board$.pipe(Object(Xt.a)(1)).subscribe(e=>{e.name=t,e.filters=this.boardFilters.current;this.state.go(".",{isNew:!1,query_props:null},{custom:{notify:!1}}),this.boardSaver.request(e)})}updateTitleName(t){this.changeChangesFromTitle(t)}get titleEditingEnabled(){return this.editable}setPartition(t){this.currentPartition=t.data&&t.data.partition?t.data.partition:"-split"}}Ci.\u0275fac=function(t){return new(t||Ci)(r.gc(p.a),r.gc(r.i),r.gc(at.O),r.gc(at.G),r.gc($.a),r.gc(G.a),r.gc(r.A),r.gc(Q.a),r.gc(st),r.gc(Y.a))},Ci.\u0275cmp=r.ac({type:Ci,selectors:[["ng-component"]],features:[r.Sb([ci.a,st]),r.Qb],decls:11,vars:11,consts:[[1,"work-packages-partitioned-query-space--container",3,"ngClass"],[1,"toolbar-container","-editable"],[1,"toolbar"],["linkClass","back-button",3,"customBackMethod",4,"ngIf"],[3,"title","inFlight","showSaveCondition","editable","onSave","onEmptySubmit"],["class","toolbar-items hide-when-print",4,"ngIf"],[1,"work-packages-partitioned-query-space--filter-area"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector"],[1,"work-packages-partitioned-page--content-container"],["data-indicator-name","table","ui-view","content-left",1,"work-packages-partitioned-page--content-left","loading-indicator--location"],["ui-view","content-right",1,"work-packages-partitioned-page--content-right"],["linkClass","back-button",3,"customBackMethod"],[1,"toolbar-items","hide-when-print"],[4,"ngFor","ngForOf"],["class","toolbar-item",3,"ngClass",4,"ngIf"],[1,"toolbar-item",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicInjector","ndcDynamicOutputs"]],template:function(t,e){1&t&&(r.mc(0,"div",0),r.mc(1,"div",1),r.mc(2,"div",2),r.Yc(3,pi,1,1,"back-button",3),r.mc(4,"editable-toolbar-title",4),r.uc("onSave",(function(t){return e.changeChangesFromTitle(t)}))("onEmptySubmit",(function(){return e.updateTitleName("")})),r.lc(),r.Yc(5,vi,2,1,"ul",5),r.lc(),r.lc(),r.mc(6,"div",6),r.hc(7,"ndc-dynamic",7),r.lc(),r.mc(8,"div",8),r.hc(9,"div",9),r.hc(10,"div",10),r.lc(),r.lc()),2&t&&(r.Bc("ngClass",e.currentPartition),r.Tb(3),r.Bc("ngIf",e.backButtonCallback),r.Tb(1),r.Bc("title",e.selectedTitle)("inFlight",e.toolbarDisabled)("showSaveCondition",e.showToolbarSaveButton)("editable",e.titleEditingEnabled),r.Tb(1),r.Bc("ngIf",e.showToolbar),r.Tb(2),r.Bc("ndcDynamicComponent",e.filterContainerDefinition.component)("ndcDynamicInputs",e.filterContainerDefinition.inputs)("ndcDynamicOutputs",e.filterContainerDefinition.outputs)("ndcDynamicInjector",e.injector))},directives:[P.n,P.q,ge.a,Ee.c,Ee.d,s.UIView,gi.a,P.p],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]{height:100%;overflow:hidden;display:grid;grid-template-columns:1fr;grid-template-rows:auto auto minmax(200px,1fr)}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]{display:flex;overflow:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover{scrollbar-color:#ddd transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{position:relative}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{flex:1}@media only screen and (max-width:679px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{min-width:0;max-width:100vw;max-height:100%}}",".work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{overflow:hidden}"],changeDetection:0});var yi=i("xFOf");const wi=["container"];function _i(t,e){1&t&&r.hc(0,"span",10)}function ki(t,e){if(1&t){const t=r.nc();r.mc(0,"div",7),r.Yc(1,_i,1,0,"span",8),r.mc(2,"board-list",9),r.uc("onRemove",(function(){r.Qc(t);const i=e.$implicit,n=r.wc(2).ngIf;return r.wc().removeList(n,i)})),r.lc(),r.lc()}if(2&t){const t=e.$implicit,i=r.wc(2).ngIf,n=r.wc();r.Bc("cdkDragData",t)("vsDragScrollContainer",n._container),r.Tb(1),r.Bc("ngIf",i.editable),r.Tb(1),r.Bc("resource",t)("board",i)}}function xi(t,e){if(1&t){const t=r.nc();r.mc(0,"div",11),r.uc("click",(function(){r.Qc(t);const e=r.wc(2).ngIf;return r.wc().addList(e)})),r.mc(1,"div",12),r.hc(2,"op-icon",13),r.hc(3,"span",14),r.lc(),r.lc()}if(2&t){const t=r.wc(3);r.Tb(3),r.Bc("textContent",t.text.addList)}}const Ii=function(t){return{"-free":t}};function Si(t,e){if(1&t){const t=r.nc();r.mc(0,"div",3,4),r.uc("cdkDropListDropped",(function(e){r.Qc(t);const i=r.wc().ngIf;return r.wc().moveList(i,e)})),r.Yc(2,ki,3,5,"div",5),r.Yc(3,xi,4,1,"div",6),r.lc()}if(2&t){const t=r.wc().ngIf,e=r.wc();r.Bc("ngClass",r.Gc(5,Ii,t.isFree))("cdkDropListDisabled",!t.editable),r.Tb(2),r.Bc("ngForOf",t.queries)("ngForTrackBy",e.trackByQueryId),r.Tb(1),r.Bc("ngIf",t.editable)}}function Oi(t,e){if(1&t&&r.hc(0,"enterprise-banner",15),2&t){const t=r.wc().ngIf,e=r.wc();r.Bc("leftMargin",!0)("linkMessage",e.text.upsaleCheckOutLink)("textMessage",e.text.upsaleBoards)("opReferrer",e.opReferrer(t))}}function ji(t,e){if(1&t&&(r.kc(0),r.Yc(1,Si,4,7,"div",1),r.Yc(2,Oi,1,4,"enterprise-banner",2),r.jc()),2&t){const t=r.wc();r.Tb(1),r.Bc("ngIf",t.showBoardListView()),r.Tb(1),r.Bc("ngIf",!t.showBoardListView())}}class Ti extends xe.a{constructor(t,e,i,n,o,s,a,r,c,l,d,h,u,b){super(),this.I18n=t,this.state=e,this.notifications=i,this.halNotification=n,this.boardComponent=o,this.BoardList=s,this.opModalService=a,this.injector=r,this.BoardCache=c,this.Boards=l,this.Banner=d,this.boardListCrossSelectionService=h,this.Drag=u,this.QueryUpdated=b,this.text={button_more:this.I18n.t("js.button_more"),delete:this.I18n.t("js.button_delete"),areYouSure:this.I18n.t("js.text_are_you_sure"),deleteSuccessful:this.I18n.t("js.notice_successful_delete"),updateSuccessful:this.I18n.t("js.notice_successful_update"),loadingError:"No such board found",addList:this.I18n.t("js.boards.add_list"),upsaleBoards:this.I18n.t("js.boards.upsale.teaser_text"),upsaleCheckOutLink:this.I18n.t("js.work_packages.table_configuration.upsale.check_out_link"),unnamed_list:this.I18n.t("js.boards.label_unnamed_list")},this.trackByQueryId=(t,e)=>e.options.queryId}set container(t){void 0!==t&&(void 0===this._container&&this.Drag.addScrollContainer(t.nativeElement),setTimeout(()=>this._container=t.nativeElement))}ngOnInit(){const t=this.state.params.board_id.toString();this.board$=this.BoardCache.observe(t),this.Boards.currentBoard$.next(t),this.board$.pipe(this.untilDestroyed()).subscribe(t=>{this.setupQueryUpdatedMonitoring(t)}),this.boardListCrossSelectionService.selections().pipe(this.untilDestroyed(),Object(lt.a)(t=>null!==t.focusedWorkPackage),Object(lt.a)(()=>this.state.includes(this.state.current.data.baseRoute+".details"))).subscribe(t=>{this.state.go(this.state.current.data.baseRoute+".details",{workPackageId:t.focusedWorkPackage})})}moveList(t,e){Object(ti.h)(t.queries,e.previousIndex,e.currentIndex),this.saveBoard(t)}removeList(t,e){t.removeQuery(e),this.saveBoard(t)}addList(t){if(t.isFree)return this.BoardList.addFreeQuery(t,{name:this.text.unnamed_list}).then(t=>this.Boards.save(t)).then(t=>{this.BoardCache.update(t)}).catch(t=>this.showError(t));{const e=this.getActionFiltersFromWidget(t);this.opModalService.show(Ue,this.injector,{board:t,active:e})}}showBoardListView(){return!this.Banner.eeShowBanners}opReferrer(t){return t.isFree?"boards#free":"boards#status"}saveBoard(t){this.boardComponent.boardSaver.request(t)}setupQueryUpdatedMonitoring(t){this.currentQueryUpdatedMonitoring&&this.currentQueryUpdatedMonitoring.unsubscribe(),this.currentQueryUpdatedMonitoring=this.QueryUpdated.monitor(t.queries.map(t=>t.options.queryId)).pipe(this.untilDestroyed()).subscribe(t=>this.requestRefreshOfUpdatedLists(t.elements))}showError(t=this.text.loadingError){this.notifications.addError(t)}requestRefreshOfUpdatedLists(t){t.forEach(t=>{this.lists.filter(e=>t.id.toString()===e.resource.options.queryId.toString()).forEach(e=>e.refreshQueryUnlessCaused(t,!1))})}getActionFiltersFromWidget(t){return t.grid.widgets.map(e=>{const i=e.options,n=_.find(i.filters,e=>!!e[t.actionAttribute]);if(n)return n[t.actionAttribute].values[0]}).filter(t=>!!t)}}Ti.\u0275fac=function(t){return new(t||Ti)(r.gc(p.a),r.gc(at.G),r.gc($.a),r.gc(G.a),r.gc(Ci),r.gc(jt.a),r.gc(X.b),r.gc(r.A),r.gc(Q.a),r.gc(Y.a),r.gc(_e.a),r.gc(dt),r.gc(ci.a),r.gc(zt))},Ti.\u0275cmp=r.ac({type:Ti,selectors:[["ng-component"]],viewQuery:function(t,e){var i;(1&t&&(r.fd(wi,!0),r.fd(xt,!0)),2&t)&&(r.Nc(i=r.vc())&&(e.container=i.first),r.Nc(i=r.vc())&&(e.lists=i))},features:[r.Sb([dt]),r.Qb],decls:2,vars:3,consts:[[4,"ngIf"],["class","boards-list--container","cdkDropList","","cdkDropListOrientation","horizontal",3,"ngClass","cdkDropListDisabled","cdkDropListDropped",4,"ngIf"],[3,"leftMargin","linkMessage","textMessage","opReferrer",4,"ngIf"],["cdkDropList","","cdkDropListOrientation","horizontal",1,"boards-list--container",3,"ngClass","cdkDropListDisabled","cdkDropListDropped"],["container",""],["class","boards-list--item","wp-isolated-query-space","","cdkDrag","","vsDragScroll","",3,"cdkDragData","vsDragScrollContainer",4,"ngFor","ngForOf","ngForTrackBy"],["class","boards-list--add-item -no-text-select",3,"click",4,"ngIf"],["wp-isolated-query-space","","cdkDrag","","vsDragScroll","",1,"boards-list--item",3,"cdkDragData","vsDragScrollContainer"],["class","boards-list-item-handle icon icon-drag-handle","cdkDragHandle","",4,"ngIf"],[3,"resource","board","onRemove"],["cdkDragHandle","",1,"boards-list-item-handle","icon","icon-drag-handle"],[1,"boards-list--add-item","-no-text-select",3,"click"],[1,"boards-list--add-item-text"],["icon-classes","icon-add icon-context"],[3,"textContent"],[3,"leftMargin","linkMessage","textMessage","opReferrer"]],template:function(t,e){1&t&&(r.Yc(0,ji,3,2,"ng-container",0),r.xc(1,"async")),2&t&&r.Bc("ngIf",r.yc(1,1,e.board$))},directives:[P.q,ti.e,P.n,P.p,ie.a,ti.a,ai,xt,ti.b,fe.a,yi.a],pipes:[P.a],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.boards-list--container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;flex-grow:1;height:100%;overflow-y:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.boards-list--container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.boards-list--container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.boards-list--container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.boards-list--container[_ngcontent-%COMP%]:hover{scrollbar-color:#ddd transparent}.boards-list--container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.boards-list-item-handle[_ngcontent-%COMP%]{position:absolute;font-size:14px;left:0;top:18px;z-index:100;opacity:0;cursor:grab}.boards-list--container.-free[_ngcontent-%COMP%]   .boards-list-item-handle[_ngcontent-%COMP%]{top:13px}.boards-list-item-handle[_ngcontent-%COMP%]:before{padding:0;color:var(--light-gray)}.boards-list--item[_ngcontent-%COMP%]:hover   .boards-list-item-handle[_ngcontent-%COMP%]{opacity:1}.boards-list--add-item[_ngcontent-%COMP%]{flex:0 0 auto;height:42px;line-height:42px;font-size:14px;cursor:pointer;color:var(--gray-dark)}.boards-list--add-item[_ngcontent-%COMP%]   .boards-list--add-item-text[_ngcontent-%COMP%]{padding:5px 15px 0}.boards-list--container.-free[_ngcontent-%COMP%]   .boards-list--add-item[_ngcontent-%COMP%]{margin-top:0}.boards-list--add-item[_ngcontent-%COMP%]:hover{color:var(--body-font-color)}.boards-list--item[_ngcontent-%COMP%]{flex:0 0 300px;max-width:300px;position:relative}.boards-list--item[_ngcontent-%COMP%]:first-of-type{margin-left:5px}.boards-list--item.cdk-drag-placeholder[_ngcontent-%COMP%]{border:1px dashed var(--primary-color);pointer-events:none}.boards-list--item.cdk-drag-placeholder[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{visibility:hidden}"]});var Bi=i("/qfM"),Mi=i("PwL/");const Pi=[{name:"boards",parent:"root",url:"/boards/?query_props",data:{bodyClasses:"router--boards-view-base",menuItem:"board-view-menu-item"},params:{query_props:{type:"opQueryString",dynamic:!0}},redirectTo:"boards.list",component:ne},{name:"boards.list",component:Qe,data:{parent:"boards",bodyClasses:"router--boards-list-view",menuItem:"board-view-menu-item"}},{name:"boards.partitioned",url:"{board_id}",params:{board_id:{type:"int"},isNew:{type:"bool",inherit:!1,dynamic:!0}},data:{parent:"boards",bodyClasses:"router--boards-full-view",menuItem:"board-view-menu-item"},reloadOnSearch:!1,component:Ci,redirectTo:"boards.partitioned.show"},{name:"boards.partitioned.show",url:"",data:{baseRoute:"boards.partitioned.show"},views:{"content-left":{component:Ti}}},...Object(Bi.a)("boards.partitioned.show","board-view-menu-item",Mi.a)];var Di=i("+rOU"),Ai=i("1EAr"),Ri=i("ximh"),qi=i("ecJW"),Fi=i("RN/J"),Li=i("CX+C"),Qi=i("YIAj"),$i=i("th4C"),Vi=i("oUDv"),Ei=i("2hMx"),Ni=i("+1L4"),Hi=i("cJ7v"),Yi=i("lmKF"),Ui=i("v9+U"),Wi=i("mRSd"),zi=i("X4Sm"),Gi=i("lfQJ"),Ji=i("8h6p"),Ki=i("IYP9"),Xi=i("upbp"),Zi=i("gh2L"),tn=i("jQQo"),en=i("9hh2"),nn=i("lmDM"),on=i("72oW"),sn=i("CVKj"),an=i("SIjI"),rn=i("ZTEj"),cn=i("70hh"),ln=i("f24R"),dn=i("2orT"),hn=i("Eofd"),un=i("m3nR"),bn=i("ZAVI"),gn=i("9pt+"),pn=i("S2zE"),mn=i("eJFM"),fn=i("sngl"),vn=i("byj5"),Cn=i("2TbE"),yn=i("XZlt"),wn=i("2bW2"),_n=i("aveh");class kn{}kn.\u0275mod=r.ec({type:kn}),kn.\u0275inj=r.dc({factory:function(t){return new(t||kn)},imports:[[n.a,o.a,ri,Ee.f.withComponents([Nt]),s.UIRouterModule.forChild({states:Pi,config:function(t){t.urlService.rules.when(new RegExp("^/projects/(.*)/boards$"),t=>`/projects/${t[1]}/boards/`)}})]]}),r.Uc(xt,[s.UISref,s.AnchorUISref,s.UIView,s.UISrefActive,s.UISrefStatus,P.n,P.o,P.p,P.q,P.x,P.t,P.u,P.v,P.w,P.r,P.s,It.C,It.r,It.B,It.c,It.s,It.v,It.a,It.y,It.z,It.u,It.m,It.n,It.x,It.k,It.j,It.t,It.b,It.d,It.p,It.q,It.o,Di.a,Di.b,Di.h,Di.e,ti.e,ti.f,ti.a,ti.b,ti.d,ti.c,me.a,Ai.a,je.a,I.a,I.n,I.d,I.c,I.e,I.f,I.g,I.h,I.i,I.j,I.k,I.l,I.m,Ri.a,qi.a,Oe.a,fe.a,Fi.a,Li.a,Qi.a,$i.a,Vi.a,Ei.a,Ni.a,Hi.a,Yi.a,Se.a,Ui.a,Wi.a,zi.a,di.a,Gi.a,Z.a,Ji.a,Ki.a,Xi.a,ge.a,Gt.a,yi.a,Ee.c,Ee.d,Ee.a,Ee.b,Ee.e,Zi.a,tn.a,en.a,nn.a,on.a,sn.a,N.a,an.a,li.a,Xe.a,ie.a,rn.a,cn.a,ln.a,dn.a,hn.a,un.a,bn.a,gn.a,pn.a,mn.a,fn.a,vn.a,Cn.a,yn.a,wn.a,_n.a,Mi.a,gi.a,ai,Qe,Ci,Ti,xt,ne,R,$e.a,St,be,pe,hi,we,Ue,We,et,Ze,Nt,Kt],[P.a,P.C,P.m,P.j,P.A,P.f,P.z,P.B,P.c,P.e,P.h,P.i,P.k])}}]);
//# sourceMappingURL=boards-openproject-boards-module.7fe59b912fd39b1beaea.js.map