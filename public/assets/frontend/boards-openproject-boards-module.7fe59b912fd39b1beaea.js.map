{"version":3,"sources":["./src/app/modules/boards/board/inline-add/board-inline-add-autocompleter.html","./src/app/modules/boards/board/inline-add/board-inline-add-autocompleter.component.ts","./src/app/modules/boards/board/board-list/board-inline-create.service.ts","./src/app/modules/boards/board/board-list/board-list-menu.component.html","./src/app/modules/boards/board/board-list/board-list-menu.component.ts","./src/app/modules/boards/board/board-filter/board-filters.service.ts","./src/app/modules/boards/board/board-list/board-list-cross-selection.service.ts","./src/app/modules/boards/board/board-list/board-list.component.html","./src/app/modules/boards/board/board-list/board-list.component.ts","./src/app/modules/boards/board/configuration-modal/tabs/highlighting-tab.component.ts","./src/app/modules/boards/board/configuration-modal/tabs/highlighting-tab.component.html","./src/app/modules/boards/board/configuration-modal/board-configuration.service.ts","./src/app/components/statuses/status-cache.service.ts","./src/app/modules/boards/board/board-actions/status/status-action.service.ts","./src/app/components/versions/version-cache.service.ts","./src/app/modules/boards/board/board-actions/version/version-board-header.html","./src/app/modules/boards/board/board-actions/version/version-board-header.component.ts","./src/app/components/forms/forms-cache.service.ts","./src/app/modules/boards/board/board-actions/version/version-action.service.ts","./src/app/modules/boards/board/query-updated/query-updated.service.ts","./src/app/modules/boards/board/board-actions/assignee/assignee-board-header.html","./src/app/modules/boards/board/board-actions/assignee/assignee-board-header.component.ts","./src/app/modules/boards/board/board-actions/assignee/assignee-action.service.ts","./src/app/modules/boards/boards-root/boards-root.component.ts","./src/app/modules/boards/board/configuration-modal/board-configuration.modal.html","./src/app/modules/boards/board/configuration-modal/board-configuration.modal.ts","./src/app/modules/boards/board/toolbar-menu/boards-toolbar-menu.directive.ts","./src/app/modules/boards/new-board-modal/new-board-modal.html","./src/app/modules/boards/new-board-modal/new-board-modal.component.ts","./src/app/modules/boards/index-page/boards-index-page.component.html","./src/app/modules/boards/index-page/boards-index-page.component.ts","./src/app/modules/boards/board-constants.const.ts","./src/app/modules/boards/board/add-list-modal/add-list-modal.html","./src/app/modules/boards/board/add-list-modal/add-list-modal.component.ts","./src/app/modules/boards/board/add-card-dropdown/add-card-dropdown-menu.directive.ts","./src/app/modules/boards/board/board-filter/board-filter.component.ts","./src/app/modules/boards/board/board-filter/board-filter.component.html","./node_modules/cdk-drag-scroll/__ivy_ngcc__/fesm2015/cdk-drag-scroll.js","./src/app/modules/boards/board/toolbar-menu/boards-menu-button.component.ts","./src/app/helpers/rxjs/request-switchmap.ts","./src/app/modules/work_packages/routing/partitioned-query-space-page/partitioned-query-space-page.component.html","./src/app/modules/boards/board/board-partitioned-page/board-partitioned-page.component.ts","./src/app/modules/boards/board/board-partitioned-page/board-list-container.component.html","./src/app/modules/boards/board/board-partitioned-page/board-list-container.component.ts","./src/app/modules/boards/openproject-boards.routes.ts","./src/app/modules/boards/openproject-boards.module.ts"],"names":["querySpace","pathHelper","urlParamsHelper","notificationService","CurrentProject","halResourceService","schemaCacheService","cdRef","I18n","wpCardDragDrop","text","placeholder","this","t","appendToContainer","onCancel","onReferenced","isLoading","searchInput$","Subject","results$","pipe","debounceTime","distinctUntilChanged","tap","switchMap","queryString","autocompleteWorkPackages","ngSelectComponent","open","setTimeout","focus","removeReferenceWorkPackageForm","emit","workPackage","ensureLoaded","then","close","searchString","length","of","path","api","v3","withOptionalProject","id","work_packages","filters","results","value","add","elements","map","wp","query","currentFilters","buildV3GetFilters","merge","get","filtered","collection","catchError","error","handleRawError","cancel","addWorkPackageToQuery","injector","pathHelperService","Gon","wpRelationsHierarchyService","super","referenceComponentClass","referenceTarget","buttonTexts","reference","create","authorisationService","can","opModalService","boardService","boardActionRegistry","onRemove","items","disabled","canDelete","linkText","onClick","board","isAction","additional","actionService","getAdditionalListMenuItems","concat","actionAttribute","canManage","delete","getValueOr","selections$","selection","next","withinQuery","icon","QueryDm","state","transitions","boardCache","boardFilters","notifications","halNotification","halEvents","wpStatesInitialization","wpViewFocusService","wpViewSelectionService","boardListCrossSelectionService","wpInlineCreate","halEditing","loadingIndicator","wpCacheService","causedUpdates","actionResourceClass","showAddButton","addCard","updateSuccessful","areYouSure","unnamed_list","click_to_remove","canDragInto","initiallyFocused","workPackageAddedHandler","addWorkPackage","canDragOutOf","canDragOutOfHandler","canMove","resource","isNewWidget","includes","current","data","baseRoute","wpId","params","workPackageId","initializeSelection","observeUntil","subscribe","canAdd","canReference","detectChanges","updates$","untilDestroyed","selectionState","selected","Object","keys","_","pickBy","focused","focusedWorkPackage","updateSelection","queryId","allSelected","selectionsForQuery","values$","updateQuery","listenToActionAttributeChanges","updateOrderedWorkPackages","loadActionAttribute","ngOnDestroy","error_message","loadingError","fieldSchema","schema","writable","updateImmediately","isFree","cardView","setReferenceMode","addNewCard","window","confirm","inFlight","name","patch","toPromise","addSuccess","catch","attribute","backgroundClass","showStatusButton","visibly","setQueryProps","loadQuery","actionResource","undefined","headerComponent","getFilterHref","href","getLoadedFilterValue","buttonPlaceholder","disabledAddButtonPlaceholder","boardListActionColorClass","dragIntoAllowed","canWriteAttribute","canAddToQuery","changeset","changeFor","isWritable","humanName","applyDefaultsFromFilters","isEmpty","updateWorkPackage","save","options","toString","observable","stream","columnsQueryProps","indicatorInstance","updateQuerySpace","retrieveErrorMessage","indicator","jQuery","nativeElement","newFilters","newColumnsQueryProps","JSON","stringify","events$","event","resourceType","eventType","commit","changes","to","from","provide","useClass","BoardHighlightingTabComponent","locals","highlightingMode","entireCardMode","lastEntireCardAttribute","highlighting_mode","description","none","type","priority","entire_card_by","updateMode","mode","indexOf","_tabs","title","componentClass","states","statusDm","one","ids","list","statuses","boardListsService","statusCache","filter","find","values","idFromLink","require","Promise","resolve","getStatuses","all","status","isDefault","addActionQuery","operator","addQuery","active","has","versionDm","versions","VersionBoardHeaderComponent","isLocked","isClosed","$formCache","post","load","versionCache","currentProject","formCache","formLink","form","version","getVersions","definingName","isOpen","buildItemsForVersion","listForProject","newStatus","updateValue","go","reload","hidden","$links","update","patchVersionStatus","versionShowPath","evt","isClickedWithModifier","versionEditPath","queryDm","time","Date","interval","startWith","result","queryForUpdates","count","updatedAfter","toISOString","AssigneeBoardHeaderComponent","assignees","getAssignees","assignee","projectDmService","parseInt","project","memberships","link","projectMembershipsPath","identifier","projectIdentifier","putFromPromiseIfPristine","projects","available_assignees","take","registry","statusAction","versionAction","assigneeAction","boardConfigurationService","appRef","componentFactoryResolver","elementRef","closeOnEscape","closeOnOutsideClick","closePopup","applyButton","cancelButton","$element","tabPortalHost","tabs","tabContentOutlet","initialTab","availableTabs","switchTo","dispose","currentTab","activeComponents","forEach","component","onSave","service","afterFocusOn","closeMe","saveChanges","opContextMenu","BoardCache","Notifications","State","deleteSuccessful","contextMenuId","buildItems","show","$event","grid","trigger","clearSome","flash_message","message","boardActions","loadingIndicatorService","showClose","confirmed","available","close_popup","free_board","free_board_text","action_board","action_board_text","select_attribute","actionAttributeSelect","modal","promise","board_id","isNew","createFree","createAction","bannerService","domSanitizer","boards","type_free","action_by_attribute","attr","createdAt","noResults","teaser_text","enterprise","upgrade","personal_demo","boards$","observeAll","teaserVideoURL","bypassSecurityTrustResourceUrl","loadAllBoards","addError","eeShowBanners","availableValues","trackByHref","valuesAvailable","button_add","button_cancel","referenceOutputs","onCreate","onNewActionCreated","onChange","onModelChange","onAfterViewInit","focusInputField","ngOnInit","Set","getAvailableValues","warningTextWhenNoOptionsAvailable","warningText","element","selectedAttribute","newValue","autocompleterComponent","boardList","focusAfterClose","position","positionArgs","assign","my","at","addReferenceCard","currentProjectService","wpTableFilters","$state","queryFormDm","initialized","board$","loadQueryForm","updateChecksumOnFilterChanges","push","live$","filterHash","query_props","putValue","custom","notify","loadWithParams","createHalResourceOfClass","payload","$source","updateStatesFromForm","AutoScroll","container","scrollCallback","margin","maxSpeed","point","x","y","boundaryRect","getBoundingClientRect","cancelAnimationFrame","animationFrame","requestAnimationFrame","scrollTick","autoScroll","scrollx","scrolly","left","Math","floor","max","right","ceil","min","top","bottom","scrollY","scrollX","amount","scrollTop","scrollLeft","debugInfo","BehaviorSubject","enabled","info","ɵfac","ɵprov","token","factory","providedIn","ctorParameters","ngInjectableDef","cdkDrag","dragDebugService","zone","changeDetectorRef","destroy$","stopDragging$","lastScroll","dragRef","runOutsideAngular","started","takeUntil","log","isDragging","ended","entered","exited","dragConnectedIds","syncSiblings","complete","destroyAutoScroll","scrollContainer","addDebugInfo","fromEvent","deltaX","deltaY","handleScroll","moved","e","onMove","pointerPosition","reset","dragFixContainer","dropListRef","getDropListRef","adjustContainers","adjustItems","_draggables","_itemPositions","syncItems","destroy","draws","it","clientRect","color","drag","_siblings","_clientRect","d","_cacheOwnPosition","markForCheck","beforeStarted","oldPositions","_activeDraggables","slice","_cacheItemPositions","newPositions","p","p1","sibling","originalRect","optionalParams","console","ɵdir","selectors","inputs","exportAs","features","propDecorators","args","DragScrollModule","ɵmod","ɵinj","imports","BoardsMenuButtonComponent","button_more","handler","requests","responses$","until","$transitions","Boards","unnamedBoard","addList","upsaleBoards","upsaleCheckOutLink","observe","backButtonCallback","toolbarDisabled","showToolbar","filterAllowed","currentPartition","filterContainerDefinition","boardSaver","toolbarButtonComponents","containerClasses","editable","removeTransitionSubscription","onSuccess","transition","toState","showToolbarSaveButton","setPartition","queryProps","selectedTitle","parse","newName","request","val","changeChangesFromTitle","partition","updateTitleName","boardComponent","BoardList","Banner","Drag","QueryUpdated","trackByQueryId","index","widget","v","_container","addScrollContainer","currentBoard$","setupQueryUpdatedMonitoring","selections","queries","previousIndex","currentIndex","saveBoard","removeQuery","addFreeQuery","saved","showError","getActionFiltersFromWidget","currentQueryUpdatedMonitoring","unsubscribe","monitor","requestRefreshOfUpdatedLists","lists","listComponent","refreshQueryUnlessCaused","widgets","BOARDS_ROUTES","parent","url","bodyClasses","menuItem","dynamic","redirectTo","inherit","reloadOnSearch","views","OpenprojectBoardsModule","withComponents","forChild","config","uiRouter","urlService","rules","when","RegExp","match"],"mappings":"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","file":"boards-openproject-boards-module.7fe59b912fd39b1beaea.js","sourcesContent":["<ng-select ngClass=\"wp-inline-create--reference-autocompleter\"\n           [items]=\"results$ | async\"\n           [appendTo]=\"appendToContainer\"\n           [multiple]=\"false\"\n           [loading]=\"isLoading\"\n           [typeahead]=\"searchInput$\"\n           [closeOnSelect]=\"false\"\n           (close)=\"cancel()\"\n           (change)=\"addWorkPackageToQuery($event)\">\n  <ng-template ng-label-tmp let-item=\"item\">\n    {{item.type.name }} #{{ item.id }} {{ item.subject }}\n  </ng-template>\n  <ng-template ng-option-tmp let-item=\"item\" let-index=\"index\" let-search=\"searchTerm\">\n    {{item.type.name }} #{{ item.id }} {{ item.subject }}\n  </ng-template>\n</ng-select>\n","//-- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n//++\n\nimport {\n  AfterViewInit,\n  ChangeDetectorRef,\n  Component,\n  EventEmitter,\n  Input,\n  Output,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport {I18nService} from 'core-app/modules/common/i18n/i18n.service';\nimport {WorkPackageResource} from 'core-app/modules/hal/resources/work-package-resource';\nimport {Observable, of, Subject} from \"rxjs\";\nimport {catchError, debounceTime, distinctUntilChanged, map, switchMap, tap} from \"rxjs/operators\";\nimport {NgSelectComponent} from \"@ng-select/ng-select\";\nimport {IsolatedQuerySpace} from \"core-app/modules/work_packages/query-space/isolated-query-space\";\nimport {PathHelperService} from \"core-app/modules/common/path-helper/path-helper.service\";\nimport {WorkPackageCollectionResource} from \"core-app/modules/hal/resources/wp-collection-resource\";\nimport {CurrentProjectService} from \"core-components/projects/current-project.service\";\nimport {ApiV3FilterBuilder} from \"core-components/api/api-v3/api-v3-filter-builder\";\nimport {HalResourceService} from \"core-app/modules/hal/services/hal-resource.service\";\nimport {SchemaCacheService} from \"core-components/schemas/schema-cache.service\";\nimport {WorkPackageCardDragAndDropService} from \"core-components/wp-card-view/services/wp-card-drag-and-drop.service\";\nimport {WorkPackageNotificationService} from \"core-app/modules/work_packages/notifications/work-package-notification.service\";\nimport {UrlParamsHelperService} from \"core-components/wp-query/url-params-helper\";\n\n@Component({\n  selector: 'board-inline-add-autocompleter',\n  templateUrl: './board-inline-add-autocompleter.html',\n\n  // Allow styling the embedded ng-select\n  encapsulation: ViewEncapsulation.None,\n  styleUrls: ['./board-inline-add-autocompleter.sass']\n})\nexport class BoardInlineAddAutocompleterComponent implements AfterViewInit {\n  readonly text = {\n    placeholder: this.I18n.t('js.relations_autocomplete.placeholder')\n  };\n\n  @Input() appendToContainer:string = '.work-packages-partitioned-query-space--container';\n  @ViewChild(NgSelectComponent) public ngSelectComponent:NgSelectComponent;\n\n  @Output() onCancel = new EventEmitter<undefined>();\n  @Output() onReferenced = new EventEmitter<WorkPackageResource>();\n\n  // Whether we're currently loading\n  public isLoading = false;\n\n  // Search input from ng-select\n  public searchInput$ = new Subject<string>();\n\n  // Search results mapped to input\n  public results$:Observable<WorkPackageResource[]> = this.searchInput$.pipe(\n    debounceTime(250),\n    distinctUntilChanged(),\n    tap(() => this.isLoading = true),\n    switchMap(queryString => this.autocompleteWorkPackages(queryString))\n  );\n\n  constructor(private readonly querySpace:IsolatedQuerySpace,\n              private readonly pathHelper:PathHelperService,\n              private readonly urlParamsHelper:UrlParamsHelperService,\n              private readonly notificationService:WorkPackageNotificationService,\n              private readonly CurrentProject:CurrentProjectService,\n              private readonly halResourceService:HalResourceService,\n              private readonly schemaCacheService:SchemaCacheService,\n              private readonly cdRef:ChangeDetectorRef,\n              private readonly I18n:I18nService,\n              private readonly wpCardDragDrop:WorkPackageCardDragAndDropService) {\n  }\n\n  ngAfterViewInit():void {\n    if (!this.ngSelectComponent) {\n      return;\n    }\n    this.ngSelectComponent.open();\n\n    setTimeout(() => {\n      this.ngSelectComponent.focus();\n    }, 25);\n\n    this.wpCardDragDrop.removeReferenceWorkPackageForm();\n  }\n\n  cancel() {\n    this.onCancel.emit();\n  }\n\n  public addWorkPackageToQuery(workPackage?:WorkPackageResource) {\n    if (workPackage) {\n      this.schemaCacheService\n        .ensureLoaded(workPackage)\n        .then(() => {\n          this.onReferenced.emit(workPackage);\n          this.ngSelectComponent.close();\n        });\n    }\n  }\n\n  private autocompleteWorkPackages(searchString:string):Observable<WorkPackageResource[]> {\n    // Return when the search string is empty\n    if (searchString.length === 0) {\n      this.isLoading = false;\n      return of([]);\n    }\n\n    const path = this.pathHelper.api.v3.withOptionalProject(this.CurrentProject.id).work_packages;\n    const filters:ApiV3FilterBuilder = new ApiV3FilterBuilder();\n    const results = this.querySpace.results.value;\n\n    filters.add('subjectOrId', '**', [searchString]);\n\n    if (results && results.elements.length > 0) {\n      filters.add('id', '!', results.elements.map((wp:WorkPackageResource) => wp.id!));\n    }\n\n    // Add the subproject filter, if any\n    const query = this.querySpace.query.value;\n    if (query?.filters) {\n      const currentFilters = this.urlParamsHelper.buildV3GetFilters(query.filters);\n      filters.merge(currentFilters, 'subprojectId');\n    }\n\n    return this.halResourceService\n      .get<WorkPackageCollectionResource>(path.filtered(filters))\n      .pipe(\n        map(collection => collection.elements),\n        catchError((error:unknown) => {\n          this.notificationService.handleRawError(error);\n          return of([]);\n        }),\n        tap(() => this.isLoading = false)\n      );\n  }\n}\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n// ++\n\nimport {Injectable, Injector} from '@angular/core';\nimport {WorkPackageResource} from 'core-app/modules/hal/resources/work-package-resource';\nimport {WorkPackageRelationsHierarchyService} from \"core-components/wp-relations/wp-relations-hierarchy/wp-relations-hierarchy.service\";\nimport {WorkPackageInlineCreateService} from \"core-components/wp-inline-create/wp-inline-create.service\";\nimport {IsolatedQuerySpace} from \"core-app/modules/work_packages/query-space/isolated-query-space\";\nimport {HalResourceService} from \"core-app/modules/hal/services/hal-resource.service\";\nimport {PathHelperService} from \"core-app/modules/common/path-helper/path-helper.service\";\nimport {BoardInlineAddAutocompleterComponent} from \"core-app/modules/boards/board/inline-add/board-inline-add-autocompleter.component\";\nimport {GonService} from \"core-app/modules/common/gon/gon.service\";\n\n@Injectable()\nexport class BoardInlineCreateService extends WorkPackageInlineCreateService {\n\n  constructor(readonly injector:Injector,\n              protected readonly querySpace:IsolatedQuerySpace,\n              protected readonly halResourceService:HalResourceService,\n              protected readonly pathHelperService:PathHelperService,\n              protected readonly Gon:GonService,\n              protected readonly wpRelationsHierarchyService:WorkPackageRelationsHierarchyService) {\n    super(injector);\n  }\n\n  /**\n   * A separate reference pane for the inline create component\n   */\n  public readonly referenceComponentClass = BoardInlineAddAutocompleterComponent;\n\n  /**\n   * A related work package for the inline create context\n   */\n  public referenceTarget:WorkPackageResource|null = null;\n\n  public get canAdd() {\n    return this.authorisationService.can('work_packages', 'createWorkPackage');\n  }\n\n  public get canReference() {\n    return this.authorisationService.can('work_packages', 'editWorkPackage');\n  }\n\n  /**\n   * Reference button text\n   */\n  public readonly buttonTexts = {\n    reference: this.I18n.t('js.relation_buttons.add_existing_child'),\n    create: this.I18n.t('js.relation_buttons.add_new_child')\n  };\n}\n","<ng-container class=\"board-list--more-menu\" *ngIf=\"canDelete()\">\n  <icon-triggered-context-menu\n     [menu-items]=\"menuItems\">\n  </icon-triggered-context-menu>\n</ng-container>\n","//-- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n//++\n\nimport {Component, Output, EventEmitter, Input} from '@angular/core';\nimport {I18nService} from 'core-app/modules/common/i18n/i18n.service';\nimport {AuthorisationService} from 'core-app/modules/common/model-auth/model-auth.service';\nimport {OpModalService} from \"core-components/op-modals/op-modal.service\";\nimport {IsolatedQuerySpace} from \"core-app/modules/work_packages/query-space/isolated-query-space\";\nimport {Board} from \"core-app/modules/boards/board/board\";\nimport {BoardActionsRegistryService} from \"core-app/modules/boards/board/board-actions/board-actions-registry.service\";\nimport {OpContextMenuItem} from \"core-components/op-context-menu/op-context-menu.types\";\nimport {BoardService} from \"core-app/modules/boards/board/board.service\";\nimport {BoardActionService} from \"core-app/modules/boards/board/board-actions/board-action.service\";\n\n@Component({\n  selector: 'board-list-menu',\n  templateUrl: './board-list-menu.component.html',\n})\nexport class BoardListMenuComponent {\n  @Input() board:Board;\n  @Output() onRemove = new EventEmitter<void>();\n\n  constructor(readonly opModalService:OpModalService,\n              readonly authorisationService:AuthorisationService,\n              private readonly querySpace:IsolatedQuerySpace,\n              private readonly boardService:BoardService,\n              private readonly boardActionRegistry:BoardActionsRegistryService,\n              readonly I18n:I18nService) {\n  }\n\n  public get menuItems() {\n    return async () => {\n      let items:OpContextMenuItem[] = [\n        {\n          disabled: !this.canDelete,\n          linkText: this.I18n.t('js.boards.lists.delete'),\n          onClick: () => {\n            this.onRemove.emit();\n            return true;\n          }\n        }\n      ];\n\n      // Add action specific menu entries\n      if (this.board.isAction) {\n        const additional = await this.actionService.getAdditionalListMenuItems(this.query);\n        return items.concat(additional);\n      }\n\n      return items;\n    };\n  }\n\n  private get actionService():BoardActionService {\n    return this.boardActionRegistry.get(this.board.actionAttribute!);\n  }\n\n  private get canManage() {\n    return this.boardService.canManage(this.board);\n  }\n\n  public canDelete() {\n    return this.canManage && !!this.query.delete;\n  }\n\n  private get query() {\n    return this.querySpace.query.value!;\n  }\n}\n","import {ApiV3Filter} from \"core-components/api/api-v3/api-v3-filter-builder\";\nimport {input} from \"reactivestates\";\n\nexport class BoardFiltersService {\n  /**\n   * We need to remember the current filter, that may either come\n   * from the saved board, or were assigned by the user.\n   *\n   * This is due to the fact we do not work on an query object here.\n   */\n  filters = input<ApiV3Filter[]>([]);\n\n  get current():ApiV3Filter[] {\n    return this.filters.getValueOr([]);\n  }\n}","import {Observable, Subject} from \"rxjs\";\nimport {filter} from \"rxjs/operators\";\n\nexport interface BoardSelection {\n  /** The query that the selection happened in */\n  withinQuery:string;\n\n  /** The focused selected work package */\n  focusedWorkPackage:string|null;\n\n  /** Array of selected work packages */\n  allSelected:string[];\n}\n\n\n/**\n * Responsible for keeping selected items across all lists of a board,\n * selections in one list will propagate to other lists as well.\n */\nexport class BoardListCrossSelectionService {\n\n  private selections$ = new Subject<BoardSelection>();\n\n  /**\n   * Marks the selection of one or multiple cards within a list\n   * by a user.\n   *\n   * The primary selected should be open in split screen (if open).\n   *\n   */\n  updateSelection(selection:BoardSelection) {\n    this.selections$.next(selection);\n  }\n\n  /**\n   * Returns an observable for a given query that fires\n   * when its selection should be updated.\n   *\n   * @param id\n   */\n  selectionsForQuery(id:string):Observable<BoardSelection> {\n    return this\n      .selections$\n      .pipe(\n        filter(selection => selection.withinQuery !== id)\n      );\n  }\n\n  selections():Observable<BoardSelection> {\n    return this.selections$;\n  }\n}","<div #loadingIndicator\n     [attr.data-query-name]=\"listName\"\n     class=\"board-list--container loading-indicator--location\"\n     [ngClass]=\"{ '-action-list': board.isAction }\">\n  <ng-container *ngIf=\"query\">\n\n    <div *ngIf=\"board.isAction\"\n         class=\"board-list--action-bar\"\n         [ngClass]=\"actionResourceClass\">\n    </div>\n\n    <div class=\"board-list--header\">\n      <ndc-dynamic *ngIf=\"headerComponent\"\n                   [ndcDynamicComponent]=\"headerComponent\"\n                   [ndcDynamicInputs]=\"{ resource: actionResource }\">\n      </ndc-dynamic>\n      <editable-toolbar-title *ngIf=\"!headerComponent\"\n                              [title]=\"query.name\"\n                              [smallHeader]=\"true\"\n                              [inFlight]=\"inFlight\"\n                              (onSave)=\"renameQuery(query, $event)\"\n                              [editable]=\"canRename\"\n                              [initialFocus]=\"initiallyFocused\"\n                              class=\"-small\">\n      </editable-toolbar-title>\n\n      <board-list-menu class=\"board-list--menu\"\n                       [board]=\"board\"\n                       (onRemove)=\"deleteList()\">\n      </board-list-menu>\n    </div>\n\n    <div class=\"board-list--query-container drop-zone\"\n         [ngClass]=\"{ '-with-create-button': board.isAction || showAddButton }\">\n      <div class=\"board-list--button-container\">\n        <button [title]=\"text.addCard\"\n                *ngIf=\"board.isAction\"\n                (accessibleClick)=\"addNewCard()\"\n                [disabled]=\"!showAddButton\"\n                class=\"board-list--add-button board-list--card-add-button button\">\n          <op-icon icon-classes=\"icon-{{buttonPlaceholder ? buttonPlaceholder.icon : 'add'}}\"></op-icon>\n          <span *ngIf=\"buttonPlaceholder\"> {{ buttonPlaceholder.text }} </span>\n        </button>\n        <button [title]=\"text.addCard\"\n                *ngIf=\"!board.isAction && showAddButton\"\n                class=\"board-list--add-button board-list--card-dropdown-button button\"\n                addCardDropdown>\n          <op-icon icon-classes=\"icon-small icon-add\"></op-icon>\n        </button>\n      </div>\n\n      <wp-card-view [dragOutOfHandler]=\"canDragOutOfHandler\"\n                    [dragInto]=\"canDragInto\"\n                    [workPackageAddedHandler]=\"workPackageAddedHandler\"\n                    [cardsRemovable]=\"board.isFree && canDragOutOf\"\n                    [showInfoButton]=\"true\"\n                    [highlightingMode]=\"board.highlightingMode\"\n                    [showStatusButton]=\"showCardStatusButton()\">\n\n      </wp-card-view>\n    </div>\n  </ng-container>\n  <div class=\"notification-box -error\" *ngIf=\"loadingError\">\n    <p>\n      <span [textContent]=\"errorMessage\"></span>\n      &ngsp;\n      <a role=\"button\" (accessibleClick)=\"onRemove.emit()\">\n        <span [textContent]=\"text.click_to_remove\"></span>\n      </a>\n    </p>\n  </div>\n</div>\n","import {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ElementRef,\n  EventEmitter,\n  Injector,\n  Input,\n  OnDestroy,\n  OnInit,\n  Output,\n  ViewChild\n} from \"@angular/core\";\nimport {QueryDmService} from \"core-app/modules/hal/dm-services/query-dm.service\";\nimport {\n  LoadingIndicatorService,\n  withLoadingIndicator\n} from \"core-app/modules/common/loading-indicator/loading-indicator.service\";\nimport {QueryResource} from \"core-app/modules/hal/resources/query-resource\";\nimport {WorkPackageInlineCreateService} from \"core-components/wp-inline-create/wp-inline-create.service\";\nimport {BoardInlineCreateService} from \"core-app/modules/boards/board/board-list/board-inline-create.service\";\nimport {AbstractWidgetComponent} from \"core-app/modules/grids/widgets/abstract-widget.component\";\nimport {I18nService} from \"core-app/modules/common/i18n/i18n.service\";\nimport {BoardCacheService} from \"core-app/modules/boards/board/board-cache.service\";\nimport {NotificationsService} from \"core-app/modules/common/notifications/notifications.service\";\nimport {IsolatedQuerySpace} from \"core-app/modules/work_packages/query-space/isolated-query-space\";\nimport {Board} from \"core-app/modules/boards/board/board\";\nimport {HalResource} from \"core-app/modules/hal/resources/hal-resource\";\nimport {AuthorisationService} from \"core-app/modules/common/model-auth/model-auth.service\";\nimport {Highlighting} from \"core-components/wp-fast-table/builders/highlighting/highlighting.functions\";\nimport {WorkPackageCardViewComponent} from \"core-components/wp-card-view/wp-card-view.component\";\nimport {WorkPackageStatesInitializationService} from \"core-components/wp-list/wp-states-initialization.service\";\nimport {ApiV3Filter} from \"core-components/api/api-v3/api-v3-filter-builder\";\nimport {BoardService} from \"app/modules/boards/board/board.service\";\nimport {WorkPackageResource} from \"core-app/modules/hal/resources/work-package-resource\";\nimport {WorkPackageFilterValues} from \"core-components/wp-edit-form/work-package-filter-values\";\n\nimport {HalResourceEditingService} from \"core-app/modules/fields/edit/services/hal-resource-editing.service\";\nimport {WorkPackageCacheService} from \"core-components/work-packages/work-package-cache.service\";\nimport {HalResourceNotificationService} from \"core-app/modules/hal/services/hal-resource-notification.service\";\nimport {BoardActionsRegistryService} from \"core-app/modules/boards/board/board-actions/board-actions-registry.service\";\nimport {BoardActionService} from \"core-app/modules/boards/board/board-actions/board-action.service\";\nimport {ComponentType} from \"@angular/cdk/portal\";\nimport {IFieldSchema} from \"core-app/modules/fields/field.base\";\nimport {CausedUpdatesService} from \"core-app/modules/boards/board/caused-updates/caused-updates.service\";\nimport {BoardListMenuComponent} from \"core-app/modules/boards/board/board-list/board-list-menu.component\";\nimport {debugLog} from \"core-app/helpers/debug_output\";\nimport {WorkPackageCardDragAndDropService} from \"core-components/wp-card-view/services/wp-card-drag-and-drop.service\";\nimport {WorkPackageChangeset} from \"core-components/wp-edit/work-package-changeset\";\nimport {componentDestroyed} from \"@w11k/ngx-componentdestroyed\";\nimport {BoardFiltersService} from \"core-app/modules/boards/board/board-filter/board-filters.service\";\nimport {StateService, TransitionService} from \"@uirouter/core\";\nimport {WorkPackageViewFocusService} from \"core-app/modules/work_packages/routing/wp-view-base/view-services/wp-view-focus.service\";\nimport {WorkPackageViewSelectionService} from \"core-app/modules/work_packages/routing/wp-view-base/view-services/wp-view-selection.service\";\nimport {BoardListCrossSelectionService} from \"core-app/modules/boards/board/board-list/board-list-cross-selection.service\";\nimport {debounceTime, filter, map} from \"rxjs/operators\";\nimport {HalEvent, HalEventsService} from \"core-app/modules/hal/services/hal-events.service\";\nimport {ChangeItem} from \"core-app/modules/fields/changeset/changeset\";\n\nexport interface DisabledButtonPlaceholder {\n  text:string;\n  icon:string;\n}\n\n@Component({\n  selector: 'board-list',\n  templateUrl: './board-list.component.html',\n  styleUrls: ['./board-list.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [\n    { provide: WorkPackageInlineCreateService, useClass: BoardInlineCreateService },\n    BoardListMenuComponent,\n    WorkPackageCardDragAndDropService\n  ]\n})\nexport class BoardListComponent extends AbstractWidgetComponent implements OnInit, OnDestroy {\n  /** Output fired upon query removal */\n  @Output() onRemove = new EventEmitter<void>();\n\n  /** Access to the board resource */\n  @Input() public board:Board;\n\n  /** Access to the loading indicator element */\n  @ViewChild('loadingIndicator', { static: true }) indicator:ElementRef;\n\n  /** Access to the card view */\n  @ViewChild(WorkPackageCardViewComponent) cardView:WorkPackageCardViewComponent;\n\n  /** The query resource being loaded */\n  public query:QueryResource;\n\n  /** Query loading error, if present */\n  public loadingError:string|undefined;\n\n  /** The action attribute resource if any */\n  public actionResource:HalResource|undefined;\n  public actionResourceClass:string = '';\n  public headerComponent:ComponentType<unknown>|undefined;\n\n  /** Rename inFlight */\n  public inFlight:boolean;\n\n  /** Whether the add button should be shown */\n  public showAddButton = false;\n\n  public columnsQueryProps:any;\n\n  public text = {\n    addCard: this.I18n.t('js.boards.add_card'),\n    updateSuccessful: this.I18n.t('js.notice_successful_update'),\n    areYouSure: this.I18n.t('js.text_are_you_sure'),\n    unnamed_list: this.I18n.t('js.boards.label_unnamed_list'),\n    click_to_remove: this.I18n.t('js.boards.click_to_remove_list')\n  };\n\n  /** Are we allowed to remove and drag & drop elements ? */\n  public canDragInto:boolean = false;\n\n  /** Initially focus the list */\n  public initiallyFocused:boolean = false;\n\n  /** Editing handler to be passed into card component */\n  public workPackageAddedHandler = (workPackage:WorkPackageResource) => this.addWorkPackage(workPackage);\n\n  /** Move check to be passed into card component */\n  public canDragOutOf:boolean = false;\n  public canDragOutOfHandler = (workPackage:WorkPackageResource) => this.canMove(workPackage);\n\n  public buttonPlaceholder:DisabledButtonPlaceholder|undefined;\n\n  constructor(readonly QueryDm:QueryDmService,\n              readonly I18n:I18nService,\n              readonly state:StateService,\n              readonly cdRef:ChangeDetectorRef,\n              readonly transitions:TransitionService,\n              readonly boardCache:BoardCacheService,\n              readonly boardFilters:BoardFiltersService,\n              readonly notifications:NotificationsService,\n              readonly querySpace:IsolatedQuerySpace,\n              readonly halNotification:HalResourceNotificationService,\n              readonly halEvents:HalEventsService,\n              readonly wpStatesInitialization:WorkPackageStatesInitializationService,\n              readonly wpViewFocusService:WorkPackageViewFocusService,\n              readonly wpViewSelectionService:WorkPackageViewSelectionService,\n              readonly boardListCrossSelectionService:BoardListCrossSelectionService,\n              readonly authorisationService:AuthorisationService,\n              readonly wpInlineCreate:WorkPackageInlineCreateService,\n              readonly injector:Injector,\n              readonly halEditing:HalResourceEditingService,\n              readonly loadingIndicator:LoadingIndicatorService,\n              readonly wpCacheService:WorkPackageCacheService,\n              readonly boardService:BoardService,\n              readonly boardActionRegistry:BoardActionsRegistryService,\n              readonly causedUpdates:CausedUpdatesService) {\n    super(I18n, injector);\n  }\n\n  ngOnInit():void {\n    // Unset the isNew flag\n    this.initiallyFocused = this.resource.isNewWidget;\n    this.resource.isNewWidget = false;\n\n    // Set initial selection if split view open\n    if (this.state.includes(this.state.current.data.baseRoute + '.details')) {\n      let wpId = this.state.params.workPackageId;\n      this.wpViewSelectionService.initializeSelection([wpId]);\n    }\n\n    // Update permission on model updates\n    this.authorisationService\n      .observeUntil(componentDestroyed(this))\n      .subscribe(() => {\n        if (!this.board.isAction) {\n          this.showAddButton = this.canDragInto && (this.wpInlineCreate.canAdd || this.canReference);\n          this.cdRef.detectChanges();\n        }\n      });\n\n    // If this query space changes its focused or selected\n    // work packages, update the board cross selection\n    this.wpViewSelectionService\n      .updates$()\n      .pipe(\n        debounceTime(100),\n        this.untilDestroyed()\n      ).subscribe((selectionState) => {\n      let selected = Object.keys(_.pickBy(selectionState.selected, (selected, _) => selected === true));\n\n      const focused = this.wpViewFocusService.focusedWorkPackage;\n\n      this.boardListCrossSelectionService.updateSelection({\n        withinQuery: this.queryId,\n        focusedWorkPackage: focused,\n        allSelected: selected\n      });\n    });\n\n    // Apply focus and selection when changed in cross service\n    this.boardListCrossSelectionService\n      .selectionsForQuery(this.queryId)\n      .pipe(\n        this.untilDestroyed()\n      )\n      .subscribe(selection => {\n        this.wpViewSelectionService.initializeSelection(selection.allSelected);\n      });\n\n    // Update query on filter change\n    this.boardFilters\n      .filters\n      .values$()\n      .pipe(\n        this.untilDestroyed()\n      )\n      .subscribe(() => this.updateQuery(true));\n\n    // Listen to changes to action attribute\n    this.listenToActionAttributeChanges();\n\n    this.querySpace.query\n      .values$()\n      .pipe(\n        this.untilDestroyed()\n      )\n      .subscribe((query) => {\n        this.query = query;\n        this.canDragOutOf = !!this.query.updateOrderedWorkPackages;\n        this.loadActionAttribute(query);\n        this.cdRef.detectChanges();\n      });\n\n    this.updateQuery();\n  }\n\n  ngOnDestroy() {\n    super.ngOnDestroy();\n  }\n\n  public get errorMessage() {\n    return this.I18n.t('js.boards.error_loading_the_list', { error_message: this.loadingError });\n  }\n\n  public canMove(workPackage:WorkPackageResource) {\n    if (this.board.isAction) {\n      const fieldSchema = workPackage.schema[this.board.actionAttribute!] as IFieldSchema;\n      return this.canDragOutOf && fieldSchema.writable;\n    } else {\n      return this.canDragOutOf;\n    }\n  }\n\n  public get canReference() {\n    return this.wpInlineCreate.canReference;\n  }\n\n  public get canManage() {\n    return this.boardService.canManage(this.board);\n  }\n\n  //public get canDelete() {\n  //    return this.canManage && !!this.query.delete;\n  //}\n\n  public get canRename() {\n    return this.canManage &&\n      !!this.query.updateImmediately &&\n      this.board.isFree;\n  }\n\n  public addReferenceCard() {\n    this.cardView.setReferenceMode(true);\n  }\n\n  public addNewCard() {\n    this.cardView.addNewCard();\n  }\n\n  public deleteList(query?:QueryResource) {\n    query = query ? query : this.query;\n\n    if (!window.confirm(this.text.areYouSure)) {\n      return;\n    }\n\n    this.QueryDm\n      .delete(query)\n      .then(() => this.onRemove.emit());\n  }\n\n  public renameQuery(query:QueryResource, value:string) {\n    this.inFlight = true;\n    this.query.name = value;\n    this.QueryDm\n      .patch(this.query.id!, { name: value })\n      .toPromise()\n      .then(() => {\n        this.inFlight = false;\n        this.notifications.addSuccess(this.text.updateSuccessful);\n      })\n      .catch(() => this.inFlight = false);\n  }\n\n  private boardListActionColorClass(value?:HalResource):string {\n    const attribute = this.board.actionAttribute!;\n    if (value && value.id) {\n      return Highlighting.backgroundClass(attribute, value.id!);\n    } else {\n      return '';\n    }\n  }\n\n  public get listName() {\n    return this.query && this.query.name;\n  }\n\n  public showCardStatusButton() {\n    return this.board.showStatusButton();\n  }\n\n  public refreshQueryUnlessCaused(query:QueryResource, visibly = true) {\n    if (!this.causedUpdates.includes(query)) {\n      debugLog(`Refreshing ${query.name} visibly due to external changes`);\n      this.updateQuery(visibly);\n    }\n  }\n\n  public updateQuery(visibly = true) {\n    this.setQueryProps(this.boardFilters.current);\n    this.loadQuery(visibly);\n  }\n\n  private loadActionAttribute(query:QueryResource) {\n    if (!this.board.isAction) {\n      this.actionResource = undefined;\n      this.headerComponent = undefined;\n      this.canDragInto = !!query.updateOrderedWorkPackages;\n      return;\n    }\n\n    const id = this.actionService.getFilterHref(query);\n\n    // Test if we loaded the resource already\n    if (this.actionResource && id === this.actionResource.href) {\n      return;\n    }\n\n    // Load the resource\n    this.actionService.getLoadedFilterValue(query).then(async resource => {\n      this.actionResource = resource;\n      this.headerComponent = this.actionService.headerComponent();\n      this.buttonPlaceholder = this.actionService.disabledAddButtonPlaceholder(resource);\n      this.actionResourceClass = this.boardListActionColorClass(resource);\n      this.canDragInto = this.actionService.dragIntoAllowed(query, resource);\n\n      const canWriteAttribute = await this.actionService.canAddToQuery(query);\n      this.showAddButton = this.canDragInto && this.wpInlineCreate.canAdd && canWriteAttribute;\n      this.cdRef.detectChanges();\n    });\n  }\n\n  /**\n   * Return the linked action service\n   */\n  private get actionService():BoardActionService {\n    return this.boardActionRegistry.get(this.board.actionAttribute!);\n  }\n\n  /**\n   * Handler to properly update the work package, when\n   * adding to this query requires saving a changeset.\n   * @param workPackage\n   */\n  private addWorkPackage(workPackage:WorkPackageResource) {\n    let query = this.querySpace.query.value!;\n    const changeset = this.halEditing.changeFor(workPackage) as WorkPackageChangeset;\n\n    // Ensure attribute remains writable in the form\n    const actionAttribute = this.board.actionAttribute;\n    if (actionAttribute && !changeset.isWritable(actionAttribute)) {\n      throw this.I18n.t(\n        'js.boards.error_attribute_not_writable',\n        { attribute: changeset.humanName(actionAttribute) }\n      );\n    }\n\n    const filter = new WorkPackageFilterValues(this.injector, changeset, query.filters);\n    filter.applyDefaultsFromFilters();\n\n    if (changeset.isEmpty()) {\n      // Ensure work package and its schema is loaded\n      return this.wpCacheService.updateWorkPackage(workPackage);\n    } else {\n      // Save changes to the work package, which reloads it as well\n      return this.halEditing.save(changeset);\n    }\n  }\n\n  private get queryId():string {\n    return (this.resource.options.queryId as number|string).toString();\n  }\n\n  private loadQuery(visibly = true) {\n    let observable = this.QueryDm.stream(this.columnsQueryProps, this.queryId);\n\n    // Spread arguments on pipe does not work:\n    // https://github.com/ReactiveX/rxjs/issues/3989\n    if (visibly) {\n      observable = observable.pipe(withLoadingIndicator(this.indicatorInstance, 50));\n    }\n\n    observable\n      .subscribe(\n        query => this.wpStatesInitialization.updateQuerySpace(query, query.results),\n        error => this.loadingError = this.halNotification.retrieveErrorMessage(error)\n      );\n  }\n\n  private get indicatorInstance() {\n    return this.loadingIndicator.indicator(jQuery(this.indicator.nativeElement));\n  }\n\n  private setQueryProps(filters:ApiV3Filter[]) {\n    const existingFilters = (this.resource.options.filters || []) as ApiV3Filter[];\n\n    const newFilters = existingFilters.concat(filters);\n    const newColumnsQueryProps:any = {\n      'columns[]': ['id', 'subject'],\n      'showHierarchies': false,\n      'pageSize': 500,\n      'filters': JSON.stringify(newFilters),\n    };\n\n    this.columnsQueryProps = newColumnsQueryProps;\n  }\n\n  private listenToActionAttributeChanges() {\n\n    // If we don't have an action attribute\n    // nothing to do\n    if (!this.board.actionAttribute) {\n      return;\n    }\n\n    // Listen to hal events to detect changes to an action attribute\n    this.halEvents\n      .events$\n      .pipe(\n        filter(event => event.resourceType === 'WorkPackage'),\n        // Only allow updates, otherwise this causes an error reloading the list\n        // before the work package can be added to the query order\n        filter(event => event.eventType === 'updated'),\n        map((event:HalEvent) => event.commit?.changes[this.board.actionAttribute!]),\n        filter(value => !!value),\n        filter((value:ChangeItem) => {\n\n          // Compare the from and to values from the committed changes\n          // with the current actionResource\n          const current = this.actionResource?.href;\n          const to = (value.to as HalResource|undefined)?.href;\n          const from = (value.from as HalResource|undefined)?.href;\n\n          return !!current && (current === to || current === from);\n        })\n      ).subscribe((event) => {\n      this.updateQuery(true);\n    });\n  }\n}\n","import {Component, Inject, Injector} from '@angular/core';\nimport {I18nService} from 'core-app/modules/common/i18n/i18n.service';\nimport {TabComponent} from 'core-components/wp-table/configuration-modal/tab-portal-outlet';\nimport {OpModalLocalsMap} from \"core-components/op-modals/op-modal.types\";\nimport {Board} from \"core-app/modules/boards/board/board\";\nimport {OpModalLocalsToken} from \"core-components/op-modals/op-modal.service\";\nimport {CardHighlightingMode} from \"core-components/wp-fast-table/builders/highlighting/highlighting-mode.const\";\n\n@Component({\n  templateUrl: './highlighting-tab.component.html'\n})\nexport class BoardHighlightingTabComponent implements TabComponent {\n\n  // Highlighting mode\n  public highlightingMode:CardHighlightingMode = 'none';\n  public entireCardMode:boolean = false;\n  public lastEntireCardAttribute:CardHighlightingMode = 'type';\n\n  // Current board resource\n  public board:Board;\n\n  public text = {\n    highlighting_mode: {\n      description: this.I18n.t('js.work_packages.table_configuration.highlighting_mode.description'),\n      none: this.I18n.t('js.work_packages.table_configuration.highlighting_mode.none'),\n      type: this.I18n.t('js.work_packages.properties.type'),\n      priority: this.I18n.t('js.work_packages.table_configuration.highlighting_mode.priority'),\n      entire_card_by: this.I18n.t('js.card.highlighting.entire_card_by'),\n    }\n  };\n\n  constructor(readonly injector:Injector,\n              @Inject(OpModalLocalsToken) public locals:OpModalLocalsMap,\n              readonly I18n:I18nService) {\n  }\n\n  public onSave() {\n    this.updateMode(this.highlightingMode);\n    this.board.highlightingMode = this.highlightingMode;\n  }\n\n  ngOnInit() {\n    this.board = this.locals.board;\n    this.highlightingMode = this.board.highlightingMode;\n    this.updateMode(this.highlightingMode);\n  }\n\n  public updateMode(mode:CardHighlightingMode) {\n    if (mode === 'inline') {\n      this.highlightingMode = this.lastEntireCardAttribute;\n    } else {\n      this.highlightingMode = mode;\n    }\n\n    if (['priority', 'type'].indexOf(this.highlightingMode) !== -1) {\n      this.lastEntireCardAttribute = this.highlightingMode;\n      this.entireCardMode = true;\n    } else {\n      this.entireCardMode = false;\n    }\n\n  }\n}\n","<div>\n  <form>\n    <p [textContent]=\"text.highlighting_mode.description\"></p>\n    \n    <div class=\"form--field -full-width\">\n      <div class=\"form--field-container\">\n        <label class=\"option-label\">\n          <input type=\"radio\"\n                 [(ngModel)]=\"entireCardMode\"\n                 (change)=\"updateMode('inline')\"\n                 [value]=\"true\"\n                 name=\"entire_card_switch\">\n          <span [textContent]=\"text.highlighting_mode.entire_card_by\"></span>\n          &ngsp;\n          <select (change)=\"updateMode($event.target.value)\"\n                  id=\"selected_attribute\"\n                  name=\"selected_attribute\"\n                  class=\"form--select form--inline-select\">\n            <option [textContent]=\"text.highlighting_mode.type\"\n                    [selected]=\"lastEntireCardAttribute === 'type'\"\n                    value=\"type\"></option>\n            <option [textContent]=\"text.highlighting_mode.priority\"\n                    [selected]=\"lastEntireCardAttribute === 'priority'\"\n                    value=\"priority\"></option>\n          </select>\n        </label>\n      </div>\n    </div>\n    <div class=\"form--field -full-width\">\n      <div class=\"form--field-container\">\n        <label class=\"option-label\">\n          <input type=\"radio\"\n                 [(ngModel)]=\"highlightingMode\"\n                 (change)=\"updateMode($event.target.value)\"\n                 value=\"none\"\n                 name=\"highlighting_mode_switch\">\n          <span [textContent]=\"text.highlighting_mode.none\"></span>\n        </label>\n      </div>\n    </div>\n\n  </form>\n</div>\n\n","import {Injectable} from '@angular/core';\nimport {I18nService} from 'core-app/modules/common/i18n/i18n.service';\nimport {TabInterface} from \"core-components/wp-table/configuration-modal/tab-portal-outlet\";\nimport {BoardHighlightingTabComponent} from \"core-app/modules/boards/board/configuration-modal/tabs/highlighting-tab.component\";\n\n@Injectable()\nexport class BoardConfigurationService {\n\n  protected _tabs:TabInterface[] = [\n    {\n      name: 'highlighting',\n      title: this.I18n.t('js.work_packages.table_configuration.highlighting'),\n      componentClass: BoardHighlightingTabComponent,\n    }\n  ];\n\n  constructor(readonly I18n:I18nService) {\n  }\n\n  public get tabs() {\n    return this._tabs;\n  }\n}\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n// ++\nimport {MultiInputState} from \"reactivestates\";\nimport {Injectable} from '@angular/core';\nimport {StateCacheService} from 'core-components/states/state-cache.service';\nimport {States} from 'core-components/states.service';\nimport {StatusDmService} from \"core-app/modules/hal/dm-services/status-dm.service\";\nimport {StatusResource} from \"core-app/modules/hal/resources/status-resource\";\n\n@Injectable({ providedIn: 'root' })\nexport class StatusCacheService extends StateCacheService<StatusResource>  {\n\n  constructor(readonly states:States,\n              readonly statusDm:StatusDmService) {\n    super();\n  }\n\n  protected load(id:number|string):Promise<StatusResource> {\n    return this.statusDm.one(id);\n  }\n\n  protected loadAll(ids:string[]):Promise<unknown> {\n    return this.statusDm.list();\n  }\n\n  protected get multiState():MultiInputState<StatusResource> {\n    return this.states.statuses;\n  }\n}\n","import {Injectable} from \"@angular/core\";\nimport {BoardListsService} from \"core-app/modules/boards/board/board-list/board-lists.service\";\nimport {Board} from \"core-app/modules/boards/board/board\";\nimport {StatusDmService} from \"core-app/modules/hal/dm-services/status-dm.service\";\nimport {StatusResource} from \"core-app/modules/hal/resources/status-resource\";\nimport {QueryResource} from \"core-app/modules/hal/resources/query-resource\";\nimport {BoardActionService} from \"core-app/modules/boards/board/board-actions/board-action.service\";\nimport {HalResource} from \"core-app/modules/hal/resources/hal-resource\";\nimport {I18nService} from \"core-app/modules/common/i18n/i18n.service\";\nimport {FilterOperator} from \"core-components/api/api-v3/api-v3-filter-builder\";\nimport {CreateAutocompleterComponent} from \"core-app/modules/common/autocomplete/create-autocompleter.component\";\nimport {OpContextMenuItem} from \"core-components/op-context-menu/op-context-menu.types\";\nimport {StatusCacheService} from \"core-components/statuses/status-cache.service\";\n\n@Injectable()\nexport class BoardStatusActionService implements BoardActionService {\n\n  constructor(protected boardListsService:BoardListsService,\n              protected I18n:I18nService,\n              protected statusCache:StatusCacheService,\n              protected statusDm:StatusDmService) {\n  }\n\n  public get localizedName() {\n    return this.I18n.t('js.work_packages.properties.status');\n  }\n\n  /**\n   * Returns the current filter value if any\n   * @param query\n   * @returns /api/v3/status/:id if a status filter exists\n   */\n  public getFilterHref(query:QueryResource):string|undefined {\n    const filter = _.find(query.filters, filter => filter.id === 'status');\n\n    if (filter) {\n      const value = filter.values[0] as string|HalResource;\n      return (value instanceof HalResource) ? value.href! : value;\n    }\n\n    return;\n  }\n\n  /**\n   * Returns the loaded status\n   * @param query\n   */\n  public getLoadedFilterValue(query:QueryResource):Promise<undefined|StatusResource> {\n    const href = this.getFilterHref(query);\n\n    if (href) {\n      const id = HalResource.idFromLink(href);\n      return this.statusCache.require(id);\n    } else {\n      return Promise.resolve(undefined);\n    }\n  }\n\n  public canAddToQuery(query:QueryResource):Promise<boolean> {\n    return Promise.resolve(true);\n  }\n\n  public addActionQueries(board:Board):Promise<Board> {\n    return this.getStatuses()\n      .then((results) =>\n        Promise.all<unknown>(\n          results.map((status:StatusResource) => {\n\n            if (status.isDefault) {\n              return this.addActionQuery(board, status);\n            }\n\n            return Promise.resolve(board);\n          })\n        )\n          .then(() => board)\n      );\n  }\n\n  public addActionQuery(board:Board, value:HalResource):Promise<Board> {\n    let params:any = {\n      name: value.name,\n    };\n\n    let filter = {\n      status: {\n        operator: '=' as FilterOperator,\n        values: [value.id]\n      }\n    };\n\n    return this.boardListsService.addQuery(board, params, [filter]);\n  }\n\n  /**\n   * Return available statuses for new lists, given the list of active\n   * queries in the board.\n   *\n   * @param board The board we're looking at\n   * @param active The active set of values (hrefs or plain values)\n   */\n  public getAvailableValues(board:Board, active:Set<string>):Promise<HalResource[]> {\n    return this.getStatuses()\n      .then(results =>\n        results.filter(status => !active.has(status.id!))\n      );\n  }\n\n  public getAdditionalListMenuItems(query:QueryResource):Promise<OpContextMenuItem[]> {\n    return Promise.resolve([]);\n  }\n\n  dragIntoAllowed(query:QueryResource, value:HalResource|undefined) {\n    return true;\n  }\n\n  public autocompleterComponent() {\n    return CreateAutocompleterComponent;\n  }\n\n  public headerComponent() {\n    return undefined;\n  }\n\n  public disabledAddButtonPlaceholder(status:StatusResource) {\n    return undefined;\n  }\n\n  public warningTextWhenNoOptionsAvailable() {\n    return Promise.resolve(this.I18n.t('js.boards.add_list_modal.warning.status'));\n  }\n\n  private getStatuses():Promise<StatusResource[]> {\n    return this.statusDm\n      .list()\n      .then(collection => collection.elements);\n  }\n\n}\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n// ++\nimport {MultiInputState} from \"reactivestates\";\nimport {Injectable} from '@angular/core';\nimport {StateCacheService} from 'core-components/states/state-cache.service';\nimport {States} from 'core-components/states.service';\nimport {VersionResource} from \"core-app/modules/hal/resources/version-resource\";\nimport {VersionDmService} from \"core-app/modules/hal/dm-services/version-dm.service\";\n\n@Injectable({ providedIn: 'root' })\nexport class VersionCacheService extends StateCacheService<VersionResource>  {\n\n  constructor(readonly states:States,\n              readonly versionDm:VersionDmService) {\n    super();\n  }\n\n  protected load(id:number|string):Promise<VersionResource> {\n    return this.versionDm.one(id);\n  }\n\n  protected loadAll(ids:string[]):Promise<unknown> {\n    return this.versionDm.list();\n  }\n\n  protected get multiState():MultiInputState<VersionResource> {\n    return this.states.versions;\n  }\n}\n","<div class=\"version-board-header\"\n     [ngClass]=\"{ '-closed': version.isClosed(), '-locked': version.isLocked() }\"\n     *ngIf=\"version\">\n  <h2 [textContent]=\"version.name\"\n      class=\"editable-toolbar-title--fixed\">\n  </h2>\n  <span class=\"version-board-header--info-row -italic -small-font\"> {{version.endDate}}  </span>\n</div>\n","//-- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n//++\nimport {Component, Input} from \"@angular/core\";\nimport {VersionResource} from \"core-app/modules/hal/resources/version-resource\";\nimport {I18nService} from \"core-app/modules/common/i18n/i18n.service\";\n\n\n@Component({\n  templateUrl: './version-board-header.html',\n  styleUrls: ['./version-board-header.sass'],\n  host: { 'class': 'title-container -small' }\n})\nexport class VersionBoardHeaderComponent {\n  @Input('resource') public version:VersionResource;\n\n  constructor(private I18n:I18nService) {\n  }\n\n  public text = {\n    isLocked: this.I18n.t('js.boards.version.is_locked'),\n    isClosed: this.I18n.t('js.boards.version.is_closed')\n  };\n}\n","import {Injectable} from '@angular/core';\nimport {HalResourceService} from 'core-app/modules/hal/services/hal-resource.service';\n// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n// ++\nimport {multiInput, MultiInputState} from 'reactivestates';\nimport {FormResource} from \"core-app/modules/hal/resources/form-resource\";\nimport {StateCacheService} from \"core-components/states/state-cache.service\";\n\n@Injectable({ providedIn: 'root' })\nexport class FormsCacheService extends StateCacheService<FormResource> {\n\n  private $formCache = multiInput<FormResource>();\n\n  constructor(private readonly halResourceService:HalResourceService) {\n    super();\n  }\n\n  protected load(href:string):Promise<FormResource> {\n    return this.halResourceService\n      .post<FormResource>(href, {})\n      .toPromise();\n  }\n\n  protected loadAll(ids:string[]):Promise<undefined> {\n    return Promise\n      .all(ids.map(id => this.load(id)))\n      .then(_ => undefined);\n  }\n\n  protected get multiState():MultiInputState<FormResource> {\n    return this.$formCache;\n  }\n}\n","import {Injectable} from \"@angular/core\";\nimport {BoardListsService} from \"core-app/modules/boards/board/board-list/board-lists.service\";\nimport {Board} from \"core-app/modules/boards/board/board\";\nimport {QueryResource} from \"core-app/modules/hal/resources/query-resource\";\nimport {BoardActionService} from \"core-app/modules/boards/board/board-actions/board-action.service\";\nimport {HalResource} from \"core-app/modules/hal/resources/hal-resource\";\nimport {I18nService} from \"core-app/modules/common/i18n/i18n.service\";\nimport {FilterOperator} from \"core-components/api/api-v3/api-v3-filter-builder\";\nimport {VersionResource} from \"core-app/modules/hal/resources/version-resource\";\nimport {VersionDmService} from \"core-app/modules/hal/dm-services/version-dm.service\";\nimport {CurrentProjectService} from \"core-components/projects/current-project.service\";\nimport {PathHelperService} from \"core-app/modules/common/path-helper/path-helper.service\";\nimport {VersionAutocompleterComponent} from \"core-app/modules/common/autocomplete/version-autocompleter.component\";\nimport {OpContextMenuItem} from \"core-components/op-context-menu/op-context-menu.types\";\nimport {LinkHandling} from \"core-app/modules/common/link-handling/link-handling\";\nimport {StateService} from \"@uirouter/core\";\nimport {HalResourceNotificationService} from \"core-app/modules/hal/services/hal-resource-notification.service\";\nimport {VersionCacheService} from \"core-components/versions/version-cache.service\";\nimport {VersionBoardHeaderComponent} from \"core-app/modules/boards/board/board-actions/version/version-board-header.component\";\nimport {FormResource} from \"core-app/modules/hal/resources/form-resource\";\nimport {FormsCacheService} from \"core-components/forms/forms-cache.service\";\n\n@Injectable()\nexport class BoardVersionActionService implements BoardActionService {\n\n  constructor(protected boardListsService:BoardListsService,\n              protected I18n:I18nService,\n              protected versionDm:VersionDmService,\n              protected versionCache:VersionCacheService,\n              protected currentProject:CurrentProjectService,\n              protected halNotification:HalResourceNotificationService,\n              protected state:StateService,\n              protected formCache:FormsCacheService,\n              protected pathHelper:PathHelperService) {\n  }\n\n  public get localizedName() {\n    return this.I18n.t('js.work_packages.properties.version');\n  }\n\n  /**\n   * Returns the current filter value if any\n   * @param query\n   * @returns /api/v3/versions/:id if a version filter exists\n   */\n  public getFilterHref(query:QueryResource):string|undefined {\n    const filter = _.find(query.filters, filter => filter.id === 'version');\n\n    if (filter) {\n      const value = filter.values[0] as string|HalResource;\n      return (value instanceof HalResource) ? value.href! : value;\n    }\n\n    return;\n  }\n\n  /**\n   * Returns the loaded status\n   * @param query\n   */\n  public getLoadedFilterValue(query:QueryResource):Promise<undefined|VersionResource> {\n    const href = this.getFilterHref(query);\n\n    if (href) {\n      const id = HalResource.idFromLink(href);\n      return this.versionCache.require(id);\n    } else {\n      return Promise.resolve(undefined);\n    }\n  }\n\n  public canAddToQuery(query:QueryResource):Promise<boolean> {\n    const formLink = _.get(query, 'results.createWorkPackage.href', null);\n\n    if (!formLink) {\n      return Promise.resolve(false);\n    }\n\n    return this.formCache\n      .require(formLink)\n      .then((form:FormResource) => form.schema.version.writable);\n  }\n\n  public addActionQueries(board:Board):Promise<Board> {\n    return this.getVersions()\n      .then((results) => {\n        return Promise.all<unknown>(\n          results.map((version:VersionResource) => {\n            const definingName = _.get(version, 'definingProject.name', null);\n            if (version.isOpen() && definingName && definingName === this.currentProject.name) {\n              return this.addActionQuery(board, version);\n            }\n\n            return Promise.resolve(board);\n          })\n        )\n          .then(() => board);\n      });\n  }\n\n  public addActionQuery(board:Board, value:HalResource):Promise<Board> {\n    let params:any = {\n      name: value.name,\n    };\n\n    let filter = {\n      version: {\n        operator: '=' as FilterOperator,\n        values: [value.id]\n      }\n    };\n\n    return this.boardListsService.addQuery(board, params, [filter]);\n  }\n\n  /**\n   * Return available versions for new lists, given the list of active\n   * queries in the board.\n   *\n   * @param board The board we're looking at\n   * @param active The active set of values (hrefs or plain values)\n   */\n  public getAvailableValues(board:Board, active:Set<string>):Promise<HalResource[]> {\n    return this.getVersions()\n      .then(results =>\n        results.filter(version => !active.has(version.id!))\n      );\n  }\n\n  /**\n   * Adds an entry to the list menu to edit the version if allowed\n   * @param {QueryResource} active query\n   * @returns {Promise<any>}\n   */\n  public getAdditionalListMenuItems(query:QueryResource):Promise<OpContextMenuItem[]> {\n    return this\n      .getLoadedFilterValue(query)\n      .then(version => {\n        if (version) {\n          return this.buildItemsForVersion(version);\n        } else {\n          return [];\n        }\n      });\n  }\n\n  public autocompleterComponent() {\n    return VersionAutocompleterComponent;\n  }\n\n  public headerComponent() {\n    return VersionBoardHeaderComponent;\n  }\n\n  public disabledAddButtonPlaceholder(version:VersionResource) {\n    if (version.isLocked()) {\n      return { icon: 'locked', text: this.I18n.t('js.boards.version.locked') };\n    } else if (version.isClosed()) {\n      return { icon: 'not-supported', text: this.I18n.t('js.boards.version.closed') };\n    } else {\n      return undefined;\n    }\n  }\n\n  public dragIntoAllowed(query:QueryResource, value:HalResource|undefined) {\n    return value instanceof VersionResource && value.isOpen();\n  }\n\n  public warningTextWhenNoOptionsAvailable() {\n    return Promise.resolve(undefined);\n  }\n\n  private getVersions():Promise<VersionResource[]> {\n    if (this.currentProject.id === null) {\n      return Promise.resolve([]);\n    }\n\n    return this.versionDm\n      .listForProject(this.currentProject.id)\n      .then(collection => collection.elements);\n  }\n\n  private patchVersionStatus(version:VersionResource, newStatus:'open'|'closed'|'locked') {\n    this.versionDm\n      .patch(version, { status: newStatus })\n      .then((version) => {\n        this.versionCache.updateValue(version.id!, version);\n        this.state.go('.', {}, { reload: true });\n      })\n      .catch(error => this.halNotification.handleRawError(error));\n  }\n\n  private buildItemsForVersion(version:VersionResource):OpContextMenuItem[] {\n    const id = version.id!;\n    return [\n      {\n        // Lock version\n        hidden: !version.isOpen() || (version.isLocked() && !version.$links.update),\n        linkText: this.I18n.t('js.boards.version.lock_version'),\n        onClick: () => {\n          this.patchVersionStatus(version, 'locked');\n          return true;\n        }\n      },\n      {\n        // Unlock version\n        hidden: !version.isLocked() || (version.isOpen() && !version.$links.update),\n        linkText: this.I18n.t('js.boards.version.unlock_version'),\n        onClick: () => {\n          this.patchVersionStatus(version, 'open');\n          return true;\n        }\n      },\n      {\n        // Close version\n        hidden: version.isClosed() || (!version.isClosed() && !version.$links.update),\n        linkText: this.I18n.t('js.boards.version.close_version'),\n        onClick: () => {\n          this.patchVersionStatus(version, 'closed');\n          return true;\n        }\n      },\n      {\n        // Open version\n        hidden: !version.isClosed() || (version.isClosed() && !version.$links.update),\n        linkText: this.I18n.t('js.boards.version.open_version'),\n        onClick: () => {\n          this.patchVersionStatus(version, 'open');\n          return true;\n        }\n      },\n      {\n        // Show link\n        linkText: this.I18n.t('js.boards.version.show_version'),\n        href: this.pathHelper.versionShowPath(id),\n        onClick: (evt:JQuery.TriggeredEvent) => {\n          if (!LinkHandling.isClickedWithModifier(evt)) {\n            window.open(this.pathHelper.versionShowPath(id), '_blank');\n            return true;\n          }\n\n          return false;\n        }\n      },\n      {\n        // Edit link\n        hidden: !version.$links.update,\n        linkText: this.I18n.t('js.boards.version.edit_version'),\n        href: this.pathHelper.versionEditPath(id),\n        onClick: (evt:JQuery.TriggeredEvent) => {\n          if (!LinkHandling.isClickedWithModifier(evt)) {\n            window.open(this.pathHelper.versionEditPath(id), '_blank');\n            return true;\n          }\n\n          return false;\n        }\n      }\n    ];\n  }\n}\n","import {Injectable} from \"@angular/core\";\nimport {interval} from 'rxjs';\nimport {startWith, switchMap, filter} from 'rxjs/operators';\nimport {QueryDmService} from \"core-app/modules/hal/dm-services/query-dm.service\";\n\nconst POLLING_INTERVAL = 2000;\n\n@Injectable()\nexport class QueryUpdatedService {\n\n  constructor(readonly queryDm:QueryDmService) {}\n\n  public monitor(ids:string[]) {\n    let time = new Date();\n\n    return interval(POLLING_INTERVAL)\n           .pipe(\n             startWith(0),\n             switchMap(() => {\n               let result = this.queryForUpdates(ids, time);\n\n               time = new Date();\n\n               return result;\n             }),\n             filter((collection) => collection.count > 0)\n           );\n  }\n\n  private queryForUpdates(ids:string[], updatedAfter:Date) {\n    return this.queryDm.list({filters: [[\"id\", \"=\", ids],\n                                                [\"updatedAt\", \"<>d\", [updatedAfter.toISOString()]]]});\n  }\n}\n","<div class=\"assignee-board-header\" *ngIf=\"user\">\n  <user-avatar [user]=\"user\" data-class-list=\"avatar-mini\"></user-avatar>\n  <h2 [textContent]=\"user.name\"\n      class=\"editable-toolbar-title--fixed\">\n  </h2>\n</div>\n","//-- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n//++\nimport {Component, Input} from \"@angular/core\";\nimport {UserResource} from \"core-app/modules/hal/resources/user-resource\";\n\n\n@Component({\n  templateUrl: './assignee-board-header.html',\n  styleUrls: ['./assignee-board-header.sass'],\n  host: { 'class': 'title-container -small' }\n})\nexport class AssigneeBoardHeaderComponent {\n  @Input('resource') public user:UserResource;\n}\n","import {Injectable, Injector} from \"@angular/core\";\nimport {BoardListsService} from \"core-app/modules/boards/board/board-list/board-lists.service\";\nimport {Board} from \"core-app/modules/boards/board/board\";\nimport {QueryResource} from \"core-app/modules/hal/resources/query-resource\";\nimport {BoardActionService} from \"core-app/modules/boards/board/board-actions/board-action.service\";\nimport {HalResource} from \"core-app/modules/hal/resources/hal-resource\";\nimport {I18nService} from \"core-app/modules/common/i18n/i18n.service\";\nimport {FilterOperator} from \"core-components/api/api-v3/api-v3-filter-builder\";\nimport {CreateAutocompleterComponent} from \"core-app/modules/common/autocomplete/create-autocompleter.component\";\nimport {OpContextMenuItem} from \"core-components/op-context-menu/op-context-menu.types\";\nimport {UserResource} from 'core-app/modules/hal/resources/user-resource';\nimport {CurrentProjectService} from 'core-app/components/projects/current-project.service';\nimport {CollectionResource} from 'core-app/modules/hal/resources/collection-resource';\nimport {HalResourceService} from 'core-app/modules/hal/services/hal-resource.service';\nimport {AssigneeBoardHeaderComponent} from \"core-app/modules/boards/board/board-actions/assignee/assignee-board-header.component\";\nimport {input} from \"reactivestates\";\nimport {take} from \"rxjs/operators\";\nimport {PathHelperService} from \"core-app/modules/common/path-helper/path-helper.service\";\nimport {InjectField} from \"core-app/helpers/angular/inject-field.decorator\";\nimport {ProjectDmService} from \"core-app/modules/hal/dm-services/project-dm.service\";\nimport {ProjectResource} from \"core-app/modules/hal/resources/project-resource\";\n\n@Injectable()\nexport class BoardAssigneeActionService implements BoardActionService {\n\n  private assignees = input<HalResource[]>();\n\n  @InjectField() public projectDmService:ProjectDmService;\n\n  constructor(protected boardListsService:BoardListsService,\n              protected I18n:I18nService,\n              protected halResourceService:HalResourceService,\n              protected pathHelper:PathHelperService,\n              protected currentProject:CurrentProjectService,\n              readonly injector:Injector) {\n  }\n\n  public get localizedName() {\n    return this.I18n.t('js.work_packages.properties.assignee');\n  }\n\n  /**\n   * Returns the current filter value if any\n   * @param query\n   * @returns /api/v3/assignee/:id if a assignee filter exists\n   */\n  public getFilterHref(query:QueryResource):string|undefined {\n    const filter = _.find(query.filters, filter => filter.id === 'assignee');\n    if (filter) {\n      const value = filter.values[0] as string|HalResource;\n      return (value instanceof HalResource) ? value.href! : value;\n    }\n\n    return;\n  }\n\n  /**\n   * Returns the loaded assignee\n   * @param query\n   */\n  public getLoadedFilterValue(query:QueryResource):Promise<undefined|HalResource> {\n    const href = this.getFilterHref(query);\n\n    if (!href) {\n      return Promise.resolve(undefined);\n    }\n\n    return this\n      .getAssignees()\n      .then(collection => collection.find(resource => resource.href === href));\n  }\n\n  public canAddToQuery(query:QueryResource):Promise<boolean> {\n    return Promise.resolve(true);\n  }\n\n  public addActionQueries(board:Board):Promise<Board> {\n    return Promise.resolve(board);\n  }\n\n  public addActionQuery(board:Board, value:HalResource):Promise<Board> {\n    let params:any = {\n      name: value.name,\n    };\n\n    let filter = {\n      assignee: {\n        operator: '=' as FilterOperator,\n        values: [value.id]\n      }\n    };\n\n    return this.boardListsService.addQuery(board, params, [filter]);\n  }\n\n  /**\n   * Return available assignees for new lists, given the list of active\n   * queries in the board.\n   *\n   * @param board The board we're looking at\n   * @param active The active set of values (hrefs)\n   */\n  public getAvailableValues(board:Board, active:Set<string>):Promise<HalResource[]> {\n    return this\n      .getAssignees()\n      .then(results =>\n        results.filter(assignee => !active.has(assignee.id!))\n      );\n  }\n\n  public getAdditionalListMenuItems(query:QueryResource):Promise<OpContextMenuItem[]> {\n    return Promise.resolve([]);\n  }\n\n  dragIntoAllowed(query:QueryResource, value:HalResource|undefined) {\n    return true;\n  }\n\n  public autocompleterComponent() {\n    return CreateAutocompleterComponent;\n  }\n\n  public headerComponent() {\n    return AssigneeBoardHeaderComponent;\n  }\n\n  public disabledAddButtonPlaceholder(assignee:HalResource) {\n    return undefined;\n  }\n\n  public warningTextWhenNoOptionsAvailable() {\n    let text = this.I18n.t('js.boards.add_list_modal.warning.assignee');\n\n    return this.projectDmService\n      .one(parseInt(this.currentProject.id!))\n      .then((project:ProjectResource) => {\n        if (project.memberships) {\n          text = text.concat(\n            this.I18n.t('js.boards.add_list_modal.warning.add_members', {\n              link: this.pathHelper.projectMembershipsPath(this.currentProject.identifier!)\n            })\n          );\n        }\n\n        return text;\n      });\n  }\n\n  private getAssignees():Promise<HalResource[]> {\n    const projectIdentifier = this.currentProject.identifier!;\n    this.assignees.putFromPromiseIfPristine(() =>\n      this.halResourceService\n        .get(this.pathHelper.api.v3.projects.id(projectIdentifier).available_assignees)\n        .toPromise()\n        .then((collection:CollectionResource<UserResource>) => collection.elements)\n    );\n\n    return this.assignees\n      .values$()\n      .pipe(take(1))\n      .toPromise();\n  }\n\n}\n","import {Component, Injector} from \"@angular/core\";\nimport {BoardConfigurationService} from \"core-app/modules/boards/board/configuration-modal/board-configuration.service\";\nimport {BoardActionsRegistryService} from \"core-app/modules/boards/board/board-actions/board-actions-registry.service\";\nimport {BoardStatusActionService} from \"core-app/modules/boards/board/board-actions/status/status-action.service\";\nimport {BoardVersionActionService} from \"core-app/modules/boards/board/board-actions/version/version-action.service\";\nimport {QueryUpdatedService} from \"core-app/modules/boards/board/query-updated/query-updated.service\";\nimport {BoardAssigneeActionService} from \"core-app/modules/boards/board/board-actions/assignee/assignee-action.service\";\n\n@Component({\n  selector: 'boards-entry',\n  template: '<ui-view wp-isolated-query-space></ui-view>',\n  providers: [\n    BoardConfigurationService,\n    BoardStatusActionService,\n    BoardVersionActionService,\n    BoardAssigneeActionService,\n    QueryUpdatedService,\n  ]\n})\nexport class BoardsRootComponent {\n\n  constructor(readonly injector:Injector) {\n\n    // Register action services\n    const registry = injector.get(BoardActionsRegistryService);\n    const statusAction = injector.get(BoardStatusActionService);\n    const versionAction = injector.get(BoardVersionActionService);\n    const assigneeAction = injector.get(BoardAssigneeActionService);\n\n    registry.add('status', statusAction);\n    registry.add('assignee', assigneeAction);\n    registry.add('version', versionAction);\n  }\n}\n","<div class=\"op-modal--portal\">\n  <div class=\"op-modal--modal-container -wide wp-table--configuration-modal loading-indicator--location\"\n       data-indicator-name=\"modal\"\n       tabindex=\"0\">\n    <div class=\"op-modal--modal-header\">\n      <h3 [textContent]=\"text.title\"></h3>\n\n      <a class=\"op-modal--modal-close-button\">\n        <i\n            class=\"icon-close\"\n            (click)=\"closeMe($event)\"\n            [attr.title]=\"text.closePopup\">\n        </i>\n      </a>\n    </div>\n\n    <div *ngIf=\"!!tabPortalHost\"\n         class=\"content--tabs scrollable-tabs\">\n      <ul class=\"tabrow\">\n        <li *ngFor=\"let tab of availableTabs\"\n            [ngClass]=\"{ 'selected': currentTab && tab.name === currentTab.name }\">\n          <a class=\"tab-show\"\n             role=\"button\"\n             [ngClass]=\"{ '-disabled': tab.disableBecause != null, 'selected': currentTab && tab.name === currentTab.name }\"\n             [attr.title]=\"tab.disableBecause || tab.title\"\n             [textContent]=\"tab.title\"\n             (click)=\"switchTo(tab.name)\"\n             href>\n          </a>\n      </ul>\n    </div>\n\n    <div class=\"tab-content\" #tabContentOutlet></div>\n    <div class=\"modal--form-actions\">\n      <button class=\"button -highlight\"\n              [textContent]=\"text.applyButton\"\n              (click)=\"saveChanges()\">\n      </button>\n      <button class=\"button\"\n              [textContent]=\"text.cancelButton\"\n              (click)=\"closeMe($event)\">\n      </button>\n    </div>\n  </div>\n</div>\n","import {\n  ApplicationRef,\n  ChangeDetectorRef,\n  Component,\n  ComponentFactoryResolver,\n  ElementRef,\n  Inject,\n  Injector,\n  OnDestroy,\n  OnInit,\n  ViewChild\n} from '@angular/core';\nimport {OpModalLocalsMap} from 'core-components/op-modals/op-modal.types';\nimport {OpModalComponent} from 'core-components/op-modals/op-modal.component';\nimport {\n  ActiveTabInterface,\n  TabComponent,\n  TabInterface,\n  TabPortalOutlet\n} from 'core-components/wp-table/configuration-modal/tab-portal-outlet';\nimport {I18nService} from \"core-app/modules/common/i18n/i18n.service\";\nimport {OpModalLocalsToken} from \"core-components/op-modals/op-modal.service\";\nimport {BoardConfigurationService} from \"core-app/modules/boards/board/configuration-modal/board-configuration.service\";\nimport {BoardService} from \"core-app/modules/boards/board/board.service\";\nimport {Board} from \"core-app/modules/boards/board/board\";\nimport {BoardCacheService} from \"core-app/modules/boards/board/board-cache.service\";\n\n\n@Component({\n  templateUrl: './board-configuration.modal.html'\n})\nexport class BoardConfigurationModal extends OpModalComponent implements OnInit, OnDestroy  {\n\n  /* Close on escape? */\n  public closeOnEscape = false;\n\n  /* Close on outside click */\n  public closeOnOutsideClick = false;\n\n  public text = {\n    title: this.I18n.t('js.boards.configuration_modal.title'),\n    closePopup: this.I18n.t('js.close_popup_title'),\n\n    applyButton: this.I18n.t('js.modals.button_apply'),\n    cancelButton: this.I18n.t('js.modals.button_cancel'),\n  };\n\n  // Get the view child we'll use as the portal host\n  @ViewChild('tabContentOutlet', { static: true }) tabContentOutlet:ElementRef;\n  // And a reference to the actual portal host interface\n  public tabPortalHost:TabPortalOutlet;\n\n  constructor(@Inject(OpModalLocalsToken) public locals:OpModalLocalsMap,\n              readonly I18n:I18nService,\n              readonly boardService:BoardService,\n              readonly boardCache:BoardCacheService,\n              readonly boardConfigurationService:BoardConfigurationService,\n              readonly injector:Injector,\n              readonly appRef:ApplicationRef,\n              readonly componentFactoryResolver:ComponentFactoryResolver,\n              readonly cdRef:ChangeDetectorRef,\n              readonly elementRef:ElementRef) {\n    super(locals, cdRef, elementRef);\n  }\n\n  ngOnInit() {\n    this.$element = jQuery(this.elementRef.nativeElement);\n\n    this.tabPortalHost = new TabPortalOutlet(\n      this.boardConfigurationService.tabs,\n      this.tabContentOutlet.nativeElement,\n      this.componentFactoryResolver,\n      this.appRef,\n      this.injector\n    );\n\n    setTimeout(() => {\n      const initialTab = this.availableTabs[0].name;\n      this.switchTo(initialTab);\n    });\n  }\n\n  ngOnDestroy() {\n    this.tabPortalHost.dispose();\n  }\n\n  public get availableTabs():TabInterface[] {\n    return this.tabPortalHost.availableTabs;\n  }\n\n  public get currentTab():ActiveTabInterface|null {\n    return this.tabPortalHost.currentTab;\n  }\n\n  public switchTo(name:string) {\n    this.tabPortalHost.switchTo(name);\n  }\n\n  public saveChanges():void {\n    this.tabPortalHost.activeComponents.forEach((component:TabComponent) => {\n      component.onSave();\n    });\n\n    const board = this.locals.board as Board;\n    this.boardService\n      .save(board)\n      .then(board => {\n        this.boardCache.update(board);\n        this.service.close();\n      });\n\n  }\n\n  /**\n   * Called when the user attempts to close the modal window.\n   * The service will close this modal if this method returns true\n   * @returns {boolean}\n   */\n  public onClose():boolean {\n    this.afterFocusOn.focus();\n    return true;\n  }\n\n  protected get afterFocusOn():JQuery {\n    return this.$element;\n  }\n}\n","//-- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n//++\n\nimport {Directive, ElementRef, Injector, Input} from '@angular/core';\nimport {I18nService} from 'core-app/modules/common/i18n/i18n.service';\nimport {OpContextMenuTrigger} from 'core-components/op-context-menu/handlers/op-context-menu-trigger.directive';\nimport {OPContextMenuService} from 'core-components/op-context-menu/op-context-menu.service';\nimport {OpModalService} from \"core-components/op-modals/op-modal.service\";\nimport {Board} from \"core-app/modules/boards/board/board\";\nimport {BoardConfigurationModal} from \"core-app/modules/boards/board/configuration-modal/board-configuration.modal\";\nimport {BoardService} from \"core-app/modules/boards/board/board.service\";\nimport {StateService} from \"@uirouter/core\";\nimport {NotificationsService} from \"core-app/modules/common/notifications/notifications.service\";\nimport {BoardCacheService} from \"core-app/modules/boards/board/board-cache.service\";\nimport {triggerEditingEvent} from \"core-app/modules/common/editable-toolbar-title/editable-toolbar-title.component\";\n\n@Directive({\n  selector: '[boardsToolbarMenu]'\n})\nexport class BoardsToolbarMenuDirective extends OpContextMenuTrigger {\n  @Input('boardsToolbarMenu-resource') public board:Board;\n\n  public text = {\n    deleteSuccessful: this.I18n.t('js.notice_successful_delete'),\n  };\n\n  constructor(readonly elementRef:ElementRef,\n              readonly opContextMenu:OPContextMenuService,\n              readonly opModalService:OpModalService,\n              readonly boardService:BoardService,\n              readonly BoardCache:BoardCacheService,\n              readonly Notifications:NotificationsService,\n              readonly State:StateService,\n              readonly injector:Injector,\n              readonly I18n:I18nService) {\n\n    super(elementRef, opContextMenu);\n  }\n\n  public get locals() {\n    return {\n      contextMenuId: 'boardsToolbarMenu',\n      items: this.items\n    };\n  }\n\n  protected open(evt:JQuery.TriggeredEvent) {\n    this.buildItems();\n    this.opContextMenu.show(this, evt);\n  }\n\n  private buildItems() {\n    this.items = [\n      {\n        // Configuration modal\n        linkText: this.I18n.t('js.toolbar.settings.configure_view'),\n        icon: 'icon-settings',\n        onClick: ($event:JQuery.TriggeredEvent) => {\n          this.opContextMenu.close();\n          this.opModalService.show(BoardConfigurationModal, this.injector, { board: this.board });\n\n          return true;\n        }\n      },\n      {\n        // Rename query shortcut\n        linkText: this.I18n.t('js.toolbar.settings.page_settings'),\n        icon: 'icon-edit',\n        onClick: ($event:JQuery.TriggeredEvent) => {\n          if (!!this.board.grid.updateImmediately) {\n            jQuery(`.toolbar-container .editable-toolbar-title--input`).trigger(triggerEditingEvent);\n          }\n\n          return true;\n        }\n      },\n      {\n        // Delete query\n        linkText: this.I18n.t('js.toolbar.settings.delete'),\n        icon: 'icon-delete',\n        onClick: ($event:JQuery.TriggeredEvent) => {\n          if (this.board.grid.delete &&\n            window.confirm(this.I18n.t('js.text_query_destroy_confirmation'))) {\n            this.boardService\n              .delete(this.board)\n              .then(() => {\n                this.BoardCache.clearSome(this.board.id!);\n                this.State.go('^', { flash_message: { type: 'success', message: this.text.deleteSuccessful } });\n              });\n          }\n\n          return true;\n        }\n      }\n    ];\n  }\n}\n","<div class=\"op-modal--portal confirm-form-submit--modal  ngdialog-theme-openproject\">\n  <div class=\"op-modal--modal-container confirm-dialog--modal loading-indicator--location\"\n       data-indicator-name=\"modal\"\n       tabindex=\"0\">\n    <div class=\"op-modal--modal-header\">\n      <a class=\"op-modal--modal-close-button\" *ngIf=\"showClose\">\n        <i\n            class=\"icon-close\"\n            (click)=\"closeMe($event)\"\n            [attr.title]=\"text.close_popup\">\n        </i>\n      </a>\n    </div>\n\n    <div class=\"ngdialog-body op-modal--modal-body\">\n      <section class=\"new-board--section\">\n        <h3 [textContent]=\"text.free_board\"></h3>\n        <p [textContent]=\"text.free_board_text\"></p>\n\n        <button class=\"button\"\n                [disabled]=\"inFlight\"\n                (accessibleClick)=\"createFree()\">\n          <op-icon icon-classes=\"icon4 icon-add\"></op-icon>\n          <span [textContent]=\"text.free_board\"></span>\n        </button>\n      </section>\n      <section class=\"new-board--section\">\n        <h3 [textContent]=\"text.action_board\"></h3>\n        <p [textContent]=\"text.action_board_text\"></p>\n\n        <div class=\"form--field\">\n          <div class=\"form--field-container\">\n            <div class=\"form--select-container -slim\">\n              <label class=\"form--label\" for=\"new_board_action_select\" [textContent]=\"text.select_attribute\"></label>\n              <select #actionAttributeSelect\n                      name=\"new_board_action_select\"\n                      id=\"new_board_action_select\"\n                      class=\"new-board--action-select\">\n                <option *ngFor=\"let item of available\" [value]=\"item.attribute\" [textContent]=\"item.text\"></option>\n              </select>\n            </div>\n          </div>\n        </div>\n\n        <button class=\"button\"\n                [disabled]=\"inFlight\"\n                (accessibleClick)=\"createAction()\">\n          <op-icon icon-classes=\"icon4 icon-add\"></op-icon>\n          <span [textContent]=\"text.action_board\"></span>\n        </button>\n      </section>\n    </div>\n  </div>\n</div>\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n// ++\n\nimport {OpModalComponent} from \"core-components/op-modals/op-modal.component\";\nimport {OpModalLocalsToken} from \"core-components/op-modals/op-modal.service\";\nimport {ChangeDetectorRef, Component, ElementRef, Inject, ViewChild} from \"@angular/core\";\nimport {OpModalLocalsMap} from \"core-components/op-modals/op-modal.types\";\nimport {I18nService} from \"core-app/modules/common/i18n/i18n.service\";\nimport {BoardType} from \"core-app/modules/boards/board/board\";\nimport {StateService} from \"@uirouter/core\";\nimport {BoardService} from \"core-app/modules/boards/board/board.service\";\nimport {BoardCacheService} from \"core-app/modules/boards/board/board-cache.service\";\nimport {BoardActionsRegistryService} from \"core-app/modules/boards/board/board-actions/board-actions-registry.service\";\nimport {LoadingIndicatorService} from \"core-app/modules/common/loading-indicator/loading-indicator.service\";\nimport {HalResourceNotificationService} from \"core-app/modules/hal/services/hal-resource-notification.service\";\n\n@Component({\n  templateUrl: './new-board-modal.html'\n})\nexport class NewBoardModalComponent extends OpModalComponent {\n  @ViewChild('actionAttributeSelect', { static: true }) actionAttributeSelect:ElementRef;\n\n  public showClose:boolean = true;\n\n  public confirmed = false;\n\n  public available = this.boardActions.available();\n\n  public inFlight = false;\n\n  public text:any = {\n    close_popup: this.I18n.t('js.close_popup_title'),\n\n    free_board: this.I18n.t('js.boards.board_type.free'),\n    free_board_text: this.I18n.t('js.boards.board_type.free_text'),\n\n    action_board: this.I18n.t('js.boards.board_type.action'),\n    action_board_text: this.I18n.t('js.boards.board_type.action_text'),\n    select_attribute: this.I18n.t('js.boards.board_type.select_attribute'),\n    placeholder: this.I18n.t('js.placeholders.selection'),\n  };\n\n  constructor(readonly elementRef:ElementRef,\n              @Inject(OpModalLocalsToken) public locals:OpModalLocalsMap,\n              readonly cdRef:ChangeDetectorRef,\n              readonly state:StateService,\n              readonly boardService:BoardService,\n              readonly boardActions:BoardActionsRegistryService,\n              readonly boardCache:BoardCacheService,\n              readonly halNotification:HalResourceNotificationService,\n              readonly loadingIndicatorService:LoadingIndicatorService,\n              readonly I18n:I18nService) {\n\n    super(locals, cdRef, elementRef);\n  }\n\n  createFree() {\n    this.create({ type: 'free' });\n  }\n\n  createAction() {\n    this.create({ type: 'action', attribute: this.actionAttributeSelect.nativeElement.value! });\n  }\n\n  private create(params:{ type:BoardType, attribute?:string }) {\n    this.inFlight = true;\n\n    this.loadingIndicatorService.modal.promise = this.boardService\n      .create(params)\n      .then((board) => {\n        this.inFlight = false;\n        this.closeMe();\n        this.boardCache.update(board);\n        this.state.go('boards.partitioned.show', { board_id: board.id, isNew: true });\n      })\n      .catch((error:unknown) => {\n        this.inFlight = false;\n        this.halNotification.handleRawError(error);\n      });\n  }\n}\n\n","<div class=\"toolbar-container\">\n  <div class=\"toolbar\">\n    <div class=\"title-container\">\n      <h2 [textContent]=\"text.boards\">\n      </h2>\n    </div>\n    <ul class=\"toolbar-items\"\n        *ngIf=\"showBoardIndexView()\">\n      <li *ngIf=\"canAdd\"\n          class=\"toolbar-item\">\n        <a class=\"button -alt-highlight\"\n           (click)=\"newBoard()\">\n          <op-icon icon-classes=\"button--icon icon-add\">\n          </op-icon>\n          <span class=\"button--text\"\n                [textContent]=\"text.board\">\n          </span>\n        </a>\n      </li>\n    </ul>\n  </div>\n</div>\n\n<div class=\"boards--listing-group loading-indicator--location\"\n     data-indicator-name=\"boards-module\">\n  <div *ngIf=\"showBoardIndexView() && (boards$ | async) as boards\"\n       class=\"generic-table--container\">\n    <div class=\"generic-table--results-container\">\n      <table class=\"generic-table\">\n        <colgroup>\n          <col highlight-col>\n          <col highlight-col>\n          <col highlight-col>\n          <col highlight-col>\n          <col>\n        </colgroup>\n        <thead>\n          <tr>\n            <th>\n              <div class=\"generic-table--sort-header-outer\">\n                <div class=\"generic-table--sort-header\">\n                 <span [textContent]=\"text.name\">\n                 </span>\n                </div>\n              </div>\n            </th>\n            <th>\n              <div class=\"generic-table--sort-header-outer\">\n                <div class=\"generic-table--sort-header\">\n                 <span [textContent]=\"text.type\">\n                 </span>\n                </div>\n              </div>\n            </th>\n            <th>\n              <div class=\"generic-table--sort-header-outer\">\n                <div class=\"generic-table--sort-header\">\n                 <span [textContent]=\"text.createdAt\">\n                 </span>\n                </div>\n              </div>\n            </th>\n            <th>\n              <div class=\"generic-table--empty-header\">\n              </div>\n            </th>\n          </tr>\n        </thead>\n        <tbody>\n        <tr *ngIf=\"boards.length === 0\" id=\"empty-row-notification\">\n          <td colspan=\"4\">\n            <span>\n              <op-icon icon-classes=\"icon-info1 icon-context\"></op-icon>\n              <span>\n                <strong [textContent]=\"text.noResults\"></strong>\n              </span>\n            </span>\n          </td>\n        </tr>\n        <tr *ngFor=\"let board of boards\">\n          <td class=\"name\">\n           <a [textContent]=\"board.name\"\n              uiSref=\"boards.partitioned.show\"\n              [uiParams]=\"{ board_id: board.id }\">\n           </a>\n          </td>\n          <td>\n            <span *ngIf=\"board.isFree\" [textContent]=\"text.type_free\"></span>\n            <span *ngIf=\"board.isAction\" [textContent]=\"text.action_by_attribute(board.actionAttribute)\"></span>\n          </td>\n          <td>\n            <op-date-time [dateTimeValue]=\"board.createdAt\"></op-date-time>\n          </td>\n          <td class=\"buttons\">\n            <accessible-by-keyboard *ngIf=\"board.editable\"\n                                    (execute)=\"destroyBoard(board)\"\n                                    linkClass=\"icon icon-delete\">\n              {{ text.delete }}\n            </accessible-by-keyboard>\n          </td>\n        </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n</div>\n\n<div *ngIf=\"!showBoardIndexView()\"\n     class=\"boards--teaser-container\">\n  <p>{{ text.teaser_text }}</p>\n  <p>{{ text.enterprise }}</p>\n\n  <a class=\"button -alt-highlight -with-icon icon-checkmark\"\n     [href]=\"eeLink()\"\n     target='blank'>\n    {{ text.upgrade }}\n  </a>\n\n  <a class=\"button -highlight-inverted\"\n     [href]=\"demoLink()\" >\n    {{ text.personal_demo }}\n  </a>\n\n  <div class=\"boards--teaser-video-container\">\n    <iframe [src]=\"teaserVideoURL\"\n            class=\"boards--teaser-video\"\n            frameborder=\"0\"\n            allow=\"autoplay; fullscreen\"\n            allowfullscreen>\n    </iframe>\n  </div>\n</div>\n","import {AfterViewInit, Component, Injector, OnInit} from \"@angular/core\";\nimport {Observable} from \"rxjs\";\nimport {I18nService} from \"core-app/modules/common/i18n/i18n.service\";\nimport {BoardService} from \"core-app/modules/boards/board/board.service\";\nimport {Board} from \"core-app/modules/boards/board/board\";\nimport {BoardCacheService} from \"core-app/modules/boards/board/board-cache.service\";\nimport {NotificationsService} from \"core-app/modules/common/notifications/notifications.service\";\nimport {OpModalService} from \"core-components/op-modals/op-modal.service\";\nimport {NewBoardModalComponent} from \"core-app/modules/boards/new-board-modal/new-board-modal.component\";\nimport {BannersService} from \"core-app/modules/common/enterprise/banners.service\";\nimport {LoadingIndicatorService} from \"core-app/modules/common/loading-indicator/loading-indicator.service\";\nimport {AuthorisationService} from \"core-app/modules/common/model-auth/model-auth.service\";\nimport {enterpriseDemoUrl, enterpriseEditionUrl} from \"core-app/globals/constants.const\";\nimport {DomSanitizer} from \"@angular/platform-browser\";\nimport {boardTeaserVideoURL} from \"core-app/modules/boards/board-constants.const\";\nimport {UntilDestroyedMixin} from \"core-app/helpers/angular/until-destroyed.mixin\";\nimport {componentDestroyed} from \"@w11k/ngx-componentdestroyed\";\n\n@Component({\n  templateUrl: './boards-index-page.component.html',\n  styleUrls: ['./boards-index-page.component.sass']\n})\nexport class BoardsIndexPageComponent extends UntilDestroyedMixin implements OnInit, AfterViewInit {\n\n  public text = {\n    name: this.I18n.t('js.modals.label_name'),\n    board: this.I18n.t('js.label_board'),\n    boards: this.I18n.t('js.label_board_plural'),\n    type: this.I18n.t('js.boards.label_board_type'),\n    type_free: this.I18n.t('js.boards.board_type.free'),\n    action_by_attribute: (attr:string) => this.I18n.t('js.boards.board_type.action_by_attribute',\n      { attribute: this.I18n.t('js.boards.board_type.action_type.' + attr ) }),\n    createdAt: this.I18n.t('js.label_created_on'),\n    delete: this.I18n.t('js.button_delete'),\n    areYouSure: this.I18n.t('js.text_are_you_sure'),\n    deleteSuccessful: this.I18n.t('js.notice_successful_delete'),\n    noResults: this.I18n.t('js.notice_no_results_to_display'),\n\n    teaser_text: this.I18n.t('js.boards.upsale.teaser_text'),\n    enterprise: this.I18n.t('js.boards.upsale.upgrade_to_ee_text'),\n    upgrade: this.I18n.t('js.boards.upsale.upgrade'),\n    personal_demo: this.I18n.t('js.boards.upsale.personal_demo'),\n  };\n\n  public canAdd = false;\n\n  public boards$:Observable<Board[]> = this.boardCache.observeAll();\n\n  teaserVideoURL = this.domSanitizer.bypassSecurityTrustResourceUrl(boardTeaserVideoURL);\n\n  constructor(private readonly boardService:BoardService,\n              private readonly boardCache:BoardCacheService,\n              private readonly I18n:I18nService,\n              private readonly notifications:NotificationsService,\n              private readonly opModalService:OpModalService,\n              private readonly loadingIndicatorService:LoadingIndicatorService,\n              private readonly authorisationService:AuthorisationService,\n              private readonly injector:Injector,\n              private readonly bannerService:BannersService,\n              private readonly domSanitizer:DomSanitizer) {\n    super();\n  }\n\n  ngOnInit():void {\n    this.authorisationService\n      .observeUntil(componentDestroyed(this))\n      .subscribe(() => {\n        this.canAdd = this.authorisationService.can('boards', 'create');\n      });\n  }\n\n  ngAfterViewInit():void {\n    const loadingIndicator = this.loadingIndicatorService.indicator('boards-module');\n    loadingIndicator.promise = this.boardService.loadAllBoards();\n  }\n\n  newBoard() {\n    this.opModalService.show(NewBoardModalComponent, this.injector);\n  }\n\n  destroyBoard(board:Board) {\n    if (!window.confirm(this.text.areYouSure)) {\n      return;\n    }\n\n    this.boardService\n      .delete(board)\n      .then(() => {\n        this.boardCache.clearSome(board.id!);\n        this.notifications.addSuccess(this.text.deleteSuccessful);\n      })\n      .catch((error) => this.notifications.addError(\"Deletion failed: \" + error));\n  }\n\n  public showBoardIndexView() {\n    return !this.bannerService.eeShowBanners;\n  }\n\n  public eeLink() {\n    return enterpriseEditionUrl + '&op_referrer=boards';\n  }\n\n  public demoLink() {\n    return enterpriseDemoUrl;\n  }\n}\n","export const boardTeaserVideoURL = \"https://player.vimeo.com/video/337280106\";\n","<div class=\"op-modal--portal confirm-form-submit--modal  ngdialog-theme-openproject\">\n  <div class=\"op-modal--modal-container confirm-dialog--modal loading-indicator--location -slim\"\n       data-indicator-name=\"modal\"\n       tabindex=\"0\">\n    <div class=\"op-modal--modal-header\">\n      <a class=\"op-modal--modal-close-button\" *ngIf=\"showClose\">\n        <i\n            class=\"icon-close\"\n            (click)=\"closeMe($event)\"\n            [attr.title]=\"text.close_popup\">\n        </i>\n      </a>\n      <h3 class=\"icon-context icon-add\" [textContent]=\"text.title\"></h3>\n    </div>\n\n    <div class=\"ngdialog-body op-modal--modal-body\">\n        <div class=\"form--field\">\n          <div class=\"form--field-container\">\n            <div class=\"form--select-container\">\n              <label class=\"form--label\" [textContent]=\"actionService.localizedName\"></label>\n              <ndc-dynamic [ndcDynamicComponent]=\"autocompleterComponent()\"\n                           [ndcDynamicInputs]=\"{ availableValues: availableValues,\n                                                 appendTo: 'body',\n                                                 model: '',\n                                                 classes: 'new-list--action-select',\n                                                 finishedLoading: true}\"\n                           [ndcDynamicOutputs]=\"referenceOutputs\">\n              </ndc-dynamic>\n            </div>\n          </div>\n        </div>\n\n      <div *ngIf=\"!valuesAvailable && warningText\"\n           class=\"notification-box -warning\">\n        <div class=\"notification-box--content\">\n          <p [innerHTML]=\"warningText\"></p>\n        </div>\n      </div>\n\n    </div>\n    <div class=\"op-modal--modal-footer\">\n      <button class=\"button -highlight\"\n              (click)=\"create()\"\n              [disabled]=\"!this.selectedAttribute || inFlight\"\n              [textContent]=\"text.button_add\"\n              [attr.title]=\"text.button_add\">\n      </button>\n      <button class=\"confirm-form-submit--cancel button\"\n              (click)=\"closeMe($event)\"\n              [textContent]=\"text.button_cancel\"\n              [attr.title]=\"text.button_cancel\">\n      </button>\n    </div>\n  </div>\n</div>\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n// ++\n\nimport {OpModalComponent} from \"core-components/op-modals/op-modal.component\";\nimport {OpModalLocalsToken} from \"core-components/op-modals/op-modal.service\";\nimport {ChangeDetectorRef, Component, ElementRef, Inject, OnInit} from \"@angular/core\";\nimport {OpModalLocalsMap} from \"core-components/op-modals/op-modal.types\";\nimport {I18nService} from \"core-app/modules/common/i18n/i18n.service\";\nimport {Board} from \"core-app/modules/boards/board/board\";\nimport {StateService} from \"@uirouter/core\";\nimport {BoardService} from \"core-app/modules/boards/board/board.service\";\nimport {BoardCacheService} from \"core-app/modules/boards/board/board-cache.service\";\nimport {BoardActionsRegistryService} from \"core-app/modules/boards/board/board-actions/board-actions-registry.service\";\nimport {BoardActionService} from \"core-app/modules/boards/board/board-actions/board-action.service\";\nimport {HalResource} from \"core-app/modules/hal/resources/hal-resource\";\nimport {AngularTrackingHelpers} from \"core-components/angular/tracking-functions\";\nimport {CreateAutocompleterComponent} from \"core-app/modules/common/autocomplete/create-autocompleter.component\";\n\n@Component({\n  templateUrl: './add-list-modal.html'\n})\nexport class AddListModalComponent extends OpModalComponent implements OnInit {\n  public showClose:boolean;\n\n  public confirmed = false;\n\n  /** Active board */\n  public board:Board;\n\n  /** Current active set of values */\n  public active:Set<string>;\n\n  /** Action service used by the board */\n  public actionService:BoardActionService;\n\n  /** Remaining available values */\n  public availableValues:HalResource[] = [];\n\n  /** The selected attribute */\n  public selectedAttribute:HalResource|undefined;\n\n  /** avoid double click */\n  public inFlight = false;\n\n  public trackByHref = AngularTrackingHelpers.trackByHref;\n\n  /* Do not close on outside click (because the select option are appended to the body */\n  public closeOnOutsideClick = false;\n\n  public valuesAvailable:boolean = true;\n\n  public warningText:string|undefined;\n\n  public text:any = {\n    title: this.I18n.t('js.boards.add_list'),\n    button_add: this.I18n.t('js.button_add'),\n    button_cancel: this.I18n.t('js.button_cancel'),\n    close_popup: this.I18n.t('js.close_popup_title'),\n\n    free_board: this.I18n.t('js.boards.board_type.free'),\n    free_board_text: this.I18n.t('js.boards.board_type.free_text'),\n\n    action_board: this.I18n.t('js.boards.board_type.action'),\n    action_board_text: this.I18n.t('js.boards.board_type.action_text'),\n    select_attribute: this.I18n.t('js.boards.board_type.select_attribute'),\n    placeholder: this.I18n.t('js.placeholders.selection'),\n  };\n\n  public referenceOutputs = {\n    onCreate: (value:HalResource) => this.onNewActionCreated(value),\n    onChange: (value:HalResource) => this.onModelChange(value),\n    onAfterViewInit: (component:CreateAutocompleterComponent) => component.focusInputField()\n  };\n\n  constructor(readonly elementRef:ElementRef,\n              @Inject(OpModalLocalsToken) public locals:OpModalLocalsMap,\n              readonly cdRef:ChangeDetectorRef,\n              readonly boardActions:BoardActionsRegistryService,\n              readonly state:StateService,\n              readonly boardService:BoardService,\n              readonly boardCache:BoardCacheService,\n              readonly I18n:I18nService) {\n\n    super(locals, cdRef, elementRef);\n  }\n\n  ngOnInit() {\n    super.ngOnInit();\n\n    this.board = this.locals.board;\n    this.active = new Set(this.locals.active as string[]);\n    this.actionService = this.boardActions.get(this.board.actionAttribute!);\n\n    this.actionService\n      .getAvailableValues(this.board, this.active)\n      .then(available => {\n        this.availableValues = available;\n        if (this.availableValues.length === 0) {\n          this.actionService\n            .warningTextWhenNoOptionsAvailable()\n            .then((text) => {\n              this.warningText = text;\n              this.valuesAvailable = false;\n            });\n        }\n      });\n  }\n\n  onModelChange(element:HalResource) {\n    this.selectedAttribute = element;\n  }\n\n  create() {\n    this.inFlight = true;\n    this.actionService\n      .addActionQuery(this.board, this.selectedAttribute!)\n      .then(board => this.boardService.save(board))\n      .then((board) => {\n        this.inFlight = false;\n        this.closeMe();\n        this.boardCache.update(board);\n        this.state.go('boards.partitioned.show', { board_id: board.id, isNew: true });\n      })\n      .catch(() => this.inFlight = false);\n  }\n\n  onNewActionCreated(newValue:HalResource) {\n    this.selectedAttribute = newValue;\n    this.create();\n  }\n\n  autocompleterComponent() {\n    return this.actionService.autocompleterComponent();\n  }\n}\n\n","//-- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n//++\n\nimport {ChangeDetectorRef, Directive, ElementRef, Injector} from '@angular/core';\nimport {I18nService} from 'core-app/modules/common/i18n/i18n.service';\nimport {AuthorisationService} from 'core-app/modules/common/model-auth/model-auth.service';\nimport {OpContextMenuTrigger} from 'core-components/op-context-menu/handlers/op-context-menu-trigger.directive';\nimport {OPContextMenuService} from 'core-components/op-context-menu/op-context-menu.service';\nimport {OpModalService} from \"core-components/op-modals/op-modal.service\";\nimport {IsolatedQuerySpace} from \"core-app/modules/work_packages/query-space/isolated-query-space\";\nimport {WorkPackageInlineCreateService} from \"core-components/wp-inline-create/wp-inline-create.service\";\nimport {BoardListComponent} from \"core-app/modules/boards/board/board-list/board-list.component\";\n\n@Directive({\n  selector: '[addCardDropdown]'\n})\nexport class AddCardDropdownMenuDirective extends OpContextMenuTrigger {\n\n  private focusAfterClose = true;\n\n  constructor(readonly elementRef:ElementRef,\n              readonly opContextMenu:OPContextMenuService,\n              readonly opModalService:OpModalService,\n              readonly authorisationService:AuthorisationService,\n              readonly wpInlineCreate:WorkPackageInlineCreateService,\n              readonly boardList:BoardListComponent,\n              readonly injector:Injector,\n              readonly querySpace:IsolatedQuerySpace,\n              readonly cdRef:ChangeDetectorRef,\n              readonly I18n:I18nService) {\n\n    super(elementRef, opContextMenu);\n  }\n\n  protected open(evt:JQuery.TriggeredEvent) {\n    this.items = this.buildItems();\n    this.opContextMenu.show(this, evt);\n  }\n\n  /**\n   * Positioning args for jquery-ui position.\n   *\n   * @param {Event} openerEvent\n   */\n  public positionArgs(evt:JQuery.TriggeredEvent) {\n    let additionalPositionArgs = {\n      my: 'left top',\n      at: 'left bottom'\n    };\n\n    let position = super.positionArgs(evt);\n    _.assign(position, additionalPositionArgs);\n\n    return position;\n  }\n\n  private buildItems() {\n    return [\n      {\n        disabled: !this.wpInlineCreate.canAdd,\n        linkText: this.I18n.t('js.card.add_new'),\n        onClick: () => {\n          this.boardList.addNewCard();\n          return true;\n        }\n      },\n      {\n        disabled: !this.wpInlineCreate.canReference,\n        linkText: this.I18n.t('js.relation_buttons.add_existing'),\n        onClick: () => {\n          this.boardList.addReferenceCard();\n          return true;\n        }\n      }\n    ];\n  }\n}\n","import {AfterViewInit, Component, Input} from \"@angular/core\";\nimport {Board} from \"core-app/modules/boards/board/board\";\nimport {CurrentProjectService} from \"core-components/projects/current-project.service\";\nimport {QueryFormDmService} from \"core-app/modules/hal/dm-services/query-form-dm.service\";\nimport {WorkPackageStatesInitializationService} from \"core-components/wp-list/wp-states-initialization.service\";\nimport {QueryFormResource} from \"core-app/modules/hal/resources/query-form-resource\";\nimport {IsolatedQuerySpace} from \"core-app/modules/work_packages/query-space/isolated-query-space\";\nimport {QueryResource} from \"core-app/modules/hal/resources/query-resource\";\nimport {HalResourceService} from \"core-app/modules/hal/services/hal-resource.service\";\nimport {WorkPackageViewFiltersService} from \"core-app/modules/work_packages/routing/wp-view-base/view-services/wp-view-filters.service\";\nimport {QueryFilterInstanceResource} from \"core-app/modules/hal/resources/query-filter-instance-resource\";\nimport {UrlParamsHelperService} from \"core-components/wp-query/url-params-helper\";\nimport {StateService} from \"@uirouter/core\";\nimport {debounceTime, skip, take} from \"rxjs/internal/operators\";\nimport {UntilDestroyedMixin} from \"core-app/helpers/angular/until-destroyed.mixin\";\nimport {Observable} from \"rxjs\";\nimport {BoardFiltersService} from \"core-app/modules/boards/board/board-filter/board-filters.service\";\n\n@Component({\n  selector: 'board-filter',\n  templateUrl: './board-filter.component.html'\n})\nexport class BoardFilterComponent extends UntilDestroyedMixin implements AfterViewInit {\n  /** Current active */\n  @Input() public board$:Observable<Board>;\n\n  initialized = false;\n\n  constructor(private readonly currentProjectService:CurrentProjectService,\n              private readonly querySpace:IsolatedQuerySpace,\n              private readonly halResourceService:HalResourceService,\n              private readonly wpStatesInitialization:WorkPackageStatesInitializationService,\n              private readonly wpTableFilters:WorkPackageViewFiltersService,\n              private readonly urlParamsHelper:UrlParamsHelperService,\n              private readonly boardFilters:BoardFiltersService,\n              private readonly $state:StateService,\n              private readonly queryFormDm:QueryFormDmService) {\n    super();\n  }\n\n  ngAfterViewInit():void {\n    if (!this.board$) {\n      return;\n    }\n\n    this.board$\n      .pipe(take(1))\n      .subscribe(board => {\n        // Initially load the form once to be able to render filters\n        this.loadQueryForm();\n\n        // Update checksum service whenever filters change\n        this.updateChecksumOnFilterChanges();\n\n        // Remove action attribute from filter service\n        if (board.isAction) {\n          this.wpTableFilters.hidden.push(board.actionAttribute!);\n        }\n      });\n  }\n\n  private updateChecksumOnFilterChanges() {\n    this.wpTableFilters\n      .live$()\n      .pipe(\n        this.untilDestroyed(),\n        skip(1),\n        debounceTime(250)\n      )\n      .subscribe(() => {\n\n        const filters:QueryFilterInstanceResource[] = this.wpTableFilters.current;\n        let filterHash = this.urlParamsHelper.buildV3GetFilters(filters);\n        let query_props = JSON.stringify(filterHash);\n\n        this.boardFilters.filters.putValue(filterHash);\n\n        this.$state.go('.', { query_props: query_props }, { custom: { notify: false } });\n      });\n  }\n\n  private loadQueryForm() {\n    this.queryFormDm\n      .loadWithParams(\n        { filters: JSON.stringify(this.boardFilters.current) },\n        undefined,\n        this.currentProjectService.id\n      )\n      .then((form:QueryFormResource) => {\n        const query:QueryResource = this.halResourceService.createHalResourceOfClass(\n          QueryResource,\n          form.payload.$source\n        );\n\n        this.querySpace.query.putValue(query);\n        this.wpStatesInitialization.updateStatesFromForm(query, form);\n      });\n  }\n}\n","<filter-container></filter-container>\n","import { CdkDrag, DragDropModule } from '@angular/cdk/drag-drop';\nimport { Injectable, ɵɵdefineInjectable, Directive, NgZone, ChangeDetectorRef, Input, NgModule } from '@angular/core';\nimport { BehaviorSubject, Subject, fromEvent } from 'rxjs';\nimport { takeUntil, debounceTime } from 'rxjs/operators';\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\nimport * as ɵngcc0 from '@angular/core';\nimport * as ɵngcc1 from '@angular/cdk/drag-drop';\nclass AutoScroll {\r\n    /**\r\n     * @param {?} container\r\n     * @param {?=} scrollCallback\r\n     */\r\n    constructor(container, scrollCallback) {\r\n        this.container = container;\r\n        this.scrollCallback = scrollCallback;\r\n        this.margin = 30;\r\n        this.maxSpeed = 25;\r\n        this.point = { x: 0, y: 0 };\r\n        this.boundaryRect = this.container.getBoundingClientRect();\r\n    }\r\n    /**\r\n     * @param {?} point\r\n     * @return {?}\r\n     */\r\n    onMove(point) {\r\n        this.point = point;\r\n        cancelAnimationFrame(this.animationFrame);\r\n        this.animationFrame = requestAnimationFrame((/**\r\n         * @return {?}\r\n         */\r\n        () => this.scrollTick()));\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    scrollTick() {\r\n        cancelAnimationFrame(this.animationFrame);\r\n        if (this.autoScroll()) {\r\n            this.animationFrame = requestAnimationFrame((/**\r\n             * @return {?}\r\n             */\r\n            () => this.scrollTick()));\r\n        }\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    autoScroll() {\r\n        /** @type {?} */\r\n        let scrollx;\r\n        /** @type {?} */\r\n        let scrolly;\r\n        if (this.point.x < this.boundaryRect.left + this.margin) {\r\n            scrollx = Math.floor(Math.max(-1, (this.point.x - this.boundaryRect.left) / this.margin - 1) * this.maxSpeed);\r\n        }\r\n        else if (this.point.x > this.boundaryRect.right - this.margin) {\r\n            scrollx = Math.ceil(Math.min(1, (this.point.x - this.boundaryRect.right) / this.margin + 1) * this.maxSpeed);\r\n        }\r\n        else {\r\n            scrollx = 0;\r\n        }\r\n        if (this.point.y < this.boundaryRect.top + this.margin) {\r\n            scrolly = Math.floor(Math.max(-1, (this.point.y - this.boundaryRect.top) / this.margin - 1) *\r\n                this.maxSpeed);\r\n        }\r\n        else if (this.point.y > this.boundaryRect.bottom - this.margin) {\r\n            scrolly = Math.ceil(Math.min(1, (this.point.y - this.boundaryRect.bottom) / this.margin + 1) * this.maxSpeed);\r\n        }\r\n        else {\r\n            scrolly = 0;\r\n        }\r\n        setTimeout((/**\r\n         * @return {?}\r\n         */\r\n        () => {\r\n            if (scrolly) {\r\n                this.scrollY(scrolly);\r\n            }\r\n            if (scrollx) {\r\n                this.scrollX(scrollx);\r\n            }\r\n        }));\r\n        return scrollx || scrolly;\r\n    }\r\n    /**\r\n     * @param {?} amount\r\n     * @return {?}\r\n     */\r\n    scrollY(amount) {\r\n        // ToDo for window: window.scrollTo(window.pageXOffset, window.pageYOffset + amount);\r\n        this.container.scrollTop += amount;\r\n        if (this.scrollCallback) {\r\n            this.scrollCallback({ x: 0, y: amount });\r\n        }\r\n    }\r\n    /**\r\n     * @param {?} amount\r\n     * @return {?}\r\n     */\r\n    scrollX(amount) {\r\n        // ToDo for window: window.scrollTo(window.pageXOffset + amount, window.pageYOffset);\r\n        this.container.scrollLeft += amount;\r\n        if (this.scrollCallback) {\r\n            this.scrollCallback({\r\n                x: amount,\r\n                y: 0\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    destroy() {\r\n        cancelAnimationFrame(this.animationFrame);\r\n    }\r\n}\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\nclass DragDebugService {\r\n    constructor() {\r\n        this.debugInfo = new BehaviorSubject(null);\r\n        this.enabled = false;\r\n    }\r\n    /**\r\n     * @param {?} info\r\n     * @return {?}\r\n     */\r\n    log(info) {\r\n        this.debugInfo.next(info);\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    reset() {\r\n        this.debugInfo.next(null);\r\n    }\r\n}\nDragDebugService.ɵfac = function DragDebugService_Factory(t) { return new (t || DragDebugService)(); };\nDragDebugService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: DragDebugService, factory: DragDebugService.ɵfac, providedIn: 'root' });\r\n/** @nocollapse */\r\nDragDebugService.ctorParameters = () => [];\r\n/** @nocollapse */ DragDebugService.ngInjectableDef = ɵɵdefineInjectable({ factory: function DragDebugService_Factory() { return new DragDebugService(); }, token: DragDebugService, providedIn: \"root\" });\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(DragDebugService, [{\n        type: Injectable,\n        args: [{\n                providedIn: 'root'\n            }]\n    }], function () { return []; }, null); })();\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\n/**\r\n * @template T\r\n */\r\nclass DragScrollDirective {\r\n    /**\r\n     * @param {?} cdkDrag\r\n     * @param {?} dragDebugService\r\n     * @param {?} zone\r\n     * @param {?} changeDetectorRef\r\n     */\r\n    constructor(cdkDrag, dragDebugService, zone, changeDetectorRef) {\r\n        this.cdkDrag = cdkDrag;\r\n        this.dragDebugService = dragDebugService;\r\n        this.zone = zone;\r\n        this.changeDetectorRef = changeDetectorRef;\r\n        this.destroy$ = new Subject();\r\n        this.stopDragging$ = new Subject();\r\n        this.lastScroll = {\r\n            top: 0,\r\n            left: 0\r\n        };\r\n        this.dragRef = this.cdkDrag['_dragRef'];\r\n        if (this.dragRef) {\r\n            this.zone.runOutsideAngular((/**\r\n             * @return {?}\r\n             */\r\n            () => {\r\n                this.dragRef.started.pipe(takeUntil(this.destroy$)).subscribe((/**\r\n                 * @param {?} event\r\n                 * @return {?}\r\n                 */\r\n                event => {\r\n                    this.log('Started', event, this.dragRef.isDragging());\r\n                    this.started();\r\n                }));\r\n                this.dragRef.ended.pipe(takeUntil(this.destroy$)).subscribe((/**\r\n                 * @param {?} event\r\n                 * @return {?}\r\n                 */\r\n                event => {\r\n                    this.log('Ended', event);\r\n                    this.ended();\r\n                }));\r\n                this.dragRef.entered.pipe(takeUntil(this.destroy$)).subscribe((/**\r\n                 * @param {?} event\r\n                 * @return {?}\r\n                 */\r\n                event => {\r\n                    this.log('Entered', event);\r\n                    this.entered();\r\n                }));\r\n                this.dragRef.exited.pipe(takeUntil(this.destroy$)).subscribe((/**\r\n                 * @param {?} event\r\n                 * @return {?}\r\n                 */\r\n                event => {\r\n                    this.log('Exited', event);\r\n                    this.exited();\r\n                }));\r\n            }));\r\n        }\r\n        else {\r\n            this.log('CdkDrag not found', this.cdkDrag, this.dragRef);\r\n        }\r\n    }\r\n    /**\r\n     * @param {?} changes\r\n     * @return {?}\r\n     */\r\n    ngOnChanges(changes) {\r\n        if (changes.dragConnectedIds) {\r\n            if (this.dragRef.isDragging()) {\r\n                // https://github.com/angular/material2/issues/15343\r\n                setTimeout((/**\r\n                 * @return {?}\r\n                 */\r\n                () => {\r\n                    this.syncSiblings();\r\n                }));\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    ngOnDestroy() {\r\n        this.destroy$.next();\r\n        this.destroy$.complete();\r\n        this.stopDragging$.next();\r\n        this.stopDragging$.complete();\r\n        this.destroyAutoScroll();\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    started() {\r\n        if (!this.scrollContainer) {\r\n            return;\r\n        }\r\n        this.destroyAutoScroll();\r\n        this.addDebugInfo();\r\n        this.autoScroll = new AutoScroll(this.scrollContainer);\r\n        this.lastScroll.top = this.scrollContainer.scrollTop;\r\n        this.lastScroll.left = this.scrollContainer.scrollLeft;\r\n        fromEvent(this.scrollContainer, 'scroll')\r\n            .pipe(takeUntil(this.stopDragging$))\r\n            .subscribe((/**\r\n         * @return {?}\r\n         */\r\n        () => {\r\n            /** @type {?} */\r\n            const deltaX = this.scrollContainer.scrollLeft - this.lastScroll.left;\r\n            /** @type {?} */\r\n            const deltaY = this.scrollContainer.scrollTop - this.lastScroll.top;\r\n            if (deltaX || deltaY) {\r\n                this.handleScroll(deltaX, deltaY);\r\n            }\r\n            this.lastScroll.top = this.scrollContainer.scrollTop;\r\n            this.lastScroll.left = this.scrollContainer.scrollLeft;\r\n        }));\r\n        this.dragRef.moved\r\n            .pipe(debounceTime(10), takeUntil(this.stopDragging$))\r\n            .subscribe((/**\r\n         * @param {?} e\r\n         * @return {?}\r\n         */\r\n        e => {\r\n            this.autoScroll.onMove(e.pointerPosition);\r\n        }));\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    ended() {\r\n        this.destroyAutoScroll();\r\n        this.stopDragging$.next();\r\n        this.dragDebugService.reset();\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    entered() {\r\n        this.dragFixContainer();\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    exited() {\r\n        this.dragFixContainer();\r\n    }\r\n    /**\r\n     * @private\r\n     * @param {?} x\r\n     * @param {?} y\r\n     * @return {?}\r\n     */\r\n    handleScroll(x, y) {\r\n        /** @type {?} */\r\n        const dropListRef = this.getDropListRef();\r\n        // adjust containers\r\n        this.adjustContainers();\r\n        // adjust items\r\n        this.adjustItems(x, y);\r\n        // ToDo: better condition for changed items\r\n        if (dropListRef._draggables.length > dropListRef._itemPositions.length) {\r\n            this.syncItems();\r\n        }\r\n        this.addDebugInfo();\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    destroyAutoScroll() {\r\n        if (this.autoScroll) {\r\n            this.autoScroll.destroy();\r\n            this.autoScroll = null;\r\n        }\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    getDropListRef() {\r\n        return this.dragRef['_dropContainer'];\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    addDebugInfo() {\r\n        if (!this.dragDebugService.enabled) {\r\n            return;\r\n        }\r\n        /** @type {?} */\r\n        const dropListRef = this.getDropListRef();\r\n        /** @type {?} */\r\n        const draws = [\r\n            ...dropListRef._itemPositions.map((/**\r\n             * @param {?} it\r\n             * @return {?}\r\n             */\r\n            it => ({\r\n                clientRect: it.clientRect,\r\n                color: 'blue',\r\n                id: it.drag.data.data.name\r\n            }))),\r\n            ...dropListRef._siblings.map((/**\r\n             * @param {?} it\r\n             * @return {?}\r\n             */\r\n            it => ({\r\n                clientRect: it._clientRect,\r\n                color: 'green',\r\n                id: ''\r\n            }))),\r\n            {\r\n                clientRect: dropListRef._clientRect,\r\n                color: '#2FD1BB',\r\n                id: ''\r\n            }\r\n        ];\r\n        this.dragDebugService.log(draws.filter((/**\r\n         * @param {?} d\r\n         * @return {?}\r\n         */\r\n        d => d.clientRect)));\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    dragFixContainer() {\r\n        // https://github.com/angular/material2/issues/15227\r\n        setTimeout((/**\r\n         * @return {?}\r\n         */\r\n        () => {\r\n            /** @type {?} */\r\n            const dropListRef = this.getDropListRef();\r\n            dropListRef._cacheOwnPosition();\r\n            this.addDebugInfo();\r\n        }));\r\n        // fix for issue when classes is not resetted\r\n        this.changeDetectorRef.markForCheck();\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    syncSiblings() {\r\n        /** @type {?} */\r\n        const dropListRef = this.getDropListRef();\r\n        this.log('syncSiblings before', dropListRef._siblings.length);\r\n        dropListRef.beforeStarted.next();\r\n        this.log('syncSiblings after', dropListRef._siblings.length);\r\n        this.adjustContainers();\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    syncItems() {\r\n        /** @type {?} */\r\n        const dropListRef = this.getDropListRef();\r\n        /** @type {?} */\r\n        const oldPositions = dropListRef._itemPositions;\r\n        dropListRef._activeDraggables = dropListRef._draggables.slice();\r\n        dropListRef._cacheItemPositions();\r\n        /** @type {?} */\r\n        const newPositions = dropListRef._itemPositions;\r\n        dropListRef._itemPositions = [...oldPositions];\r\n        newPositions.forEach((/**\r\n         * @param {?} p\r\n         * @return {?}\r\n         */\r\n        p => {\r\n            if (!oldPositions.find((/**\r\n             * @param {?} p1\r\n             * @return {?}\r\n             */\r\n            p1 => p.drag === p1.drag))) {\r\n                dropListRef._itemPositions.push(p);\r\n            }\r\n        }));\r\n        dropListRef._activeDraggables.push(this.dragRef);\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    adjustContainers() {\r\n        /** @type {?} */\r\n        const dropListRef = this.getDropListRef();\r\n        dropListRef._cacheOwnPosition();\r\n        dropListRef._siblings.forEach((/**\r\n         * @param {?} sibling\r\n         * @return {?}\r\n         */\r\n        sibling => {\r\n            sibling._cacheOwnPosition();\r\n        }));\r\n    }\r\n    /**\r\n     * @private\r\n     * @param {?} deltaX\r\n     * @param {?} deltaY\r\n     * @return {?}\r\n     */\r\n    adjustItems(deltaX, deltaY) {\r\n        /** @type {?} */\r\n        const dropListRef = this.getDropListRef();\r\n        dropListRef._itemPositions.forEach((/**\r\n         * @param {?} it\r\n         * @return {?}\r\n         */\r\n        it => {\r\n            it.originalRect = it.originalRect || it.clientRect;\r\n            it.clientRect = Object.assign({}, it.clientRect, { left: it.clientRect.left - deltaX, right: it.clientRect.right - deltaX, top: it.clientRect.top - deltaY, bottom: it.clientRect.bottom - deltaY });\r\n        }));\r\n    }\r\n    /**\r\n     * @private\r\n     * @param {?=} message\r\n     * @param {...?} optionalParams\r\n     * @return {?}\r\n     */\r\n    log(message, ...optionalParams) {\r\n        if (this.dragDebugService.enabled) {\r\n            console.log(message, optionalParams);\r\n        }\r\n    }\r\n}\nDragScrollDirective.ɵfac = function DragScrollDirective_Factory(t) { return new (t || DragScrollDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.CdkDrag), ɵngcc0.ɵɵdirectiveInject(DragDebugService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef)); };\nDragScrollDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: DragScrollDirective, selectors: [[\"\", \"vsDragScroll\", \"\"]], inputs: { dragConnectedIds: [\"vsDragScrollConnectedTo\", \"dragConnectedIds\"], scrollContainer: [\"vsDragScrollContainer\", \"scrollContainer\"] }, exportAs: [\"vsDragScroll\"], features: [ɵngcc0.ɵɵNgOnChangesFeature] });\r\n/** @nocollapse */\r\nDragScrollDirective.ctorParameters = () => [\r\n    { type: CdkDrag },\r\n    { type: DragDebugService },\r\n    { type: NgZone },\r\n    { type: ChangeDetectorRef }\r\n];\r\nDragScrollDirective.propDecorators = {\r\n    dragConnectedIds: [{ type: Input, args: ['vsDragScrollConnectedTo',] }],\r\n    scrollContainer: [{ type: Input, args: ['vsDragScrollContainer',] }]\r\n};\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(DragScrollDirective, [{\n        type: Directive,\n        args: [{\n                selector: '[vsDragScroll]',\n                exportAs: 'vsDragScroll'\n            }]\n    }], function () { return [{ type: ɵngcc1.CdkDrag }, { type: DragDebugService }, { type: ɵngcc0.NgZone }, { type: ɵngcc0.ChangeDetectorRef }]; }, { dragConnectedIds: [{\n            type: Input,\n            args: ['vsDragScrollConnectedTo']\n        }], scrollContainer: [{\n            type: Input,\n            args: ['vsDragScrollContainer']\n        }] }); })();\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\nclass DragScrollModule {\r\n}\nDragScrollModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: DragScrollModule });\nDragScrollModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function DragScrollModule_Factory(t) { return new (t || DragScrollModule)(); }, imports: [[DragDropModule]] });\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(DragScrollModule, { declarations: function () { return [DragScrollDirective]; }, imports: function () { return [DragDropModule]; }, exports: function () { return [DragScrollDirective]; } }); })();\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(DragScrollModule, [{\n        type: NgModule,\n        args: [{\n                imports: [DragDropModule],\n                declarations: [DragScrollDirective],\n                exports: [DragScrollDirective]\n            }]\n    }], null, null); })();\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\n\nexport { AutoScroll, DragDebugService, DragScrollDirective, DragScrollModule };\n\n//# sourceMappingURL=cdk-drag-scroll.js.map","import {Component, Input} from \"@angular/core\";\nimport {I18nService} from \"core-app/modules/common/i18n/i18n.service\";\nimport {Board} from \"core-app/modules/boards/board/board\";\nimport {Observable} from \"rxjs\";\n\n@Component({\n  template: `\n    <button title=\"{{ text.button_more }}\"\n            class=\"button last board--settings-dropdown toolbar-icon\"\n            boardsToolbarMenu\n            [boardsToolbarMenu-resource]=\"board$ | async\">\n      <op-icon icon-classes=\"button--icon icon-show-more\"></op-icon>\n    </button>\n  `\n})\nexport class BoardsMenuButtonComponent {\n  @Input() board$:Observable<Board>;\n\n  text = {\n    button_more: this.I18n.t('js.button_more'),\n  };\n\n  constructor(readonly I18n:I18nService) {\n  }\n}","import {Observable, Subject} from \"rxjs\";\nimport {HalResource} from \"core-app/modules/hal/resources/hal-resource\";\nimport {switchMap, takeUntil} from \"rxjs/operators\";\n\nexport type RequestSwitchmapHandler<T, R> = (input:T) => Observable<R>;\n\nexport class RequestSwitchmap<T, R = HalResource> {\n\n  /** Input request state */\n  private requests = new Subject<T>();\n\n  /** Output switchmap observable */\n  private responses$ = this.requests\n    .pipe(\n      // Stream the request, switchMap will result in previous requests to be cancelled\n      switchMap(this.handler)\n    );\n\n  /**\n   *\n   * @param handler switch map handler function to output a response observable\n   */\n  constructor(readonly handler:RequestSwitchmapHandler<T, R>) {\n  }\n\n  /**\n   * Append a new request for the given request value and pass\n   * that to the switchmap handler\n   * @param newValue\n   */\n  public request(newValue:T) {\n    this.requests.next(newValue);\n  }\n\n  /**\n   * Observe the switched response\n   */\n  public observe(until:Observable<unknown>) {\n    return this\n      .responses$\n      .pipe(\n        takeUntil(until)\n      );\n  }\n}\n","<div class=\"work-packages-partitioned-query-space--container\"\n      [ngClass]=\"currentPartition\">\n  <div class=\"toolbar-container -editable\">\n    <div class=\"toolbar\">\n      <back-button *ngIf=\"backButtonCallback\"\n                   linkClass=\"back-button\"\n                   [customBackMethod]=\"backButtonCallback\">\n      </back-button>\n\n      <editable-toolbar-title [title]=\"selectedTitle\"\n                              [inFlight]=\"toolbarDisabled\"\n                              [showSaveCondition]=\"showToolbarSaveButton\"\n                              (onSave)=\"changeChangesFromTitle($event)\"\n                              (onEmptySubmit)=\"updateTitleName('')\"\n                              [editable]=\"titleEditingEnabled\">\n      </editable-toolbar-title>\n\n      <ul class=\"toolbar-items hide-when-print\"\n          *ngIf=\"showToolbar\">\n\n        <ng-container *ngFor=\"let definition of toolbarButtonComponents\">\n          <li class=\"toolbar-item\"\n              *ngIf=\"!definition.show || definition.show()\"\n              [ngClass]=\"definition.containerClasses\">\n            <ndc-dynamic [ndcDynamicComponent]=\"definition.component\"\n                         [ndcDynamicInputs]=\"definition.inputs\"\n                         [ndcDynamicInjector]=\"injector\"\n                         [ndcDynamicOutputs]=\"definition.outputs\">\n            </ndc-dynamic>\n          </li>\n        </ng-container>\n      </ul>\n    </div>\n  </div>\n\n  <div class=\"work-packages-partitioned-query-space--filter-area\">\n    <ndc-dynamic [ndcDynamicComponent]=\"filterContainerDefinition.component\"\n                 [ndcDynamicInputs]=\"filterContainerDefinition.inputs\"\n                 [ndcDynamicOutputs]=\"filterContainerDefinition.outputs\"\n                 [ndcDynamicInjector]=\"injector\">\n    </ndc-dynamic>\n  </div>\n\n  <div class=\"work-packages-partitioned-page--content-container\">\n    <!-- Left content view -->\n    <div class=\"work-packages-partitioned-page--content-left loading-indicator--location\"\n         data-indicator-name=\"table\"\n         ui-view=\"content-left\">\n    </div>\n\n    <!-- Right content view -->\n    <div class=\"work-packages-partitioned-page--content-right\"\n         ui-view=\"content-right\"></div>\n  </div>\n</div>\n","import {ChangeDetectionStrategy, ChangeDetectorRef, Component, Injector} from \"@angular/core\";\nimport {\n  DynamicComponentDefinition,\n  ToolbarButtonComponentDefinition,\n  ViewPartitionState\n} from \"core-app/modules/work_packages/routing/partitioned-query-space-page/partitioned-query-space-page.component\";\nimport {StateService, TransitionService} from \"@uirouter/core\";\nimport {BoardFilterComponent} from \"core-app/modules/boards/board/board-filter/board-filter.component\";\nimport {Board} from \"core-app/modules/boards/board/board\";\nimport {NotificationsService} from \"core-app/modules/common/notifications/notifications.service\";\nimport {HalResourceNotificationService} from \"core-app/modules/hal/services/hal-resource-notification.service\";\nimport {BoardCacheService} from \"core-app/modules/boards/board/board-cache.service\";\nimport {BoardService} from \"core-app/modules/boards/board/board.service\";\nimport {DragAndDropService} from \"core-app/modules/common/drag-and-drop/drag-and-drop.service\";\nimport {WorkPackageFilterButtonComponent} from \"core-components/wp-buttons/wp-filter-button/wp-filter-button.component\";\nimport {ZenModeButtonComponent} from \"core-components/wp-buttons/zen-mode-toggle-button/zen-mode-toggle-button.component\";\nimport {BoardsMenuButtonComponent} from \"core-app/modules/boards/board/toolbar-menu/boards-menu-button.component\";\nimport {RequestSwitchmap} from \"core-app/helpers/rxjs/request-switchmap\";\nimport {from} from \"rxjs\";\nimport {componentDestroyed} from \"@w11k/ngx-componentdestroyed\";\nimport {take} from \"rxjs/operators\";\nimport {I18nService} from \"core-app/modules/common/i18n/i18n.service\";\nimport {UntilDestroyedMixin} from \"core-app/helpers/angular/until-destroyed.mixin\";\nimport {QueryResource} from \"core-app/modules/hal/resources/query-resource\";\nimport {Ng2StateDeclaration} from \"@uirouter/angular\";\nimport {BoardFiltersService} from \"core-app/modules/boards/board/board-filter/board-filters.service\";\nimport {CardViewHandlerRegistry} from \"core-components/wp-card-view/event-handler/card-view-handler-registry\";\n\nexport function boardCardViewHandlerFactory(injector:Injector) {\n  return new CardViewHandlerRegistry(injector);\n}\n\n@Component({\n  templateUrl: '/app/modules/work_packages/routing/partitioned-query-space-page/partitioned-query-space-page.component.html',\n  styleUrls: [\n    '/app/modules/work_packages/routing/partitioned-query-space-page/partitioned-query-space-page.component.sass',\n    './board-partitioned-page.component.sass'\n  ],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [\n    DragAndDropService,\n    BoardFiltersService,\n  ]\n})\nexport class BoardPartitionedPageComponent extends UntilDestroyedMixin {\n\n  text = {\n    button_more: this.I18n.t('js.button_more'),\n    delete: this.I18n.t('js.button_delete'),\n    areYouSure: this.I18n.t('js.text_are_you_sure'),\n    deleteSuccessful: this.I18n.t('js.notice_successful_delete'),\n    updateSuccessful: this.I18n.t('js.notice_successful_update'),\n    unnamedBoard: this.I18n.t('js.boards.label_unnamed_board'),\n    loadingError: 'No such board found',\n    addList: this.I18n.t('js.boards.add_list'),\n    upsaleBoards: this.I18n.t('js.boards.upsale.teaser_text'),\n    upsaleCheckOutLink: this.I18n.t('js.work_packages.table_configuration.upsale.check_out_link'),\n    unnamed_list: this.I18n.t('js.boards.label_unnamed_list'),\n  };\n\n  /** Board observable */\n  board$ = this.BoardCache.observe(this.state.params.board_id.toString());\n\n  /** Whether this is a new board just created */\n  isNew:boolean = !!this.state.params.isNew;\n\n  /** Whether the board is editable */\n  editable:boolean;\n\n  /** Go back to boards using back-button */\n  backButtonCallback = () => this.state.go('boards');\n\n  /** Current query title to render */\n  selectedTitle?:string;\n  currentQuery:QueryResource|undefined;\n\n  /** Whether we're saving the board */\n  toolbarDisabled:boolean = false;\n\n  /** Do we currently have query props ? */\n  showToolbarSaveButton:boolean;\n\n  /** Listener callbacks */\n  removeTransitionSubscription:Function;\n\n  showToolbar = true;\n\n  /** Whether filtering is allowed */\n  filterAllowed:boolean = true;\n\n  /** We need to pass the correct partition state to the view to manage the grid */\n  currentPartition:ViewPartitionState = '-split';\n\n  /** We need to apply our own board filter component */\n  /** Which filter container component to mount */\n  filterContainerDefinition:DynamicComponentDefinition = {\n    component: BoardFilterComponent,\n    inputs: {\n      board$: this.board$\n    },\n  };\n\n  // We remember when we want to update the board\n  boardSaver = new RequestSwitchmap(\n    (board:Board) => {\n      this.toolbarDisabled = true;\n      const promise = this.Boards\n        .save(board)\n        .then(board => {\n          this.toolbarDisabled = false;\n          return board;\n        })\n        .catch((error) => {\n          this.toolbarDisabled = false;\n          throw error;\n        });\n\n      return from(promise);\n    }\n  );\n\n  toolbarButtonComponents:ToolbarButtonComponentDefinition[] = [\n    {\n      component: WorkPackageFilterButtonComponent,\n      containerClasses: 'hidden-for-mobile'\n    },\n    {\n      component: ZenModeButtonComponent,\n      containerClasses: 'hidden-for-mobile'\n    },\n    {\n      component: BoardsMenuButtonComponent,\n      containerClasses: 'hidden-for-mobile',\n      show: () => this.editable,\n      inputs: {\n        board$: this.board$\n      }\n    }\n  ];\n\n  constructor(readonly I18n:I18nService,\n              readonly cdRef:ChangeDetectorRef,\n              readonly $transitions:TransitionService,\n              readonly state:StateService,\n              readonly notifications:NotificationsService,\n              readonly halNotification:HalResourceNotificationService,\n              readonly injector:Injector,\n              readonly BoardCache:BoardCacheService,\n              readonly boardFilters:BoardFiltersService,\n              readonly Boards:BoardService) {\n    super();\n  }\n\n  ngOnInit():void {\n    // Ensure board is being loaded\n    this.Boards.loadAllBoards();\n\n    this.boardSaver\n      .observe(componentDestroyed(this))\n      .subscribe(\n        (board:Board) => {\n          this.BoardCache.update(board);\n          this.notifications.addSuccess(this.text.updateSuccessful);\n        },\n        (error:unknown) => this.halNotification.handleRawError(error)\n      );\n\n    this.removeTransitionSubscription = this.$transitions.onSuccess({}, (transition):any => {\n      const toState = transition.to();\n      const params = transition.params('to');\n\n      this.showToolbarSaveButton = !!params.query_props\n      this.setPartition(toState);\n      this.cdRef.detectChanges();\n    });\n\n    this.board$\n      .pipe(\n        this.untilDestroyed()\n      )\n      .subscribe(board => {\n        let queryProps = this.state.params.query_props;\n        this.editable = board.editable;\n        this.selectedTitle = board.name;\n        this.boardFilters.filters.putValue(queryProps ? JSON.parse(queryProps) : board.filters);\n        this.cdRef.detectChanges();\n      });\n  }\n\n  ngOnDestroy():void {\n    super.ngOnDestroy();\n    this.removeTransitionSubscription();\n  }\n\n  changeChangesFromTitle(newName:string) {\n    this.board$\n      .pipe(take(1))\n      .subscribe(board => {\n        board.name = newName;\n        board.filters = this.boardFilters.current;\n\n        let params = { isNew: false, query_props: null };\n        this.state.go('.', params, { custom: { notify: false } });\n\n        this.boardSaver.request(board);\n      });\n  }\n\n  updateTitleName(val:string) {\n    this.changeChangesFromTitle(val);\n  }\n\n  /** Whether the title can be edited */\n  get titleEditingEnabled():boolean {\n    return this.editable;\n  }\n\n  /**\n   * We need to set the current partition to the grid to ensure\n   * either side gets expanded to full width if we're not in '-split' mode.\n   *\n   * @param state The current or entering state\n   */\n  protected setPartition(state:Ng2StateDeclaration) {\n    this.currentPartition = (state.data && state.data.partition) ? state.data.partition : '-split';\n  }\n}\n","<ng-container *ngIf=\"(board$ | async) as board\">\n  <div class=\"boards-list--container\"\n       [ngClass]=\"{ '-free' : board.isFree }\"\n       #container\n       *ngIf=\"showBoardListView()\"\n       cdkDropList\n       [cdkDropListDisabled]=\"!board.editable\"\n       cdkDropListOrientation=\"horizontal\"\n       (cdkDropListDropped)=\"moveList(board, $event)\"\n  >\n    <div *ngFor=\"let queryWidget of board.queries; trackBy:trackByQueryId\"\n         class=\"boards-list--item\"\n         wp-isolated-query-space\n         cdkDrag\n         vsDragScroll\n         [cdkDragData]=\"queryWidget\"\n         [vsDragScrollContainer]=\"_container\">\n      <span *ngIf=\"board.editable\"\n            class=\"boards-list-item-handle icon icon-drag-handle\"\n            cdkDragHandle></span>\n      <board-list [resource]=\"queryWidget\"\n                  [board]=\"board\"\n                  (onRemove)=\"removeList(board, queryWidget)\"></board-list>\n    </div>\n\n    <div class=\"boards-list--add-item -no-text-select\"\n         *ngIf=\"board.editable\"\n         (click)=\"addList(board)\">\n      <div class=\"boards-list--add-item-text\">\n        <op-icon icon-classes=\"icon-add icon-context\"></op-icon>\n        <span [textContent]=\"text.addList\"></span>\n      </div>\n    </div>\n  </div>\n\n  <enterprise-banner *ngIf=\"!showBoardListView()\"\n                     [leftMargin]=\"true\"\n                     [linkMessage]=\"text.upsaleCheckOutLink\"\n                     [textMessage]=\"text.upsaleBoards\"\n                     [opReferrer]=\"opReferrer(board)\">\n  </enterprise-banner>\n</ng-container>","import {Component, ElementRef, Injector, OnInit, QueryList, ViewChild, ViewChildren} from \"@angular/core\";\nimport {Observable, Subscription} from \"rxjs\";\nimport {QueryResource} from \"core-app/modules/hal/resources/query-resource\";\nimport {BoardListComponent} from \"core-app/modules/boards/board/board-list/board-list.component\";\nimport {StateService} from \"@uirouter/core\";\nimport {NotificationsService} from \"core-app/modules/common/notifications/notifications.service\";\nimport {HalResourceNotificationService} from \"core-app/modules/hal/services/hal-resource-notification.service\";\nimport {BoardListsService} from \"core-app/modules/boards/board/board-list/board-lists.service\";\nimport {OpModalService} from \"core-components/op-modals/op-modal.service\";\nimport {BoardCacheService} from \"core-app/modules/boards/board/board-cache.service\";\nimport {BoardService} from \"core-app/modules/boards/board/board.service\";\nimport {BannersService} from \"core-app/modules/common/enterprise/banners.service\";\nimport {DragAndDropService} from \"core-app/modules/common/drag-and-drop/drag-and-drop.service\";\nimport {QueryUpdatedService} from \"core-app/modules/boards/board/query-updated/query-updated.service\";\nimport {UntilDestroyedMixin} from \"core-app/helpers/angular/until-destroyed.mixin\";\nimport {Board, BoardWidgetOption} from \"core-app/modules/boards/board/board\";\nimport {CdkDragDrop, moveItemInArray} from \"@angular/cdk/drag-drop\";\nimport {GridWidgetResource} from \"core-app/modules/hal/resources/grid-widget-resource\";\nimport {BoardPartitionedPageComponent} from \"core-app/modules/boards/board/board-partitioned-page/board-partitioned-page.component\";\nimport {AddListModalComponent} from \"core-app/modules/boards/board/add-list-modal/add-list-modal.component\";\nimport {I18nService} from \"core-app/modules/common/i18n/i18n.service\";\nimport {BoardListCrossSelectionService} from \"core-app/modules/boards/board/board-list/board-list-cross-selection.service\";\nimport {filter} from \"rxjs/operators\";\n\n@Component({\n  templateUrl: './board-list-container.component.html',\n  styleUrls: ['./board-list-container.component.sass'],\n  providers: [\n    BoardListCrossSelectionService\n  ]\n})\nexport class BoardListContainerComponent extends UntilDestroyedMixin implements OnInit {\n\n  text = {\n    button_more: this.I18n.t('js.button_more'),\n    delete: this.I18n.t('js.button_delete'),\n    areYouSure: this.I18n.t('js.text_are_you_sure'),\n    deleteSuccessful: this.I18n.t('js.notice_successful_delete'),\n    updateSuccessful: this.I18n.t('js.notice_successful_update'),\n    loadingError: 'No such board found',\n    addList: this.I18n.t('js.boards.add_list'),\n    upsaleBoards: this.I18n.t('js.boards.upsale.teaser_text'),\n    upsaleCheckOutLink: this.I18n.t('js.work_packages.table_configuration.upsale.check_out_link'),\n    unnamed_list: this.I18n.t('js.boards.label_unnamed_list'),\n  };\n\n\n  /** Container reference */\n  public _container:HTMLElement;\n  @ViewChild('container')\n  set container(v:ElementRef|undefined) {\n    // ViewChild reference may be undefined initially\n    // due to ngIf\n    if (v !== undefined) {\n      if (this._container === undefined) {\n        this.Drag.addScrollContainer(v.nativeElement);\n      }\n      setTimeout(() => this._container = v.nativeElement);\n    }\n  }\n\n  /** Reference all query children to extract current actions */\n  @ViewChildren(BoardListComponent) lists:QueryList<BoardListComponent>;\n\n  trackByQueryId = (index:number, widget:GridWidgetResource) => widget.options.queryId;\n\n  board$:Observable<Board>;\n\n  private currentQueryUpdatedMonitoring:Subscription;\n\n  constructor(readonly I18n:I18nService,\n              readonly state:StateService,\n              readonly notifications:NotificationsService,\n              readonly halNotification:HalResourceNotificationService,\n              readonly boardComponent:BoardPartitionedPageComponent,\n              readonly BoardList:BoardListsService,\n              readonly opModalService:OpModalService,\n              readonly injector:Injector,\n              readonly BoardCache:BoardCacheService,\n              readonly Boards:BoardService,\n              readonly Banner:BannersService,\n              readonly boardListCrossSelectionService:BoardListCrossSelectionService,\n              readonly Drag:DragAndDropService,\n              readonly QueryUpdated:QueryUpdatedService) {\n    super();\n  }\n\n  ngOnInit():void {\n    const id:string = this.state.params.board_id.toString();\n\n    this.board$ = this.BoardCache.observe(id);\n    this.Boards.currentBoard$.next(id);\n\n    this.board$\n      .pipe(\n        this.untilDestroyed()\n      )\n      .subscribe(board => {\n        this.setupQueryUpdatedMonitoring(board);\n      });\n\n    this.boardListCrossSelectionService\n      .selections()\n      .pipe(\n        this.untilDestroyed(),\n        filter((state) => state.focusedWorkPackage !== null),\n        filter(() => this.state.includes(this.state.current.data.baseRoute + '.details'))\n      ).subscribe(selection => {\n      // Update split screen\n      this.state.go(this.state.current.data.baseRoute + '.details', { workPackageId: selection.focusedWorkPackage });\n    });\n  }\n\n  moveList(board:Board, event:CdkDragDrop<GridWidgetResource[]>) {\n    moveItemInArray(board.queries, event.previousIndex, event.currentIndex);\n    this.saveBoard(board);\n  }\n\n  removeList(board:Board, query:GridWidgetResource) {\n    board.removeQuery(query);\n    this.saveBoard(board);\n  }\n\n  addList(board:Board):any {\n    if (board.isFree) {\n      return this.BoardList\n        .addFreeQuery(board, { name: this.text.unnamed_list })\n        .then(board => this.Boards.save(board))\n        .then(saved => {\n          this.BoardCache.update(saved);\n        })\n        .catch(error => this.showError(error));\n    } else {\n      const active = this.getActionFiltersFromWidget(board);\n      this.opModalService.show(\n        AddListModalComponent,\n        this.injector,\n        { board: board, active: active }\n      );\n    }\n  }\n\n  showBoardListView() {\n    return !this.Banner.eeShowBanners;\n  }\n\n  opReferrer(board:Board) {\n    return board.isFree ? 'boards#free' : 'boards#status';\n  }\n\n  saveBoard(board:Board):void {\n    this.boardComponent.boardSaver.request(board);\n  }\n\n  private setupQueryUpdatedMonitoring(board:Board) {\n    if (this.currentQueryUpdatedMonitoring) {\n      this.currentQueryUpdatedMonitoring.unsubscribe();\n    }\n\n    this.currentQueryUpdatedMonitoring = this\n      .QueryUpdated\n      .monitor(board.queries.map((widget) => widget.options.queryId as string))\n      .pipe(\n        this.untilDestroyed()\n      )\n      .subscribe((collection) => this.requestRefreshOfUpdatedLists(collection.elements));\n  }\n\n  private showError(text = this.text.loadingError) {\n    this.notifications.addError(text);\n  }\n\n  private requestRefreshOfUpdatedLists(queries:QueryResource[]) {\n    queries.forEach((query) => {\n      this\n        .lists\n        .filter((listComponent) => {\n          const id = query.id!.toString();\n          const listId = (listComponent.resource.options.queryId as string|number).toString();\n\n          return id === listId;\n        })\n        .forEach((listComponent) => listComponent.refreshQueryUnlessCaused(query, false));\n    });\n  }\n\n  /**\n   * Returns the current filter values for an action board.\n   * By extracting them from the widget options, we can avoid waiting for the queries\n   * to be loaded for each list\n   *\n   * @param board\n   */\n  private getActionFiltersFromWidget(board:Board):string[] {\n    return board.grid.widgets\n      .map(widget => {\n        const options:BoardWidgetOption = widget.options as any;\n        const filter = _.find(options.filters, (filter) => !!filter[board.actionAttribute!]);\n\n        if (filter) {\n          return filter[board.actionAttribute!].values[0];\n        }\n      })\n      .filter(value => !!value);\n  }\n\n}","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n// ++\n\nimport {Ng2StateDeclaration, UIRouter} from \"@uirouter/angular\";\nimport {BoardsRootComponent} from \"core-app/modules/boards/boards-root/boards-root.component\";\nimport {BoardsIndexPageComponent} from \"core-app/modules/boards/index-page/boards-index-page.component\";\nimport {BoardPartitionedPageComponent} from \"core-app/modules/boards/board/board-partitioned-page/board-partitioned-page.component\";\nimport {BoardListContainerComponent} from \"core-app/modules/boards/board/board-partitioned-page/board-list-container.component\";\nimport {makeSplitViewRoutes} from \"core-app/modules/work_packages/routing/split-view-routes.template\";\nimport {WorkPackageSplitViewComponent} from \"core-app/modules/work_packages/routing/wp-split-view/wp-split-view.component\";\n\nexport const menuItemClass = 'board-view-menu-item';\n\nexport const BOARDS_ROUTES:Ng2StateDeclaration[] = [\n  {\n    name: 'boards',\n    parent: 'root',\n    // The trailing slash is important\n    // cf., https://community.openproject.com/wp/29754\n    url: '/boards/?query_props',\n    data: {\n      bodyClasses: 'router--boards-view-base',\n      menuItem: menuItemClass\n    },\n    params: {\n      // Use custom encoder/decoder that ensures validity of URL string\n      query_props: { type: 'opQueryString', dynamic: true }\n    },\n    redirectTo: 'boards.list',\n    component: BoardsRootComponent\n  },\n  {\n    name: 'boards.list',\n    component: BoardsIndexPageComponent,\n    data: {\n      parent: 'boards',\n      bodyClasses: 'router--boards-list-view',\n      menuItem: menuItemClass\n    }\n  },\n  {\n    name: 'boards.partitioned',\n    url: '{board_id}',\n    params: {\n      board_id: { type: 'int' },\n      isNew: { type: 'bool', inherit: false, dynamic: true }\n    },\n    data: {\n      parent: 'boards',\n      bodyClasses: 'router--boards-full-view',\n      menuItem: menuItemClass\n    },\n    reloadOnSearch: false,\n    component: BoardPartitionedPageComponent,\n    redirectTo: 'boards.partitioned.show',\n  },\n  {\n    name: 'boards.partitioned.show',\n    url: '',\n    data: {\n      baseRoute: 'boards.partitioned.show'\n    },\n    views: {\n      'content-left': { component: BoardListContainerComponent }\n    }\n  },\n  ...makeSplitViewRoutes(\n    'boards.partitioned.show',\n    menuItemClass,\n    WorkPackageSplitViewComponent\n  )\n];\n\nexport function uiRouterBoardsConfiguration(uiRouter:UIRouter) {\n  // Ensure boards/ are being redirected correctly\n  // cf., https://community.openproject.com/wp/29754\n  uiRouter.urlService.rules\n    .when(\n      new RegExp(\"^/projects/(.*)/boards$\"),\n      match => `/projects/${match[1]}/boards/`\n    );\n}\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n// ++\n\nimport {NgModule} from '@angular/core';\nimport {OpenprojectCommonModule} from \"core-app/modules/common/openproject-common.module\";\nimport {OpenprojectWorkPackagesModule} from \"core-app/modules/work_packages/openproject-work-packages.module\";\nimport {UIRouterModule} from \"@uirouter/angular\";\nimport {BoardListComponent} from \"core-app/modules/boards/board/board-list/board-list.component\";\nimport {BoardsRootComponent} from \"core-app/modules/boards/boards-root/boards-root.component\";\nimport {BoardInlineAddAutocompleterComponent} from \"core-app/modules/boards/board/inline-add/board-inline-add-autocompleter.component\";\nimport {BoardsToolbarMenuDirective} from \"core-app/modules/boards/board/toolbar-menu/boards-toolbar-menu.directive\";\nimport {BoardConfigurationModal} from \"core-app/modules/boards/board/configuration-modal/board-configuration.modal\";\nimport {BoardsIndexPageComponent} from \"core-app/modules/boards/index-page/boards-index-page.component\";\nimport {BoardsMenuComponent} from \"core-app/modules/boards/boards-sidebar/boards-menu.component\";\nimport {NewBoardModalComponent} from \"core-app/modules/boards/new-board-modal/new-board-modal.component\";\nimport {AddListModalComponent} from \"core-app/modules/boards/board/add-list-modal/add-list-modal.component\";\nimport {BoardHighlightingTabComponent} from \"core-app/modules/boards/board/configuration-modal/tabs/highlighting-tab.component\";\nimport {AddCardDropdownMenuDirective} from \"core-app/modules/boards/board/add-card-dropdown/add-card-dropdown-menu.directive\";\nimport {BoardFilterComponent} from \"core-app/modules/boards/board/board-filter/board-filter.component\";\nimport {DragScrollModule} from \"cdk-drag-scroll\";\nimport {BoardListMenuComponent} from \"core-app/modules/boards/board/board-list/board-list-menu.component\";\nimport {VersionBoardHeaderComponent} from \"core-app/modules/boards/board/board-actions/version/version-board-header.component\";\nimport {DynamicModule} from \"ng-dynamic-component\";\nimport {BOARDS_ROUTES, uiRouterBoardsConfiguration} from \"core-app/modules/boards/openproject-boards.routes\";\nimport {BoardPartitionedPageComponent} from \"core-app/modules/boards/board/board-partitioned-page/board-partitioned-page.component\";\nimport {BoardListContainerComponent} from \"core-app/modules/boards/board/board-partitioned-page/board-list-container.component\";\nimport {BoardsMenuButtonComponent} from \"core-app/modules/boards/board/toolbar-menu/boards-menu-button.component\";\nimport {AssigneeBoardHeaderComponent} from \"core-app/modules/boards/board/board-actions/assignee/assignee-board-header.component\";\n\n@NgModule({\n  imports: [\n    OpenprojectCommonModule,\n    OpenprojectWorkPackagesModule,\n    DragScrollModule,\n\n    // Dynamic Module for actions\n    DynamicModule.withComponents([VersionBoardHeaderComponent]),\n\n    // Routes for /boards\n    UIRouterModule.forChild({\n      states: BOARDS_ROUTES,\n      config: uiRouterBoardsConfiguration\n    }),\n  ],\n  declarations: [\n    BoardsIndexPageComponent,\n    BoardPartitionedPageComponent,\n    BoardListContainerComponent,\n    BoardListComponent,\n    BoardsRootComponent,\n    BoardInlineAddAutocompleterComponent,\n    BoardsMenuComponent,\n    BoardHighlightingTabComponent,\n    BoardConfigurationModal,\n    BoardsToolbarMenuDirective,\n    BoardsMenuButtonComponent,\n    NewBoardModalComponent,\n    AddListModalComponent,\n    AddCardDropdownMenuDirective,\n    BoardListMenuComponent,\n    BoardFilterComponent,\n    VersionBoardHeaderComponent,\n    AssigneeBoardHeaderComponent,\n  ]\n})\nexport class OpenprojectBoardsModule {\n}\n\n"],"sourceRoot":"webpack:///"}