(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"+1L4":function(e,t,i){"use strict";i.d(t,"b",(function(){return l})),i.d(t,"a",(function(){return d}));var n=i("d/TE"),s=i("AEvm"),a=i("fXoL"),r=i("ofXK"),c=i("cJ7v");function o(e,t){if(1&e&&a.hc(0,"notification",3),2&e){const e=t.$implicit;a.Bc("notification",e)}}const l="notifications-container";class d extends s.a{constructor(e,t){super(),this.notificationsService=e,this.cdRef=t,this.stack=[]}ngOnInit(){this.notificationsService.current.values$("Subscribing to changes in the notification stack").pipe(this.untilDestroyed()).subscribe(e=>{this.stack=e,this.cdRef.detectChanges()})}}d.\u0275fac=function(e){return new(e||d)(a.gc(n.a),a.gc(a.i))},d.\u0275cmp=a.ac({type:d,selectors:[["notifications-container"]],features:[a.Qb],decls:3,vars:1,consts:[[1,"notification-box--wrapper"],[1,"notification-box--casing"],[3,"notification",4,"ngFor","ngForOf"],[3,"notification"]],template:function(e,t){1&e&&(a.mc(0,"div",0),a.mc(1,"div",1),a.Yc(2,o,1,1,"notification",2),a.lc(),a.lc()),2&e&&(a.Tb(2),a.Bc("ngForOf",t.stack))},directives:[r.p,c.a],encapsulation:2,changeDetection:0})},"+B5R":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("4lR/"),s=i("PUHT"),a=i("wZYP"),r=i("Va5K"),c=i("PtkW"),o=i("fXoL");class l extends s.a{constructor(e,t,i,n,s){super(e,t),this.elementRef=e,this.opContextMenu=t,this.I18n=i,this.wpDisplayRepresentationService=n,this.wpTableTimeline=s}open(e){this.buildItems(),this.opContextMenu.show(this,e)}get locals(){return{items:this.items,contextMenuId:"wp-view-context-menu"}}buildItems(){this.items=[],this.wpDisplayRepresentationService.current!==r.b&&this.items.push({linkText:this.I18n.t("js.views.card"),icon:"icon-view-card",onClick:e=>(this.wpDisplayRepresentationService.setDisplayRepresentation(r.b),this.wpTableTimeline.isVisible&&this.wpTableTimeline.toggle(),!0)}),(this.wpTableTimeline.isVisible||this.wpDisplayRepresentationService.current===r.b)&&this.items.push({linkText:this.I18n.t("js.views.list"),icon:"icon-view-list",onClick:e=>(this.wpDisplayRepresentationService.setDisplayRepresentation(r.c),this.wpTableTimeline.isVisible&&this.wpTableTimeline.toggle(),!0)}),this.wpTableTimeline.isVisible&&this.wpDisplayRepresentationService.current!==r.b||this.items.push({linkText:this.I18n.t("js.views.timeline"),icon:"icon-view-timeline",onClick:e=>(this.wpTableTimeline.isVisible||this.wpTableTimeline.toggle(),this.wpDisplayRepresentationService.setDisplayRepresentation(r.c),!0)})}}l.\u0275fac=function(e){return new(e||l)(o.gc(o.q),o.gc(n.a),o.gc(a.a),o.gc(r.a),o.gc(c.a))},l.\u0275dir=o.bc({type:l,selectors:[["","wpViewDropdown",""]],features:[o.Qb]})},"+NA0":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("GntA");class s extends n.a{setValue(e,t){super.setValue(e,t),"project"!==e&&"type"!==e||this.updateForm()}applyChanges(e){return delete e.description,super.applyChanges(e)}setNewDefaultFor(e,t){"description"===e&&this.pristineResource.isNew?this.pristineResource.description=t:super.setNewDefaultFor(e,t)}}},"+oAL":function(e,t,i){"use strict";i.d(t,"a",(function(){return j}));var n=i("iMRi"),s=i("ug4p"),a=i("W6hW"),r=i("Kg8T"),c=i("E2tj"),o=i("2Qcm"),l=i("IzEk"),d=i("Uyc6"),u=i("Va5K"),h=i("EnRq"),p=i("JY8V"),g=i("6yP5"),m=i("ONn1"),f=i("wyKs"),b=i("Zq3F"),w=i("PtkW"),v=i("AeZM"),y=i("F5Dh"),k=i("FB4C"),C=i("fXoL");class j{constructor(e,t,i,n,s,a,r,c,o,l,d,u,h,p,g,m,f,b){this.states=e,this.querySpace=t,this.wpTableColumns=i,this.wpTableGroupBy=n,this.wpTableSortBy=s,this.wpTableFilters=a,this.wpTableSum=r,this.wpTableTimeline=c,this.wpTableHierarchies=o,this.wpTableHighlighting=l,this.wpTableRelationColumns=d,this.wpTablePagination=u,this.wpTableOrder=h,this.wpTableAdditionalElements=p,this.wpCacheService=g,this.wpListChecksumService=m,this.authorisationService=f,this.wpDisplayRepresentation=b}initialize(e,t){this.clearStates(),this.querySpace.query.putValue(e),this.initializeFromQuery(e,t),this.updateQuerySpace(e,t),this.updateChecksum(e,t)}updateStatesFromForm(e,t){let i=t.schema;_.each(i.filtersSchemas.elements,e=>{this.states.schemas.get(e.$href).putValue(e)}),this.wpTableFilters.initializeFilters(e,i),this.querySpace.queryForm.putValue(t),this.states.queries.columns.putValue(i.columns.allowedValues),this.states.queries.sortBy.putValue(i.sortBy.allowedValues),this.states.queries.groupBy.putValue(i.groupBy.allowedValues),this.states.queries.displayRepresentation.putValue(i.displayRepresentation.allowedValues)}updateQuerySpace(e,t){this.querySpace.additionalRequiredWorkPackages.clear("Clearing additional WPs before updating rows"),this.querySpace.tableRendered.clear("Clearing rendered data before upgrading query space"),t.schemas&&_.each(t.schemas.elements,e=>{this.states.schemas.get(e.href).putValue(e)}),this.querySpace.query.putValue(e),this.authorisationService.initModelAuth("work_packages",t.$links),t.elements.forEach(e=>this.wpCacheService.updateWorkPackage(e,!0)),this.querySpace.results.putValue(t),this.querySpace.groups.putValue(t.groups),this.wpTablePagination.initialize(e,t),this.wpTableRelationColumns.initialize(e,t),this.wpTableAdditionalElements.initialize(t.elements),this.wpTableOrder.initialize(e,t),this.wpDisplayRepresentation.initialize(e,t),this.querySpace.additionalRequiredWorkPackages.values$().pipe(Object(l.a)(1)).subscribe(()=>this.querySpace.initialized.putValue(null))}updateChecksum(e,t){this.wpListChecksumService.updateIfDifferent(this.querySpace.query.value,this.wpTablePagination.current),this.authorisationService.initModelAuth("work_packages",t.$links)}initializeFromQuery(e,t){this.querySpace.query.putValue(e),this.wpTableSum.initialize(e),this.wpTableColumns.initialize(e,t),this.wpTableSortBy.initialize(e,t),this.wpTableGroupBy.initialize(e,t),this.wpTableTimeline.initialize(e,t),this.wpTableHierarchies.initialize(e,t),this.wpTableHighlighting.initialize(e,t),this.wpDisplayRepresentation.initialize(e,t),this.authorisationService.initModelAuth("query",e.$links),this.authorisationService.initModelAuth("work_packages",t.$links)}applyToQuery(e){this.wpTableFilters.applyToQuery(e),this.wpTableSum.applyToQuery(e),this.wpTableColumns.applyToQuery(e),this.wpTableSortBy.applyToQuery(e),this.wpTableGroupBy.applyToQuery(e),this.wpTableTimeline.applyToQuery(e),this.wpTableHighlighting.applyToQuery(e),this.wpTableHierarchies.applyToQuery(e),this.wpTableOrder.applyToQuery(e),this.wpDisplayRepresentation.applyToQuery(e)}clearStates(){const e="Clearing states before re-initialization.";this.querySpace.initialized.clear(e),this.querySpace.query.clear(e),this.querySpace.results.clear(e),this.querySpace.groups.clear(e),this.querySpace.additionalRequiredWorkPackages.clear(e),this.wpTableFilters.clear(e),this.wpTableColumns.clear(e),this.wpTableSortBy.clear(e),this.wpTableGroupBy.clear(e),this.wpDisplayRepresentation.clear(e),this.wpTableSum.clear(e),this.querySpace.tableRendered.clear(e)}}j.\u0275fac=function(e){return new(e||j)(C.qc(n.a),C.qc(c.a),C.qc(p.a),C.qc(v.a),C.qc(g.a),C.qc(y.a),C.qc(h.a),C.qc(w.a),C.qc(f.a),C.qc(o.a),C.qc(k.a),C.qc(b.a),C.qc(d.a),C.qc(m.a),C.qc(s.a),C.qc(a.a),C.qc(r.a),C.qc(u.a))},j.\u0275prov=C.cc({token:j,factory:j.\u0275fac})},"+pCT":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));i("y2Tr");var n=i("wZYP"),s=i("fXoL"),a=i("ofXK");function r(e,t){if(1&e&&s.hc(0,"a",2),2&e){const e=s.wc();s.Bc("textContent",e.name),s.Ub("href",e.href,s.Tc)("title",e.label)}}function c(e,t){if(1&e&&(s.kc(0),s.ad(1),s.ic(2),s.jc()),2&e){const e=s.wc();s.Tb(1),s.cd(" ",e.name," ")}}class o{constructor(e){this.I18n=e}get href(){return this.user&&this.user.showUserPath}get name(){return this.user&&this.user.name}get label(){return this.I18n.t("js.label_author",{user:this.name})}}o.\u0275fac=function(e){return new(e||o)(s.gc(n.a))},o.\u0275cmp=s.ac({type:o,selectors:[["user-link"]],inputs:{user:"user"},decls:2,vars:2,consts:[[3,"textContent",4,"ngIf"],[4,"ngIf"],[3,"textContent"]],template:function(e,t){1&e&&(s.Yc(0,r,1,3,"a",0),s.Yc(1,c,3,1,"ng-container",1)),2&e&&(s.Bc("ngIf",t.href),s.Tb(1),s.Bc("ngIf",!t.href))},directives:[a.q],encapsulation:2,changeDetection:0})},"+ytV":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("711n"),s=i("fXoL");class a{constructor(e,t){this.wpeditForm=e,this.elementRef=t}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement)}activate(e){if(jQuery(e.target).closest(".help-text--entry").length)return!0;const t=this.wpeditForm.fields[this.fieldName];return t&&t.handleUserActivate(null),!1}}a.\u0275fac=function(e){return new(e||a)(s.gc(n.a),s.gc(s.q))},a.\u0275cmp=s.ac({type:a,selectors:[["wp-replacement-label"]],inputs:{fieldName:"fieldName"},ngContentSelectors:["*"],decls:2,vars:0,consts:[["tabindex","-1",1,"wp-replacement-label",3,"click"]],template:function(e,t){1&e&&(s.Ac(),s.mc(0,"span",0),s.uc("click",(function(e){return t.activate(e)})),s.zc(1),s.lc())},encapsulation:2})},"/8SZ":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("hxxE");class s extends n.a{$initialize(e){super.$initialize(e),this.elements=this.elements||[]}}},"/C7M":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("XNiG"),s=i("pLZG"),a=i("p9/F"),r=i("Kj3r"),c=i("fXoL");class o{constructor(){this._events=new n.a,this.events$=this._events.asObservable()}aggregated$(e,t=500){return this.events$.pipe(Object(s.a)(t=>t.resourceType===e),Object(a.a)(this.events$.pipe(Object(r.a)(t))))}push(e,t){t.id=e.id,t.resourceType=e._type,this._events.next(t)}}o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=c.cc({token:o,factory:o.\u0275fac,providedIn:"root"})},"/Rze":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("fXoL"),s=i("ofXK"),a=i("kor4");class r{constructor(){this.execute=new n.s}handleClick(e){return this.isDisabled||this.execute.emit(e),!1}}r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=n.ac({type:r,selectors:[["accessible-by-keyboard"]],inputs:{isDisabled:"isDisabled",linkClass:"linkClass",linkTitle:"linkTitle",spanClass:"spanClass",linkAriaLabel:"linkAriaLabel"},outputs:{execute:"execute"},ngContentSelectors:["*"],decls:3,vars:5,consts:[["role","link","href","",3,"ngClass","accessibleClick"],[3,"ngClass"]],template:function(e,t){1&e&&(n.Ac(),n.mc(0,"a",0),n.uc("accessibleClick",(function(e){return t.handleClick(e)})),n.mc(1,"span",1),n.zc(2),n.lc(),n.lc()),2&e&&(n.Bc("ngClass",t.linkClass),n.Ub("disabled",t.isDisabled||void 0)("title",t.linkTitle)("aria-label",t.linkAriaLabel),n.Tb(1),n.Bc("ngClass",t.spanClass))},directives:[s.n,a.a],encapsulation:2})},"/cHX":function(e,t,i){"use strict";i.d(t,"e",(function(){return r})),i.d(t,"d",(function(){return c})),i.d(t,"c",(function(){return o})),i.d(t,"b",(function(){return l})),i.d(t,"a",(function(){return d}));var n=i("mrSG"),s=i("wZYP"),a=i("r0MM");const r="wp-table--context-menu-td",c="wp-table--context-menu-span",o="wp-table-context-menu-link",l="wp-table-context-menu-icon";class d{constructor(e,t){this.injector=e,this.workPackage=t}}Object(n.c)([Object(a.a)(),Object(n.e)("design:type",s.a)],d.prototype,"I18n",void 0)},"/qfM":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("gvAf"),s=i("ODu2"),a=i("qs3h"),r=i("ylTo"),c=i("ZGxV"),o=i("4fM7");function l(e,t,i,l=c.a){return[{name:e+".details",url:"/details/{workPackageId:[0-9]+}",redirectTo:e+".details.overview",reloadOnSearch:!1,data:{bodyClasses:"router--work-packages-partitioned-split-view-details",menuItem:t,baseRoute:e,partition:"-split",newRoute:e+".new"},views:{"content-right@^.^":{component:i}}},{name:e+".details.overview",url:"/overview",component:n.a,data:{menuItem:t,parent:e+".details"}},{name:e+".details.activity",url:"/activity",component:s.a,data:{menuItem:t,parent:e+".details"}},{name:e+".details.relations",url:"/relations",component:a.a,data:{menuItem:t,parent:e+".details"}},{name:e+".details.watchers",url:"/watchers",component:r.a,data:{menuItem:t,parent:e+".details"}},{name:e+".new",url:"/create_new?{type:[0-9]+}&{parent_id:[0-9]+}",reloadOnSearch:!1,data:{partition:"-split",allowMovingInEditMode:!0,bodyClasses:"router--work-packages-partitioned-split-view-new",baseRoute:e,parent:e},views:{"content-right@^.^":{component:l}}},{name:e+".copy",url:"/details/{copiedFromWorkPackageId:[0-9]+}/copy",views:{"content-right@^.^":{component:o.a}},reloadOnSearch:!1,data:{baseRoute:e,parent:e,allowMovingInEditMode:!0,bodyClasses:"router--work-packages-partitioned-split-view",menuItem:t,partition:"-split"}}]}},0:function(e,t,i){e.exports=i("zUnb")},"07mJ":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("Jui0"),s=i("fXoL");class a{constructor(e){this.pathHelper=e}projectImportIssuePath(e){return this.pathHelper.projectPath(e)+"/issues/upload"}projectExportIssuesPath(e,t){return t?this.pathHelper.projectPath(e)+"/work_packages.bcf?filters="+t:this.pathHelper.projectPath(e)+"/work_packages.bcf"}snapshotPath(e){return e.href+"/snapshot"}}a.\u0275fac=function(e){return new(e||a)(s.qc(n.a))},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac})},"0To3":function(e,t,i){"use strict";i.d(t,"a",(function(){return O}));var n=i("mrSG"),s=i("wZYP"),a=i("qHU1"),r=i("iMRi"),c=i("SKFm"),o=i("QOiP"),l=i("pXZk"),d=i("6XbZ"),u=i("r0MM");function h(e){return`__relations-expanded-from-${e}`}class p extends d.a{constructor(e,t){super(e,t),this.injector=e,this.workPackageTable=t}buildCell(e,t){return Object(o.a)(t)?this.emptyRelationCell(t):super.buildCell(e,t)}buildEmptyRelationRow(e,t,i){const n=t.denormalized(e),s=this.states.workPackages.get(n.targetId).value,a=this.createEmptyRelationRow(e,s),[r,c]=super.buildEmptyRow(s,a);return[r,s]}createEmptyRelationRow(e,t){const i=this.relationClassIdentifier(e,t);let n=document.createElement("tr");return n.dataset.workPackageId=t.id,n.dataset.classIdentifier=i,n.classList.add(d.b,d.c,"issue","wp-table--relations-aditional-row",i,`${i}-table`,h(e.id)),n}relationClassIdentifier(e,t){return i=t.id,`wp-relation-row-${e.id}-to-${i}`;var i}appendRelationLabel(e,t,i,n,s){const a=i.denormalized(t);let r="";if("toType"===s&&(r=this.I18n.t(`js.relation_labels.${a.reverseRelationType}`)),"ofType"===s){r=this.states.workPackages.get(a.target.id).value.type.name}const c=document.createElement("span");c.classList.add("relation-row--type-label"),c.textContent=r;document.createTextNode(a.target.name);e.find(".wp-table--relation-cell-td").empty(),e.find(`.wp-table--relation-cell-td.${n}`).append(c)}emptyRelationCell(e){const t=document.createElement("td");return t.classList.add("wp-table--relation-cell-td",l.c,e.id),t}}Object(n.c)([Object(u.a)(),Object(n.e)("design:type",r.a)],p.prototype,"states",void 0),Object(n.c)([Object(u.a)(),Object(n.e)("design:type",s.a)],p.prototype,"I18n",void 0);var g=i("uSJ+"),m=i("JY8V"),f=i("FB4C");class b{constructor(e,t,i){this.injector=e,this.table=t,this.tablePass=i,this.relationRowBuilder=new p(e,t)}render(){if(!this.isApplicable)return;_.clone(this.tablePass.renderedOrder).forEach((e,t)=>{if(!e.workPackage)return;const i=e.workPackage,n=i.id,s=this.wpRelations.state(n);s.hasValue()&&0!==_.size(s.value)&&this.wpTableRelationColumns.relationsToExtendFor(i,s.value,(t,s,a)=>{const[r,c]=this.relationRowBuilder.buildEmptyRelationRow(i,t,a);r.classList.add(...e.additionalClasses),this.relationRowBuilder.appendRelationLabel(jQuery(r),i,t,s.id,a),this.tablePass.spliceRow(r,`.${this.relationRowBuilder.classIdentifier(i)},.${h(n)}`,{classIdentifier:this.relationRowBuilder.relationClassIdentifier(i,c),additionalClasses:e.additionalClasses.concat(["wp-table--relations-aditional-row"]),workPackage:c,belongsTo:i,renderType:"relations",hidden:e.hidden,data:{relation:t,columnId:s.id,relationType:a}})})})}refreshRelationRow(e,t,i){const n=this.relationRowBuilder.refreshRow(t,i);return this.relationRowBuilder.appendRelationLabel(n,e.belongsTo,e.data.relation,e.data.columnId,e.data.relationType),n}get isApplicable(){return this.wpTableColumns.hasRelationColumns()}}Object(n.c)([Object(u.a)(),Object(n.e)("design:type",g.a)],b.prototype,"wpRelations",void 0),Object(n.c)([Object(u.a)(),Object(n.e)("design:type",m.a)],b.prototype,"wpTableColumns",void 0),Object(n.c)([Object(u.a)(),Object(n.e)("design:type",f.a)],b.prototype,"wpTableRelationColumns",void 0);var w=i("9nXh");class v{constructor(e,t,i){this.injector=e,this.table=t,this.tablePass=i}render(){this.timelineBody=document.createDocumentFragment(),this.timelineBuilder=new w.a(this.injector,this.table),this.tablePass.renderedOrder.forEach(e=>{const t=e.workPackage?e.workPackage.id:null,i=this.timelineBuilder.build(t);i.classList.add(e.classIdentifier,`${e.classIdentifier}-timeline`,...e.additionalClasses),this.timelineBody.appendChild(i)})}}var y=i("2Qcm"),k=i("RGDJ"),C=i("E2tj");class j{constructor(e,t,i){this.injector=e,this.table=t,this.tablePass=i}render(){if(!this.isApplicable)return;const e=this.wpTableHighlighting.current.mode;window.getComputedStyle(document.body);this.tablePass.renderedOrder.forEach((t,i)=>{if(!t.workPackage)return;const n=t.workPackage[e];if(!n)return;const s=n.id;this.tablePass.tableBody.children[i].classList.add(k.a.backgroundClass(e,s))})}get isApplicable(){return!(this.wpTableHighlighting.isInline||this.wpTableHighlighting.isDisabled)}}Object(n.c)([Object(u.a)(),Object(n.e)("design:type",y.a)],j.prototype,"wpTableHighlighting",void 0),Object(n.c)([Object(u.a)(),Object(n.e)("design:type",C.a)],j.prototype,"querySpace",void 0);var x=i("pSHE"),T=i("FlxY");class S{constructor(e){this.injector=e;const t=this.injector.get(x.a);this.actionService=t.get(e)}build(e,t){let i=document.createElement("td");if(!this.actionService.canPickup(e))return i;i.classList.add(l.c,"wp-table--sort-td",T.b.id,"hide-when-print");let n=document.createElement("span");return n.classList.add("wp-table--drag-and-drop-handle","icon-drag-handle"),i.appendChild(n),i}}var P=i("Uyc6");class I{constructor(e,t,i){this.injector=e,this.table=t,this.tablePass=i,this.dragDropHandleBuilder=new S(this.injector)}render(){this.table.configuration.dragAndDropEnabled&&this.wpTableOrder.withLoadedPositions().then(e=>{this.tablePass.renderedOrder.forEach((t,i)=>{if(!t.workPackage||"relations"===t.renderType)return;const n=this.dragDropHandleBuilder.build(t.workPackage,e[t.workPackage.id]);n&&t.element.replaceChild(n,t.element.firstElementChild)})})}}Object(n.c)([Object(u.a)(),Object(n.e)("design:type",m.a)],I.prototype,"wpTableColumns",void 0),Object(n.c)([Object(u.a)(),Object(n.e)("design:type",P.a)],I.prototype,"wpTableOrder",void 0);class O{constructor(e,t,i){this.injector=e,this.workPackageTable=t,this.rowBuilder=i}render(){return Object(a.b)("Primary render pass",()=>{this.prepare(),this.doRender(),this.postRender()}),this.highlighting.render(),Object(a.b)("Relations render pass",()=>{this.relations.render()}),Object(a.b)("Drag handle render pass",()=>{this.dragDropHandle.render()}),Object(a.b)("Timelines render pass",()=>{this.timeline.render()}),this}refresh(e,t,i){let n=jQuery(i).find(`.${e.classIdentifier}`),s=null;switch(e.renderType){case"primary":s=this.rowBuilder.refreshRow(t,n);break;case"relations":s=this.relations.refreshRelationRow(e,t,n)}null!==s&&n.length&&n.replaceWith(s)}get result(){return this.renderedOrder.map(e=>({classIdentifier:e.classIdentifier,workPackageId:e.workPackage?e.workPackage.id:null,hidden:e.hidden}))}spliceRow(e,t,i){const n=jQuery(this.tableBody).find(t).last();n.after(e);const s=n.index();this.renderedOrder.splice(s+1,0,i)}prepare(){this.timeline=new v(this.injector,this.workPackageTable,this),this.relations=new b(this.injector,this.workPackageTable,this),this.dragDropHandle=new I(this.injector,this.workPackageTable,this),this.highlighting=new j(this.injector,this.workPackageTable,this),this.tableBody=document.createDocumentFragment(),this.renderedOrder=[]}postRender(){0===this.renderedOrder.length&&this.workPackageTable.renderPlaceholderRow&&this.tableBody.appendChild(this.rowBuilder.placeholderRow)}appendRow(e,t,i=[],n=!1){this.tableBody.appendChild(t),this.renderedOrder.push({classIdentifier:this.rowBuilder.classIdentifier(e),additionalClasses:i,workPackage:e,renderType:"primary",element:t,hidden:n})}appendNonWorkPackageRow(e,t,i=[],n=!1){e.classList.add(t),this.tableBody.appendChild(e),this.renderedOrder.push({element:e,classIdentifier:t,additionalClasses:i,workPackage:null,renderType:"primary",hidden:n})}}Object(n.c)([Object(u.a)(),Object(n.e)("design:type",c.a)],O.prototype,"halEditing",void 0),Object(n.c)([Object(u.a)(),Object(n.e)("design:type",r.a)],O.prototype,"states",void 0),Object(n.c)([Object(u.a)(),Object(n.e)("design:type",s.a)],O.prototype,"I18n",void 0)},"0Usb":function(e,t,i){"use strict";i.d(t,"c",(function(){return l})),i.d(t,"b",(function(){return d})),i.d(t,"a",(function(){return u}));var n=i("mrSG"),s=i("iMRi"),a=i("pXZk"),r=i("uSJ+"),c=i("FB4C"),o=i("r0MM");const l="wp-table--relation-cell-td",d="wp-table--relation-indicator";class u{constructor(e){this.injector=e}build(e,t){const i=document.createElement("td");i.classList.add(a.c,l,t.id),i.dataset.columnId=t.id;const n=this.wpTableRelationColumns.getExpandFor(e.id)===t.id,s=this.wpRelations.state(e.id).value,r=this.wpTableRelationColumns.relationsForColumn(e,s,t),c=this.renderIndicator(),o=this.renderBadge(r);return n&&i.classList.add("-expanded"),r.length>0&&(i.appendChild(o),i.appendChild(c)),i}renderIndicator(){const e=document.createElement("span");return e.classList.add(d),e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex","0"),e}renderBadge(e){const t=document.createElement("span");return t.classList.add("wp-table--relation-count"),t.textContent=""+e.length,t.classList.add("badge","-border-only"),t}}Object(n.c)([Object(o.a)(),Object(n.e)("design:type",s.a)],u.prototype,"states",void 0),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",r.a)],u.prototype,"wpRelations",void 0),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",c.a)],u.prototype,"wpTableRelationColumns",void 0)},"0XIV":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));i("ii2/");var n=i("fXoL"),s=i("0loS");const a=function(e,t){return{workPackageId:e,"#":t}};class r{ngOnInit(){this.activityHtmlId=`activity-${this.activityNo}`,this.activityLabel=`#${this.activityNo}`}}r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=n.ac({type:r,selectors:[["activity-link"]],inputs:{workPackage:"workPackage",activityNo:"activityNo"},decls:1,vars:6,consts:[["uiSref","work-packages.show.activity",3,"id","textContent","uiParams"]],template:function(e,t){1&e&&n.hc(0,"a",0),2&e&&(n.Dc("id","",t.activityHtmlId,"-link"),n.Bc("textContent",t.activityLabel)("uiParams",n.Hc(3,a,t.workPackage.id,t.activityHtmlId)))},directives:[s.AnchorUISref,s.UISref],encapsulation:2})},"0bag":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("kTsZ"),s=i("6x6j"),a=i("pL6k"),r=i("Jui0"),c=i("1SJX"),o=i("ciXH"),l=i("yQm5"),d=i("fXoL"),u=i("tk/3");class h extends o.a{constructor(e,t,i,n,s,a){super(e,i),this.halResourceService=e,this.http=t,this.pathHelper=i,this.UrlParamsHelper=n,this.QueryFilters=s,this.PayloadDm=a}stream(e,t,i){let n;return n=t?this.pathHelper.api.v3.queries.id(t).toString():this.pathHelper.api.v3.withOptionalProject(i).queries.default.toString(),this.halResourceService.get(n,e)}find(e,t,i){return this.stream(e,t,i).toPromise()}findDefault(e,t){return this.find(e,void 0,t)}reload(e,t){let i=this.pathHelper.api.v3.queries.id(e.id).toString();return this.halResourceService.get(i,t).toPromise()}loadResults(e,t){if(!e.results)throw"No results embedded when expected";let i=this.UrlParamsHelper.buildV3GetQueryFromQueryResource(e,t),n=l(e.href).path();return this.halResourceService.get(n,i).toPromise()}loadIdsUpdatedSince(e,t){const i=[{id:{operator:"=",values:e.filter(e=>e)}},{updatedAt:{operator:"<>d",values:[t,""]}}];return this.halResourceService.get(this.pathHelper.api.v3.work_packages.toString(),{filters:JSON.stringify(i)}).toPromise()}update(e,t){const i=this.extractPayload(e,t);return this.patch(e.id,i)}patch(e,t){let i=this.pathHelper.api.v3.queries.id(e).toString();return this.halResourceService.patch(i,t)}create(e,t){const i=this.extractPayload(e,t);let n=this.pathHelper.api.v3.queries.toString();return this.halResourceService.post(n,i).toPromise()}delete(e){return e.delete()}toggleStarred(e){return e.starred?e.unstar():e.star()}listNonHidden(e){let t={filters:[["hidden","=",["f"]]]};return e?t.filters.push(["project_identifier","=",[e]]):t.filters.push(["project","!*",[]]),this.list(t)}extractPayload(e,t){return this.QueryFilters.mapSchemasIntoFilters(e,t),this.PayloadDm.extract(e,t.schema)}listUrl(){return this.pathHelper.api.v3.queries.toString()}oneUrl(e){return this.pathHelper.api.v3.queries.id(e).toString()}}h.\u0275fac=function(e){return new(e||h)(d.qc(n.a),d.qc(u.b),d.qc(r.a),d.qc(a.a),d.qc(c.a),d.qc(s.a))},h.\u0275prov=d.cc({token:h,factory:h.\u0275fac})},"0lDN":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=new(i("fXoL").z)("CONTEXT_MENU_LOCALS")},"0zio":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("wZYP"),s=i("tN7n"),a=i("ho3E"),r=i("fXoL");class c extends s.a{constructor(e,t){super(t),this.locals=e,this.I18n=t}get tabs(){const e=this.locals.disabledTabs||{};return this._tabs.map(t=>{const i=e[t.name];return null!=i&&(t.disableBecause=i),t})}}c.\u0275fac=function(e){return new(e||c)(r.qc(a.a),r.qc(n.a))},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac})},"13ri":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.isClickedWithModifier=function(e){const t=e.ctrlKey||e.shiftKey||e.metaKey,i=1===e.button;return t||i}}(n||(n={}))},"1EAr":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this.stopEventPropagation=!0,this.eventHandler=new n.s}handleClick(e){return"dblclick"!==e.type&&2!==e.tapCount||(this.eventHandler.emit(e),this.eventStopReturnCode(e))}eventStopReturnCode(e){return!this.stopEventPropagation||(e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1)}}s.\u0275fac=function(e){return new(e||s)},s.\u0275dir=n.bc({type:s,selectors:[["","doubleClickOrTap",""]],hostBindings:function(e,t){1&e&&n.uc("dblclick",(function(e){return t.handleClick(e)}))("tap",(function(e){return t.handleClick(e)}))},inputs:{stopEventPropagation:["doubleClickOrTapStopEvent","stopEventPropagation"]},outputs:{eventHandler:"doubleClickOrTap"}})},"1MaS":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("kTsZ"),s=i("RhL0"),a=i("Jui0"),r=i("fXoL");class c{constructor(e,t){this.halResourceService=e,this.pathHelper=t}load(e){return this.halResourceService.get(this.pathHelper.api.v3.work_packages.id(e).relations,{}).toPromise().then(e=>e.elements)}loadInvolved(e){let t=_.filter(e,e=>/\d+/.test(e));return 0===t.length?Promise.resolve([]):this.halResourceService.get(this.pathHelper.api.v3.relations.toPath(),{filters:Object(s.b)("involved","=",t).toJson()}).toPromise().then(e=>e.elements)}}c.\u0275fac=function(e){return new(e||c)(r.qc(n.a),r.qc(a.a))},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac})},"1SJX":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{getFilterSchema(e,t){const i=t.$embedded.schema.filtersSchemas.elements;return _.find(i,t=>t.allowedFilterValue.href===e.filter.href)}mapSchemasIntoFilters(e,t){e.filters.forEach(e=>{e.schema=this.getFilterSchema(e,t)})}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.cc({token:s,factory:s.\u0275fac})},"1zMF":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("4lR/"),s=i("PUHT"),a=i("SKFm"),r=i("iMRi"),c=i("fXoL");class o extends s.a{constructor(e,t,i,n){super(e,t),this.elementRef=e,this.opContextMenu=t,this.states=i,this.halEditing=n}open(e){const t=this.states.workPackages.get("new").value;if(t){this.halEditing.changeFor(t).getForm().then(t=>{this.buildItems(t),this.opContextMenu.show(this,e)})}}positionArgs(e){let t=super.positionArgs(e);return _.assign(t,{my:"right top",at:"right bottom"}),t}buildItems(e){this.items=[];const t=e.configureForm,i=e.customFields;i&&this.items.push({href:i.href,icon:"icon-custom-fields",linkText:i.name,onClick:()=>!1}),t&&this.items.push({href:t.href,icon:"icon-settings3",linkText:t.name,onClick:()=>!1})}}o.\u0275fac=function(e){return new(e||o)(c.gc(c.q),c.gc(n.a),c.gc(r.a),c.gc(a.a))},o.\u0275dir=c.bc({type:o,selectors:[["","wpCreateSettingsMenu",""]],features:[c.Qb]})},"2G+H":function(e,t,i){"use strict";function n(e){return(e.current.data.baseRoute||"")+".details"}i.d(t,"a",(function(){return n}))},"2Qcm":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("zqrF"),s=i("E2tj"),a=i("iMRi"),r=i("fbLK"),c=i("fXoL");class o extends n.a{constructor(e,t,i){super(i),this.states=e,this.Banners=t,this.querySpace=i}initialize(e,t,i){super.initialize(e,t,i)}shouldHighlightInline(e){return!(!this.isInline||this.Banners.eeShowBanners)&&(void 0===this.current.selectedAttributes||this.current.selectedAttributes===[]||!!_.find(this.current.selectedAttributes,t=>t.id===e))}get current(){let e=this.lastUpdatedState.getValueOr({mode:"inline"});return this.filteredValue(e)}get isInline(){return"inline"===this.current.mode}get isDisabled(){return"none"===this.current.mode}update(e){super.update(this.filteredValue(e))}valueFromQuery(e){const t={mode:e.highlightingMode||"inline",selectedAttributes:e.highlightedAttributes};return this.filteredValue(t)}hasChanged(e){return e.highlightingMode!==this.current.mode||!_.isEqual(e.highlightedAttributes,this.current.selectedAttributes)}applyToQuery(e){const t=this.current;return e.highlightingMode=t.mode,e.highlightedAttributes=t.selectedAttributes,!1}filteredValue(e){return _.isEmpty(e.selectedAttributes)&&(e.selectedAttributes=void 0),this.Banners.conditional(()=>{e.mode="none",e.selectedAttributes=void 0}),e}}o.\u0275fac=function(e){return new(e||o)(c.qc(a.a),c.qc(r.a),c.qc(s.a))},o.\u0275prov=c.cc({token:o,factory:o.\u0275fac})},"2TbE":function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("iB+3"),s=i("wZYP"),a=i("sjKJ"),r=i("Kg8T"),c=i("AEvm"),o=i("Hg4z"),l=i("fXoL"),d=i("8YXA"),u=i("N5AO"),h=i("ofXK");class p extends c.a{constructor(e,t,i,n,s,a){super(),this.$state=e,this.currentProject=t,this.authorisationService=i,this.transition=n,this.I18n=s,this.cdRef=a,this.text={createWithDropdown:this.I18n.t("js.work_packages.create.button"),createButton:this.I18n.t("js.label_work_package"),explanation:this.I18n.t("js.label_create_work_package")}}ngOnInit(){this.projectIdentifier=this.currentProject.identifier,this.authorisationService.observeUntil(Object(o.b)(this)).subscribe(()=>{this.allowed=!!this.allowedWhen.find(e=>{let[t,i]=e.split(".");return this.authorisationService.can(t,i)}),this.updateDisabledState()}),this.transitionUnregisterFn=this.transition.onSuccess({},this.updateDisabledState.bind(this))}ngOnDestroy(){super.ngOnDestroy(),this.transitionUnregisterFn()}updateDisabledState(){this.disabled=!this.allowed||this.$state.includes("**.new"),this.cdRef.detectChanges()}}p.\u0275fac=function(e){return new(e||p)(l.gc(n.G),l.gc(a.a),l.gc(r.a),l.gc(n.O),l.gc(s.a),l.gc(l.i))},p.\u0275cmp=l.ac({type:p,selectors:[["wp-create-button"]],inputs:{allowedWhen:["allowed","allowedWhen"],stateName$:"stateName$"},features:[l.Qb],decls:6,vars:8,consts:[[1,"wp-create-button"],["opTypesCreateDropdown","",1,"button","-alt-highlight","add-work-package",3,"disabled","projectIdentifier","stateName","dropdownActive"],["icon-classes","button--icon icon-add"],["aria-hidden","true",1,"button--text",3,"textContent"],["icon-classes","button--icon icon-small icon-pulldown hidden-for-mobile"]],template:function(e,t){1&e&&(l.mc(0,"div",0),l.mc(1,"button",1),l.xc(2,"async"),l.hc(3,"op-icon",2),l.hc(4,"span",3),l.hc(5,"op-icon",4),l.lc(),l.lc()),2&e&&(l.Tb(1),l.Bc("disabled",t.disabled)("projectIdentifier",t.projectIdentifier)("stateName",l.yc(2,6,t.stateName$))("dropdownActive",t.allowed),l.Ub("aria-label",t.text.explanation),l.Tb(3),l.Bc("textContent",t.text.createWithDropdown))},directives:[d.a,u.a],pipes:[h.a],encapsulation:2,changeDetection:0})},"2Uhg":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("kgyZ"),s=i("XNiG"),a=i("+NA0"),r=i("fXoL");class c extends n.a{constructor(e,t){super(),this.elementRef=e,this.injector=t,this.fieldName="comment",this.handler=this,this.active=!1,this.inEditMode=!1,this.inFlight=!1,this.onDestroy=new s.a}ngOnInit(){this.change=new a.a(this.workPackage)}reset(e=""){e.length>0&&(e+="\n"),this.change.setValue("comment",{raw:e})}get schema(){return{name:I18n.t("js.label_comment"),writable:!0,required:!1,type:"_comment",hasDefault:!1}}get rawComment(){return _.get(this.commentValue,"raw","")}get commentValue(){return this.change.value("comment")}handleUserCancel(){this.deactivate(!0)}activate(e){this.active=!0,this.reset(e)}deactivate(e){this.active=!1,this.onDestroy.next(),this.onDestroy.complete()}focus(){const e=this.elementRef.nativeElement.querySelector(".inplace-editing--trigger-container");e&&e.focus()}onFocusOut(){}handleUserKeydown(e,t){}isChanged(){return!1}stopPropagation(e){return!1}}c.\u0275fac=function(e){return new(e||c)(r.gc(r.q),r.gc(r.A))},c.\u0275dir=r.bc({type:c,features:[r.Qb]})},"2bW2":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("fXoL"),s=i("wZYP"),a=i("711n"),r=i("N5AO");class c{constructor(e,t,i){this.I18n=e,this.editForm=t,this.cdRef=i,this.onSave=new n.s,this.onCancel=new n.s,this._saving=!1,this.text={save:this.I18n.t("js.button_save"),cancel:this.I18n.t("js.button_cancel")}}set saving(e){this._saving=e,this.cdRef.detectChanges()}get saving(){return this._saving}save(){this.saving||(this.saving=!0,this.editForm.submit().then(()=>{this.saving=!1,this.onSave.emit()}).catch(()=>{this.saving=!1}))}cancel(){this.editForm.cancel(),this.onCancel.emit()}}c.\u0275fac=function(e){return new(e||c)(n.gc(s.a),n.gc(a.a),n.gc(n.i))},c.\u0275cmp=n.ac({type:c,selectors:[["wp-edit-actions-bar"]],outputs:{onSave:"onSave",onCancel:"onCancel"},decls:7,vars:3,consts:[[1,"work-packages--edit-actions"],["id","work-packages--edit-actions-save","accesskey","3",1,"button","-highlight",3,"disabled","click"],["icon-classes","button--icon icon-checkmark"],[1,"button--text",3,"textContent"],["id","work-packages--edit-actions-cancel","accesskey","7",1,"button",3,"click"],["icon-classes","button--icon icon-close"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"button",1),n.uc("click",(function(){return t.save()})),n.hc(2,"op-icon",2),n.hc(3,"span",3),n.lc(),n.mc(4,"button",4),n.uc("click",(function(){return t.cancel()})),n.hc(5,"op-icon",5),n.hc(6,"span",3),n.lc(),n.lc()),2&e&&(n.Tb(1),n.Bc("disabled",t.saving),n.Tb(2),n.Bc("textContent",t.text.save),n.Tb(3),n.Bc("textContent",t.text.cancel))},directives:[r.a],encapsulation:2,changeDetection:0})},"2hMx":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("wZYP"),s=i("Jui0"),a=(i("Mo6U"),i("juWA")),r=i("fXoL"),c=i("ofXK");function o(e,t){if(1&e&&r.hc(0,"span",4),2&e){const e=r.wc();r.Bc("textContent",e.author.name)}}function l(e,t){if(1&e&&r.hc(0,"a",4),2&e){const e=r.wc();r.Bc("textContent",e.author.name),r.Ub("href",e.userLink,r.Tc)}}function d(e,t){if(1&e&&(r.mc(0,"span",5),r.hc(1,"a",4),r.lc()),2&e){const e=r.wc();r.Tb(1),r.Bc("textContent",e.timeago),r.Ub("title",e.time)("href",e.activityFromPath(e.createdOnTime.format("YYYY-MM-DD")),r.Tc)}}function u(e,t){if(1&e&&r.hc(0,"span",6),2&e){const e=r.wc();r.Bc("textContent",e.timeago),r.Ub("title",e.time)}}class h{constructor(e,t,i){this.PathHelper=e,this.I18n=t,this.timezoneService=i}ngOnInit(){this.createdOnTime=this.timezoneService.parseDatetime(this.createdOn),this.timeago=this.createdOnTime.fromNow(),this.time=this.createdOnTime.format("LLL"),this.userLink=this.PathHelper.userPath(this.author.idFromLink)}activityFromPath(e){var t=this.PathHelper.projectActivityPath(this.project);return e&&(t+="?from="+e),t}}h.\u0275fac=function(e){return new(e||h)(r.gc(s.a),r.gc(n.a),r.gc(a.a))},h.\u0275cmp=r.ac({type:h,selectors:[["authoring"]],inputs:{createdOn:"createdOn",author:"author",showAuthorAsLink:"showAuthorAsLink",project:"project",activity:"activity"},decls:5,vars:4,consts:[[1,"authoring-entry"],[3,"textContent",4,"ngIf"],["class","timestamp",4,"ngIf"],["class","timestamp",3,"textContent",4,"ngIf"],[3,"textContent"],[1,"timestamp"],[1,"timestamp",3,"textContent"]],template:function(e,t){1&e&&(r.mc(0,"div",0),r.Yc(1,o,1,1,"span",1),r.Yc(2,l,1,2,"a",1),r.Yc(3,d,2,3,"span",2),r.Yc(4,u,1,2,"span",3),r.lc()),2&e&&(r.Tb(1),r.Bc("ngIf",t.showAuthorAsLink),r.Tb(1),r.Bc("ngIf",!t.showAuthorAsLink),r.Tb(1),r.Bc("ngIf",t.activity),r.Tb(1),r.Bc("ngIf",!t.activity))},directives:[c.q],styles:['.timestamp[_ngcontent-%COMP%]:before{content:" ";white-space:pre}']})},"2orT":function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));i("ii2/");var n=i("wZYP"),s=i("fXoL"),a=i("ofXK"),r=i("Eofd"),c=i("0loS");const o=function(e){return{"icon4 icon-small icon-arrow-right5":e}},l=function(e){return{workPackageId:e}};function d(e,t){if(1&e&&(s.mc(0,"li",8),s.hc(1,"a",9),s.lc()),2&e){const e=s.wc(),t=e.first,i=e.$implicit;s.Bc("ngClass",s.Gc(4,o,!t)),s.Tb(1),s.Bc("textContent",i.name)("uiParams",s.Gc(6,l,i.id)),s.Ub("title",i.name)}}function u(e,t){if(1&e&&(s.kc(0),s.Yc(1,d,2,8,"li",7),s.jc()),2&e){const e=t.last;s.Tb(1),s.Bc("ngIf",!e)}}function h(e,t){if(1&e&&(s.kc(0),s.mc(1,"li"),s.mc(2,"span"),s.ad(3),s.lc(),s.lc(),s.Yc(4,u,2,1,"ng-container",6),s.jc()),2&e){const e=s.wc(2);s.Tb(3),s.cd("",e.hierarchyLabel,": "),s.Tb(1),s.Bc("ngForOf",e.workPackage.ancestors)}}const p=function(e,t){return{"active-parent-select":e,"icon4 icon-small icon-arrow-right5":t}};function g(e,t){if(1&e){const e=s.nc();s.mc(0,"div",1),s.mc(1,"ul",2),s.Yc(2,h,5,2,"ng-container",3),s.mc(3,"li",4),s.mc(4,"wp-breadcrumb-parent",5),s.uc("onSwitch",(function(t){return s.Qc(e),s.wc().updateActiveInput(t)})),s.lc(),s.lc(),s.lc(),s.lc()}if(2&e){const e=s.wc();s.Tb(2),s.Bc("ngIf",!e.inputActive&&e.hierarchyCount>0),s.Tb(1),s.Bc("ngClass",s.Hc(3,p,e.inputActive,!e.inputActive&&e.hierarchyCount>1)),s.Tb(1),s.Bc("workPackage",e.workPackage)}}class m{constructor(e){this.I18n=e,this.text={parent:this.I18n.t("js.relations_hierarchy.parent_headline"),hierarchy:this.I18n.t("js.relations_hierarchy.hierarchy_headline")},this.inputActive=!1}get hierarchyCount(){return this.workPackage.ancestors.length}get hierarchyLabel(){return 1===this.hierarchyCount?this.text.parent:this.text.hierarchy}updateActiveInput(e){this.inputActive=e}}m.\u0275fac=function(e){return new(e||m)(s.gc(n.a))},m.\u0275cmp=s.ac({type:m,selectors:[["wp-breadcrumb"]],inputs:{workPackage:"workPackage"},decls:1,vars:1,consts:[["class","wp-breadcrumb -show",4,"ngIf"],[1,"wp-breadcrumb","-show"],[1,"breadcrumb"],[4,"ngIf"],[3,"ngClass"],[3,"workPackage","onSwitch"],[4,"ngFor","ngForOf"],["class","wp-breadcrumb--ellipsed",3,"ngClass",4,"ngIf"],[1,"wp-breadcrumb--ellipsed",3,"ngClass"],["uiSref","work-packages.show.activity",1,"breadcrumb-project-title","nocut",3,"textContent","uiParams"]],template:function(e,t){1&e&&s.Yc(0,g,5,6,"div",0),2&e&&s.Bc("ngIf",t.workPackage)},directives:[a.q,a.n,r.a,a.p,c.AnchorUISref,c.UISref],styles:[".active-parent-select[_ngcontent-%COMP%]{min-width:320px}"]})},"2yvi":function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("8zkO"),s=i("wZYP"),a=(i("Mo6U"),i("kTsZ")),r=i("d/TE"),c=i("fXoL"),o=i("ofXK"),l=i("kor4"),d=i("N5AO");const u=["hiddenFileInput"],h=function(e){return{"-dragging":e}};function p(e,t){if(1&e){const e=c.nc();c.mc(0,"div",1),c.uc("drop",(function(t){return c.Qc(e),c.wc().onDropFiles(t)}))("dragover",(function(t){return c.Qc(e),c.wc().onDragOver(t)}))("dragleave",(function(t){return c.Qc(e),c.wc().onDragLeave(t)})),c.mc(1,"input",2,3),c.uc("change",(function(){return c.Qc(e),c.wc().onFilePickerChanged()})),c.lc(),c.mc(3,"div",4),c.uc("accessibleClick",(function(t){return c.Qc(e),c.wc().triggerFileInput(t)})),c.mc(4,"div",5),c.hc(5,"op-icon",6),c.mc(6,"label",7),c.ad(7),c.hc(8,"br"),c.ad(9),c.lc(),c.lc(),c.lc(),c.lc()}if(2&e){const e=c.wc();c.Ub("aria-label",e.text.uploadLabel),c.Tb(3),c.Bc("ngClass",c.Gc(4,h,e.draggingOver)),c.Tb(4),c.cd(" ",e.text.dropFiles," "),c.Tb(2),c.cd(" ",e.text.dropFilesHint," ")}}class g{constructor(e,t,i,n,s){this.I18n=e,this.ConfigurationService=t,this.notificationsService=i,this.elementRef=n,this.halResourceService=s,this.draggingOver=!1,this.text={uploadLabel:e.t("js.label_add_attachments"),dropFiles:e.t("js.label_drop_files"),dropFilesHint:e.t("js.label_drop_files_hint"),foldersWarning:e.t("js.label_drop_folders_hint")}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.ConfigurationService.initialized.then(()=>this.maxFileSize=this.ConfigurationService.maximumAttachmentFileSize)}triggerFileInput(e){return this.filePicker.nativeElement.click(),e.preventDefault(),e.stopPropagation(),!1}onDropFiles(e){e.dataTransfer.dropEffect="copy",e.preventDefault(),e.stopPropagation();let t=e.dataTransfer.files,i=t?t.length:0,n=[];for(let s=0;s<i;s++)n.push(t[s]);this.uploadFiles(n),this.draggingOver=!1}onDragOver(e){this.containsFiles(e.dataTransfer)&&(e.dataTransfer.dropEffect="copy",this.draggingOver=!0),e.preventDefault(),e.stopPropagation()}onDragLeave(e){this.draggingOver=!1,e.preventDefault(),e.stopPropagation()}onFilePickerChanged(){const e=Array.from(this.filePicker.nativeElement.files);this.uploadFiles(e)}containsFiles(e){return e.types.contains?e.types.contains("Files"):e.types.indexOf("Files")>=0}uploadFiles(e){const t=(e=e||[]).length;0!==(e=this.filterFolders(e)).length?this.resource.uploadAttachments(e):t>0&&this.notificationsService.addNotice(this.text.foldersWarning)}filterFolders(e){return e.filter(e=>""!==e.type||(0!==e.size&&4096!==e.size||(console.warn(`Skipping file because of file size (${e.size}) %O`,e),!1)))}}g.\u0275fac=function(e){return new(e||g)(c.gc(s.a),c.gc(n.a),c.gc(r.a),c.gc(c.q),c.gc(a.a))},g.\u0275cmp=c.ac({type:g,selectors:[["attachments-upload"]],viewQuery:function(e,t){var i;(1&e&&c.fd(u,!0),2&e)&&(c.Nc(i=c.vc())&&(t.filePicker=i.first))},inputs:{resource:"resource"},decls:1,vars:1,consts:[["class","wp-attachment-upload hide-when-print",3,"drop","dragover","dragleave",4,"ngIf"],[1,"wp-attachment-upload","hide-when-print",3,"drop","dragover","dragleave"],["type","file","id","attachment_files","name","attachment_files","hidden","","multiple","",3,"change"],["hiddenFileInput",""],["tabindex","0",1,"work-package--attachments--drop-box",3,"ngClass","accessibleClick"],[1,"work-package--attachments--label"],["icon-classes","icon-attachment"],["for","attachment_files"]],template:function(e,t){1&e&&c.Yc(0,p,10,6,"div",0),2&e&&c.Bc("ngIf",t.resource.canAddAttachments)},directives:[o.q,o.n,l.a,d.a],encapsulation:2})},"32V0":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("fXoL"),s=(i("V4eP"),i("ofXK")),a=i("/Rze"),r=i("N5AO");function c(e,t){if(1&e){const e=n.nc();n.mc(0,"div",2),n.mc(1,"accessible-by-keyboard",3),n.uc("execute",(function(){return n.Qc(e),n.wc().save()})),n.hc(2,"op-icon",4),n.lc(),n.mc(3,"accessible-by-keyboard",5),n.uc("execute",(function(){return n.Qc(e),n.wc().cancel()})),n.hc(4,"op-icon",6),n.lc(),n.lc()}if(2&e){const e=n.wc();n.Tb(1),n.Bc("linkTitle",e.saveTitle),n.Ub("disabled",e.field.required&&e.field.isEmpty()||void 0),n.Tb(1),n.Bc("icon-title",e.saveTitle),n.Tb(1),n.Bc("linkTitle",e.cancelTitle),n.Tb(1),n.Bc("icon-title",e.cancelTitle)}}class o{constructor(){this.onSave=new n.s,this.onCancel=new n.s}save(){this.onSave.emit()}cancel(){this.onCancel.emit()}}o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=n.ac({type:o,selectors:[["edit-field-controls"]],inputs:{cancelTitle:"cancelTitle",saveTitle:"saveTitle",field:["fieldController","field"]},outputs:{onSave:"onSave",onCancel:"onCancel"},decls:2,vars:1,consts:[[1,"inplace-edit--dashboard"],["class","inplace-edit--controls",4,"ngIf"],[1,"inplace-edit--controls"],[1,"inplace-edit--control","inplace-edit--control--save",3,"linkTitle","execute"],["icon-classes","icon-checkmark",3,"icon-title"],[1,"inplace-edit--control","inplace-edit--control--cancel",3,"linkTitle","execute"],["icon-classes","icon-close",3,"icon-title"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.Yc(1,c,5,5,"div",1),n.lc()),2&e&&(n.Tb(1),n.Bc("ngIf",t.field.handler.active))},directives:[s.q,a.a,r.a],encapsulation:2})},"3VS2":function(e,t,i){"use strict";i.d(t,"a",(function(){return _}));var n=i("JLFs");class s extends n.a{constructor(e,t,i){super(t,i),this.injector=e}}class a extends n.b{constructor(e,t,i,n){super(t,i,n),this.injector=e,this.basePath=t,this.resource=n}id(e){return new(this.resource||s)(this.injector,this.path,e)}}var r=i("mrSG"),c=i("tk/3"),o=i("6HfZ"),l=i("Ng29"),d=i("lJxs"),u=i("JIr8"),h=i("vLqr"),p=i("r0MM");class g{constructor(e,t){this.injector=e,this.resourceClass=t}get(e,t,i={}){const n={headers:i,params:new c.f({encoder:new l.a,fromObject:t}),withCredentials:!0,responseType:"json"};return this._request("get",e,n)}request(e,t,i={},n={}){if("get"===e)return this.get(t,i,n);const s={body:i||{},headers:n,withCredentials:!0,responseType:"json"};return this._request(e,t,s)}_request(e,t,i){return this.http.request(e,t,i).pipe(Object(d.a)(e=>this.deserialize(e)),Object(u.a)(i=>(console.error(`Failed to ${e} ${t}: ${i.name}`),Object(h.throwError)(i))))}deserialize(e){if(this.resourceClass){return new o.TypedJSON(this.resourceClass).parse(e)}return e}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",c.b)],g.prototype,"http",void 0);let m=class{};Object(r.c)([o.jsonMember,Object(r.e)("design:type",Number)],m.prototype,"project_id",void 0),Object(r.c)([o.jsonMember,Object(r.e)("design:type",String)],m.prototype,"name",void 0),m=Object(r.c)([o.jsonObject],m);var f=i("wd/R");let b=class{};Object(r.c)([Object(o.jsonArrayMember)(String),Object(r.e)("design:type",Array)],b.prototype,"topic_actions",void 0),Object(r.c)([Object(o.jsonArrayMember)(String),Object(r.e)("design:type",Array)],b.prototype,"topic_status",void 0),b=Object(r.c)([o.jsonObject],b);let w=class{};Object(r.c)([o.jsonMember,Object(r.e)("design:type",String)],w.prototype,"guid",void 0),Object(r.c)([o.jsonMember,Object(r.e)("design:type",String)],w.prototype,"topic_type",void 0),Object(r.c)([o.jsonMember,Object(r.e)("design:type",String)],w.prototype,"topic_status",void 0),Object(r.c)([o.jsonMember,Object(r.e)("design:type",String)],w.prototype,"priority",void 0),Object(r.c)([Object(o.jsonArrayMember)(String),Object(r.e)("design:type",Array)],w.prototype,"reference_links",void 0),Object(r.c)([o.jsonMember,Object(r.e)("design:type",String)],w.prototype,"title",void 0),Object(r.c)([Object(o.jsonMember)({preserveNull:!0}),Object(r.e)("design:type",Object)],w.prototype,"index",void 0),Object(r.c)([Object(o.jsonArrayMember)(String),Object(r.e)("design:type",Array)],w.prototype,"labels",void 0),Object(r.c)([Object(o.jsonMember)({deserializer:e=>f(e),serializer:e=>e.toISOString()}),Object(r.e)("design:type",Object)],w.prototype,"creation_date",void 0),Object(r.c)([o.jsonMember,Object(r.e)("design:type",String)],w.prototype,"creation_author",void 0),Object(r.c)([Object(o.jsonMember)({deserializer:e=>f(e),serializer:e=>e.toISOString()}),Object(r.e)("design:type",Object)],w.prototype,"modified_date",void 0),Object(r.c)([Object(o.jsonMember)({preserveNull:!0}),Object(r.e)("design:type",Object)],w.prototype,"modified_author",void 0),Object(r.c)([o.jsonMember,Object(r.e)("design:type",String)],w.prototype,"assigned_to",void 0),Object(r.c)([Object(o.jsonMember)({preserveNull:!0}),Object(r.e)("design:type",Object)],w.prototype,"stage",void 0),Object(r.c)([o.jsonMember,Object(r.e)("design:type",String)],w.prototype,"description",void 0),Object(r.c)([Object(o.jsonMember)({deserializer:e=>f(e),serializer:e=>e.format("YYYY-MM-DD")}),Object(r.e)("design:type",Object)],w.prototype,"due_date",void 0),Object(r.c)([o.jsonMember,Object(r.e)("design:type",b)],w.prototype,"authorization",void 0),w=Object(r.c)([o.jsonObject],w);class v extends s{constructor(){super(...arguments),this.bcfTopicService=new g(this.injector)}get(e={},t={}){return this.bcfTopicService.get(this.toPath(),e,t)}delete(e={}){return this.bcfTopicService.request("delete",this.toPath(),{},e)}}class y extends a{constructor(){super(...arguments),this.bcfTopicService=new g(this.injector)}get(e={},t={}){throw new Error("Not implemented")}post(e){return this.bcfTopicService.request("post",this.toPath(),e)}}class k extends s{constructor(){super(...arguments),this.bcfTopicService=new g(this.injector,w),this.comments=new a(this.injector,this.path,"comments"),this.viewpoints=new y(this.injector,this.path,"viewpoints",v)}get(e={},t={}){return this.bcfTopicService.get(this.toPath(),e,t)}}class C extends a{constructor(e,t,i){super(e,t,i,k),this.injector=e,this.basePath=t,this.bcfTopicService=new g(this.injector,w)}get(e={},t={}){throw new Error("Not implemented")}post(e){return this.bcfTopicService.request("post",this.toPath(),e)}}let j=class{};Object(r.c)([Object(o.jsonArrayMember)(String),Object(r.e)("design:type",Array)],j.prototype,"topic_actions",void 0),Object(r.c)([Object(o.jsonArrayMember)(String),Object(r.e)("design:type",Array)],j.prototype,"project_actions",void 0),Object(r.c)([Object(o.jsonArrayMember)(String),Object(r.e)("design:type",Array)],j.prototype,"comment_actions",void 0),j=Object(r.c)([o.jsonObject],j);class x extends s{constructor(){super(...arguments),this.bcfExtensionService=new g(this.injector,j)}get(e={},t={}){return this.bcfExtensionService.get(this.toPath(),e,t)}}class T extends s{constructor(){super(...arguments),this.bcfProjectService=new g(this.injector,m),this.topics=new C(this.injector,this.path,"topics"),this.extensions=new x(this.injector,this.path,"extensions")}get(e={},t={}){return this.bcfProjectService.get(this.toPath(),e,t)}}var S=i("fXoL");class _{constructor(e){this.injector=e,this.bcfApiVersion="2.1",this.appBasePath=window.appBasePath||"",this.bcfApiBase=`${this.appBasePath}/api/bcf/${this.bcfApiVersion}`,this.projects=new a(this.injector,this.bcfApiBase,"projects",T)}parse(e){if(!e.startsWith(this.bcfApiBase))throw new Error(`Cannot parse ${e} into BCF resource.`);const t=e.replace(this.bcfApiBase+"/","").split("/");let i=this;for(let n=0;n<t.length;n++){let e=t[n];if(e in i)i=i[e];else{if(!(i instanceof a))break;i=i.id(e)}}return i===this?void 0:i}}_.\u0275fac=function(e){return new(e||_)(S.qc(S.A))},_.\u0275prov=S.cc({token:_,factory:_.\u0275fac,providedIn:"root"})},"3uR5":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("Jui0"),s=i("PvNn"),a=i("fXoL");class r{constructor(e,t){this.pathHelper=e,this.colors=t}renderMultiple(e,t,i=!0,n=!1){const s=document.createElement("span");for(let a=0;a<t.length;a++){const e=document.createElement("span");if(n&&e.classList.add("user-avatar--multi-line"),this.render(e,t[a],i),!n&&a<t.length-1){const t=document.createElement("span");t.textContent=", ",e.appendChild(t)}s.appendChild(e)}e.appendChild(s)}render(e,t,i=!0,n="avatar-medium"){const s=this.getInitials(t.name),a=this.colors.toHsl(t.name);let r=document.createElement("div");if(r.className=n,r.classList.add("avatar-default"),r.textContent=s,r.style.background=a,e.appendChild(r),i){const i=document.createElement("span");i.textContent=t.name,e.appendChild(i)}if(!t.id)return;const c=new Image;c.className=n,c.classList.add("avatar--fallback"),c.src=this.pathHelper.api.v3.users.id(t.id).avatar.toString(),c.title=t.name,c.alt=t.name,c.onload=function(){r.replaceWith(c),r=void 0}}getInitials(e){var t,i;let n=[...e],s=e.lastIndexOf(" ");return[null===(t=n[0])||void 0===t?void 0:t.toUpperCase(),null===(i=e[s+1])||void 0===i?void 0:i.toUpperCase()].join("")}}r.\u0275fac=function(e){return new(e||r)(a.qc(n.a),a.qc(s.a))},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac,providedIn:"root"})},"4EDS":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n,s=i("Mo6U");!function(e){function t(e){return(t,i)=>!t&&!i||!!t&&!!i&&t[e]===i[e]}function i(e,t){return!e&&!t||!!e&&!!t&&e.$href===t.$href}e.halHref=function(e,t){return t.$href},e.compareByName=function(e,i){return t("name")(e,i)},e.compareByAttribute=t,e.trackByName=function(e,t){return _.get(t,"name")},e.trackByHref=function(e,t){return _.get(t,"href")},e.trackByProperty=function(e){return(t,i)=>_.get(i,e)},e.trackByHrefAndProperty=function(e){return(t,i)=>{let n=_.get(i,"href"),s=_.get(i,e,"none");return`${n}#${e}=${s}`}},e.trackByTrackingIdentifier=function(e,t){return _.get(t,"trackingIdentifier",t&&t.href)},e.compareByHref=i,e.compareByHrefOrString=function(e,t){return e instanceof s.a&&t instanceof s.a?i(e,t):!e&&!t||e===t}}(n||(n={}))},"4Obc":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));i("ii2/");var n=i("4zHP"),s=i("4EDS"),a=i("fXoL"),r=i("vd15"),c=i("ofXK"),o=i("Tcty");function l(e,t){if(1&e&&(a.mc(0,"div",3),a.hc(1,"activity-entry",4),a.lc()),2&e){const e=t.$implicit,i=a.wc(2);a.Tb(1),a.Bc("workPackage",i.workPackage)("activity",e.activity)("activityNo",e.number(e.isReversed))("isInitial",e.isInitial())}}function d(e,t){if(1&e&&(a.mc(0,"div",1),a.Yc(1,l,2,4,"div",2),a.lc()),2&e){const e=a.wc();a.Tb(1),a.Bc("ngForOf",e.latestActivityInfo)("ngForTrackBy",e.trackByHref)}}class u extends n.a{constructor(){super(...arguments),this.latestActivityInfo=[],this.trackByHref=s.a.trackByHref}ngOnInit(){this.workPackageId=this.workPackage.id,super.ngOnInit()}shouldShowToggler(){return!1}updateActivities(e){super.updateActivities(e),this.latestActivityInfo=this.latestActivities()}latestActivities(e=3){if(this.reverse){return this.unfilteredActivities.slice(0,e).map((e,t)=>this.info(e,t))}{let t=this.unfilteredActivities.slice(-e),i=this.unfilteredActivities.length-t.length;return t.map((e,t)=>this.info(e,i+t))}}}u.\u0275fac=function(e){return h(e||u)},u.\u0275cmp=a.ac({type:u,selectors:[["newest-activity-on-overview"]],inputs:{workPackage:"workPackage"},features:[a.Qb],decls:2,vars:1,consts:[[3,"workPackage"],[1,"work-package-details-activities-list"],["class","work-package-details-activities-activity",4,"ngFor","ngForOf","ngForTrackBy"],[1,"work-package-details-activities-activity"],[3,"workPackage","activity","activityNo","isInitial"]],template:function(e,t){1&e&&(a.mc(0,"work-package-comment",0),a.Yc(1,d,2,2,"ng-template"),a.lc()),2&e&&a.Bc("workPackage",t.workPackage)},directives:[r.a,c.p,o.a],encapsulation:2});const h=a.oc(u)},"4fM7":function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("Nolp"),s=i("fXoL"),a=i("ofXK"),r=i("711n"),c=i("XZlt"),o=i("aveh"),l=i("2bW2"),d=i("f24R");const u=function(){return["status","type"]};function h(e,t){if(1&e){const e=s.nc();s.mc(0,"div",1),s.mc(1,"edit-form",2),s.uc("onSaved",(function(t){return s.Qc(e),s.wc().onSaved(t)})),s.mc(2,"div",3),s.mc(3,"div",4),s.hc(4,"wp-type-status",5),s.mc(5,"div",6),s.mc(6,"a",7),s.uc("click",(function(){return s.Qc(e),s.wc().switchToFullscreen()})),s.hc(7,"span",8),s.lc(),s.lc(),s.lc(),s.hc(8,"wp-single-view",9),s.lc(),s.mc(9,"div",10),s.mc(10,"wp-edit-actions-bar",11),s.uc("onCancel",(function(){return s.Qc(e),s.wc().cancelAndBackToList()})),s.lc(),s.lc(),s.mc(11,"div",12),s.hc(12,"wp-resizer",13),s.lc(),s.lc(),s.lc()}if(2&e){const e=s.wc();s.Tb(1),s.Bc("resource",e.newWorkPackage)("skippedFields",s.Fc(8,u))("inEditMode",!0),s.Tb(3),s.Bc("workPackage",e.newWorkPackage),s.Tb(4),s.Bc("workPackage",e.newWorkPackage)("showProject",e.copying),s.Tb(4),s.Bc("elementClass","work-packages-partitioned-page--content-right")("localStorageKey","openProject-splitViewFlexBasis")}}class p extends n.a{}p.\u0275fac=function(e){return g(e||p)},p.\u0275cmp=s.ac({type:p,selectors:[["wp-copy-split-view"]],features:[s.Qb],decls:1,vars:1,consts:[["class","work-packages--details work-packages--new",4,"ngIf"],[1,"work-packages--details","work-packages--new"],[3,"resource","skippedFields","inEditMode","onSaved"],[1,"work-packages--details-content","-create-mode"],[1,"work-packages--new-details-header"],[3,"workPackage"],[1,"wp--details--switch-fullscreen-wrapper"],[1,"work-packages-show-view-button","wp--details--switch-fullscreen",3,"click"],[1,"icon-context","icon-to-fullscreen"],[3,"workPackage","showProject"],[1,"work-packages--details-toolbar-container"],[3,"onCancel"],[1,"work-packages--details--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"]],template:function(e,t){1&e&&s.Yc(0,h,13,9,"div",0),2&e&&s.Bc("ngIf",t.newWorkPackage)},directives:[a.q,r.a,c.a,o.a,l.a,d.a],encapsulation:2,changeDetection:0});const g=s.oc(p)},"4fzr":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("wZYP"),s=(i("ii2/"),i("Jui0")),a=i("VgZ9"),r=i("ug4p"),c=i("AEvm"),o=i("fXoL"),l=i("HEQ6"),d=i("t+3x");class u extends c.a{constructor(e,t,i,n){super(),this.wpRelationsHierarchyService=e,this.wpCacheService=t,this.PathHelper=i,this.I18n=n,this.showEditForm=!1,this.text={parentHeadline:this.I18n.t("js.relations_hierarchy.parent_headline"),childrenHeadline:this.I18n.t("js.relations_hierarchy.children_headline")}}ngOnInit(){this.workPackagePath=this.PathHelper.workPackagePath(this.workPackage.id),this.canModifyHierarchy=!!this.workPackage.changeParent,this.canAddRelation=!!this.workPackage.addRelation,this.childrenQueryProps={filters:JSON.stringify([{parent:{operator:"=",values:[this.workPackage.id]}}]),"columns[]":["id","type","subject","status"],showHierarchies:!1},this.wpCacheService.loadWorkPackage(this.workPackage.id).values$().pipe(this.untilDestroyed()).subscribe(e=>{var t,i;this.workPackage=e;let n=[],s=null===(i=null===(t=this.workPackage.parent)||void 0===t?void 0:t.id)||void 0===i?void 0:i.toString();s&&(n.push(s.toString()),this.wpCacheService.require(s).then(e=>{this.workPackage.parent=e})),this.wpCacheService.requireAll(n)})}}u.\u0275fac=function(e){return new(e||u)(o.gc(a.a),o.gc(r.a),o.gc(s.a),o.gc(n.a))},u.\u0275cmp=o.ac({type:u,selectors:[["wp-relations-hierarchy"]],inputs:{workPackage:"workPackage",relationType:"relationType"},features:[o.Qb],decls:6,vars:4,consts:[[1,"wp-relations-hierarchy-section","wp-relations--children"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],["wp-isolated-query-space",""],[3,"workPackage","addExistingChildEnabled","query"]],template:function(e,t){1&e&&(o.mc(0,"div",0),o.mc(1,"div",1),o.mc(2,"div",2),o.hc(3,"h3",3),o.lc(),o.lc(),o.kc(4,4),o.hc(5,"wp-children-query",5),o.jc(),o.lc()),2&e&&(o.Tb(3),o.Bc("textContent",t.text.childrenHeadline),o.Tb(2),o.Bc("workPackage",t.workPackage)("addExistingChildEnabled",!0)("query",t.childrenQueryProps))},directives:[l.a,d.a],encapsulation:2})},"4jc8":function(e,t,i){"use strict";i.d(t,"i",(function(){return s})),i.d(t,"h",(function(){return a})),i.d(t,"j",(function(){return r})),i.d(t,"m",(function(){return c})),i.d(t,"k",(function(){return o})),i.d(t,"l",(function(){return l})),i.d(t,"n",(function(){return u})),i.d(t,"e",(function(){return h})),i.d(t,"g",(function(){return p})),i.d(t,"a",(function(){return g})),i.d(t,"d",(function(){return m})),i.d(t,"c",(function(){return f})),i.d(t,"f",(function(){return b})),i.d(t,"b",(function(){return w}));var n=i("wd/R");const s="timeline-element",a="timeline-element--bg",r="wp-timeline--grid-element",c="selection-start",o="wp-timeline--header-element",l="wp-timeline-header";class d{constructor(){this.zoomLevel="days"}}const u=["days","weeks","months","quarters","years"];function h(e){switch(e){case"days":return 30;case"weeks":return 15;case"months":return 6;case"quarters":return 2;case"years":return.5}throw new Error("invalid zoom level: "+e)}const p=120;class g{constructor(){this.now=n({hour:0,minute:0,seconds:0}),this.dateDisplayStart=n({hour:0,minute:0,seconds:0}),this.dateDisplayEnd=this.dateDisplayStart.clone().add(1,"day"),this.settings=new d,this.activeSelectionMode=null,this.selectionModeStart=null}get pixelPerDay(){return h(this.settings.zoomLevel)}get maxWidthInPx(){return this.maxSteps*this.pixelPerDay}get maxSteps(){return this.dateDisplayEnd.diff(this.dateDisplayStart,"days")}get dayCountForMarginLeft(){return Math.ceil(p/this.pixelPerDay)}}function m(e,t){return t*e.pixelPerDay}function f(e,t){return m(e,t)+"px"}function b(e,t,i,s){const a=[],r=[],c=i.clone().startOf(t),o=s.clone().endOf(t);for(;c.isBefore(o);){const o=n.max(c,i).clone(),l=n.min(c.clone().endOf(t),s).clone();c.add(1,t);const d=e.visibleViewportAtCalculationTime;o.isSameOrAfter(d[0])&&o.isSameOrBefore(d[1])||l.isSameOrAfter(d[0])&&l.isSameOrBefore(d[1])?a.push([o,l]):r.push([o,l])}const l=r.splice(0,1)[0],d=r.pop();return{inViewportAndBoundaries:_.concat([l].filter(e=>!_.isNil(e)),a,[d].filter(e=>!_.isNil(e))),rest:r}}function w(e,t,i){let s=n(),a=n();return e.forEach(e=>{const i=e.workPackageId;if(!i)return;const r=t.get(i).value;if(!r)return;const c=r.startDate?r.startDate:r.date;c&&n(c).isBefore(s)&&(s=n(c));const o=r.dueDate?r.dueDate:r.date;o&&n(o).isAfter(a)&&(a=n(o))}),a.diff(s,"days")+1}},"4lR/":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("+rOU"),s=i("iB+3"),a=i("0lDN"),r=i("lfQJ"),c=i("E5Dd"),o=i("7ond"),l=i("fXoL");class d{constructor(e,t,i,s,a){this.componentFactoryResolver=e,this.FocusHelper=t,this.appRef=i,this.$transitions=s,this.injector=a,this.active=null,this.isOpening=!1;const r=this.portalHostElement=document.createElement("div");r.classList.add("op-context-menu--overlay"),document.body.appendChild(r),this.bodyPortalHost=new n.d(r,this.componentFactoryResolver,this.appRef,this.injector),s.onStart({},()=>this.close()),jQuery(window).on("keydown",e=>(this.active&&e.which===c.a.ESCAPE&&this.close(),!0));const o=this;document.getElementById("wrapper").addEventListener("click",(function(e){o.active&&!o.portalHostElement.contains(e.target)&&o.close()}),!0)}show(e,t,i=r.a){this.close(),this.isOpening=!0;const s=new n.c(i,null,this.injectorFor(e.locals));this.bodyPortalHost.attach(s),this.portalHostElement.style.display="block",this.active=e,setTimeout(()=>{this.reposition(t),this.active&&this.active.onOpen(this.activeMenu),this.isOpening=!1})}isActive(e){return this.active&&this.active===e}close(){this.isOpening||(this.bodyPortalHost.detach(),this.portalHostElement.style.display="none",this.active&&this.active.onClose(),this.active=null)}reposition(e){this.active&&this.activeMenu.position(this.active.positionArgs(e)).css("visibility","visible")}get activeMenu(){return jQuery(this.portalHostElement).find(".dropdown")}injectorFor(e){const t=new WeakMap;return e.service=this,t.set(a.a,e),new n.f(this.injector,t)}}d.\u0275fac=function(e){return new(e||d)(l.qc(l.l),l.qc(o.a),l.qc(l.f),l.qc(s.O),l.qc(l.A))},d.\u0275prov=l.cc({token:d,factory:d.\u0275fac,providedIn:"root"})},"4n9w":function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("ug4p"),s=i("XNiG"),a=i("kTsZ"),r=i("g1AQ"),c=i("fMMW"),o=i("SKFm"),l=i("pLZG"),d=i("E2tj"),u=i("5JuZ"),h=i("/C7M"),p=i("Kg8T"),g=i("AEvm"),m=i("fXoL");class f extends g.a{constructor(e,t,i,n,a,r,c,o,d){super(),this.injector=e,this.hooks=t,this.wpCacheService=i,this.halResourceService=n,this.querySpace=a,this.authorisationService=r,this.halEditing=c,this.workPackageDmService=o,this.halEvents=d,this.newWorkPackageCreatedSubject=new s.a,this.halEditing.comittedChanges.pipe(this.untilDestroyed(),Object(l.a)(e=>"WorkPackage"===e.resource._type&&e.wasNew)).subscribe(e=>{this.newWorkPackageCreated(e.resource)}),this.halEditing.changes$("/api/v3/work_packages/new").pipe(this.untilDestroyed(),Object(l.a)(e=>!e)).subscribe(()=>{this.reset()})}newWorkPackageCreated(e){this.reset(),this.newWorkPackageCreatedSubject.next(e)}onNewWorkPackage(){return this.newWorkPackageCreatedSubject.asObservable()}createNewWorkPackage(e){return this.getEmptyForm(e).then(e=>this.fromCreateForm(e))}createNewTypedWorkPackage(e,t){return this.workPackageDmService.typedCreateForm(t,e).then(e=>this.fromCreateForm(e))}fromCreateForm(e){let t=this.halResourceService.createHalResourceOfType("WorkPackage",e.payload.$plain());t.initializeNewResource(e);const i=this.halEditing.edit(t,e);return this.hooks.call("workPackageNewInitialization",i),i}copyWorkPackage(e){let t=e.pristineResource.$source;return this.workPackageDmService.emptyCreateForm(t).then(e=>this.fromCreateForm(e))}copyFrom(e){let t=this.halResourceService.createHalResourceOfType("WorkPackage",e.payload.$plain());return t.initializeNewResource(e),this.halEditing.edit(t,e)}getEmptyForm(e){return this.form||(this.form=this.workPackageDmService.emptyCreateForm({},e)),this.form}cancelCreation(){this.halEditing.stopEditing({href:"/api/v3/work_packages/new"}),this.reset()}changesetUpdates$(){return this.halEditing.state("/api/v3/work_packages/new").values$()}createOrContinueWorkPackage(e,t){let i=this.continueExistingEdit(t);return i||(i=this.createNewWithDefaults(e,t)),i.then(e=>(this.authorisationService.initModelAuth("work_package",e.pristineResource),this.halEditing.updateValue("/api/v3/work_packages/new",e),this.wpCacheService.updateWorkPackage(e.pristineResource),e))}reset(){this.wpCacheService.clearSome("new"),this.form=void 0}continueExistingEdit(e){const t=this.halEditing.state("/api/v3/work_packages/new").value;if(void 0!==t){const i=t.projectedResource.type,n=!t.isEmpty(),s=!i&&!e,a=e&&i&&i.idFromLink===e.toString();if(n&&(s||a))return Promise.resolve(t)}return null}createNewWithDefaults(e,t){let i=null;return i=t?this.createNewTypedWorkPackage(e,t):this.createNewWorkPackage(e),i.then(e=>{if(!e)throw"No new work package was created";let i=[];return t&&(i=["type"]),this.applyDefaults(e,e.projectedResource,i),e})}applyDefaults(e,t,i){let n=this.querySpace.query.value;if(n){new c.a(this.injector,e,n.filters,i).applyDefaultsFromFilters()}}}f.\u0275fac=function(e){return new(e||f)(m.qc(m.A),m.qc(r.a),m.qc(n.a),m.qc(a.a),m.qc(d.a),m.qc(p.a),m.qc(o.a),m.qc(u.a),m.qc(h.a))},f.\u0275prov=m.cc({token:f,factory:f.\u0275fac})},"4nS0":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("mrSG"),s=i("iMRi"),a=i("r0MM");class r{constructor(e,t){this.injector=e,this.workPackageTable=t}isApplicable(e){return!0}}Object(n.c)([Object(a.a)(),Object(n.e)("design:type",s.a)],r.prototype,"states",void 0)},"4rda":function(e,t,i){"use strict";i.d(t,"b",(function(){return c})),i.d(t,"a",(function(){return o}));var n=i("mrSG"),s=i("M0J3"),a=i("wZYP"),r=i("r0MM");const c="custom-option";class o extends s.a{constructor(e,t){super(),this.name=e,this.context=t,this.mode=null,this.activeChange=null,this.texts={empty:this.I18n.t("js.label_no_value"),placeholder:this.I18n.t("js.placeholders.default")}}apply(e,t){this.resource=e,this.schema=t}get isFormattable(){return!1}get injector(){return this.context.injector}get value(){return this.schema?this.activeChange?this.activeChange.projectedResource[this.name]:this.attribute:null}get attribute(){return this.resource[this.name]}get type(){return this.constructor.type}get valueString(){return this.value}get placeholder(){return"-"}get label(){return this.schema.name||this.name}get title(){return this.isFormattable?null:this.valueString}render(e,t,i={}){e.textContent=t}renderEmpty(e){const t=document.createElement("div");t.setAttribute("title",this.texts.empty),t.textContent=this.texts.placeholder,t.classList.add(c,"-empty"),e.appendChild(t)}}Object(n.c)([Object(r.a)(),Object(n.e)("design:type",a.a)],o.prototype,"I18n",void 0)},"4zHP":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("mMv8"),s=i("ug4p"),a=i("wZYP"),r=i("iB+3"),c=i("AEvm"),o=i("fXoL");class l extends c.a{constructor(e,t,i,n,s){super(),this.wpCacheService=e,this.I18n=t,this.cdRef=i,this.$transition=n,this.wpActivity=s,this.unfilteredActivities=[],this.visibleActivities=[],this.onlyComments=!1,this.text={commentsOnly:this.I18n.t("js.label_activity_show_only_comments"),showAll:this.I18n.t("js.label_activity_show_all")},this.reverse=s.isReversed,this.togglerText=this.text.commentsOnly}ngOnInit(){this.wpCacheService.observe(this.workPackageId).pipe(this.untilDestroyed()).subscribe(e=>{this.workPackage=e,this.wpActivity.require(this.workPackage).then(e=>{this.updateActivities(e),this.cdRef.detectChanges()})})}updateActivities(e){this.unfilteredActivities=e;const t=this.getVisibleActivities();this.visibleActivities=t.map((e,t)=>this.info(e,t)),this.showToggler=this.shouldShowToggler()}shouldShowToggler(){const e=this.unfilteredActivities.length,t=this.getActivitiesWithComments().length;return e>1&&t>0&&t<this.unfilteredActivities.length}getVisibleActivities(){return this.onlyComments?this.getActivitiesWithComments():this.unfilteredActivities}getActivitiesWithComments(){return this.unfilteredActivities.filter(e=>!!_.get(e,"comment.html"))}toggleComments(){this.onlyComments=!this.onlyComments,this.updateActivities(this.unfilteredActivities),this.onlyComments?this.togglerText=this.text.showAll:this.togglerText=this.text.commentsOnly}info(e,t){return this.wpActivity.info(this.unfilteredActivities,e,t)}}l.\u0275fac=function(e){return new(e||l)(o.gc(s.a),o.gc(a.a),o.gc(o.i),o.gc(r.J),o.gc(n.a))},l.\u0275dir=o.bc({type:l,features:[o.Qb]})},"5+Sy":function(e,t,i){"use strict";function n(e){return`wp-row-${e}-table`}function s(){return"wp-table--relations-aditional-row"}function a(e){return jQuery("."+n(e))}function r(e){return jQuery(`.${e}-table`)}function c(e,t){let i=e.previousElementSibling;for(;i;){if(i.matches(t))return i;i=i.previousElementSibling}return null}function o(e){try{const t=a(e),i=t.scrollParent(),n=i.scrollTop(),s=n+i.height(),r=t[0].offsetTop,c=r+t.height();r<n?i[0].scrollTop=r:c>s&&(i[0].scrollTop=c-i.height())}catch(t){console.warn("Can't scroll row element into view: "+t)}}i.d(t,"e",(function(){return n})),i.d(t,"d",(function(){return s})),i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return c})),i.d(t,"f",(function(){return o}))},"57Du":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("V4eP"),s=i("+rOU");function a(e,t,i,a){const r=new WeakMap;return r.set(n.b,t),r.set(n.c,i),r.set(n.d,a),new s.f(e,r)}},"59tY":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("AEvm"),s=i("fXoL"),a=i("wZYP"),r=i("juWA");class c extends n.a{constructor(e,t){super(),this.I18n=e,this.timezoneService=t}ngOnInit(){_.remove(this.filter.values,e=>!this.timezoneService.isValidISODateTime(e))}isoDateParser(e){if(!this.timezoneService.isValidISODate(e))return"";var t=this.timezoneService.parseISODatetime(e);return this.timezoneService.formattedISODateTime(t)}isoDateFormatter(e){if(!this.timezoneService.isValidISODateTime(e))return"";var t=this.timezoneService.parseISODatetime(e);return this.timezoneService.formattedISODate(t)}get isTimeZoneDifferent(){let e=this.lowerBoundary||this.upperBoundary;return!!e&&(0!==e.hours()||0!==e.minutes())}get timeZoneText(){return this.lowerBoundary&&this.upperBoundary?this.I18n.t("js.filter.time_zone_converted.two_values",{from:this.lowerBoundary.format("YYYY-MM-DD HH:mm"),to:this.upperBoundary.format("YYYY-MM-DD HH:mm")}):this.upperBoundary?this.I18n.t("js.filter.time_zone_converted.only_end",{to:this.upperBoundary.format("YYYY-MM-DD HH:mm")}):this.lowerBoundary?this.I18n.t("js.filter.time_zone_converted.only_start",{from:this.lowerBoundary.format("YYYY-MM-DD HH:mm")}):""}}c.\u0275fac=function(e){return new(e||c)(s.gc(a.a),s.gc(r.a))},c.\u0275dir=s.bc({type:c,features:[s.Qb]})},"5HGI":function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var n=i("mrSG"),s=i("wZYP"),a=i("E2tj"),r=i("qHU1"),c=i("iMRi"),o=i("ug4p"),l=i("8jMx"),d=i("4nS0"),u=i("xV+i"),h=i("0To3"),p=i("CBsm"),g=i("wyKs"),m=i("r0MM");class f extends h.a{constructor(e,t,i){super(e,t,i),this.injector=e,this.workPackageTable=t,this.rowBuilder=i,this.rendered={},this.additionalParents={},this.deferred={},this.parentsWithVisibleChildren={}}prepare(){super.prepare(),this.hierarchies=this.wpTableHierarchies.current,_.each(this.workPackageTable.originalRowIndex,e=>{e.object.ancestors.forEach(e=>{this.parentsWithVisibleChildren[e.id]=!0})}),this.rowBuilder.parentsWithVisibleChildren=this.parentsWithVisibleChildren}doRender(){this.workPackageTable.originalRows.forEach(e=>{const t=this.workPackageTable.originalRowIndex[e],i=t.object;if(!this.deferInsertion(i)){if(i.ancestors.length)this.buildWithHierarchy(t);else{let[e,n]=this.rowBuilder.buildEmpty(i);t.element=e,this.tableBody.appendChild(e),this.markRendered(e,i,n)}this.renderAllDeferredChildren(i)}})}deferInsertion(e){const t=e.ancestors;if(0===t.length)return!1;let i=t.concat([e]);for(let n=i.length-2;n>=0;--n){const e=i[n],t=this.workPackageTable.originalRowIndex[e.id];if(this.rendered[e.id])return!1;if(t){let t=this.deferred[e.id]||[],s=i.slice(n+1,i.length);return s=s.map(e=>this.wpCacheService.state(e.id).value),t=t.concat(s),this.deferred[e.id]=_.uniqBy(t,e=>e.id),!0}}return!1}renderAllDeferredChildren(e){const t=e.id;(this.deferred[t]||[]).forEach(t=>{this.insertUnderParent(this.getOrBuildRow(t),t.parent||e),this.renderAllDeferredChildren(t)})}getOrBuildRow(e){let t=this.workPackageTable.originalRowIndex[e.id];return t||(t={object:e}),t}buildWithHierarchy(e){const t=e.object.ancestors,i=[];t.forEach((e,n)=>{const s=this.states.workPackages.get(e.id).getValueOr(e);if(!this.rendered[s.id]){let[e,a]=this.rowBuilder.buildAncestorRow(s,i,n);if(0===n)this.tableBody.appendChild(e),this.markRendered(e,s,a,!0);else{const i=t[n-1];this.insertAtExistingHierarchy(s,e,i,a,!0)}this.additionalParents[s.id]=s}i.push(Object(p.c)(s.id)),t.slice(0,n).forEach(e=>{i.push(Object(p.c)(e.id))})});const n=_.last(t);this.insertUnderParent(e,n)}insertUnderParent(e,t){const[i,n]=this.rowBuilder.buildEmpty(e.object);e.element=i,this.insertAtExistingHierarchy(e.object,i,t,n,!1)}markRendered(e,t,i=!1,n=!1){this.rendered[t.id]=!0,this.renderedOrder.push(this.buildRenderInfo(e,t,i,n))}insertAtExistingHierarchy(e,t,i,n,s){const a=`.__hierarchy-root-${i.id}`,r=`.__hierarchy-group-${i.id}`;this.spliceRow(t,`${a},${r}`,this.buildRenderInfo(t,e,n,s)),this.rendered[e.id]=!0}buildRenderInfo(e,t,i,n){let s={element:e,classIdentifier:"",additionalClasses:[],workPackage:t,renderType:"primary",hidden:i},[a,r]=this.rowBuilder.ancestorRowData(t);return n?(s.additionalClasses=[u.b].concat(a),s.classIdentifier=Object(p.a)(t.id)):(s.additionalClasses=a,s.classIdentifier=this.rowBuilder.classIdentifier(t)),s}}Object(n.c)([Object(m.a)(),Object(n.e)("design:type",a.a)],f.prototype,"querySpace",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",c.a)],f.prototype,"states",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",o.a)],f.prototype,"wpCacheService",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",g.a)],f.prototype,"wpTableHierarchies",void 0);var b=i("JY8V");class w extends d.a{constructor(e,t){super(e,t),this.injector=e,this.workPackageTable=t}isApplicable(e){return this.wpTableHierarchies.isEnabled}buildRows(){const e=new u.a(this.injector,this.workPackageTable);return new f(this.injector,this.workPackageTable,e).render()}}Object(n.c)([Object(m.a)(),Object(n.e)("design:type",c.a)],w.prototype,"states",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",b.a)],w.prototype,"wpTableColumns",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",g.a)],w.prototype,"wpTableHierarchies",void 0);var v=i("6XbZ"),y=i("LHWx");class k extends d.a{constructor(e,t){super(e,t),this.injector=e}buildRows(){const e=new v.a(this.injector,this.workPackageTable);return new y.a(this.injector,this.workPackageTable,e).render()}}Object(n.c)([Object(m.a)(),Object(n.e)("design:type",s.a)],k.prototype,"I18n",void 0);var C=i("SKFm"),j=i("7ond"),x=i("Ie+Q"),T=i("pXZk"),S=i("e6KS"),P=i("V4eP");class I extends S.a{constructor(e,t,i,n){super(e),this.injector=e,this.table=t,this.workPackageId=i,this.classIdentifier=n,this.cellBuilder=new T.a(this.injector),this.resourceSubscription=this.wpCacheService.requireAndStream(this.workPackageId).subscribe(e=>this.resource=e)}destroy(){this.resourceSubscription.unsubscribe()}findContainer(e){return this.rowContainer.find(`.${T.c}.${e} .${T.b}`).first()}findCell(e){return this.rowContainer.find(`.${T.c}.${e}`).first()}activateField(e,t,i,n){return this.waitForContainer(i).then(s=>{const a=this.findCell(i);a.addClass(P.e);let r=parseInt(a.css("width"));return r=r>150?r-10:150,a.css("max-width",r+"px"),a.css("width",r+"px"),this.editingPortalService.create(s,this.injector,e,t,i,n)})}reset(e,t){const i=this.findContainer(e),n=this.findCell(e);i.length&&(this.findCell(e).css("width",""),this.findCell(e).css("max-width",""),this.cellBuilder.refresh(i[0],this.resource,e),n.removeClass(P.e),t&&this.FocusHelper.focusElement(i))}requireVisible(e){return this.wpTableColumns.addColumn(e),this.waitForContainer(e)}focusOnFirstError(){jQuery(this.table.tableAndTimelineContainer).find(".inline-edit--active-field.-error .inline-edit--field").first().trigger("focus")}waitForContainer(e){return new Promise((t,i)=>{const n=setInterval(()=>{const i=this.findContainer(e);i.length>0&&(clearInterval(n),t(i[0]))},100)})}get rowContainer(){return jQuery(this.table.tableAndTimelineContainer).find(`.${this.classIdentifier}-table`)}}Object(n.c)([Object(m.a)(),Object(n.e)("design:type",b.a)],I.prototype,"wpTableColumns",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",o.a)],I.prototype,"wpCacheService",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",c.a)],I.prototype,"states",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",j.a)],I.prototype,"FocusHelper",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",x.a)],I.prototype,"editingPortalService",void 0);class O{constructor(e,t){this.table=e,this.injector=t,this.forms={}}reset(){_.each(this.forms,e=>e.destroy()),this.forms={}}change(e){return this.halEditing.typedState(e).value}stopEditing(e){this.halEditing.stopEditing(e);const t=this.forms[e.id];t&&(t.destroy(),delete this.forms[e.id])}startEditing(e,t){const i=e.id,n=this.forms[i];return n||(this.forms[i]=new I(this.injector,this.table,i,t))}}Object(n.c)([Object(m.a)(),Object(n.e)("design:type",C.a)],O.prototype,"halEditing",void 0);class R{constructor(e,t,i,n,s,a,r){this.injector=e,this.tableAndTimelineContainer=t,this.scrollContainer=i,this.tbody=n,this.timelineBody=s,this.timelineController=a,this.configuration=r,this.originalRows=[],this.originalRowIndex={},this.builders=[new w(this.injector,this),new l.a(this.injector,this),new k(this.injector,this)],this.lastRenderPass=null,this.editing=new O(this,this.injector)}get renderedRows(){return this.querySpace.tableRendered.getValueOr([])}findRenderedRow(e){const t=_.findIndex(this.renderedRows,t=>t.classIdentifier===e);return[t,this.renderedRows[t]]}get rowBuilder(){return _.find(this.builders,e=>e.isApplicable(this))}buildIndex(e){this.originalRowIndex={},this.originalRows=e.map((e,t)=>{let i=e.id;return e=this.wpCacheService.current(i,e),this.originalRowIndex[i]={object:e,workPackageId:i,position:t},i})}initialSetup(e){this.buildIndex(e),this.redrawTableAndTimeline()}redrawTableAndTimeline(){const e=this.performRenderPass(!1);requestAnimationFrame(()=>{this.tbody.innerHTML="",this.timelineBody.innerHTML="",this.tbody.appendChild(e.tableBody),this.timelineBody.appendChild(e.timeline.timelineBody),setTimeout(()=>this.querySpace.tableRendered.putValue(e.result))})}redrawTable(){const e=this.performRenderPass();this.querySpace.tableRendered.putValue(e.result)}refreshRows(e){const t=this.lastRenderPass;t?_.each(t.renderedOrder,i=>{i.workPackage&&i.workPackage.id===e.id&&(Object(r.a)(`Refreshing rendered row ${i.classIdentifier}`),i.workPackage=e,t.refresh(i,e,this.tbody))}):Object(r.a)("Trying to refresh a singular row without a previous render pass.")}get renderPlaceholderRow(){return this.configuration.dragAndDropEnabled}performRenderPass(e=!0){this.editing.reset();const t=this.lastRenderPass=this.rowBuilder.buildRows();return e&&requestAnimationFrame(()=>{this.tbody.innerHTML="",this.tbody.appendChild(t.tableBody)}),t}}Object(n.c)([Object(m.a)(),Object(n.e)("design:type",a.a)],R.prototype,"querySpace",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",o.a)],R.prototype,"wpCacheService",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",c.a)],R.prototype,"states",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",s.a)],R.prototype,"I18n",void 0)},"5JuZ":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("kTsZ"),s=i("Jui0"),a=i("iMRi"),r=i("RhL0"),c=i("fXoL");class o{constructor(e,t,i){this.halResourceService=e,this.pathHelper=t,this.states=i}loadWorkPackageById(e,t=!1){const i=this.pathHelper.api.v3.work_packages.id(e).toString();return this.halResourceService.get(i).toPromise()}loadWorkPackagesCollectionsFor(e){return this.halResourceService.getAllPaginated(this.pathHelper.api.v3.work_packages.toString(),e.length,{filters:Object(r.b)("id","=",e).toJson()})}emptyCreateForm(e,t){return this.halResourceService.post(this.workPackagesFormPath(t),e).toPromise()}typedCreateForm(e,t){const i={_links:{type:{href:this.pathHelper.api.v3.types.id(e).toString()}}};return this.halResourceService.post(this.workPackagesFormPath(t),i).toPromise()}createWorkPackage(e){return this.halResourceService.post(this.pathHelper.api.v3.work_packages.path,e).toPromise()}workPackagesFormPath(e){return e?this.pathHelper.api.v3.projects.id(e).work_packages.form.toString():this.pathHelper.api.v3.work_packages.form.toString()}}o.\u0275fac=function(e){return new(e||o)(c.qc(n.a),c.qc(s.a),c.qc(a.a))},o.\u0275prov=c.cc({token:o,factory:o.\u0275fac})},"5Lfy":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("IaZ+"),s=i("SqdZ"),a=i("wZYP"),r=i("fXoL");class c extends s.a{constructor(e,t,i,n){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.I18n=n,this.closeOnOutsideClick=!1}ngOnInit(){super.ngOnInit(),this.$element.find(".dynamic-content-modal--wrapper").addClass(this.locals.modalClassName).append(this.locals.modalBody),jQuery(document.body).on("click.opdynamicmodal",".dynamic-content-modal--close-button",e=>{this.closeMe(e)})}ngOnDestroy(){jQuery(document.body).off("click.opdynamicmodal"),super.ngOnDestroy()}}c.\u0275fac=function(e){return new(e||c)(r.gc(r.q),r.gc(n.a),r.gc(r.i),r.gc(a.a))},c.\u0275cmp=r.ac({type:c,selectors:[["ng-component"]],features:[r.Qb],decls:2,vars:0,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","dynamic-content-modal--wrapper","loading-indicator--location"]],template:function(e,t){1&e&&(r.mc(0,"div",0),r.hc(1,"div",1),r.lc())},encapsulation:2})},"5Mgc":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("Jui0"),s=i("fXoL");class a{constructor(e){this.PathHelper=e}create(e,t,i,n=null){const s="constrained"===e?window.OPConstrainedEditor:window.OPClassicEditor;t.classList.add(`ckeditor-type-${e}`);const a=t.querySelector(".document-editor__toolbar"),r=t.querySelector(".document-editor__editable");var c=i.options&&i.options.rtl?"ar":"en";return s.createCustomized(r,{openProject:this.createConfig(i),initialData:n,language:{content:c}}).then(e=>(a.appendChild(e.ui.view.toolbar.element),jQuery(t).on("op:ckeditor:setData",(t,i)=>e.setData(i)).on("op:ckeditor:clear",t=>e.setData(" ")).on("op:ckeditor:getData",(t,i)=>i(e.getData({trim:!1}))),e))}createConfig(e){return"none"===e.macros?e.macros=!1:"wp"===e.macros?e.macros=["OPMacroToc","OPMacroEmbeddedTable","OPMacroWpButton"]:e.macros=e.macros,{context:e,helpURL:this.PathHelper.textFormattingHelp(),pluginContext:window.OpenProject.pluginContext.value}}}a.\u0275fac=function(e){return new(e||a)(s.qc(n.a))},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac})},"5btT":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("8ocD"),s=i("fXoL");class a extends n.a{}a.\u0275fac=function(e){return r(e||a)},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac,providedIn:"root"});const r=s.oc(a)},"5gqY":function(e,t,i){"use strict";i.d(t,"b",(function(){return k})),i.d(t,"a",(function(){return C}));var n=i("iMRi"),s=i("iB+3"),a=i("0bag"),r=i("Y0Nk"),c=i("wZYP"),o=i("Jui0"),l=i("kTg4"),d=i("13ri"),u=i("sjKJ"),h=i("E5Dd"),p=i("Sulb"),g=i("K018"),m=i("AEvm"),f=i("fXoL"),b=i("ofXK");const w=["wpQueryMenuSearchInput"],v=["queryResultsContainer"];function y(e,t){1&e&&(f.mc(0,"div",11),f.hc(1,"div",12),f.hc(2,"div",13),f.hc(3,"div",14),f.hc(4,"div",15),f.hc(5,"div",16),f.lc())}const k="wp-query-select";class C extends m.a{constructor(e,t,i,n,s,a,r,c,o,l,d,u,h,p){super(),this.ref=e,this.element=t,this.QueryDm=i,this.$state=n,this.$transitions=s,this.I18n=a,this.states=r,this.CurrentProject=c,this.loadingIndicator=o,this.pathHelper=l,this.wpStaticQueries=d,this.mainMenuService=u,this.toggleService=h,this.cdRef=p,this.loading=!1,this.noResults=!1,this.text={search:this.I18n.t("js.toolbar.search_query_label"),label:this.I18n.t("js.toolbar.search_query_label"),scope_default:this.I18n.t("js.label_default_queries"),scope_starred:this.I18n.t("js.label_starred_queries"),scope_global:this.I18n.t("js.label_global_queries"),scope_private:this.I18n.t("js.label_custom_queries"),no_results:this.I18n.t("js.work_packages.query.text_no_results")},this.hiddenCategories=[],this.reportsBodySelector=".controller-work_packages\\/reports",this.initialized=!1}ngOnInit(){this.queryResultsContainer=jQuery(this._queryResultsContainerElement.nativeElement),this.projectIdentifier=this.element.nativeElement.getAttribute("data-project-identifier"),this.mainMenuService.onActivate("work_packages","work_packages_query_select").subscribe(()=>this.initializeAutocomplete()),this.addClickHandler(),this.cdRef.detach()}ngOnDestroy(){super.ngOnDestroy(),this.unregisterTransitionListener()}initializeAutocomplete(){this.initialized||(this.searchInput=jQuery(this._wpQueryMenuSearchInput.nativeElement),this.buttonArrowLeft=jQuery(".main-menu--arrow-left-to-project",jQuery("#main-menu-work-packages-wrapper").parent()),this.initialized=!0,this.buttonArrowLeft.focus(),this.setupAutoCompletion(this.searchInput),this.updateMenuOnChanges(),this.loadQueries())}transformQueries(e){const t=e.elements.map(e=>({label:e.name,query:e,query_props:null})).concat(this.wpStaticQueries.all);return this.sortQueries(t)}sortQueries(e){let t={starred:[],default:[],public:[],private:[]},i=0;return e.forEach(e=>(e.auto_id=i++,e.query?e.query.starred?(e.category="starred",t.starred.push(e)):!e.query.starred&&e.query.public?(e.category="public",t.public.push(e)):e.query.starred||e.query.public?void 0:(e.category="private",t.private.push(e)):(e.category="default",t.default.push(e)))),_.flatten([t.starred,t.default,t.public,t.private].map(e=>this.sortByLabel(e)))}sortByLabel(e){return e.sort((e,t)=>e.label.toLowerCase().localeCompare(t.label.toLowerCase()))}loadQueries(){return this.loadingPromise=this.QueryDm.listNonHidden(this.CurrentProject.identifier).then(e=>{this.searchInput.querycomplete("option",{source:this.transformQueries(e)}),this.searchInput.querycomplete("search",this.searchInput.val()),_.each(this.hiddenCategories,e=>{let t=jQuery(e).attr("category");this.expandCollapseCategory(t)}),this.ref.detectChanges()})}set loadingPromise(e){this.loading=!0,e.then(()=>{this.loading=!1,this.cdRef.detectChanges()}).catch(()=>{this.loading=!1,this.cdRef.detectChanges()})}setupAutoCompletion(e){this.defineJQueryQueryComplete(),e.querycomplete({delay:100,source:[],select:(e,t)=>!1,response:(e,t)=>{this.noResults=0===t.content.length},close:(e,t)=>{const i=this.queryResultsContainer.find("ul.ui-autocomplete");i.is(":visible")||this.noResults||i.show()},focus:(e,t)=>{let i=e;for(;i&&i.originalEvent;)i=i.originalEvent;return i&&"keydown"===i.type&&this.queryResultsContainer.find(`#wp-query-menu-item-${t.item.auto_id} .wp-query-menu--item-link`).focus(),!1},appendTo:".wp-query-menu--results-container",classes:{"ui-autocomplete":"wp-query-menu--search-ul -inplace","ui-menu-divider":"wp-query-menu--category-icon"},autoFocus:!1,minLength:0})}defineJQueryQueryComplete(){let e=this;jQuery.widget("custom.querycomplete",jQuery.ui.autocomplete,{_create:function(){this._super(),this.widget().menu("option","items",".wp-query-menu--item"),this._search("")},_renderItem:function(t,i){const n=jQuery("<a>").addClass("wp-query-menu--item-link").attr("href",e.buildQueryItemUrl(i)).text(i.label),s=jQuery("<li>").addClass("ui-menu-item wp-query-menu--item").attr("id",`wp-query-menu-item-${i.auto_id}`).attr("data-category",i.category||"").data("ui-autocomplete-item",i).append(n).appendTo(t);return e.setInitialHighlighting(s,i),s},_renderMenu:function(t,i){let n;if(_.each(i,i=>{if(i.category!==n){n=i.category;let s=e.labelFunction(n);t.append(`<a tabindex="0" class="wp-query-menu--category-icon wp-query-menu--category-toggle" data-category="${n}" aria-hidden="true"></a>`),jQuery("<li>").addClass("ui-autocomplete--category wp-query-menu--category-toggle ellipsis").attr("title",s).attr("data-category",n).text(s).appendTo(t)}this._renderItemData(t,i)}),""===e.searchInput.val()){let t=e.queryResultsContainer.find(".wp-query-menu--item.selected");t.length>0&&setTimeout(()=>t[0].scrollIntoView({behavior:"auto",block:"center"}),20)}}})}setInitialHighlighting(e,t){const i=this.getQueryParams(t),n=this.$state.params.query_id,s=this.$state.params.query_props;let a=this.$state.includes("work-packages"),r=jQuery("body").hasClass("controller-work_packages/reports");const c=i.query_id&&(n||"").toString()===i.query_id.toString(),o=!t.query&&t.query_props&&t.query_props===s,l=a&&!n&&!s&&"all_open"===t.identifier,d=r&&"summary"===t.identifier;(c||o||l||d)&&e.addClass("selected")}labelFunction(e){switch(e){case"starred":return this.text.scope_starred;case"public":return this.text.scope_global;case"private":return this.text.scope_private;case"default":return this.text.scope_default;default:return""}}updateMenuOnChanges(){this.states.changes.queries.pipe(this.untilDestroyed()).subscribe(()=>this.loadQueries())}expandCollapseCategory(e){jQuery(`[data-category="${e}"]`).not(".ui-autocomplete--category").toggleClass("-hidden"),jQuery(`.wp-query-menu--category-icon[data-category="${e}"]`).toggleClass("-collapsed")}loadQuery(e){const t=this.getQueryParams(e);this.$state.go("work-packages.partitioned.list",t,{reload:!0}),this.toggleService.closeWhenOnMobile()}getQueryParams(e){let t={query_id:e.query?_.toString(e.query.id):null,query_props:e.query?null:e.query_props};return this.projectIdentifier&&(t.projects="projects",t.projectPath=this.projectIdentifier),t}buildQueryItemUrl(e){if(e.static_link)return e.static_link;const t=this.getQueryParams(e);return this.$state.href("work-packages.partitioned.list",t)}highlightSelected(e){this.highlightBySelector(`#wp-query-menu-item-${e.auto_id}`)}highlightBySelector(e){this.queryResultsContainer.find(".ui-menu-item").removeClass("selected"),this.queryResultsContainer.find(e).addClass("selected")}addClickHandler(){this.queryResultsContainer.on("click keydown",".ui-menu-item a",e=>{if("keydown"===e.type&&e.which!==h.a.ENTER)return!0;const t=jQuery(e.target),i=t.closest(".wp-query-menu--item").data("ui-autocomplete-item"),n="click"===e.type&&d.a.isClickedWithModifier(e),s=!!i.static_link;return n||s?(e.stopImmediatePropagation(),"keydown"===e.type&&(window.location.href=t.attr("href")),!0):(e.preventDefault(),this.loadQuery(i),this.highlightSelected(i),!1)}).on("click keydown",".wp-query-menu--category-toggle",e=>{if("keydown"===e.type&&e.which!==h.a.ENTER)return!0;const t=jQuery(e.target).data("category");return t&&this.expandCollapseCategory(t),this.hiddenCategories=this.queryResultsContainer.find(".ui-autocomplete--category.hidden"),e.preventDefault(),!1})}}C.\u0275fac=function(e){return new(e||C)(f.gc(f.i),f.gc(f.q),f.gc(a.a),f.gc(s.G),f.gc(s.O),f.gc(c.a),f.gc(n.a),f.gc(u.a),f.gc(r.a),f.gc(o.a),f.gc(l.a),f.gc(g.a),f.gc(p.a),f.gc(f.i))},C.\u0275cmp=f.ac({type:C,selectors:[["wp-query-select"]],viewQuery:function(e,t){var i;(1&e&&(f.Wc(w,!0),f.Wc(v,!0)),2&e)&&(f.Nc(i=f.vc())&&(t._wpQueryMenuSearchInput=i.first),f.Nc(i=f.vc())&&(t._queryResultsContainerElement=i.first))},features:[f.Qb],decls:11,vars:5,consts:[["id","querySelectDropdown",1,"wp-query-menu--container"],[1,"wp-query-menu--search-container"],[1,"wp-query-menu--search-bar"],["for","query-title-filter",1,"hidden-for-sighted",3,"textContent"],["type","text","name","query-title-filter","id","query-title-filter",1,"wp-query-menu--search-input","ui-autocomplete--input","ellipsis"],["wpQueryMenuSearchInput",""],[1,"icon-search","wp-query-menu--search-icon"],[1,"wp-query-menu--results-container"],["queryResultsContainer",""],[1,"wp-query-menu--no-results-container",3,"hidden","textContent"],["class","loading-indicator -compact",4,"ngIf"],[1,"loading-indicator","-compact"],[1,"block-1"],[1,"block-2"],[1,"block-3"],[1,"block-4"],[1,"block-5"]],template:function(e,t){1&e&&(f.mc(0,"div",0),f.mc(1,"div",1),f.mc(2,"div",2),f.hc(3,"label",3),f.hc(4,"input",4,5),f.hc(6,"i",6),f.lc(),f.mc(7,"div",7,8),f.hc(9,"p",9),f.Yc(10,y,6,0,"div",10),f.lc(),f.lc(),f.lc()),2&e&&(f.Tb(3),f.Bc("textContent",t.text.label),f.Tb(1),f.Ub("placeholder",t.text.search),f.Tb(5),f.Bc("hidden",!t.noResults||t.loading)("textContent",t.text.no_results),f.Tb(1),f.Bc("ngIf",t.loading))},directives:[b.q],encapsulation:2,changeDetection:0})},"5iud":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r}));const n=".work-packages-tabletimeline--timeline-side";function s(e){if(0===e)return e;let t=15;return e<0&&(t*=-1),t}function a(e,t,i){const n=e.target,a=e.originalEvent;let[r,c]=function(e){let t=e.deltaX,i=e.deltaY;return e.shiftKey&&(t=i,i=0),[t,i]}(a);0!==c&&(r=s(r),c=s(c),window.requestAnimationFrame((function(){t[0].scrollTop=t[0].scrollTop+c,i[0].scrollTop=i[0].scrollTop+c,n.scrollLeft=n.scrollLeft+r})))}function r(e){var t=jQuery(e).find(".work-packages-tabletimeline--table-side"),i=jQuery(e).find(n);return e=>{var n=!1,s=!1;e?(t.on("wheel.scroll-sync",e=>{a(e,t,i)}),t.on("scroll.scroll-sync",e=>{n=!0,s||(i[0].scrollTop=e.target.scrollTop),n&&s&&(n=!1,s=!1)}),i.on("wheel.scroll-sync",e=>{a(e,t,i)}),i.on("scroll.scroll-sync",e=>{s=!0,n||(t[0].scrollTop=e.target.scrollTop),n&&s&&(n=!1,s=!1)})):t.off(".scroll-sync")}}},"5mBr":function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));i("Mo6U");var n=i("kTsZ"),s=i("pLZG"),a=i("iMRi"),r=i("4EDS"),c=i("AEvm"),o=i("fXoL"),l=i("ofXK"),d=i("wZYP"),u=i("Jui0"),h=i("POAS"),p=i("th4C"),g=i("N5AO"),m=i("2hMx");const f=function(e){return{fileName:e}};function b(e,t){if(1&e){const e=o.nc();o.mc(0,"a",7),o.uc("click",(function(t){return o.Qc(e),o.wc().confirmRemoveAttachment(t)})),o.hc(1,"op-icon",8),o.lc()}if(2&e){const e=o.wc();o.Tb(1),o.Bc("icon-title",e.text.removeFile(o.Gc(1,f,e.attachment.fileName)))}}class w{constructor(e,t,i,n){this.halNotification=e,this.I18n=t,this.states=i,this.pathHelper=n,this.destroyImmediately=!0,this.removeAttachment=new o.s,this.text={dragHint:this.I18n.t("js.attachments.draggable_hint"),destroyConfirmation:this.I18n.t("js.text_attachment_destroy_confirmation"),removeFile:e=>this.I18n.t("js.label_remove_file",e)}}setDragData(e){const t=this.downloadPath,i=this.draggableHTML(t);e.dataTransfer.setData("text/plain",t),e.dataTransfer.setData("text/html",i.outerHTML),e.dataTransfer.setData("text/uri-list",t),e.dataTransfer.setDragImage(i,0,0)}draggableHTML(e){let t;return this.isImage?(t=document.createElement("img"),t.src=e,t.textContent=this.fileName):(t=document.createElement("a"),t.href=e,t.textContent=this.fileName),t}get downloadPath(){return this.pathHelper.attachmentDownloadPath(this.attachment.id,this.fileName)}get isImage(){const e=this.fileName.split(".").pop()||"";return w.imageFileExtensions.indexOf(e.toLowerCase())>-1}get fileName(){const e=this.attachment;return e.fileName||e.customName||e.name}confirmRemoveAttachment(e){return window.confirm(this.text.destroyConfirmation)?(this.removeAttachment.emit(),this.destroyImmediately&&this.resource.removeAttachment(this.attachment),!1):(e.stopImmediatePropagation(),e.preventDefault(),!1)}}function v(e,t){if(1&e){const e=o.nc();o.mc(0,"ul",3),o.mc(1,"attachment-list-item",4),o.uc("removeAttachment",(function(){o.Qc(e);const i=t.$implicit;return o.wc(2).removeAttachment(i)})),o.lc(),o.lc()}if(2&e){const e=t.$implicit,i=t.index,n=o.wc(2);o.Tb(1),o.Bc("attachment",e)("resource",n.resource)("index",i)("destroyImmediately",n.destroyImmediately)}}function y(e,t){if(1&e&&(o.mc(0,"div",1),o.Yc(1,v,2,4,"ul",2),o.lc()),2&e){const e=o.wc();o.Tb(1),o.Bc("ngForOf",e.attachments)("ngForTrackBy",e.trackByHref)}}w.imageFileExtensions=["jpeg","jpg","gif","bmp","png"],w.\u0275fac=function(e){return new(e||w)(o.gc(h.a),o.gc(d.a),o.gc(a.a),o.gc(u.a))},w.\u0275cmp=o.ac({type:w,selectors:[["attachment-list-item"]],inputs:{resource:"resource",attachment:"attachment",index:"index",destroyImmediately:"destroyImmediately"},outputs:{removeAttachment:"removeAttachment"},decls:8,vars:9,consts:[["focus-within","","draggable","true","focusWithinSelector",".inplace-editing--trigger-icon",1,"form--selected-value--container","work-package--attachments--draggable-item",3,"title","dragstart"],[1,"form--selected-value"],["icon-classes","icon-context icon-attachment"],["target","_blank","rel","noopener",1,"work-package--attachments--filename"],[1,"work-package--attachments--info",3,"createdOn","author","showAuthorAsLink"],["href","","class","form--selected-value--remover work-package--atachments--delete-button",3,"click",4,"ngIf"],["type","hidden",3,"name","value"],["href","",1,"form--selected-value--remover","work-package--atachments--delete-button",3,"click"],["icon-classes","icon-delete",3,"icon-title"]],template:function(e,t){1&e&&(o.mc(0,"li",0),o.uc("dragstart",(function(e){return t.setDragData(e)})),o.mc(1,"span",1),o.hc(2,"op-icon",2),o.mc(3,"a",3),o.ad(4),o.hc(5,"authoring",4),o.lc(),o.lc(),o.Yc(6,b,2,3,"a",5),o.hc(7,"input",6),o.lc()),2&e&&(o.Bc("title",t.text.dragHint),o.Tb(3),o.Ub("href",t.downloadPath||"#",o.Tc),o.Tb(1),o.cd(" ",t.attachment.fileName||t.attachment.customName||t.attachment.name," "),o.Tb(1),o.Bc("createdOn",t.attachment.createdAt)("author",t.attachment.author)("showAuthorAsLink",!1),o.Tb(1),o.Bc("ngIf",!!t.attachment.$links.delete),o.Tb(1),o.Dc("name","attachments[",t.index,"][id]"),o.Cc("value",t.attachment.id))},directives:[p.a,g.a,m.a,l.q],encapsulation:2});class k extends c.a{constructor(e,t,i,n){super(),this.elementRef=e,this.states=t,this.cdRef=i,this.halResourceService=n,this.destroyImmediately=!0,this.trackByHref=r.a.trackByHref,this.attachments=[],this.deletedAttachments=[]}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.updateAttachments(),this.setupResourceUpdateListener(),this.destroyImmediately||this.setupAttachmentDeletionCallback()}setupResourceUpdateListener(){this.states.forResource(this.resource).values$().pipe(this.untilDestroyed(),Object(s.a)(e=>!!e)).subscribe(e=>{this.resource=e||this.resource,this.updateAttachments(),this.cdRef.detectChanges()})}ngOnDestroy(){super.ngOnDestroy(),this.destroyImmediately||this.$formElement.off("submit.attachment-component")}removeAttachment(e){this.deletedAttachments.push(e);let t=this.attachments.filter(t=>t!==e);this.attachments.length=0,this.attachments.push(...t),this.cdRef.detectChanges()}get attachmentsUpdatable(){return this.resource.attachments&&this.resource.attachmentsBackend}setupAttachmentDeletionCallback(){this.$formElement=this.$element.closest("form"),this.$formElement.on("submit.attachment-component",()=>{this.destroyRemovedAttachments()})}destroyRemovedAttachments(){this.deletedAttachments.forEach(e=>{this.resource.removeAttachment(e)})}updateAttachments(){this.attachmentsUpdatable?this.resource.attachments.updateElements().then(()=>{this.attachments=this.resource.attachments.elements,this.cdRef.detectChanges()}):this.attachments=this.resource.attachments.elements}}k.\u0275fac=function(e){return new(e||k)(o.gc(o.q),o.gc(a.a),o.gc(o.i),o.gc(n.a))},k.\u0275cmp=o.ac({type:k,selectors:[["attachment-list"]],inputs:{resource:"resource",destroyImmediately:"destroyImmediately"},features:[o.Qb],decls:1,vars:1,consts:[["class","work-package--attachments--files",4,"ngIf"],[1,"work-package--attachments--files"],["class","form--selected-value--list",4,"ngFor","ngForOf","ngForTrackBy"],[1,"form--selected-value--list"],[3,"attachment","resource","index","destroyImmediately","removeAttachment"]],template:function(e,t){1&e&&o.Yc(0,y,2,2,"div",0),2&e&&o.Bc("ngIf",t.resource)},directives:[l.q,l.p,w],encapsulation:2})},"5qbd":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("mrSG"),s=i("4rda"),a=i("2Qcm"),r=i("r0MM");class c extends s.a{get shouldHighlight(){if(!1===this.context.options.colorize)return!1;const e=!!this.viewHighlighting&&this.viewHighlighting.shouldHighlightInline(this.name);return"table"!==this.context.container||e}}Object(n.c)([Object(r.a)(a.a,null),Object(n.e)("design:type",a.a)],c.prototype,"viewHighlighting",void 0)},"60np":function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));var n=i("NawS"),s=(i("ii2/"),i("ug4p")),a=i("uSJ+"),r=i("wZYP"),c=i("/C7M"),o=i("qc15"),l=i("fXoL"),d=i("ofXK"),u=i("RN/J"),h=i("kor4"),p=i("N5AO"),g=i("3Pt+"),m=i("oUDv"),f=i("MIK2"),b=i("/Rze");function w(e,t){if(1&e){const e=l.nc();l.mc(0,"div",4),l.mc(1,"div",5),l.mc(2,"div",6),l.mc(3,"a",7),l.uc("accessibleClick",(function(){return l.Qc(e),l.wc().toggleRelationsCreateForm()})),l.hc(4,"op-icon",8),l.hc(5,"span",9),l.lc(),l.lc(),l.lc(),l.lc()}if(2&e){const e=l.wc();l.Tb(5),l.Bc("textContent",e.text.addNewRelation)}}function v(e,t){if(1&e&&l.hc(0,"option",20),2&e){const e=t.$implicit;l.Bc("textContent",e.label)("value",e.name)}}function y(e,t){if(1&e){const e=l.nc();l.mc(0,"div",10),l.mc(1,"div",11),l.hc(2,"label",12),l.mc(3,"select",13),l.uc("ngModelChange",(function(t){return l.Qc(e),l.wc().selectedRelationType=t})),l.Yc(4,v,1,2,"option",14),l.lc(),l.lc(),l.mc(5,"div",15),l.mc(6,"wp-relations-autocomplete",16),l.uc("onSelected",(function(t){return l.Qc(e),l.wc().onSelected(t)}))("onCancel",(function(){return l.Qc(e),l.wc().toggleRelationsCreateForm()})),l.lc(),l.lc(),l.mc(7,"div",17),l.mc(8,"accessible-by-keyboard",18),l.uc("execute",(function(){return l.Qc(e),l.wc().toggleRelationsCreateForm()})),l.hc(9,"op-icon",19),l.lc(),l.lc(),l.lc()}if(2&e){const e=l.wc();l.Tb(2),l.Bc("textContent",e.text.relationType),l.Tb(1),l.Bc("ngModel",e.selectedRelationType),l.Tb(1),l.Bc("ngForOf",e.relationTypes),l.Tb(2),l.Bc("workPackage",e.workPackage)("hiddenOverflowContainer",".work-packages-tab-view--overflow")("selectedRelationType",e.selectedRelationType),l.Tb(3),l.Bc("icon-title",e.text.abort)}}class k{constructor(e,t,i,s,a){this.I18n=e,this.wpRelations=t,this.notificationService=i,this.halEvents=s,this.wpCacheService=a,this.showRelationsCreateForm=!1,this.selectedRelationType=n.a.DEFAULT(),this.relationTypes=n.a.LOCALIZED_RELATION_TYPES(!1),this.isDisabled=!1,this.text={abort:this.I18n.t("js.relation_buttons.abort"),relationType:this.I18n.t("js.relation_buttons.relation_type"),addNewRelation:this.I18n.t("js.relation_buttons.add_new_relation")}}createRelation(){this.selectedRelationType&&this.selectedWpId&&(this.isDisabled=!0,this.createCommonRelation().catch(()=>this.isDisabled=!1).then(()=>this.isDisabled=!1))}onSelected(e){e&&(this.selectedWpId=e.id,this.createCommonRelation())}createCommonRelation(){return this.wpRelations.addCommonRelation(this.workPackage.id,this.selectedRelationType,this.selectedWpId).then(e=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:e.id,relationType:this.selectedRelationType}),this.notificationService.showSave(this.workPackage),this.toggleRelationsCreateForm()}).catch(e=>{this.notificationService.handleRawError(e,this.workPackage),this.toggleRelationsCreateForm()})}toggleRelationsCreateForm(){this.showRelationsCreateForm=!this.showRelationsCreateForm,this.selectedWpId=""}}k.\u0275fac=function(e){return new(e||k)(l.gc(r.a),l.gc(a.a),l.gc(o.a),l.gc(c.a),l.gc(s.a))},k.\u0275cmp=l.ac({type:k,selectors:[["wp-relations-create"]],inputs:{workPackage:"workPackage"},decls:4,vars:2,consts:[[1,"wp-relations-create"],["class","wp-relations-create-button hide-when-print",4,"ngIf"],["data-indicator-name","relationAddDynamic",1,"loading-indicator--location"],["class","v-align wp-relations-create--form",4,"ngIf"],[1,"wp-relations-create-button","hide-when-print"],[1,"grid-block"],[1,"grid-content","collapse","wp-inline-create-button"],["autoFocus","","href","","id","relation--add-relation",1,"wp-inline-create--add-link","relation-create",3,"accessibleClick"],["icon-classes","icon icon-add"],[3,"textContent"],[1,"v-align","wp-relations-create--form"],[1,"grid-content","collapse","medium-3"],["for","relation-type--select",1,"hidden-for-sighted",3,"textContent"],["id","relation-type--select","role","listbox","focus","",1,"form--select","relationTypeSelect",3,"ngModel","ngModelChange"],[3,"textContent","value",4,"ngFor","ngForOf"],[1,"grid-content","medium-8"],[3,"workPackage","hiddenOverflowContainer","selectedRelationType","onSelected","onCancel"],[1,"grid-content","medium-1","collapse","wp-relations-controls-section","relation-row"],["linkClass","wp-create-relation--cancel","aria-hidden","false",3,"execute"],["icon-classes","icon-remove -padded",3,"icon-title"],[3,"textContent","value"]],template:function(e,t){1&e&&(l.mc(0,"div",0),l.Yc(1,w,6,1,"div",1),l.mc(2,"div",2),l.Yc(3,y,10,7,"div",3),l.lc(),l.lc()),2&e&&(l.Tb(1),l.Bc("ngIf",!t.showRelationsCreateForm),l.Tb(2),l.Bc("ngIf",t.showRelationsCreateForm))},directives:[d.q,u.a,h.a,p.a,g.y,m.a,g.m,g.p,d.p,f.a,b.a,g.r,g.B],encapsulation:2})},"67Ga":function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("wZYP"),s=(i("AA01"),i("Y41n")),a=i("juWA"),r=i("59tY"),c=i("Hg4z"),o=i("fXoL"),l=i("ecJW"),d=i("oUDv"),u=i("ofXK"),h=i("N5AO");function p(e,t){if(1&e&&(o.mc(0,"span",3),o.hc(1,"op-icon",4),o.lc()),2&e){const e=o.wc();o.Ub("data-tooltip",e.timeZoneText)}}class g extends r.a{constructor(e,t){super(e,t),this.I18n=e,this.timezoneService=t,this.shouldFocus=!1,this.filterChanged=new s.a(Object(c.b)(this))}get value(){return this.filter.values[0]}get valueString(){return this.filter.values[0].toString()}set value(e){this.filter.values=[e],this.filterChanged.emit(this.filter)}get lowerBoundary(){return this.value&&this.timezoneService.isValidISODateTime(this.valueString)?this.timezoneService.parseDatetime(this.valueString):null}get upperBoundary(){return this.value&&this.timezoneService.isValidISODateTime(this.valueString)?this.timezoneService.parseDatetime(this.valueString).add(24,"hours"):null}}g.\u0275fac=function(e){return new(e||g)(o.gc(n.a),o.gc(a.a))},g.\u0275cmp=o.ac({type:g,selectors:[["filter-date-time-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[o.Qb],decls:3,vars:6,consts:[[1,"inline-label",3,"id"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","focus","id","name","onChange"],["class","advanced-filters--tooltip-trigger -multiline",4,"ngIf"],[1,"advanced-filters--tooltip-trigger","-multiline"],["icon-classes","icon icon-warning"]],template:function(e,t){1&e&&(o.mc(0,"div",0),o.mc(1,"op-date-picker",1),o.uc("onChange",(function(e){return t.value=t.isoDateParser(e)})),o.lc(),o.Yc(2,p,2,1,"span",2),o.lc()),2&e&&(o.Dc("id","div-values-",t.filter.id,""),o.Tb(1),o.Bc("initialDate",t.isoDateFormatter(t.value))("focus",t.shouldFocus)("id","values-"+t.filter.id)("name","v["+t.filter.id+"]"),o.Tb(1),o.Bc("ngIf",t.isTimeZoneDifferent))},directives:[l.a,d.a,u.q,h.a],encapsulation:2})},"6DMU":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("mrSG"),s=i("eyhC"),a=i("Y/CA"),r=i("WW/2"),c=i("iB+3"),o=i("K247"),l=i("r0MM");class d{constructor(e,t){this.injector=e}get EVENT(){return"click.cardView.card"}get SELECTOR(){return".wp-card"}eventScope(e){return jQuery(e.container.nativeElement)}handleEvent(e,t){let i=jQuery(t.target);if(i.is("a")||i.parent().is("a"))return!0;let n=i.closest("wp-single-card"),s=n.data("workPackageId");return!s||(this.handleWorkPackage(s,n,t),!1)}handleWorkPackage(e,t,i){this.setSelection(e,t,i),this.openFullViewOnMobile(e)}openFullViewOnMobile(e){this.deviceService.isMobile&&this.$state.go("work-packages.show",{workPackageId:e})}setSelection(e,t,i){let n=t.data("classIdentifier"),s=this.wpCardView.findRenderedCard(n);i.ctrlKey||i.metaKey||i.shiftKey||this.wpTableSelection.setSelection(e,s),i.shiftKey&&this.wpTableSelection.setMultiSelectionFrom(this.wpCardView.renderedCards,e,s),(i.ctrlKey||i.metaKey)&&this.wpTableSelection.toggleRow(e),this.wpTableFocus.updateFocus(e)}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",o.a)],d.prototype,"deviceService",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",c.G)],d.prototype,"$state",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",s.a)],d.prototype,"wpTableSelection",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",a.a)],d.prototype,"wpTableFocus",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",r.a)],d.prototype,"wpCardView",void 0)},"6XbZ":function(e,t,i){"use strict";i.d(t,"c",(function(){return w})),i.d(t,"b",(function(){return v})),i.d(t,"a",(function(){return y}));var n=i("mrSG"),s=i("wZYP"),a=i("5+Sy"),r=i("qHU1"),c=i("QOiP"),o=i("JY8V"),l=i("pXZk"),d=i("0Usb"),u=i("cd/7"),h=i("ooSb"),p=i("/cHX"),g=i("FlxY"),m=i("r0MM");class f{constructor(e){this.injector=e}build(e){let t=document.createElement("td");t.classList.add(l.c,p.e,g.a.id,"hide-when-print");let i=document.createElement("span");return i.classList.add(p.d),this.tableActionsService.render(e).forEach(e=>{i.appendChild(e)}),t.appendChild(i),t}}Object(n.c)([Object(m.a)(),Object(n.e)("design:type",h.a)],f.prototype,"tableActionsService",void 0);var b=i("eyhC");const w="wp-table--row",v="wp--row";class y{constructor(e,t){this.injector=e,this.workPackageTable=t,this.cellBuilder=new l.a(this.injector),this.relationCellBuilder=new d.a(this.injector),this.contextLinkBuilder=new f(this.injector),this.augmentedColumns=this.buildAugmentedColumns()}get columns(){return this.wpTableColumns.getColumns()}buildAugmentedColumns(){let e=[...this.columns,g.a];return this.workPackageTable.configuration.dragAndDropEnabled&&e.unshift(g.b),e}buildCell(e,t){if(Object(c.a)(t))return this.relationCellBuilder.build(e,t);switch(t.id){case g.a.id:if(this.workPackageTable.configuration.actionsColumnEnabled)return this.contextLinkBuilder.build(e);if(this.workPackageTable.configuration.columnMenuEnabled){let e=document.createElement("td");return e.classList.add("hide-when-print"),e}return null;default:return this.cellBuilder.build(e,t)}}buildEmpty(e){let t=this.createEmptyRow(e);return this.buildEmptyRow(e,t)}createEmptyRow(e){const t=this.classIdentifier(e);let i=document.createElement("tr");return i.setAttribute("tabindex","0"),i.dataset.workPackageId=e.id,i.dataset.classIdentifier=t,i.classList.add(w,v,t,`${t}-table`,"issue"),i}get placeholderRow(){const e=document.createElement("tr"),t=document.createElement("td");return e.classList.add("wp--placeholder-row"),t.colSpan=this.augmentedColumns.length,e.appendChild(t),e}classIdentifier(e){return`wp-row-${e.id}`}refreshRow(e,t){const i=t.find(`.${l.c}`).detach(),n=[];return this.augmentedColumns.forEach(t=>{const s=i.filter(`td.${t.id}`);if(t.id.startsWith("__internal")||this.isColumnBeingEdited(e,t))return void n.push(s[0]);const a=this.buildCell(e,t);a&&n.push(a)}),t.prepend(n),t}isColumnBeingEdited(e,t){const i=this.workPackageTable.editing.forms[e.id];return i&&i.activeFields[t.id]}buildEmptyRow(e,t){const i=this.workPackageTable.editing.change(e);let n={};if(i&&!i.isEmpty()){const t=Object(a.c)(this.classIdentifier(e));i.changedAttributes.forEach(e=>{n[e]=t.find(`.${l.c}.${e}`)})}return this.augmentedColumns.forEach(i=>{let s,a=n[i.id];a&&a.length?(Object(r.a)(`Rendering previous open column ${i.id} on ${e.id}`),jQuery(t).append(a)):(s=this.buildCell(e,i),s&&t.appendChild(s))}),this.wpTableSelection.isSelected(e.id)&&t.classList.add(u.b),[t,!1]}}Object(n.c)([Object(m.a)(),Object(n.e)("design:type",b.a)],y.prototype,"wpTableSelection",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",o.a)],y.prototype,"wpTableColumns",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",s.a)],y.prototype,"I18n",void 0)},"6p3c":function(e,t,i){"use strict";i.d(t,"a",(function(){return D}));var n=i("Kg8T"),s=i("Y/CA"),a=i("pLZG"),r=i("Yg+W"),c=(i("5HGI"),i("4n9w")),o=i("mrSG"),l=i("wZYP"),d=i("iMRi"),u=i("6XbZ"),h=i("5+Sy"),p=i("eyhC"),g=i("JY8V"),m=i("pXZk"),f=i("FlxY"),b=i("r0MM");class w extends u.a{constructor(e,t){super(e,t),this.injector=e,this.text={cancelButton:this.I18n.t("js.button_cancel")}}buildCell(e,t){switch(t.id){case f.a.id:return this.buildCancelButton();default:return super.buildCell(e,t)}}buildNew(e,t){const[i,n]=this.buildEmpty(e);return[i,n]}createEmptyRow(e){const t=this.classIdentifier(e),i=document.createElement("tr");return i.id=Object(h.e)(e.id),i.dataset.workPackageId=e.id,i.dataset.classIdentifier=t,i.classList.add("wp-inline-create-row",u.b,u.c,"issue",t,`${t}-table`),i}buildCancelButton(){const e=document.createElement("td");return e.classList.add(m.c,"wp-table--cancel-create-td"),e.innerHTML=`\n    <a\n       href="#"\n       class="wp-table--cancel-create-link icon icon-cancel"\n       aria-label="${this.text.cancelButton}">\n    </a>\n   `,e}}Object(o.c)([Object(b.a)(),Object(o.e)("design:type",d.a)],w.prototype,"states",void 0),Object(o.c)([Object(b.a)(),Object(o.e)("design:type",p.a)],w.prototype,"wpTableSelection",void 0),Object(o.c)([Object(b.a)(),Object(o.e)("design:type",g.a)],w.prototype,"wpTableColumns",void 0),Object(o.c)([Object(b.a)(),Object(o.e)("design:type",l.a)],w.prototype,"I18n",void 0);var v=i("E2tj"),y=i("7ond"),k=i("FDFi"),C=i("AEvm"),j=i("Hg4z"),x=i("fXoL"),T=i("ofXK"),S=i("oUDv"),_=i("kor4"),P=i("N5AO"),I=i("CS/5");const O=function(e){return{"wp-inline-create--split-link":e}};function R(e,t){if(1&e){const e=x.nc();x.mc(0,"a",6),x.uc("accessibleClick",(function(){return x.Qc(e),x.wc(3).handleAddRowClick()})),x.hc(1,"op-icon",7),x.hc(2,"span",8),x.lc()}if(2&e){const e=x.wc(3);x.Bc("focus",e.focus)("ngClass",x.Gc(5,O,e.hasReferenceClass)),x.Ub("disabled",!e.isAllowed||void 0)("aria-label",e.text.create),x.Tb(2),x.Bc("textContent",e.text.create)}}function B(e,t){if(1&e){const e=x.nc();x.kc(0),x.mc(1,"a",9),x.uc("accessibleClick",(function(){return x.Qc(e),x.wc(3).handleReferenceClick()})),x.hc(2,"op-icon",10),x.hc(3,"span",8),x.lc(),x.jc()}if(2&e){const e=x.wc(3);x.Tb(1),x.Ub("disabled",!e.isAllowed||void 0)("aria-label",e.text.create),x.Tb(2),x.Bc("textContent",e.text.reference)}}function E(e,t){if(1&e&&(x.mc(0,"tr",2),x.mc(1,"td",3),x.mc(2,"div",4),x.Yc(3,R,3,7,"a",5),x.Yc(4,B,4,3,"ng-container",0),x.lc(),x.lc(),x.lc()),2&e){const e=x.wc(2);x.Tb(1),x.Ub("colspan",e.colspan),x.Tb(2),x.Bc("ngIf",e.canAdd),x.Tb(1),x.Bc("ngIf",e.canReference)}}function M(e,t){1&e&&x.ic(0)}function F(e,t){if(1&e&&(x.mc(0,"tr",2),x.mc(1,"td",11),x.Yc(2,M,1,0,"ng-container",12),x.lc(),x.lc()),2&e){const e=x.wc(2);x.Tb(1),x.Ub("colspan",e.colspan),x.Tb(1),x.Bc("ngComponentOutlet",e.referenceClass)("ngComponentOutletInjector",e.injector)}}function A(e,t){if(1&e&&(x.kc(0),x.Yc(1,E,5,3,"tr",1),x.Yc(2,F,3,3,"tr",1),x.jc()),2&e){const e=x.wc();x.Tb(1),x.Bc("ngIf","inactive"===e.mode),x.Tb(1),x.Bc("ngIf",e.hasReferenceClass&&"reference"===e.mode)}}class D extends C.a{constructor(e,t,i,n,s,a,r,c,o,l,d){super(),this.injector=e,this.elementRef=t,this.FocusHelper=i,this.I18n=n,this.querySpace=s,this.cdRef=a,this.wpCreate=r,this.wpInlineCreate=c,this.wpTableColumns=o,this.wpTableFocus=l,this.authorisationService=d,this.canAdd=!1,this.canReference=!1,this.mode="inactive",this.focus=!1,this.text=this.wpInlineCreate.buttonTexts}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.authorisationService.observeUntil(Object(j.b)(this)).subscribe(()=>{this.canReference=this.hasReferenceClass&&this.wpInlineCreate.canReference,this.canAdd=this.wpInlineCreate.canAdd,this.cdRef.detectChanges()})}get isActive(){return"inactive"!==this.mode}ngAfterViewInit(){jQuery(this.table.timelineBody).addClass("-inline-create-mirror"),this.registerCreationCallback(),this.refreshOnColumnChanges(),this.registerCancelHandler()}registerCancelHandler(){this.$element.on("click keydown",".wp-table--cancel-create-link",e=>(Object(r.b)(e,()=>{this.resetRow()}),e.stopImmediatePropagation(),!1))}refreshOnColumnChanges(){this.wpTableColumns.updates$().pipe(Object(a.a)(()=>this.isActive),this.untilDestroyed()).subscribe(()=>this.refreshRow())}registerCreationCallback(){this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed()).subscribe(e=>{this.currentWorkPackage&&this.currentWorkPackage.__initialized_at===e.__initialized_at?(this.resetRow(),this.table.configuration.isEmbedded||this.wpTableFocus.updateFocus(e.id),this.wpInlineCreate.newInlineWorkPackageCreated.next(e.id)):(this.wpCreate.cancelCreation(),this.removeWorkPackageRow(),this.showRow()),this.cdRef.detectChanges()})}handleAddRowClick(){return this.addWorkPackageRow(),!1}handleReferenceClick(){return this.mode="reference",!1}get referenceClass(){return this.wpInlineCreate.referenceComponentClass}get hasReferenceClass(){return!!this.referenceClass}addWorkPackageRow(){this.wpCreate.createOrContinueWorkPackage(this.projectIdentifier).then(e=>{const t=this.currentWorkPackage=e.projectedResource;this.editingSubscription=this.wpCreate.changesetUpdates$().pipe(Object(a.a)(()=>!!this.currentWorkPackage)).subscribe(e=>{this.isActive?(this.currentWorkPackage.overriddenSchema=e.schema,this.refreshRow()):this.insertRow(t)})})}insertRow(e){const t=this.workPackageEditForm=this.renderInlineCreateRow(e);setTimeout(()=>{t.activateMissingFields(),this.hideRow()})}refreshRow(){const e=new w(this.injector,this.table),t=this.$element.find(".wp-inline-create-row");t.length&&this.currentWorkPackage&&e.refreshRow(this.currentWorkPackage,t)}renderInlineCreateRow(e){const t=new w(this.injector,this.table),i=this.table.editing.startEditing(e,t.classIdentifier(e)),[n]=t.buildNew(e,i);return this.$element.append(n),i}resetRow(){this.focus=!0,this.removeWorkPackageRow(),setTimeout(()=>{this.showRow(),this.cdRef.detectChanges()},50)}removeWorkPackageRow(){this.wpCreate.cancelCreation(),this.currentWorkPackage=null,this.$element.find(".wp-row-new").remove(),this.editingSubscription&&this.editingSubscription.unsubscribe()}showRow(){this.mode="inactive",this.cdRef.detectChanges()}hideRow(){this.mode="create",this.cdRef.detectChanges()}get colspan(){return this.wpTableColumns.columnCount+1}}D.\u0275fac=function(e){return new(e||D)(x.gc(x.A),x.gc(x.q),x.gc(y.a),x.gc(l.a),x.gc(v.a),x.gc(x.i),x.gc(c.a),x.gc(k.a),x.gc(g.a),x.gc(s.a),x.gc(n.a))},D.\u0275cmp=x.ac({type:D,selectors:[["","wpInlineCreate",""]],hostBindings:function(e,t){1&e&&x.uc("keydown.escape",(function(){return t.resetRow()}))},inputs:{table:["wp-inline-create--table","table"],projectIdentifier:["wp-inline-create--project-identifier","projectIdentifier"]},features:[x.Qb],attrs:["wpInlineCreate",""],decls:1,vars:1,consts:[[4,"ngIf"],["class","wp-inline-create-button-row hide-when-print",4,"ngIf"],[1,"wp-inline-create-button-row","hide-when-print"],[1,"wp-inline-create-button-td","-no-highlighting"],[1,"wp-inline-create-button"],["class","wp-inline-create--add-link","href","","role","link","aria-haspopup","true",3,"focus","ngClass","accessibleClick",4,"ngIf"],["href","","role","link","aria-haspopup","true",1,"wp-inline-create--add-link",3,"focus","ngClass","accessibleClick"],["icon-classes","icon icon-add"],[3,"textContent"],["href","","role","link","aria-haspopup","true",1,"wp-inline-create--reference-link","wp-inline-create--split-link",3,"accessibleClick"],["icon-classes","icon icon-link"],[1,"wp-inline-reference-row-td","-no-highlighting"],[4,"ngComponentOutlet","ngComponentOutletInjector"]],template:function(e,t){1&e&&x.Yc(0,A,3,2,"ng-container",0),2&e&&x.Bc("ngIf",t.canAdd||t.canReference)},directives:[T.q,S.a,T.n,_.a,P.a,T.o,I.a],encapsulation:2})},"6x6j":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("Mo6U"),s=i("fXoL");class a{extract(e,t){let i={_links:{}};var s=[];for(var a in t)t.hasOwnProperty(a)&&t[a].writable&&(e.$links[a]?Array.isArray(e[a])?i._links[a]=_.map(e[a],e=>({href:e.$href})):i._links[a]={href:e[a]&&e[a].$href}:s.push(a));return _.each(s,t=>{(e.hasOwnProperty(t)||e[t])&&(Array.isArray(e[t])?i[t]=_.map(e[t],e=>e instanceof n.a?this.extract(e,e.currentSchema||e.schema):e):i[t]=e[t])}),i}}a.\u0275fac=function(e){return new(e||a)},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac})},"6yP5":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("iMRi"),s=i("FnNU"),a=i("CqXF"),r=i("E2tj"),c=i("zqrF"),o=i("Jui0"),l=i("fXoL");class d extends c.a{constructor(e,t,i){super(t),this.states=e,this.querySpace=t,this.pathHelper=i}valueFromQuery(e){return[...e.sortBy]}onReadyWithAvailable(){return Object(s.b)(this.pristineState,this.states.queries.sortBy).values$().pipe(Object(a.a)(null))}hasChanged(e){const t=e=>e.map(e=>e.href);return!_.isEqual(t(e.sortBy),t(this.current))}applyToQuery(e){const t=this.isManuallySorted(e.sortBy);return e.sortBy=[...this.current],!(t&&this.isManualSortingMode)}isSortable(e){return!!_.find(this.available,t=>t.column.$href===e.$href)}addSortCriteria(e,t){let i=this.findAvailableDirection(e,t);i&&this.add(i)}setAsSingleSortCriteria(e,t){let i=this.findAvailableDirection(e,t);i&&this.update([i])}findAvailableDirection(e,t){return _.find(this.available,i=>i.column.$href===e.$href&&i.direction.$href===t)}add(e){let t=_.uniqBy([e,...this.current],e=>e.column.$href).slice(0,3);this.update(t)}get isManualSortingMode(){return this.isManuallySorted(this.current)}switchToManualSorting(e){let t=this.manualSortObject;if(t&&!this.isManualSortingMode){if(e&&e.persisted)return e.sortBy=[t],!0;this.update([t])}return!1}get current(){return this.lastUpdatedState.getValueOr([])}get availableState(){return this.states.queries.sortBy}get available(){return this.availableState.getValueOr([])}isManuallySorted(e){return!!(e&&e.length>0)&&e[0].column.href.endsWith("/manualSorting")}get manualSortObject(){return _.find(this.available,e=>e.column.$href.endsWith("/manualSorting"))}}d.\u0275fac=function(e){return new(e||d)(l.qc(n.a),l.qc(r.a),l.qc(o.a))},d.\u0275prov=l.cc({token:d,factory:d.\u0275fac})},"70hh":function(e,t,i){"use strict";i.d(t,"a",(function(){return x}));var n=i("wZYP"),s=i("Y41n"),a=i("4EDS"),r=i("fbLK"),c=i("ZOsW"),o=i("F5Dh"),l=i("l08T"),d=i("AEvm"),u=i("Hg4z"),h=i("fXoL"),p=i("ofXK"),g=i("Q2ix"),m=i("N5AO"),f=i("Ndcw"),b=i("xFOf");function w(e,t){if(1&e){const e=h.nc();h.mc(0,"a",20),h.uc("click",(function(){return h.Qc(e),h.wc(2).closeFilter()})),h.lc()}if(2&e){const e=h.wc(2);h.Ub("title",e.text.close_form)}}function v(e,t){if(1&e){const e=h.nc();h.mc(0,"li",22),h.uc("deactivateFilter",(function(t){return h.Qc(e),h.wc(3).deactivateFilter(t)}))("filterChanged",(function(){h.Qc(e);const t=h.wc(3);return t.filtersChanged.emit(t.filters)})),h.lc()}if(2&e){const e=h.wc(),t=e.$implicit,i=e.index,n=h.wc(2);h.Dc("id","filter_",t.id,""),h.Bc("shouldFocus",i==n.focusElementIndex)("filter",t)("hidden",n.isHiddenFilter(t))}}function y(e,t){if(1&e&&(h.kc(0),h.Yc(1,v,1,4,"li",21),h.jc()),2&e){const e=t.$implicit,i=h.wc(2);h.Tb(1),h.Bc("ngIf",i.isFilterAvailable(e.id))}}function k(e,t){1&e&&h.hc(0,"li",9)}function C(e,t){if(1&e&&h.hc(0,"enterprise-banner",23),2&e){const e=h.wc(2);h.Bc("linkMessage",e.text.upsale_link)("textMessage",e.text.upsale_for_more)}}function j(e,t){if(1&e){const e=h.nc();h.mc(0,"fieldset",1),h.hc(1,"legend",2),h.Yc(2,w,1,1,"a",3),h.mc(3,"ul",4),h.mc(4,"li",5),h.hc(5,"label",6),h.mc(6,"div",7),h.mc(7,"wp-filter-by-text-input",8),h.uc("deactivateFilter",(function(t){return h.Qc(e),h.wc().deactivateFilter(t)})),h.lc(),h.lc(),h.lc(),h.hc(8,"li",9),h.Yc(9,y,2,1,"ng-container",10),h.Yc(10,k,1,0,"li",11),h.mc(11,"li",12),h.mc(12,"label",13),h.hc(13,"op-icon",14),h.ad(14),h.lc(),h.mc(15,"label",15),h.ad(16),h.lc(),h.mc(17,"div",16),h.mc(18,"ng-select",17,18),h.uc("open",(function(){return h.Qc(e),h.wc().onOpen()}))("change",(function(t){return h.Qc(e),h.wc().onFilterAdded(t)})),h.lc(),h.lc(),h.lc(),h.lc(),h.Yc(20,C,1,2,"enterprise-banner",19),h.lc()}if(2&e){const e=h.wc();h.Tb(1),h.Bc("textContent",e.text.selected_filter_list),h.Tb(1),h.Bc("ngIf",e.showCloseFilter),h.Tb(3),h.Bc("textContent",e.text.filter_by_text),h.Ub("title",e.text.filter_by_text),h.Tb(4),h.Bc("ngForOf",e.filters)("ngForTrackBy",e.trackByName),h.Tb(1),h.Bc("ngIf",e.isSecondSpacerVisible),h.Tb(4),h.cd(" ",e.text.label_filter_add,": "),h.Tb(2),h.ed(" ",e.text.label_filter_add," ",e.text.open_filter," ",e.text.close_filter," "),h.Tb(2),h.Bc("items",e.remainingFilters)("clearSearchOnAdd",!0)("multiple",!1)("clearable",!0)("clearOnBackspace",!0)("closeOnSelect",!0)("virtualScroll",!0)("placeholder",e.text.please_select),h.Tb(2),h.Bc("ngIf",e.eeShowBanners)}}class x extends d.a{constructor(e,t,i,n){super(),this.wpTableFilters=e,this.wpFiltersService=t,this.I18n=i,this.bannerService=n,this.showCloseFilter=!1,this.filtersChanged=new s.a(Object(u.b)(this)),this.remainingFilters=[],this.eeShowBanners=!1,this.focusElementIndex=0,this.trackByName=a.a.trackByName,this.text={open_filter:this.I18n.t("js.filter.description.text_open_filter"),label_filter_add:this.I18n.t("js.work_packages.label_filter_add"),close_filter:this.I18n.t("js.filter.description.text_close_filter"),upsale_for_more:this.I18n.t("js.filter.upsale_for_more"),upsale_link:this.I18n.t("js.filter.upsale_link"),close_form:this.I18n.t("js.close_form_title"),selected_filter_list:this.I18n.t("js.label_selected_filter_list"),button_delete:this.I18n.t("js.button_delete"),please_select:this.I18n.t("js.placeholders.selection"),filter_by_text:this.I18n.t("js.work_packages.label_filter_by_text")}}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners}ngOnChanges(){this.updateRemainingFilters()}onFilterAdded(e){if(e){let t=this.wpTableFilters.instantiate(e);this.filters.push(t);const i=this.currentFilterLength();this.updateFilterFocus(i),this.updateRemainingFilters(),this.filtersChanged.emit(this.filters),this.ngSelectComponent.clearItem(e)}}closeFilter(){this.wpFiltersService.toggleVisibility()}isHiddenFilter(e){return _.includes(this.wpTableFilters.hidden,e.id)}deactivateFilter(e){let t=this.filters.indexOf(e);_.remove(this.filters,t=>t.id===e.id),this.filtersChanged.emit(this.filters),this.updateFilterFocus(t),this.updateRemainingFilters()}get isSecondSpacerVisible(){const e=!!_.find(this.filters,e=>"search"===e.id),t=!!_.find(this.filters,e=>"search"!==e.id&&this.isFilterAvailable(e.id));return e&&t}updateRemainingFilters(){this.remainingFilters=_.sortBy(this.wpTableFilters.remainingVisibleFilters(this.filters),"name")}updateFilterFocus(e){var t=this.currentFilterLength();if(0===t)this.focusElementIndex=-1;else{const i=e<t?e:t-1,n=this.currentFilterAt(i);this.focusElementIndex=this.filters.indexOf(n)}}currentFilterLength(){return this.filters.length}currentFilterAt(e){return this.filters[e]}isFilterAvailable(e){return this.wpTableFilters.availableFilters.some(t=>t.id===e)}onOpen(){setTimeout(()=>{const e=this.ngSelectComponent;e&&e.dropdownPanel&&e.dropdownPanel._updatePosition()},25)}}x.\u0275fac=function(e){return new(e||x)(h.gc(o.a),h.gc(l.a),h.gc(n.a),h.gc(r.a))},x.\u0275cmp=h.ac({type:x,selectors:[["query-filters"]],viewQuery:function(e,t){var i;(1&e&&h.fd(c.a,!0),2&e)&&(h.Nc(i=h.vc())&&(t.ngSelectComponent=i.first))},inputs:{filters:"filters",showCloseFilter:"showCloseFilter"},outputs:{filtersChanged:"filtersChanged"},features:[h.Qb,h.Rb],decls:1,vars:1,consts:[["id","filters","class","advanced-filters--container",4,"ngIf"],["id","filters",1,"advanced-filters--container"],[3,"textContent"],["class","advanced-filters--close icon-context icon-close",3,"click",4,"ngIf"],[1,"advanced-filters--filters"],["id","filter_search",1,"advanced-filters--filter","--without-operator"],["for","filter-by-text-input",1,"advanced-filters--filter-name",3,"textContent"],[1,"advanced-filters--filter-value"],[3,"deactivateFilter"],[1,"advanced-filters--spacer"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","advanced-filters--spacer",4,"ngIf"],[1,"advanced-filters--add-filter"],["for","add_filter_select","aria-hidden","true",1,"advanced-filters--add-filter-label"],["icon-classes","icon-add icon4"],["for","add_filter_select",1,"hidden-for-sighted"],[1,"advanced-filters--add-filter-value"],["id","add_filter_select","bindLabel","name","appendTo","body",3,"items","clearSearchOnAdd","multiple","clearable","clearOnBackspace","closeOnSelect","virtualScroll","placeholder","open","change"],["ngSelectComponent",""],["class","advanced-filters--add-filter-info","opReferrer","wp-filter#filters",3,"linkMessage","textMessage",4,"ngIf"],[1,"advanced-filters--close","icon-context","icon-close",3,"click"],["query-filter","","class","advanced-filters--filter",3,"id","shouldFocus","filter","hidden","deactivateFilter","filterChanged",4,"ngIf"],["query-filter","",1,"advanced-filters--filter",3,"id","shouldFocus","filter","hidden","deactivateFilter","filterChanged"],["opReferrer","wp-filter#filters",1,"advanced-filters--add-filter-info",3,"linkMessage","textMessage"]],template:function(e,t){1&e&&h.Yc(0,j,21,20,"fieldset",0),2&e&&h.Bc("ngIf",t.filters)},directives:[p.q,g.a,p.p,m.a,c.a,f.a,b.a],encapsulation:2,changeDetection:0})},"711n":function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("mrSG"),s=i("fXoL"),a=i("iB+3"),r=i("8zkO"),c=i("FnNU"),o=i("pLZG"),l=i("IzEk"),d=i("lJxs"),u=i("wZYP"),h=i("e6KS"),p=(i("Mo6U"),i("Ie+Q")),g=i("A0F/");class m extends h.a{constructor(e,t,i,n,a,r,o,l){super(e),this.injector=e,this.elementRef=t,this.$transitions=i,this.ConfigurationService=n,this.editingPortalService=a,this.$state=r,this.I18n=o,this.editFormRouting=l,this.initializeEditMode=!1,this.skippedFields=[],this.onSavedEmitter=new s.s,this.fields={},this.registeredFields=Object(c.f)();const d=o.t("js.work_packages.confirm_edit_cancel"),u=n.warnOnLeavingUnsaved();this.unregisterListener=i.onBefore({},e=>{if(this.editing){if(!this.editFormRouting||this.editFormRouting.blockedTransition(e)){if(u&&!window.confirm(d))return!1;this.cancel(!1)}return!0}})}ngOnDestroy(){this.unregisterListener()}ngOnInit(){this.editMode=this.initializeEditMode,this.initializeEditMode&&this.start()}activateField(e,t,i,s){return Object(n.b)(this,void 0,void 0,(function*(){return this.waitForField(i).then(n=>{n.setActive(!0);const a=n.editContainer.nativeElement;return this.editingPortalService.create(a,this.injector,e,t,i,s)})}))}reset(e,t=!1){return Object(n.b)(this,void 0,void 0,(function*(){const i=yield this.waitForField(e);i.reset(),i.deactivate(t)}))}onSaved(e){this.cancel(!1),this.onSavedEmitter.emit({savedResource:e.resource,isInitial:e.wasNew})}cancel(e=!1){this.editMode=!1,this.closeEditFields("all",e),e&&this.halEditing.reset(this.change)}requireVisible(e){return new Promise((t,i)=>{const n=setInterval(()=>{void 0!==this.fields[e]&&(clearInterval(n),t())},50)})}get editing(){return this.editMode||this.hasActiveFields()}register(e){this.fields[e.fieldName]=e,this.registeredFields.putValue(_.keys(this.fields)),(this.editMode&&!this.skipField(e)||this.activeFields[e.fieldName])&&e.activateOnForm(!0)}waitForField(e){return this.registeredFields.values$().pipe(Object(o.a)(t=>t.indexOf(e)>=0),Object(l.a)(1),Object(d.a)(()=>this.fields[e])).toPromise()}start(){_.each(this.fields,e=>this.activate(e.fieldName))}focusOnFirstError(){jQuery(this.elementRef.nativeElement).find(`.${h.c}.-error .${h.b}`).first().trigger("focus")}skipField(e){const t=e.fieldName;if(!(-1!==this.skippedFields.indexOf(t)))return!1;const i=this.resource[t],n=this.change.changes[t];return i&&!n}}m.\u0275fac=function(e){return new(e||m)(s.gc(s.A),s.gc(s.q),s.gc(a.O),s.gc(r.a),s.gc(p.a),s.gc(a.G),s.gc(u.a),s.gc(g.a,8))},m.\u0275cmp=s.ac({type:m,selectors:[["edit-form"],["","edit-form",""]],inputs:{resource:"resource",initializeEditMode:["inEditMode","initializeEditMode"],skippedFields:"skippedFields"},outputs:{onSavedEmitter:"onSaved"},features:[s.Qb],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(s.Ac(),s.zc(0))},encapsulation:2})},"72I8":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("wZYP"),s=(i("AA01"),i("Y41n")),a=i("juWA"),r=i("AEvm"),c=i("Hg4z"),o=i("fXoL"),l=i("ecJW"),d=i("oUDv");class u extends r.a{constructor(e,t){super(),this.timezoneService=e,this.I18n=t,this.shouldFocus=!1,this.filterChanged=new s.a(Object(c.b)(this))}get value(){return this.filter.values[0]}set value(e){this.filter.values=[e],this.filterChanged.emit(this.filter)}parser(e){return moment(e,"YYYY-MM-DD",!0).isValid()?e:null}formatter(e){if(moment(e,"YYYY-MM-DD",!0).isValid()){var t=this.timezoneService.parseDate(e);return this.timezoneService.formattedISODate(t)}return null}}u.\u0275fac=function(e){return new(e||u)(o.gc(a.a),o.gc(n.a))},u.\u0275cmp=o.ac({type:u,selectors:[["filter-date-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[o.Qb],decls:2,vars:5,consts:[[3,"id"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","focus","id","name","onChange"]],template:function(e,t){1&e&&(o.mc(0,"div",0),o.mc(1,"op-date-picker",1),o.uc("onChange",(function(e){return t.value=t.parser(e)})),o.lc(),o.lc()),2&e&&(o.Dc("id","div-values-",t.filter.id,""),o.Tb(1),o.Bc("initialDate",t.formatter(t.value))("focus",t.shouldFocus)("id","values-"+t.filter.id)("name","v["+t.filter.id+"]"))},directives:[l.a,d.a],encapsulation:2})},"72oW":function(e,t,i){"use strict";i.d(t,"a",(function(){return $}));var n=i("mrSG"),s=i("fXoL"),a=i("PtkW"),r=i("Zq3F"),c=i("ooSb"),o=i("0bag"),l=i("sngl"),d=i("IaZ+"),u=i("sjKJ"),h=i("+oAL"),p=i("U1xf"),g=i("Y0Nk"),m=i("pL6k"),f=i("wZYP"),b=i("E2tj"),w=i("Dp3K"),v=i("r0MM");class y extends w.a{constructor(){super(...arguments),this.uniqueEmbeddedTableName=`embedded-table-${Date.now()}`,this.initialLoadingIndicator=!0,this.renderTable=!1,this.showTablePagination=!1,this.error=null,this.initialized=!1}ngOnInit(){this.configuration=new p.a(this.providedConfiguration),this.configuration.isEmbedded=!0,this.initialized=!0,super.ngOnInit()}ngAfterViewInit(){this.loadQuery(!0,!1)}ngOnChanges(e){this.initialized&&(e.queryId||e.queryProps)&&this.loadQuery(this.initialLoadingIndicator,!1)}get projectIdentifier(){return this.configuration.projectContext?this.currentProject.identifier||void 0:this.configuration.projectIdentifier||void 0}buildQueryProps(){const e=this.querySpace.query.value;return this.wpStatesInitialization.applyToQuery(e),this.urlParamsHelper.buildV3GetQueryFromQueryResource(e)}setLoaded(){this.renderTable=this.configuration.tableVisible,this.cdRef.detectChanges()}refresh(e=!0,t=!1){const i=this.querySpace.query.value,n=this.wpTablePagination.paginationObject;t&&(n.offset=1);const s=this.QueryDm.loadResults(i,n).then(e=>this.wpStatesInitialization.updateQuerySpace(e,e.results));return e&&(this.loadingIndicator=s),s}get isInitialized(){return!!this.configuration}set loadingIndicator(e){this.configuration.tableVisible&&(this.loadingIndicatorService.indicator(this.uniqueEmbeddedTableName).promise=e)}get queryProjectScope(){return this.configuration.projectContext?this.projectIdentifier:void 0}initializeStates(e){this.wpStatesInitialization.clearStates(),this.wpStatesInitialization.initializeFromQuery(e,e.results),this.wpStatesInitialization.updateQuerySpace(e,e.results)}}y.\u0275fac=function(e){return k(e||y)},y.\u0275dir=s.bc({type:y,inputs:{providedConfiguration:["configuration","providedConfiguration"],uniqueEmbeddedTableName:"uniqueEmbeddedTableName",initialLoadingIndicator:"initialLoadingIndicator"},features:[s.Qb,s.Rb]}),Object(n.c)([Object(v.a)(),Object(n.e)("design:type",o.a)],y.prototype,"QueryDm",void 0),Object(n.c)([Object(v.a)(),Object(n.e)("design:type",b.a)],y.prototype,"querySpace",void 0),Object(n.c)([Object(v.a)(),Object(n.e)("design:type",f.a)],y.prototype,"I18n",void 0),Object(n.c)([Object(v.a)(),Object(n.e)("design:type",m.a)],y.prototype,"urlParamsHelper",void 0),Object(n.c)([Object(v.a)(),Object(n.e)("design:type",g.a)],y.prototype,"loadingIndicatorService",void 0),Object(n.c)([Object(v.a)(),Object(n.e)("design:type",h.a)],y.prototype,"wpStatesInitialization",void 0),Object(n.c)([Object(v.a)(),Object(n.e)("design:type",u.a)],y.prototype,"currentProject",void 0),Object(n.c)([Object(v.a)(),Object(n.e)("design:type",s.i)],y.prototype,"cdRef",void 0);const k=s.oc(y);var C=i("OGNV"),j=i("lJxs"),x=i("/uUt"),T=i("zp1y"),S=i("IzEk"),P=i("ofXK"),I=i("lmDM"),O=i("eaMR"),R=i("9hh2"),B=i("eJFM");function E(e,t){if(1&e&&s.hc(0,"filter-container",10),2&e){const e=s.wc(3);s.Bc("showFilterButton",e.configuration.showFilterButton)("filterButtonText",e.configuration.filterButtonText)}}function M(e,t){if(1&e&&s.hc(0,"wp-table",11),2&e){const e=s.wc(3);s.Bc("projectIdentifier",e.projectIdentifier)("configuration",e.configuration)}}function F(e,t){if(1&e&&s.hc(0,"wp-grid",12),2&e){const e=s.wc(3);s.Bc("configuration",e.configuration)}}function A(e,t){if(1&e&&(s.kc(0),s.Yc(1,E,1,2,"filter-container",4),s.Yc(2,M,1,2,"wp-table",5),s.mc(3,"div",6),s.Yc(4,F,1,1,"wp-grid",7),s.lc(),s.mc(5,"div",8),s.hc(6,"wp-table-pagination",9),s.lc(),s.jc()),2&e){const e=s.wc(2);s.Tb(1),s.Bc("ngIf",e.configuration.withFilters),s.Tb(1),s.Bc("ngIf",!e.configuration.isCardView),s.Tb(2),s.Bc("ngIf",e.configuration.isCardView),s.Tb(2),s.Bc("hideForSinglePageResults",!0)}}function D(e,t){if(1&e&&(s.mc(0,"div",13),s.hc(1,"span",14),s.lc()),2&e){const e=s.wc(2);s.Tb(1),s.Bc("textContent",e.error.message||e.error)}}const q=function(e,t,i){return{"-hierarchy-disabled":e,"-compact-tables":t,"-external-height":i}};function L(e,t){if(1&e&&(s.mc(0,"div",1),s.Yc(1,A,7,4,"ng-container",2),s.Yc(2,D,2,1,"div",3),s.lc()),2&e){const e=s.wc();s.Bc("ngClass",s.Ic(4,q,!e.configuration.hierarchyToggleEnabled,e.configuration.compactTableStyle,e.externalHeight)),s.Ub("data-indicator-name",e.uniqueEmbeddedTableName),s.Tb(1),s.Bc("ngIf",e.renderTable),s.Tb(1),s.Bc("ngIf",e.error)}}class $ extends y{constructor(){super(...arguments),this.queryProps={},this.tableActions=[],this.externalHeight=!1,this.onError=new s.s,this.onQueryLoaded=new s.s}ngOnInit(){super.ngOnInit(),this.loadedQuery=this.querySpace.query.value}ngAfterViewInit(){super.ngAfterViewInit(),this.tableActions&&this.tableActionsService.setActions(...this.tableActions),this.wpTablePagination.updates$().pipe(Object(j.a)(e=>[e.page,e.perPage]),Object(x.a)(),this.untilDestroyed(),Object(T.a)(this.querySpace.query.values$())).subscribe(([e,t])=>{this.loadingIndicator=this.QueryDm.loadResults(t,this.wpTablePagination.paginationObject).then(e=>this.initializeStates(e))})}openConfigurationModal(e){this.querySpace.query.valuesPromise().then(()=>{this.opModalService.show(l.a,this.injector).onDataUpdated.subscribe(e)})}initializeStates(e){this.configuration.withFilters&&this.loadForm(e),super.initializeStates(e),this.querySpace.initialized.values$().pipe(Object(S.a)(1)).subscribe(()=>{this.showTablePagination=e.results.total>e.results.count,this.setLoaded(),this.wpTableTimeline.isVisible&&(this.configuration=Object.assign(Object.assign({},this.configuration),{compactTableStyle:!1}))})}loadForm(e){return this.formPromise?this.formPromise:this.formPromise=this.QueryFormDm.load(e).then(t=>(this.wpStatesInitialization.updateStatesFromForm(e,t),t)).catch(()=>this.formPromise=void 0)}loadQuery(e=!0,t=!1){if(this.formPromise=void 0,this.loadedQuery){const e=this.loadedQuery;return this.loadedQuery=void 0,this.initializeStates(e),Promise.resolve(this.loadedQuery)}this.configuration.tableVisible||(this.queryProps.pageSize=1),t&&(this.queryProps.page=1),this.error=null;const i=this.QueryDm.find(this.queryProps,this.queryId,this.queryProjectScope).then(e=>(this.initializeStates(e),this.onQueryLoaded.emit(e),e)).catch(e=>{this.error=this.I18n.t("js.error.embedded_table_loading",{message:_.get(e,"message",e)}),this.onError.emit(e)});return e&&(this.loadingIndicator=i),i}}$.\u0275fac=function(e){return N(e||$)},$.\u0275cmp=s.ac({type:$,selectors:[["wp-embedded-table"]],inputs:{queryId:"queryId",queryProps:"queryProps",tableActions:"tableActions",externalHeight:"externalHeight"},outputs:{onError:"onError",onQueryLoaded:"onQueryLoaded"},features:[s.Qb],decls:1,vars:1,consts:[["class","work-packages-embedded-view--container loading-indicator--location",3,"ngClass",4,"ngIf"],[1,"work-packages-embedded-view--container","loading-indicator--location",3,"ngClass"],[4,"ngIf"],["class","notification-box -error",4,"ngIf"],[3,"showFilterButton","filterButtonText",4,"ngIf"],["class","work-packages-split-view--tabletimeline-content",3,"projectIdentifier","configuration",4,"ngIf"],[1,"work-packages-embedded-view--grid-view"],[3,"configuration",4,"ngIf"],[1,"work-packages-split-view--tabletimeline-footer","hide-when-print"],[3,"hideForSinglePageResults"],[3,"showFilterButton","filterButtonText"],[1,"work-packages-split-view--tabletimeline-content",3,"projectIdentifier","configuration"],[3,"configuration"],[1,"notification-box","-error"],[3,"textContent"]],template:function(e,t){1&e&&s.Yc(0,L,3,8,"div",0),2&e&&s.Bc("ngIf",t.configuration)},directives:[P.q,P.n,I.a,O.a,R.a,B.a],encapsulation:2}),Object(n.c)([Object(v.a)(),Object(n.e)("design:type",o.a)],$.prototype,"QueryDm",void 0),Object(n.c)([Object(v.a)(),Object(n.e)("design:type",d.b)],$.prototype,"opModalService",void 0),Object(n.c)([Object(v.a)(),Object(n.e)("design:type",c.a)],$.prototype,"tableActionsService",void 0),Object(n.c)([Object(v.a)(),Object(n.e)("design:type",a.a)],$.prototype,"wpTableTimeline",void 0),Object(n.c)([Object(v.a)(),Object(n.e)("design:type",r.a)],$.prototype,"wpTablePagination",void 0),Object(n.c)([Object(v.a)(),Object(n.e)("design:type",C.a)],$.prototype,"QueryFormDm",void 0);const N=s.oc($)},"7MH/":function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("fXoL"),s=(i("kgyZ"),i("V4eP")),a=i("57Du"),r=i("5btT"),c=(i("GntA"),i("ofXK")),o=i("3Pt+"),l=i("CS/5");function d(e,t){1&e&&n.ic(0)}const u=function(e){return{"-error":e}};function h(e,t){if(1&e){const e=n.nc();n.mc(0,"div",1),n.mc(1,"form",2),n.uc("submit",(function(){return n.Qc(e),n.wc().handler.handleUserSubmit()})),n.mc(2,"label",3),n.ad(3),n.lc(),n.Yc(4,d,1,0,"ng-container",4),n.lc(),n.lc()}if(2&e){const e=n.wc();n.Vb("inline-edit--active-field inplace-edit ",e.handler.fieldName,""),n.Bc("ngClass",n.Gc(9,u,e.handler.isErrorenous)),n.Tb(2),n.Bc("for",e.handler.htmlId),n.Tb(1),n.dd(" ",e.handler.fieldLabel," ",e.handler.errorMessageOnLabel," "),n.Tb(1),n.Bc("ngComponentOutlet",e.componentClass)("ngComponentOutletInjector",e.fieldInjector)}}class p{constructor(e,t,i){this.injector=e,this.editField=t,this.elementRef=i,this.onEditFieldReady=new n.s}ngOnInit(){this.editFieldHandler&&this.schemaInput?(this.handler=this.editFieldHandler,this.schema=this.schemaInput,this.change=this.changeInput):(this.handler=this.injector.get(s.c),this.schema=this.injector.get(s.d),this.change=this.injector.get(s.b)),this.componentClass=this.editField.getSpecificClassFor(this.change.pristineResource._type,this.handler.fieldName,this.schema.type),this.fieldInjector=Object(a.a)(this.injector,this.change,this.handler,this.schema)}ngOnDestroy(){this.onEditFieldReady.complete()}ngAfterViewInit(){setTimeout(()=>{this.onEditFieldReady.emit()})}}p.\u0275fac=function(e){return new(e||p)(n.gc(n.A),n.gc(r.a),n.gc(n.q))},p.\u0275cmp=n.ac({type:p,selectors:[["edit-form-portal"]],inputs:{schemaInput:"schemaInput",changeInput:"changeInput",editFieldHandler:"editFieldHandler"},outputs:{onEditFieldReady:"onEditFieldReady"},decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],["role","form","tabindex","-1",3,"submit"],[1,"hidden-for-sighted",3,"for"],[4,"ngComponentOutlet","ngComponentOutletInjector"]],template:function(e,t){1&e&&n.Yc(0,h,5,11,"div",0),2&e&&n.Bc("ngIf",t.handler)},directives:[c.q,c.n,o.C,o.n,o.o,c.o,l.a],encapsulation:2})},"7ond":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this.minimumOffsetForNewSwitchInMs=100,this.lastFocusSwitch=-this.minimumOffsetForNewSwitchInMs,this.lastPriority=-1}throttleAndCheckIfAllowedFocusChangeBasedOnTimeout(){var e=Date.now()-this.lastFocusSwitch>=this.minimumOffsetForNewSwitchInMs;return this.lastFocusSwitch=Date.now(),e}checkIfAllowedFocusChange(e){var t=this.throttleAndCheckIfAllowedFocusChangeBasedOnTimeout();if(t)this.lastPriority=-1;else if(e>this.lastPriority)return this.lastPriority=e,!0;return t}getFocusableElement(e){var t=e.find("input.ui-select-focusser");if(t.length>0)return t[0];var i=e;return e.is(s.FOCUSABLE_SELECTORS)||(i=e.find(s.FOCUSABLE_SELECTORS)),i[0]}focus(e){var t=jQuery(this.getFocusableElement(e)),i=jQuery(t),n=i.is("[disabled]");n&&!i.attr("ng-disabled")&&i.prop("disabled",!1),t.focus(),n&&!i.attr("ng-disabled")&&i.prop("disabled",!0)}focusElement(e,t){this.checkIfAllowedFocusChange(t)&&setTimeout(()=>{this.focus(e)},10)}}s.FOCUSABLE_SELECTORS="a, button, :input, [tabindex], select",s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.cc({token:s,factory:s.\u0275fac,providedIn:"root"})},"7xci":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("mrSG"),s=i("wyKs"),a=i("E2tj"),r=i("VgZ9"),c=i("iMRi"),o=i("ug4p"),l=i("Va5K"),d=i("fXoL");class u{constructor(e,t,i,n,s,a){this.wpViewHierarchies=e,this.wpDisplayRepresentation=t,this.states=i,this.wpRelationHierarchy=n,this.wpCacheService=s,this.querySpace=a}get applicable(){return this.wpViewHierarchies.isEnabled&&this.wpDisplayRepresentation.isList}canIndent(e){if(!e.changeParent||!this.applicable)return!1;const t=this.renderedWorkPackageIds,i=t.indexOf(e.id);if(0===i)return!1;const n=e.ancestorIds,s=n.length;if(0===s)return!0;const a=n[s-1];return t[i-1]!==a}canOutdent(e){return!(!e.changeParent||!this.applicable)&&!!e.parent}indent(e){return Object(n.b)(this,void 0,void 0,(function*(){if(!this.canIndent(e))return Promise.reject();const t=this.renderedWorkPackageIds,i=t.indexOf(e.id),n=t[i-1];let s=n;const a=yield this.wpCacheService.require(n),r=_.difference(a.ancestorIds,e.ancestorIds);return r&&r.length>0&&(s=r[0]),this.wpRelationHierarchy.changeParent(e,s)}))}outdent(e){if(!this.canOutdent(e))return Promise.reject();let t=null;const i=e.ancestorIds,n=i.length;return n>1&&(t=i[n-2]),this.wpRelationHierarchy.changeParent(e,t)}get renderedWorkPackageIds(){return this.querySpace.renderedWorkPackageIds.getValueOr([])}}u.\u0275fac=function(e){return new(e||u)(d.qc(s.a),d.qc(l.a),d.qc(c.a),d.qc(r.a),d.qc(o.a),d.qc(a.a))},u.\u0275prov=d.cc({token:u,factory:u.\u0275fac})},"8+xT":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));i("ii2/");var n=i("ug4p"),s=i("wZYP"),a=i("VFHb"),r=i("AEvm"),c=i("fXoL"),o=i("ofXK"),l=i("N5AO");function d(e,t){if(1&e&&c.hc(0,"span",4),2&e){const e=c.wc(2);c.Bc("textContent",e.buttonText)}}function u(e,t){if(1&e){const e=c.nc();c.mc(0,"button",1),c.uc("click",(function(){return c.Qc(e),c.wc().toggleWatch()})),c.hc(1,"op-icon",2),c.Yc(2,d,1,1,"span",3),c.lc()}if(2&e){const e=c.wc();c.Bc("disabled",e.disabled)("ngClass",e.buttonClass)("id",e.buttonId),c.Ub("title",e.buttonTitle),c.Tb(1),c.Dc("icon-classes","button--icon ",e.watchIconClass,""),c.Tb(1),c.Bc("ngIf",e.showText)}}class h extends r.a{constructor(e,t,i){super(),this.I18n=e,this.wpWatchersService=t,this.wpCacheService=i,this.showText=!1,this.disabled=!1}ngOnInit(){this.wpCacheService.loadWorkPackage(this.workPackage.id).values$().pipe(this.untilDestroyed()).subscribe(e=>{this.workPackage=e,this.setWatchStatus()})}get isWatched(){return this.workPackage.hasOwnProperty("unwatch")}get displayWatchButton(){return this.isWatched||this.workPackage.hasOwnProperty("watch")}toggleWatch(){const e=this.nextStateLink();e(e.$link.payload).then(()=>{this.wpWatchersService.clear(this.workPackage.id),this.wpCacheService.loadWorkPackage(this.workPackage.id,!0)})}nextStateLink(){const e=this.isWatched?"unwatch":"watch";return this.workPackage[e]}setWatchStatus(){this.isWatched?(this.buttonTitle=this.I18n.t("js.label_unwatch_work_package"),this.buttonText=this.I18n.t("js.label_unwatch"),this.buttonClass="-active",this.buttonId="unwatch-button",this.watchIconClass="icon-watched"):(this.buttonTitle=this.I18n.t("js.label_watch_work_package"),this.buttonText=this.I18n.t("js.label_watch"),this.buttonClass="",this.buttonId="watch-button",this.watchIconClass="icon-unwatched")}}h.\u0275fac=function(e){return new(e||h)(c.gc(s.a),c.gc(a.a),c.gc(n.a))},h.\u0275cmp=c.ac({type:h,selectors:[["wp-watcher-button"]],inputs:{workPackage:"workPackage",showText:"showText",disabled:"disabled"},features:[c.Qb],decls:1,vars:1,consts:[["class","button toolbar-icon",3,"disabled","ngClass","id","click",4,"ngIf"],[1,"button","toolbar-icon",3,"disabled","ngClass","id","click"],[3,"icon-classes"],["class","button--text",3,"textContent",4,"ngIf"],[1,"button--text",3,"textContent"]],template:function(e,t){1&e&&c.Yc(0,u,3,6,"button",0),2&e&&c.Bc("ngIf",t.displayWatchButton)},directives:[o.q,o.n,l.a],encapsulation:2})},"80WE":function(e,t,i){"use strict";i.d(t,"a",(function(){return j}));var n,s=i("ug4p"),a=i("POAS"),r=i("iMRi"),c=i("Ncnr"),o=i("SKFm");!function(e){e.hasSelectionWithin=function(e){try{const t=window.getSelection(),i=t.toString().length>0,n=e.contains(t.anchorNode);return i&&n}catch(t){return console.error("Failed to test whether in selection ",t),!1}}}(n||(n={}));var l=i("qHU1"),d=i("8zkO"),u=i("4lR/"),h=i("d/TE"),p=i("wZYP"),g=i("GjwL"),m=i("711n"),f=(i("Mo6U"),i("AEvm")),b=i("fXoL"),w=i("ofXK"),v=i("kor4");const y=["displayContainer"],k=["editContainer"],C=function(e,t,i,n){return[e,t,i,n]};class j extends f.a{constructor(e,t,i,n,s,a,r,o,l,d,u,h){super(),this.states=e,this.injector=t,this.elementRef=i,this.halNotification=n,this.ConfigurationService=s,this.opContextMenu=a,this.halEditing=r,this.wpCacheService=o,this.editForm=l,this.NotificationsService=d,this.cdRef=u,this.I18n=h,this.displayFieldOptions={},this.isDropTarget=!1,this.editFieldContainerClass=c.c,this.active=!1,this.destroyed=!1}setActive(e=!0){this.active=e,this.componentDestroyed||this.cdRef.detectChanges()}ngOnInit(){this.fieldRenderer=new c.a(this.injector,"single-view",this.displayFieldOptions),this.$element=jQuery(this.elementRef.nativeElement),this.editForm.register(this),this.halEditing.temporaryEditResource(this.resource).values$().pipe(this.untilDestroyed()).subscribe(e=>{this.resource=e,this.render()})}startDragOverActivation(e){return!(this.isDropTarget&&this.isEditable&&!this.active)||(this.handleUserActivate(null),e.preventDefault(),!1)}render(){const e=this.fieldRenderer.render(this.resource,this.fieldName,null,this.displayPlaceholder);this.displayContainer.nativeElement.innerHTML="",this.displayContainer.nativeElement.appendChild(e)}deactivate(e=!1){this.editContainer.nativeElement.innerHTML="",this.editContainer.nativeElement.hidden=!0,this.setActive(!1),e&&setTimeout(()=>this.$element.find(`.${c.b}`).focus(),20)}get isEditable(){const e=this.resource.schema[this.fieldName];return this.resource.isAttributeEditable(this.fieldName)&&e&&e.writable}activateIfEditable(e){if(n.hasSelectionWithin(e.target))return Object(l.a)(`Not activating ${this.fieldName} because of active selection within`),!0;return jQuery(e.target).closest("a,macro",this.displayContainer.nativeElement).length>0||(this.isEditable&&this.handleUserActivate(e),this.opContextMenu.close(),e.preventDefault(),e.stopImmediatePropagation(),!1)}activateOnForm(e=!1){return this.setActive(!0),this.editForm.activate(this.fieldName,e).catch(()=>this.deactivate(!0))}handleUserActivate(e){let t=0;return e&&(t=g.a.getPosition(e)),this.activateOnForm().then(e=>{e&&(e.$onUserActivate.next(),e.focus(t))}),!1}reset(){this.render(),this.deactivate()}}j.\u0275fac=function(e){return new(e||j)(b.gc(r.a),b.gc(b.A),b.gc(b.q),b.gc(a.a),b.gc(d.a),b.gc(u.a),b.gc(o.a),b.gc(s.a),b.gc(m.a),b.gc(h.a),b.gc(b.i),b.gc(p.a))},j.\u0275cmp=b.ac({type:j,selectors:[["editable-attribute-field"]],viewQuery:function(e,t){var i;(1&e&&(b.Wc(y,!0),b.Wc(k,!0)),2&e)&&(b.Nc(i=b.vc())&&(t.displayContainer=i.first),b.Nc(i=b.vc())&&(t.editContainer=i.first))},inputs:{fieldName:"fieldName",resource:"resource",wrapperClasses:"wrapperClasses",displayFieldOptions:"displayFieldOptions",displayPlaceholder:"displayPlaceholder",isDropTarget:"isDropTarget"},features:[b.Qb],decls:5,vars:9,consts:[[3,"ngClass","dragover"],[3,"hidden"],["editContainer",""],["tabindex","-1",3,"accessibleClickStopEvent","hidden","accessibleClick"],["displayContainer",""]],template:function(e,t){1&e&&(b.mc(0,"div",0),b.uc("dragover",(function(e){return t.startDragOverActivation(e)})),b.hc(1,"div",1,2),b.mc(3,"div",3,4),b.uc("accessibleClick",(function(e){return t.activateIfEditable(e)})),b.lc(),b.lc()),2&e&&(b.Bc("ngClass",b.Jc(4,C,t.editFieldContainerClass,t.fieldName,t.active?"-active":"",t.wrapperClasses||"-small")),b.Tb(1),b.Bc("hidden",!t.active),b.Tb(2),b.Bc("accessibleClickStopEvent",!1)("hidden",t.active))},directives:[w.n,v.a],encapsulation:2,changeDetection:0})},"87fy":function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("mrSG"),s=i("Uyc6"),a=i("iMRi"),r=i("4n9w"),c=i("sjKJ"),o=i("FDFi"),l=i("tmNb"),d=i("99YG"),u=i("ug4p"),h=i("qc15"),p=i("fXoL");class g{constructor(e,t,i,n,s,a,r,c,o){this.states=e,this.injector=t,this.reorderService=i,this.wpCreate=n,this.notificationService=s,this.wpCacheService=a,this.currentProject=r,this.dragService=c,this.wpInlineCreate=o}init(e){this.cardView=e}destroy(){null!==this.dragService&&this.dragService.remove(this.cardView.container.nativeElement)}registerDragAndDrop(){null!==this.dragService&&this.dragService.register({dragContainer:this.cardView.container.nativeElement,scrollContainers:[this.cardView.container.nativeElement],moves:e=>{const t=e.dataset.workPackageId,i=this.states.workPackages.get(t).value;return!!i&&this.cardView.canDragOutOf(i)&&!e.dataset.isNew},accepts:()=>this.cardView.dragInto,onMoved:e=>Object(n.b)(this,void 0,void 0,(function*(){const t=e.dataset.workPackageId,i=d.a.findIndex(e),n=yield this.reorderService.move(this.currentOrder,t,i);this.updateOrder(n),this.cardView.onMoved.emit()})),onRemoved:e=>{const t=e.dataset.workPackageId,i=this.reorderService.remove(this.currentOrder,t);this.updateOrder(i)},onAdded:e=>Object(n.b)(this,void 0,void 0,(function*(){const t=e.dataset.workPackageId,i=d.a.findIndex(e),n=yield this.wpCacheService.require(t),s=yield this.addWorkPackageToQuery(n,i);return e.parentElement&&e.parentElement.removeChild(e),s}))})}get workPackages(){return this._workPackages}set workPackages(e){if(this.activeInlineCreateWp){let t=this._workPackages.find(e=>e.isNew);if(t){let e=this._workPackages.indexOf(t);this._workPackages[e]=this.activeInlineCreateWp}else this._workPackages=[this.activeInlineCreateWp,...e]}else this._workPackages=[...e]}get currentOrder(){return this.workPackages.filter(e=>e&&!e.isNew).map(e=>e.id)}updateOrder(e){e=_.uniq(e),Promise.all(e.map(e=>this.wpCacheService.require(e))).then(e=>{this.workPackages=e,this.cardView.cdRef.detectChanges()})}addNewCard(){this.wpCreate.createOrContinueWorkPackage(this.currentProject.identifier).then(e=>{this.activeInlineCreateWp=e.projectedResource,this.workPackages=this.workPackages,this.cardView.cdRef.detectChanges()})}addWorkPackageToQuery(e,t=-1){return Object(n.b)(this,void 0,void 0,(function*(){try{yield this.cardView.workPackageAddedHandler(e);const i=yield this.reorderService.add(this.currentOrder,e.id,t);return this.updateOrder(i),!0}catch(i){this.notificationService.handleRawError(i,e)}return!1}))}removeReferenceWorkPackageForm(){this.activeInlineCreateWp&&this.removeCard(this.activeInlineCreateWp)}removeCard(e){const t=this.workPackages.indexOf(e);if(this.workPackages.splice(t,1),this.activeInlineCreateWp=void 0,!e.isNew){const t=this.reorderService.remove(this.currentOrder,e.id);this.updateOrder(t)}}onCardSaved(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=this.workPackages.findIndex(e=>"new"===e.id);if(-1!==t){this.activeInlineCreateWp=void 0;const i=yield this.reorderService.add(this.currentOrder,e.id,t);this.updateOrder(i),this.wpInlineCreate.newInlineWorkPackageCreated.next(e.id)}}))}}g.\u0275fac=function(e){return new(e||g)(p.qc(a.a),p.qc(p.A),p.qc(s.a),p.qc(r.a),p.qc(h.a),p.qc(u.a),p.qc(c.a),p.qc(l.a,8),p.qc(o.a))},g.\u0275prov=p.cc({token:g,factory:g.\u0275fac})},"8OyR":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.setBodyCursor=function(e,t=""){document.body.style.setProperty("cursor",e,t)}}(n||(n={}))},"8VVp":function(e,t,i){"use strict";i.d(t,"a",(function(){return we}));var n=i("fXoL"),s=i("tk/3"),a=i("ii2/"),r=i("NawS"),c=i("Mo6U");class o extends c.a{get state(){return this.states.schemas.get(this.href)}get availableAttributes(){return _.keys(this.$source).filter(e=>0!==e.indexOf("_"))}}class l extends c.a{get state(){return this.states.types.get(this.href)}}class d extends c.a{forValue(e){return this.dependencies[e]}}var u=i("XZsv"),h=i("y2Tr"),p=i("hxxE");class g extends p.a{}var m=i("B4Ei");class f extends c.a{getErrors(){const e=_.values(this.validationErrors),t=e.length;if(0===t)return null;let i;return 1===t?i=new u.a(this.injector,e[0],!0,this.halInitializer,"Error"):(i=new u.a(this.injector,{},!0,this.halInitializer,"Error"),i.errorIdentifier=u.b,i.errors=e),i.isValidationError=!0,i}}var b=i("AA01");class w extends o{get _type(){return"QueryFilterInstanceSchema"}get availableOperators(){return this.operator.allowedValues}get allowedFilterValue(){return this.filter.allowedValues instanceof p.a?this.filter.allowedValues.elements[0]:this.filter.allowedValues[0]}$initialize(e){super.$initialize(e),e._dependencies&&(this.dependency=new d(this.injector,e._dependencies[0],!0,this.halInitializer,"SchemaDependency"))}getFilter(){let e=this.operator.allowedValues[0],t=this.filter.allowedValues[0],i={name:t.name,_links:{filter:t.$source._links.self,schema:this.$source._links.self,operator:e.$source._links.self}};this.definesAllowedValues()?i._links.values=[]:i.values=[];let n=new b.a(this.injector,i,!0,this.halInitializer,"QueryFilterInstance");return n.schema=this,n}isValueRequired(){return!!this.values}isResourceValue(){return!(!this.values||!this.values.allowedValues)}resultingSchema(e){let t=this.$source,i=this.dependency.forValue(e.href.toString()),n={};return _.merge(n,t,i),new w(this.injector,n,!0,this.halInitializer,"QueryFilterInstanceSchema")}definesAllowedValues(){return _.some(this._dependencies[0].dependencies,e=>e.values&&e.values._links&&e.values._links.allowedValues)}}var v=i("d4d5");class y extends c.a{}class k extends c.a{get id(){return this.$source.id||this.idFromLink}get idFromLink(){if(this.$href){const e=c.a.idFromLink(this.$href);return decodeURIComponent(e)}return""}set id(e){this.$source.id=e}}class C extends c.a{}var j=i("RWlv"),x=i("LrpJ");class T extends c.a{constructor(){super(...arguments),this.attachmentsBackend=!1}}const S=Object(x.a)(T);class P extends c.a{constructor(){super(...arguments),this.attachmentsBackend=!1}}const I=Object(x.a)(P);class O extends c.a{constructor(){super(...arguments),this.attachmentsBackend=!1}}const R=Object(x.a)(O);class B extends c.a{get state(){return this.states.statuses.get(this.href)}}var E=i("/8SZ"),M=i("PHo6"),F=i("uhGA"),A=i("qvol");class D extends c.a{}var q=i("Nnhs");class L extends c.a{}class $ extends c.a{}var N=i("mrSG"),Q=i("dMmB"),V=i("r0MM");class H extends c.a{get state(){return this.states.projects.get(this.id)}getEditorTypeFor(e){return-1!==["statusExplanation","description"].indexOf(e)?"full":"constrained"}get schema(){const e=this.schemaCacheService.state(this);if(!e.hasValue())throw`Accessing schema of ${this.id} without it being loaded.`;return e.value}$linkableKeys(){return _.without(super.$linkableKeys(),"schema")}}Object(N.c)([Object(V.a)(),Object(N.e)("design:type",Q.a)],H.prototype,"schemaCacheService",void 0);class z extends c.a{}const Y={WorkPackage:{cls:a.a,attrTypes:{parent:"WorkPackage",ancestors:"WorkPackage",children:"WorkPackage",relations:"Relation",schema:"Schema",status:"Status",type:"Type"}},Activity:{cls:c.a,attrTypes:{user:"User"}},"Activity::Comment":{cls:c.a,attrTypes:{user:"User"}},"Activity::Revision":{cls:c.a,attrTypes:{user:"User"}},Relation:{cls:r.a,attrTypes:{from:"WorkPackage",to:"WorkPackage"}},Schema:{cls:o},Type:{cls:l},Status:{cls:B},SchemaDependency:{cls:d},Error:{cls:u.a},User:{cls:h.a},Group:{cls:z},Collection:{cls:p.a},WorkPackageCollection:{cls:g},AttachmentCollection:{cls:E.a},Query:{cls:m.a,attrTypes:{filters:"QueryFilterInstance"}},Form:{cls:f,attrTypes:{payload:"FormPayload"}},FormPayload:{cls:c.a,attrTypes:{attachments:"AttachmentsCollection"}},QueryFilterInstance:{cls:b.a,attrTypes:{schema:"QueryFilterInstanceSchema",filter:"QueryFilter",operator:"QueryOperator"}},QueryFilterInstanceSchema:{cls:w},QueryFilter:{cls:v.a},Root:{cls:y},QueryOperator:{cls:k},HelpText:{cls:C},CustomAction:{cls:j.a},WikiPage:{cls:S},MeetingContent:{cls:I},Post:{cls:R},Project:{cls:H},Role:{cls:$},Grid:{cls:F.a},GridWidget:{cls:M.a},TimeEntry:{cls:A.a},Membership:{cls:L},News:{cls:D},Version:{cls:q.a}};var W=i("kTsZ"),U=i("XaHm"),G=i("Ul5t"),X=i("6x6j"),K=i("0bag"),Z=i("OGNV"),J=i("1MaS"),ee=i("9cVk"),te=i("iMRi"),ie=i("Jui0");class ne{constructor(e,t,i){this.halResourceService=e,this.states=t,this.pathHelper=i}loadAll(e){const t=this.pathHelper.api.v3.withOptionalProject(e).types.toString();return this.halResourceService.get(t).toPromise().then(e=>(_.each(e.elements,e=>this.states.types.get(e.href).putValue(e)),e.elements))}load(){return this.halResourceService.get(this.pathHelper.api.v3.root.toString()).toPromise()}}ne.\u0275fac=function(e){return new(e||ne)(n.qc(W.a),n.qc(te.a),n.qc(ie.a))},ne.\u0275prov=n.cc({token:ne,factory:ne.\u0275fac});var se=i("HGdY"),ae=i("TTfU"),re=i("Ywds"),ce=i("n9mQ"),oe=i("j/Ak"),le=i("ofXK"),de=i("DDsP"),ue=i("DP6S"),he=i("VQC/"),pe=i("Gyz5"),ge=i("PSqx"),me=i("POAS"),fe=i("wZYP");class be extends n.r{constructor(e){super(),this.I18n=e,this.text={internal_error:this.I18n.t("js.error.internal")}}handleError(e){let t=this.text.internal_error;e instanceof u.a?(console.error("Returned error resource %O",e),t+=` ${e.errorMessages.join("\n")}`):e instanceof c.a?(console.error("Returned hal resource %O",e),t+=`Resource returned ${e.name}`):e instanceof Error?window.ErrorReporter.captureException(e):"string"==typeof e&&(window.ErrorReporter.captureMessage(e),t=e),super.handleError(t)}}be.\u0275fac=function(e){return new(e||be)(n.qc(fe.a))},be.\u0275prov=n.cc({token:be,factory:be.\u0275fac});class we{}we.\u0275mod=n.ec({type:we}),we.\u0275inj=n.dc({factory:function(e){return new(e||we)},providers:[{provide:n.r,useClass:be},{provide:s.a,useClass:se.a,multi:!0},{provide:n.c,useFactory:function(e){return()=>{_.each(Y,(t,i)=>e.registerResource(i,t))}},deps:[W.a],multi:!0},U.a,ce.a,G.a,ge.a,de.a,X.a,re.a,K.a,pe.a,Z.a,J.a,ee.a,oe.a,ne,ae.a,ue.a,he.a,me.a],imports:[[le.b,s.c]]})},"8YXA":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("iB+3"),s=i("4lR/"),a=i("13ri"),r=i("PUHT"),c=i("RGDJ"),o=i("buwf"),l=i("4n9w"),d=i("fXoL");class u extends r.a{constructor(e,t,i,n,s){super(e,t),this.elementRef=e,this.opContextMenu=t,this.browserDetector=i,this.wpCreate=n,this.$state=s}ngAfterViewInit(){super.ngAfterViewInit(),this.active&&(this.browserDetector.isMobile&&(this.stateName="work-packages.new"),this.loadingPromise=this.wpCreate.getEmptyForm(this.projectIdentifier).then(e=>this.buildItems(e.schema.type.allowedValues)))}open(e){this.loadingPromise.then(()=>{this.opContextMenu.show(this,e)})}get locals(){return{items:this.items,contextMenuId:"types-context-menu"}}buildItems(e){this.items=e.map(e=>({disabled:!1,linkText:e.name,href:this.$state.href(this.stateName,{type:e.id}),ariaLabel:e.name,class:c.a.inlineClass("type",e.id),onClick:t=>!a.a.isClickedWithModifier(t)&&(this.$state.go(this.stateName,{type:e.id}),!0)}))}}u.\u0275fac=function(e){return new(e||u)(d.gc(d.q),d.gc(s.a),d.gc(o.a),d.gc(l.a),d.gc(n.G))},u.\u0275dir=d.bc({type:u,selectors:[["","opTypesCreateDropdown",""]],inputs:{projectIdentifier:"projectIdentifier",stateName:"stateName",active:["dropdownActive","active"]},features:[d.Qb]})},"8aTQ":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("SqdZ"),s=i("IaZ+"),a=i("wZYP"),r=i("fXoL"),c=i("ofXK");function o(e,t){if(1&e){const e=r.nc();r.mc(0,"a",11),r.mc(1,"i",12),r.uc("click",(function(t){return r.Qc(e),r.wc().closeMe(t)})),r.lc(),r.lc()}if(2&e){const e=r.wc();r.Tb(1),r.Ub("title",e.text.close_popup)}}function l(e,t){if(1&e&&(r.mc(0,"span"),r.hc(1,"br"),r.mc(2,"strong"),r.ad(3),r.lc(),r.lc()),2&e){const e=t.$implicit;r.Tb(3),r.bd(e)}}const d=function(e){return{"-highlight -danger-zone":e}};class u extends n.a{constructor(e,t,i,n){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.I18n=n,this.confirmed=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text"),button_continue:this.I18n.t("js.button_continue"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.options=t.options||{},this.dangerHighlighting=_.defaultTo(this.options.dangerHighlighting,!1),this.passedData=_.defaultTo(this.options.passedData,[]),this.closeOnEscape=_.defaultTo(this.options.closeByEscape,!0),this.closeOnOutsideClick=_.defaultTo(this.options.closeByDocument,!0),this.showClose=_.defaultTo(this.options.showClose,!0),this.text=_.defaults(this.options.text,this.text)}confirmAndClose(e){this.confirmed=!0,this.closeMe(e)}}u.\u0275fac=function(e){return new(e||u)(r.gc(r.q),r.gc(s.a),r.gc(r.i),r.gc(a.a))},u.\u0275cmp=r.ac({type:u,selectors:[["ng-component"]],features:[r.Qb],decls:13,vars:12,consts:[[1,"op-modal--portal","confirm-form-submit--modal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","confirm-dialog--modal","loading-indicator--location",3,"ngClass"],[1,"op-modal--modal-header"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"icon-context","icon-attention",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[3,"textContent"],[4,"ngFor","ngForOf"],[1,"op-modal--modal-footer"],[1,"confirm-form-submit--continue","button",3,"ngClass","textContent","click"],[1,"confirm-form-submit--cancel","button",3,"textContent","click"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"]],template:function(e,t){1&e&&(r.mc(0,"div",0),r.mc(1,"div",1),r.mc(2,"div",2),r.Yc(3,o,2,1,"a",3),r.hc(4,"h3",4),r.lc(),r.mc(5,"div",5),r.mc(6,"p"),r.hc(7,"span",6),r.hc(8,"br"),r.Yc(9,l,4,1,"span",7),r.lc(),r.lc(),r.mc(10,"div",8),r.mc(11,"button",9),r.uc("click",(function(e){return t.confirmAndClose(e)})),r.lc(),r.mc(12,"button",10),r.uc("click",(function(e){return t.closeMe(e)})),r.lc(),r.lc(),r.lc(),r.lc()),2&e&&(r.Tb(1),r.Bc("ngClass",r.Gc(10,d,t.dangerHighlighting)),r.Tb(2),r.Bc("ngIf",t.showClose),r.Tb(1),r.Bc("textContent",t.text.title),r.Tb(3),r.Bc("textContent",t.text.text),r.Tb(2),r.Bc("ngForOf",t.passedData),r.Tb(2),r.Bc("ngClass",t.dangerHighlighting?"-danger":"-highlight")("textContent",t.text.button_continue),r.Ub("title",t.text.button_continue),r.Tb(1),r.Bc("textContent",t.text.button_cancel),r.Ub("title",t.text.button_cancel))},directives:[c.n,c.q,c.p],encapsulation:2})},"8ggW":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("3Pt+"),s=i("ofXK"),a=i("fXoL");class r{}r.\u0275mod=a.ec({type:r}),r.\u0275inj=a.dc({factory:function(e){return new(e||r)},imports:[[n.i,s.b]]})},"8h6p":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("fXoL"),s=i("ofXK");function a(e,t){if(1&e&&n.hc(0,"span",3),2&e){const e=n.wc();n.Bc("textContent",e.description)}}class r{constructor(){this.setHostClass=!0}}r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=n.ac({type:r,selectors:[["no-results"]],hostVars:2,hostBindings:function(e,t){2&e&&n.Xb("generic-table--no-results-container",t.setHostClass)},inputs:{title:"title",description:"description"},decls:4,vars:2,consts:[["aria-hidden","true",1,"icon-info1"],[1,"generic-table--no-results-title"],[3,"textContent",4,"ngIf"],[3,"textContent"]],template:function(e,t){1&e&&(n.hc(0,"i",0),n.mc(1,"span",1),n.ad(2),n.Yc(3,a,1,1,"span",2),n.lc()),2&e&&(n.Tb(2),n.cd(" ",t.title," "),n.Tb(1),n.Bc("ngIf",t.description))},directives:[s.q],encapsulation:2})},"8jMx":function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("mrSG"),s=i("wZYP"),a=i("iMRi"),r=i("6XbZ"),c=i("4nS0"),o=i("T9ri"),l=i("nbRO"),d=i("r0MM");function u(e){return`group-${e.identifier}`}class h{constructor(e){this.injector=e,this.text={collapse:this.I18n.t("js.label_collapse"),expand:this.I18n.t("js.label_expand")}}buildGroupRow(e,t){let i,n,s=document.createElement("tr");return e.collapsed?(n=this.text.expand,i="icon-plus"):(n=this.text.collapse,i="icon-minus2"),s.classList.add(l.b,u(e)),s.id=`wp-table-rowgroup-${e.index}`,s.dataset.groupIndex=e.index.toString(),s.dataset.groupIdentifier=e.identifier,s.innerHTML=`\n      <td colspan="${t}" class="-no-highlighting">\n        <div class="expander icon-context ${i}">\n          <span class="hidden-for-sighted">${_.escape(n)}</span>\n        </div>\n        <div class="group--value">\n          ${_.escape(Object(o.c)(e))}\n          <span class="count">\n            (${e.count})\n          </span>\n        </div>\n      </td>\n    `,s}}Object(n.c)([Object(d.a)(),Object(n.e)("design:type",s.a)],h.prototype,"I18n",void 0);var p=i("LHWx");class g extends p.a{constructor(e,t,i,n,s){super(e,t,new r.a(e,t)),this.injector=e,this.workPackageTable=t,this.groups=i,this.headerBuilder=n,this.colspan=s}doRender(){let e=null;this.workPackageTable.originalRows.forEach(t=>{let i=this.workPackageTable.originalRowIndex[t],n=this.matchingGroup(i.object);if(n&&e!==n){const t=u(n);let i=this.headerBuilder.buildGroupRow(n,this.colspan);this.appendNonWorkPackageRow(i,t),e=n}i.group=e,this.buildSingleRow(i)})}matchingGroup(e){return _.find(this.groups,t=>{let i=e[Object(o.a)(t)];if(void 0===i&&(i=null),_.isArray(i))return this.matchesMultiValue(i,t);if(i&&i.$href)return!!_.find(t._links.valueLink,e=>i.$href===e.href);let n=""===t.value?null:t.value;return n&&(n=n.replace("%","")),n==i})}matchesMultiValue(e,t){if(e.length!==t.href.length)return!1;let i=e=>_.map(e,e=>e.href).sort().join(", ");return _.isEqualWith(e,t.href,(e,t)=>i(e)===i(t))}buildSingleRow(e){const t=e.group,i=t.collapsed;let n=[],[s,a]=this.rowBuilder.buildEmpty(e.object);n.push(Object(o.d)(t.index)),i&&n.push(l.a),e.element=s,s.classList.add(...n),this.appendRow(e.object,s,n,i)}}var m=i("E2tj"),f=i("JY8V");class b extends c.a{constructor(e,t){super(e,t),this.injector=e}isApplicable(e){return!_.isEmpty(this.groups)}get groups(){return this.querySpace.groups.value||[]}get collapsedGroups(){return this.querySpace.collapsedGroups.value||{}}get colspan(){return this.wpTableColumns.columnCount+2}buildRows(){const e=new h(this.injector);return new g(this.injector,this.workPackageTable,this.getGroupData(),e,this.colspan).render()}refreshExpansionState(){const e=this.getGroupData(),t=this.wpTableColumns.columnCount+1,i=this.querySpace.tableRendered.value,n=new h(this.injector);jQuery(this.workPackageTable.tableAndTimelineContainer).find(`.${l.b}`).each((s,a)=>{let c=jQuery(a).data("groupIndex"),d=e[c],u=n.buildGroupRow(d,t);a.parentNode&&a.parentNode.replaceChild(u,a);const h=jQuery(this.workPackageTable.tableAndTimelineContainer).find(`.${Object(o.d)(c)}`);h.toggleClass(l.a,!!d.collapsed),h.filter(`.${r.c}`).each((e,t)=>{const n=jQuery(t).index();i[n].hidden=!!d.collapsed})}),this.querySpace.tableRendered.putValue(i,"Updated hidden state of rows after group change.")}getGroupData(){return this.groups.map((e,t)=>(e.index=t,e._links&&e._links.valueLink&&(e.href=e._links.valueLink),e.identifier=Object(o.b)(e),e.collapsed=this.collapsedGroups[e.identifier],e))}}Object(n.c)([Object(d.a)(),Object(n.e)("design:type",m.a)],b.prototype,"querySpace",void 0),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",a.a)],b.prototype,"states",void 0),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",f.a)],b.prototype,"wpTableColumns",void 0),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",s.a)],b.prototype,"I18n",void 0)},"8ocD":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(){this.fields={},this.classes={}}fieldType(e){return this.fields[e]}getClassFor(e,t="unknown"){let i=this.fieldType(e)||this.fieldType(t)||this.defaultFieldType;return this.classes[i]}getSpecificClassFor(e,t,i="unknown"){let n=this.fieldType(`${e}-${t}`)||this.fieldType(`${e}-${i}`);return n?this.classes[n]:this.getClassFor(t,i)}addFieldType(e,t,i){return e.fieldType=t,this.register(e,i),this}addSpecificFieldType(e,t,i,n){return t.fieldType=`${e}-${i}`,n=n.map(t=>`${e}-${t}`),this.register(t,n),this}extendFieldType(e,t){let i=this.classes[e]||this.getClassFor(e);return this.addFieldType(i,e,t)}register(e,t=[]){const i=e.fieldType;t.forEach(e=>this.fields[e]=i),this.classes[i]=e}}},"8zkO":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("wZYP"),s=i("XaHm"),a=i("wd/R"),r=i("fXoL");class c{constructor(e,t){this.I18n=e,this.configurationDm=t,this.initialized=this.loadConfiguration().then(()=>!0).catch(()=>!1)}commentsSortedInDescendingOrder(){return this.userPreference("commentSortDescending")}warnOnLeavingUnsaved(){return this.userPreference("warnOnLeavingUnsaved")}autoHidePopups(){return this.userPreference("autoHidePopups")}isTimezoneSet(){return!!this.timezone()}timezone(){return this.userPreference("timeZone")}get maximumAttachmentFileSize(){return this.systemPreference("maximumAttachmentFileSize")}get perPageOptions(){return this.systemPreference("perPageOptions")}dateFormatPresent(){return!!this.systemPreference("dateFormat")}dateFormat(){return this.systemPreference("dateFormat")}timeFormatPresent(){return!!this.systemPreference("timeFormat")}timeFormat(){return this.systemPreference("timeFormat")}startOfWeekPresent(){return!!this.systemPreference("startOfWeek")}startOfWeek(){return this.startOfWeekPresent()?this.systemPreference("startOfWeek"):a.localeData(I18n.locale).firstDayOfWeek()}loadConfiguration(){return this.configurationDm.load().toPromise().then(e=>{this.configuration=e})}userPreference(e){return _.get(this.configuration,["userPreferences",e])}systemPreference(e){return _.get(this.configuration,e)}}c.\u0275fac=function(e){return new(e||c)(r.qc(n.a),r.qc(s.a))},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac,providedIn:"root"})},"9+6k":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("AEvm");class s extends n.a{constructor(e){super(),this.opContextMenu=e,this.items=[]}onClose(){this.afterFocusOn.focus()}onOpen(e){e.find(".menu-item").first().focus()}positionArgs(e){return{my:"left top",at:"right bottom",of:e,collision:"flipfit"}}get locals(){return{items:this.items}}open(e){this.opContextMenu.show(this,e)}get afterFocusOn(){return this.$element}}},"99YG":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.findIndex=function(e){return e.parentElement?Array.from(e.parentElement.children).indexOf(e):-1},e.reinsert=function(e,t,i){t="string"==typeof t?parseInt(t,10):t;const n=Array.from(i.children);(t<0||t>=n.length||0===n.length)&&i.appendChild(e);const s=n[t];s?i.insertBefore(e,s):i.appendChild(e)}}(n||(n={}))},"9cVk":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("kTsZ"),s=i("Jui0"),a=i("fXoL");class r{constructor(e,t){this.halResourceService=e,this.pathHelper=t}load(){return this.halResourceService.get(this.pathHelper.api.v3.root.toString()).toPromise()}}r.\u0275fac=function(e){return new(e||r)(a.qc(n.a),a.qc(s.a))},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac})},"9hh2":function(e,t,i){"use strict";i.d(t,"a",(function(){return We}));var n=i("wZYP"),s=i("mrSG"),a=i("qHU1"),r=i("iMRi"),c=i("Ncnr"),o=i("SKFm"),l=i("6XbZ"),d=i("Yg+W"),u=i("GjwL"),h=i("r0MM");class p extends d.a{constructor(e,t){super(),this.injector=e}get EVENT(){return"click.table.cell, keydown.table.cell"}get SELECTOR(){return`.${c.b}.${c.d}`}eventScope(e){return jQuery(e.tableAndTimelineContainer)}processEvent(e,t){Object(a.a)("Starting editing on cell: ",t.target),t.preventDefault();let i=jQuery(t.target).closest(`.${c.b}`),n=i.data("fieldName");if(!n)return Object(a.a)("Click handled by cell not a field? ",t.target),!0;const s=i.closest(`.${l.c}`),r=s.data("workPackageId"),o=this.states.workPackages.get(r).value,d=s.data("classIdentifier"),h=e.editing.startEditing(o,d),p=u.a.getPosition(t);return h.activate(n).then(e=>{e.$onUserActivate.next(),e.focus(p)}).catch(()=>i.addClass(c.e)),!1}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",r.a)],p.prototype,"states",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",o.a)],p.prototype,"halEditing",void 0);var g=i("0Usb"),m=i("FB4C");class f extends d.a{constructor(e,t){super(),this.injector=e}get EVENT(){return"click.table.relationsCell, keydown.table.relationsCell"}get SELECTOR(){return`.${g.b}`}eventScope(e){return jQuery(e.tableAndTimelineContainer)}processEvent(e,t){Object(a.a)("Handled click on relation cell %o",t.target),t.preventDefault();const i=jQuery(t.target).closest(`.${g.c}`).data("columnId"),n=jQuery(t.target).closest(`.${l.c}`).data("workPackageId");return this.wpTableRelationColumns.getExpandFor(n)===i?this.wpTableRelationColumns.collapse(n):this.wpTableRelationColumns.setExpandFor(n,i),!1}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",m.a)],f.prototype,"wpTableRelationColumns",void 0);var b=i("cd/7"),w=i("4lR/"),v=i("qtzK"),y=i("7xci");class k extends v.a{constructor(e,t,i,n={},s){super(e,t,i,n,!0),this.injector=e,this.workPackageId=t,this.$element=i,this.additionalPositionArgs=n,this.table=s}triggerContextMenuAction(e){switch(e.key){case"relation-precedes":this.table.timelineController.startAddRelationPredecessor(this.workPackage);break;case"relation-follows":this.table.timelineController.startAddRelationFollower(this.workPackage);break;case"hierarchy-indent":this.wpViewIndentation.indent(this.workPackage);break;case"hierarchy-outdent":this.wpViewIndentation.outdent(this.workPackage);break;default:super.triggerContextMenuAction(e)}}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",y.a)],k.prototype,"wpViewIndentation",void 0);class C{constructor(e,t){this.injector=e,this.table=t}get rowSelector(){return`.${l.c}`}eventScope(e){return jQuery(e.tableAndTimelineContainer)}openContextMenu(e,t,i){const n=new k(this.injector,t,jQuery(e.target),i,this.table);this.opContextMenu.show(n,e)}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",w.a)],C.prototype,"opContextMenu",void 0);var j=i("/cHX");class x extends C{constructor(e,t){super(e,t),this.injector=e}get EVENT(){return"click.table.contextmenu"}get SELECTOR(){return`.${j.c}`}handleEvent(e,t){let i=jQuery(t.target);if(i.closest(`.${b.c}`).length)return Object(a.a)("Allowing original context menu on state link"),!0;t.preventDefault(),t.stopPropagation();const n=i.closest(this.rowSelector).data("workPackageId");return n&&super.openContextMenu(t,n),!1}}var T=i("E5Dd");class S extends C{constructor(e,t){super(e,t),this.injector=e}get EVENT(){return"keydown.table.contextmenu"}get SELECTOR(){return this.rowSelector}handleEvent(e,t){if(!e.configuration.contextMenuEnabled)return!1;let i=jQuery(t.target);if(t.keyCode!==T.a.F10||!t.shiftKey||!t.altKey)return!0;t.preventDefault(),t.stopPropagation();const n=i.closest(this.SELECTOR).data("workPackageId");let s={my:"left top",at:"left bottom",of:i};return super.openContextMenu(t,n,s),!1}}var P=i("9nXh"),I=i("eyhC");class O extends C{constructor(e,t){super(e,t),this.injector=e}get EVENT(){return"contextmenu.table.rightclick"}get SELECTOR(){return`.${l.c},.${P.b}`}eventScope(e){return jQuery(e.tableAndTimelineContainer)}handleEvent(e,t){if(!e.configuration.contextMenuEnabled)return!1;let i=jQuery(t.target);if(i.closest(`.${b.c}`).length)return Object(a.a)("Allowing original context menu on state link"),!0;t.preventDefault(),t.stopPropagation();const n=i.closest(this.SELECTOR).data("workPackageId");if(n){let[e]=this.table.findRenderedRow(n);this.wpTableSelection.isSelected(n)||this.wpTableSelection.setSelection(n,e),super.openContextMenu(t,n)}return!1}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",I.a)],O.prototype,"wpTableSelection",void 0);var R=i("iB+3"),B=i("Y/CA"),E=i("PkGb"),M=i("e6KS");class F{constructor(e,t){this.injector=e}get EVENT(){return"click.table.row"}get SELECTOR(){return`.${l.c}`}eventScope(e){return jQuery(e.tbody)}handleEvent(e,t){let i=jQuery(t.target);if(i.is("a")||i.parent().is("a"))return!0;if(i.hasClass(`${c.b}`)||i.hasClass(`${M.b}`))return Object(a.a)("Skipping click on inner cell"),!0;let n=i.closest(this.SELECTOR),s=n.data("workPackageId"),r=n.data("classIdentifier");if(!s)return!0;let[o,l]=e.findRenderedRow(r);return t.ctrlKey||t.metaKey||t.shiftKey||this.wpTableSelection.setSelection(s,o),t.shiftKey&&this.wpTableSelection.setMultiSelectionFrom(e.renderedRows,s,o),(t.ctrlKey||t.metaKey)&&this.wpTableSelection.toggleRow(s),this.wpTableFocus.updateFocus(s),!1}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",R.G)],F.prototype,"$state",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",r.a)],F.prototype,"states",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",E.a)],F.prototype,"keepTab",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",I.a)],F.prototype,"wpTableSelection",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",B.a)],F.prototype,"wpTableFocus",void 0);var A=i("pXZk"),D=i("13ri");class q{constructor(e,t){this.injector=e}get EVENT(){return"dblclick.table.row"}get SELECTOR(){return`.${A.c}`}eventScope(e){return jQuery(e.tbody)}handleEvent(e,t){let i=jQuery(t.target);if(D.a.isClickedWithModifier(t))return!0;if(i.hasClass(`${c.b}`)||i.hasClass(`${M.b}`))return Object(a.a)("Skipping click on inner cell"),!0;let n=i.closest(this.SELECTOR).closest(`.${l.c}`).data("workPackageId");return!(!i.is("a")&&!i.parent().is("a"))||(this.wpTableFocus.updateFocus(n),this.$state.go("work-packages.show",{workPackageId:n}),!1)}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",R.G)],q.prototype,"$state",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",r.a)],q.prototype,"states",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",I.a)],q.prototype,"wpTableSelection",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",B.a)],q.prototype,"wpTableFocus",void 0);var L=i("8jMx"),$=i("E2tj"),N=i("nbRO");class Q{constructor(e,t){this.injector=e,this.builder=new L.a(e,t)}get EVENT(){return"click.table.groupheader"}get SELECTOR(){return`.${N.b} .expander`}eventScope(e){return jQuery(e.tbody)}handleEvent(e,t){t.preventDefault(),t.stopPropagation();let i=jQuery(t.target).parents(`.${N.b}`).data("groupIdentifier"),n=this.collapsedState.value||{};n[i]=!n[i],this.collapsedState.putValue(n);var s=performance.now();this.builder.refreshExpansionState();var r=performance.now();Object(a.a)("Group redraw took "+(r-s)+" milliseconds.")}get collapsedState(){return this.querySpace.collapsedGroups}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",$.a)],Q.prototype,"querySpace",void 0);var V=i("wyKs");class H extends d.a{constructor(e,t){super(),this.injector=e}get EVENT(){return"click.table.hierarchy"}get SELECTOR(){return".wp-table--hierarchy-indicator"}eventScope(e){return jQuery(e.tbody)}processEvent(e,t){let i=jQuery(t.target).closest(`.${l.c}`).data("workPackageId");return this.wpTableHierarchies.toggle(i),t.stopImmediatePropagation(),t.preventDefault(),!1}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",r.a)],H.prototype,"states",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",V.a)],H.prototype,"wpTableHierarchies",void 0);class z{constructor(e,t){this.injector=e}get EVENT(){return"click.table.wpLink"}get SELECTOR(){return`.${b.c}`}eventScope(e){return jQuery(e.tableAndTimelineContainer)}handleEvent(e,t){if(t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)return!0;const i=jQuery(t.target),n=i.closest(this.SELECTOR),s=n.data("wpState"),a=n.data("workPackageId");i.closest("a").blur();let r=i.closest(`.${l.c}`).data("classIdentifier"),[c,o]=e.findRenderedRow(r);return this.wpTableSelection.setSelection(a,c),this.$state.go(this.keepTab[s],{workPackageId:a,focus:!0}),t.preventDefault(),t.stopPropagation(),!1}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",R.G)],z.prototype,"$state",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",E.a)],z.prototype,"keepTab",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",r.a)],z.prototype,"states",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",I.a)],z.prototype,"wpTableSelection",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",B.a)],z.prototype,"wpTableFocus",void 0);var Y=i("1G5W"),W=i("JY8V");class U{constructor(e,t){this.injector=e,this.table=t,this.wpTableColumns.updates$().pipe(Object(Y.a)(this.querySpace.stopAllSubscriptions)).subscribe(()=>{if(t.originalRows.length>0){var e=performance.now();t.redrawTable();var i=performance.now();Object(a.a)("column redraw took "+(i-e)+" milliseconds.")}})}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",$.a)],U.prototype,"querySpace",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",W.a)],U.prototype,"wpTableColumns",void 0);var G=i("5+Sy"),X=i("lJxs"),K=i("/uUt"),Z=i("pLZG"),J=i("CBsm"),ee=i("xV+i");class te{constructor(e,t){this.injector=e,this.wpTableHierarchies.updates$().pipe(Object(Y.a)(this.querySpace.stopAllSubscriptions),Object(X.a)(e=>e.isVisible),Object(K.a)()).subscribe(()=>{this.wpTableHierarchies.isEnabled||t.redrawTableAndTimeline()});let i=this.wpTableHierarchies.isEnabled;this.wpTableHierarchies.updates$().pipe(Object(Y.a)(this.querySpace.stopAllSubscriptions),Object(Z.a)(()=>this.querySpace.tableRendered.hasValue())).subscribe(e=>{e.isVisible===i&&this.renderHierarchyState(e),i=e.isVisible})}renderHierarchyState(e){const t=this.querySpace.tableRendered.value;jQuery('[class^="__hierarchy-group-"]').removeClass((e,t)=>(t.match(/__collapsed-group-\d+/g)||[]).join(" "));const i={};_.each(e.collapsed,(e,n)=>{jQuery(`.${Object(J.d)(n)} .wp-table--hierarchy-indicator`).toggleClass(ee.c,e);const s=jQuery(`.${Object(J.c)(n)}`);s.toggleClass(Object(J.b)(n),e),s.filter(`.${l.c}`).each((n,s)=>{const a=jQuery(s).index();i[a]||(t[a].hidden=e,i[a]=e)})}),e.last&&Object(G.f)(e.last),this.querySpace.tableRendered.putValue(t,"Updated hidden state of rows after hierarchy change.")}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",V.a)],te.prototype,"wpTableHierarchies",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",$.a)],te.prototype,"querySpace",void 0);class ie{constructor(e,t){this.injector=e,this.wpTableRelationColumns.updates$().pipe(Object(Y.a)(this.querySpace.stopAllSubscriptions)).subscribe(()=>{t.redrawTableAndTimeline()})}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",m.a)],ie.prototype,"wpTableRelationColumns",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",$.a)],ie.prototype,"querySpace",void 0);var ne=i("Uyc6"),se=i("6yP5");class ae{constructor(e,t){this.injector=e,this.table=t,this.querySpace.initialized.values$().pipe(Object(Y.a)(this.querySpace.stopAllSubscriptions)).subscribe(()=>{let e;e=this.wpTableSortBy.isManualSortingMode?this.wpTableOrder.orderedWorkPackages():this.querySpace.results.value.elements,t.initialSetup(e)}),this.states.workPackages.observeChange().pipe(Object(Y.a)(this.querySpace.stopAllSubscriptions.asObservable()),Object(Z.a)(()=>{let e=this.querySpace.tableRendered.getValueOr([]);return e&&e.length>0})).subscribe(([e,t])=>{void 0!==t&&this.table.refreshRows(t)})}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",$.a)],ae.prototype,"querySpace",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",se.a)],ae.prototype,"wpTableSortBy",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",ne.a)],ae.prototype,"wpTableOrder",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",r.a)],ae.prototype,"states",void 0);var re=i("7ond");class ce{constructor(e,t){this.injector=e,this.table=t,this.querySpace.tableRendered.values$().pipe(Object(Y.a)(this.querySpace.stopAllSubscriptions)).subscribe(()=>{this.wpTableFocus.ifShouldFocus(e=>{const t=Object(G.b)(e);t.length&&(Object(G.f)(e),this.FocusHelper.focusElement(t,!0))})}),this.wpTableSelection.live$().pipe(Object(Y.a)(this.querySpace.stopAllSubscriptions)).subscribe(e=>{this.renderSelectionState(e)}),this.wpTableSelection.registerSelectAllListener(()=>t.renderedRows),this.wpTableSelection.registerDeselectAllListener()}renderSelectionState(e){const t=jQuery(this.table.tableAndTimelineContainer);t.find(`.${l.c}.${b.b}`).removeClass(b.b),_.each(e.selected,(e,i)=>{t.find(`.${l.c}[data-work-package-id="${i}"]`).toggleClass(b.b,e)})}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",I.a)],ce.prototype,"wpTableSelection",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",B.a)],ce.prototype,"wpTableFocus",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",$.a)],ce.prototype,"querySpace",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",re.a)],ce.prototype,"FocusHelper",void 0);var oe=i("PtkW");class le{constructor(e,t){this.injector=e,this.table=t,this.wpTableTimeline.live$().pipe(Object(Y.a)(this.querySpace.stopAllSubscriptions)).subscribe(e=>{this.renderVisibility(e.visible)})}renderVisibility(e){const t=jQuery(this.table.tableAndTimelineContainer).parent();t.find(".work-packages-tabletimeline--timeline-side").toggle(e),t.find(".work-packages-tabletimeline--table-side").toggleClass("-timeline-visible",e)}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",$.a)],le.prototype,"querySpace",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",oe.a)],le.prototype,"wpTableTimeline",void 0);var de=i("2Qcm");class ue{constructor(e,t){this.injector=e,this.wpTableHighlighting.updates$().pipe(Object(Y.a)(this.querySpace.stopAllSubscriptions),Object(K.a)()).subscribe(()=>t.redrawTable())}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",de.a)],ue.prototype,"wpTableHighlighting",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",$.a)],ue.prototype,"querySpace",void 0);var he=i("IzEk"),pe=i("FDFi"),ge=i("POAS"),me=i("pSHE"),fe=i("tmNb"),be=i("99YG"),we=i("buwf"),ve=i("ug4p"),ye=i("DhiE");class ke{constructor(e,t){this.injector=e,this.table=t,null!==this.dragService&&(this.inlineCreateService.newInlineWorkPackageCreated.pipe(Object(Y.a)(this.querySpace.stopAllSubscriptions)).subscribe(e=>Object(s.b)(this,void 0,void 0,(function*(){const t=yield this.wpTableOrder.add(this.currentOrder,e);this.updateRenderedOrder(t)}))),this.querySpace.stopAllSubscriptions.pipe(Object(he.a)(1)).subscribe(()=>{this.dragService.remove(this.table.tbody)}),this.dragService.register({dragContainer:this.table.tbody,scrollContainers:[this.table.scrollContainer],accepts:()=>!0,moves:(e,t,i)=>{if(!i.classList.contains("wp-table--drag-and-drop-handle"))return!1;const n=e.dataset.workPackageId,s=this.states.workPackages.get(n).value;return!!s&&this.actionService.canPickup(s)},onMoved:(e,t,i)=>Object(s.b)(this,void 0,void 0,(function*(){const t=e.dataset.workPackageId,n=this.findRowIndex(e);try{const i=yield this.wpCacheService.require(t),s=yield this.wpTableOrder.move(this.currentOrder,t,n);yield this.actionService.handleDrop(i,e),this.updateRenderedOrder(s),this.actionService.onNewOrder(s);let a=this.querySpace.query.value;a&&this.wpTableSortBy.switchToManualSorting(a)&&(yield this.wpListService.save(a))}catch(s){this.halNotification.handleRawError(s),be.a.reinsert(e,e.dataset.sourceIndex||-1,i)}})),onRemoved:e=>{const t=e.dataset.workPackageId,i=this.wpTableOrder.remove(this.currentOrder,t);this.updateRenderedOrder(i)},onAdded:e=>Object(s.b)(this,void 0,void 0,(function*(){const t=e.dataset.workPackageId,i=yield this.wpCacheService.require(t),n=this.findRowIndex(e);return this.actionService.handleDrop(i,e).then(()=>Object(s.b)(this,void 0,void 0,(function*(){const e=yield this.wpTableOrder.add(this.currentOrder,t,n);return this.updateRenderedOrder(e),this.actionService.onNewOrder(e),!0}))).catch(()=>!1)})),onCloned:(e,t)=>Object(s.b)(this,void 0,void 0,(function*(){const i=t.dataset.workPackageId,n=yield this.wpCacheService.require(i),s=e.children.length,a=document.createElement("td");a.textContent=n.subjectWithId(),a.colSpan=s,a.classList.add("wp-table--cell-td","subject"),e.style.maxWidth="500px",e.innerHTML=a.outerHTML})),onShadowInserted:e=>{this.browserDetector.isEdge||this.actionService.changeShadowElement(e)},onCancel:e=>{this.browserDetector.isEdge||this.actionService.changeShadowElement(e,!0)}}))}updateRenderedOrder(e){return Object(s.b)(this,void 0,void 0,(function*(){e=_.uniq(e);const t=yield Promise.all(e.map(e=>this.wpCacheService.require(e)));this.table.initialSetup(t)}))}get actionService(){return this.dragActionRegistry.get(this.injector)}get currentOrder(){return this.currentRenderedOrder.map(e=>e.workPackageId)}get currentRenderedOrder(){return this.querySpace.renderedWorkPackages.getValueOr([])}findRowIndex(e){return Array.from(this.table.tbody.getElementsByClassName(l.c)).indexOf(e)||0}}Object(s.c)([Object(h.a)(),Object(s.e)("design:type",r.a)],ke.prototype,"states",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",$.a)],ke.prototype,"querySpace",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",pe.a)],ke.prototype,"inlineCreateService",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",ge.a)],ke.prototype,"halNotification",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",se.a)],ke.prototype,"wpTableSortBy",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",ne.a)],ke.prototype,"wpTableOrder",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",we.a)],ke.prototype,"browserDetector",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",ve.a)],ke.prototype,"wpCacheService",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",ye.a)],ke.prototype,"wpListService",void 0),Object(s.c)([Object(h.a)(),Object(s.e)("design:type",me.a)],ke.prototype,"dragActionRegistry",void 0),Object(s.c)([Object(h.a)(fe.a,null),Object(s.e)("design:type",Object)],ke.prototype,"dragService",void 0);var Ce=i("WUI6");class je extends Ce.a{constructor(){super(...arguments),this.eventHandlers=[e=>new H(this.injector,e),e=>new p(this.injector,e),e=>new z(this.injector,e),e=>new F(this.injector,e),e=>new q(this.injector,e),e=>new Q(this.injector,e),e=>new O(this.injector,e),e=>new x(this.injector,e),e=>new S(this.injector,e),e=>new f(this.injector,e)],this.stateTransformers=[ce,ae,U,le,te,ie,ue,ke]}attachTo(e){this.stateTransformers.map(t=>new t(this.injector,e)),super.attachTo(e)}}var xe=i("itXk"),Te=i("U1xf"),Se=i("4EDS"),_e=i("AeZM"),Pe=i("5iud");class Ie{constructor(e){this.tableAndTimeline=e,this.lastHoveredElement=null,this.eventListener=e=>{const t=e.target;t&&t!==this.lastHoveredElement&&this.handleHover(t),this.lastHoveredElement=t}}activate(){window.addEventListener("mousemove",this.eventListener,{passive:!0})}deactivate(){window.removeEventListener("mousemove",this.eventListener),this.removeAllHoverClasses()}locateHoveredTableRow(e){const t=e.closest("tr");return 0===t.length?null:t[0]}locateHoveredTimelineRow(e){const t=e.closest("div.wp-timeline-cell");return 0===t.length?null:t[0]}handleHover(e){const t=jQuery(e),i=this.locateHoveredTableRow(t),n=this.locateHoveredTimelineRow(t);null!==i||null!==n?this.removeOldAndAddNewHoverClass(i,n):this.removeAllHoverClasses()}extractWorkPackageId(e){return parseInt(e.getAttribute("data-work-package-id"))}removeOldAndAddNewHoverClass(e,t){const i=null!==e?e:t,n=this.extractWorkPackageId(i),s=this.tableAndTimeline.find("tr.wp-row-"+n).first(),a=this.tableAndTimeline.find("div.wp-row-"+n).first();requestAnimationFrame(()=>{this.removeAllHoverClasses(),a.addClass("row-hovered"),s.addClass("row-hovered")})}removeAllHoverClasses(){this.tableAndTimeline.find(".row-hovered").removeClass("row-hovered")}}var Oe=i("5HGI"),Re=i("AEvm"),Be=i("fXoL");function Ee(e,t){1&e&&Be.hc(0,"col")}function Me(e,t){1&e&&Be.hc(0,"col",19)}function Fe(e,t){1&e&&Be.hc(0,"col",19)}function Ae(e,t){1&e&&Be.hc(0,"col")}function De(e,t){1&e&&Be.hc(0,"op-icon",23)}function qe(e,t){if(1&e&&(Be.mc(0,"th",20),Be.mc(1,"div",21),Be.Yc(2,De,1,0,"op-icon",22),Be.lc(),Be.lc()),2&e){const e=Be.wc(2);Be.Tb(2),Be.Bc("ngIf",e.manualSortEnabled)}}function Le(e,t){if(1&e&&(Be.mc(0,"th",24),Be.hc(1,"sortHeader",25),Be.lc()),2&e){const e=t.$implicit,i=Be.wc(2);Be.Tb(1),Be.Bc("headerColumn",e)("locale",e.custom_field&&e.custom_field.name_locale||i.locale)("table",i.workPackageTable)("opColumnsContextMenu-column",e)("opColumnsContextMenu-table",i.workPackageTable)}}function $e(e,t){1&e&&(Be.mc(0,"div",28),Be.hc(1,"wp-table-config-menu"),Be.lc())}function Ne(e,t){if(1&e&&(Be.mc(0,"th",26),Be.Yc(1,$e,2,0,"div",27),Be.lc()),2&e){const e=Be.wc(2);Be.Tb(1),Be.Bc("ngIf",e.configuration.columnMenuEnabled)}}function Qe(e,t){if(1&e&&(Be.mc(0,"tbody",29),Be.mc(1,"tr",30),Be.mc(2,"td"),Be.mc(3,"span"),Be.hc(4,"op-icon",31),Be.mc(5,"span"),Be.mc(6,"strong"),Be.ad(7),Be.lc(),Be.ad(8),Be.lc(),Be.lc(),Be.lc(),Be.lc(),Be.lc()),2&e){const e=Be.wc(2);Be.Tb(2),Be.Ub("colspan",e.columns.length+2),Be.Tb(5),Be.bd(e.text.noResults.title),Be.Tb(1),Be.cd(" ",e.text.noResults.description," ")}}function Ve(e,t){if(1&e&&Be.hc(0,"tbody",32),2&e){const e=Be.wc(2);Be.Bc("wp-inline-create--table",e.workPackageTable)("wp-inline-create--project-identifier",e.projectIdentifier)}}function He(e,t){1&e&&(Be.mc(0,"div",33),Be.hc(1,"wp-resizer",34),Be.lc()),2&e&&(Be.Tb(1),Be.Bc("elementClass","work-packages-tabletimeline--timeline-side")("resizeEvent","wp-resize.timeline")("localStorageKey","openProject-timelineFlexBasis"))}const ze=function(){return[]};function Ye(e,t){if(1&e&&(Be.mc(0,"div",1),Be.mc(1,"div",2),Be.mc(2,"table",3),Be.mc(3,"colgroup"),Be.Yc(4,Ee,1,0,"col",4),Be.Yc(5,Me,1,0,"col",5),Be.Yc(6,Fe,1,0,"col",6),Be.Yc(7,Ae,1,0,"col",4),Be.lc(),Be.mc(8,"caption",7),Be.mc(9,"span"),Be.ad(10),Be.lc(),Be.hc(11,"span",8),Be.mc(12,"span"),Be.ad(13),Be.lc(),Be.lc(),Be.mc(14,"thead",9),Be.mc(15,"tr"),Be.Yc(16,qe,3,1,"th",10),Be.Yc(17,Le,2,5,"th",11),Be.Yc(18,Ne,2,1,"th",12),Be.lc(),Be.lc(),Be.Yc(19,Qe,9,3,"tbody",13),Be.hc(20,"tbody",14),Be.Yc(21,Ve,1,2,"tbody",15),Be.mc(22,"tfoot"),Be.hc(23,"tr",16),Be.lc(),Be.lc(),Be.lc(),Be.Yc(24,He,2,3,"div",17),Be.mc(25,"div",18),Be.hc(26,"wp-timeline-container"),Be.lc(),Be.lc()),2&e){const e=Be.wc();Be.Tb(4),Be.Bc("ngIf",e.configuration.dragAndDropEnabled),Be.Tb(1),Be.Bc("ngForOf",Be.Fc(13,ze).constructor(e.columns.length)),Be.Tb(1),Be.Bc("ngIf",e.configuration.columnMenuEnabled),Be.Tb(1),Be.Bc("ngIf",!e.configuration.columnMenuEnabled),Be.Tb(3),Be.bd(e.text.tableSummary),Be.Tb(3),Be.bd(e.text.tableSummaryHints),Be.Tb(3),Be.Bc("ngIf",e.configuration.dragAndDropEnabled),Be.Tb(1),Be.Bc("ngForOf",e.columns)("ngForTrackBy",e.trackByHref),Be.Tb(1),Be.Bc("ngIf",e.configuration.columnMenuEnabled||e.configuration.actionsColumnEnabled),Be.Tb(1),Be.Bc("ngIf",!e.isEmbedded&&e.query&&0===e.results.count),Be.Tb(2),Be.Bc("ngIf",e.tableElement&&e.configuration.inlineCreateEnabled),Be.Tb(3),Be.Bc("ngIf",!e.configuration.isEmbedded)}}class We extends Re.a{constructor(e,t,i,n,s,a,r,c,o,l,d){super(),this.elementRef=e,this.injector=t,this.states=i,this.querySpace=n,this.I18n=s,this.cdRef=a,this.zone=r,this.wpTableGroupBy=c,this.wpTableTimeline=o,this.wpTableColumns=l,this.wpTableSortBy=d,this.trackByHref=Se.a.trackByHref,this.limitedResults=!1}ngOnInit(){this.configuration=new Te.a(this.configurationObject),this.$element=jQuery(this.elementRef.nativeElement),this.querySpace.stopAllSubscriptions.next(),this.locale=I18n.locale,this.text={cancel:I18n.t("js.button_cancel"),noResults:{title:I18n.t("js.work_packages.no_results.title"),description:I18n.t("js.work_packages.no_results.description")},limitedResults:(e,t)=>I18n.t("js.work_packages.limited_results",{count:e,total:t}),tableSummary:I18n.t("js.work_packages.table.summary"),tableSummaryHints:[I18n.t("js.work_packages.table.text_inline_edit"),I18n.t("js.work_packages.table.text_select_hint"),I18n.t("js.work_packages.table.text_sort_hint")].join(" ")},Object(xe.a)([this.querySpace.results.values$(),this.wpTableGroupBy.live$(),this.wpTableColumns.live$(),this.wpTableTimeline.live$(),this.wpTableSortBy.live$()]).pipe(this.untilDestroyed()).subscribe(([e,t,i,n,s])=>{this.query=this.querySpace.query.value,this.results=e,this.groupBy=t,this.columns=i,this.numTableColumns=this.columns.length+2,this.scrollSyncUpdate&&this.timelineVisible!==n.visible&&this.scrollSyncUpdate(n.visible),this.timelineVisible=n.visible,this.manualSortEnabled=this.wpTableSortBy.isManualSortingMode,this.limitedResults=this.manualSortEnabled&&e.total>e.count,this.cdRef.detectChanges()}),this.cdRef.detectChanges()}ngOnDestroy(){super.ngOnDestroy(),this.wpTableHoverSync.deactivate()}registerTimeline(e,t){const i=this.$element.find(".work-package--results-tbody"),n=this.$element.find(".work-package-table--container")[0];this.workPackageTable=new Oe.a(this.injector,this.$element[0],n,i[0],t,e,this.configuration),this.tbody=i,e.workPackageTable=this.workPackageTable,new je(this.injector).attachTo(this.workPackageTable);const s=this.getTableAndTimelineElement();this.tableElement=s[0],this.timeline=s[1],this.wpTableHoverSync=new Ie(this.$element),this.wpTableHoverSync.activate(),this.scrollSyncUpdate=Object(Pe.a)(this.$element),this.scrollSyncUpdate(this.timelineVisible),this.cdRef.detectChanges()}get isEmbedded(){return this.configuration.isEmbedded}getTableAndTimelineElement(){const e=this.$element.find(".work-packages-tabletimeline--table-side"),t=this.$element.find(".work-packages-tabletimeline--timeline-side");if(0===t.length||0===e.length)throw new Error("invalid state");return[e[0],t[0]]}}We.\u0275fac=function(e){return new(e||We)(Be.gc(Be.q),Be.gc(Be.A),Be.gc(r.a),Be.gc($.a),Be.gc(n.a),Be.gc(Be.i),Be.gc(Be.K),Be.gc(_e.a),Be.gc(oe.a),Be.gc(W.a),Be.gc(se.a))},We.\u0275cmp=Be.ac({type:We,selectors:[["wp-table"]],inputs:{projectIdentifier:"projectIdentifier",configurationObject:["configuration","configurationObject"]},features:[Be.Qb],decls:1,vars:1,consts:[["class","work-packages-split-view--tabletimeline-content",4,"ngIf"],[1,"work-packages-split-view--tabletimeline-content"],[1,"work-packages-tabletimeline--table-side","work-package-table--container","__hidden_overflow_container"],[1,"keyboard-accessible-list","generic-table","work-package-table"],[4,"ngIf"],["highlight-col","",4,"ngFor","ngForOf"],["highlight-col","",4,"ngIf"],[1,"hidden-for-sighted"],["id","wp-table-sort-summary"],[1,"-sticky"],["class","wp-table--manual-sort-th -short hide-when-print",4,"ngIf"],["class","wp-table--table-header",4,"ngFor","ngForOf","ngForTrackBy"],["class","wp-table--configuration-modal--trigger wp-table--context-menu-th -short hide-when-print",4,"ngIf"],["class","work-package--empty-tbody",4,"ngIf"],[1,"results-tbody","work-package--results-tbody"],["wpInlineCreate","",3,"wp-inline-create--table","wp-inline-create--project-identifier",4,"ngIf"],["wpTableSumsRow",""],["class","work-packages--tabletimeline--timeline--resizer hidden-for-mobile hide-when-print",4,"ngIf"],[1,"work-packages-tabletimeline--timeline-side"],["highlight-col",""],[1,"wp-table--manual-sort-th","-short","hide-when-print"],[1,"generic-table--empty-header"],["icon-classes","icon-sort-by",4,"ngIf"],["icon-classes","icon-sort-by"],[1,"wp-table--table-header"],["opColumnsContextMenu","",3,"headerColumn","locale","table","opColumnsContextMenu-column","opColumnsContextMenu-table"],[1,"wp-table--configuration-modal--trigger","wp-table--context-menu-th","-short","hide-when-print"],["class","generic-table--sort-header-outer",4,"ngIf"],[1,"generic-table--sort-header-outer"],[1,"work-package--empty-tbody"],["id","empty-row-notification"],["icon-classes","icon-info1 icon-context"],["wpInlineCreate","",3,"wp-inline-create--table","wp-inline-create--project-identifier"],[1,"work-packages--tabletimeline--timeline--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","resizeEvent","localStorageKey"]],template:function(e,t){1&e&&Be.Yc(0,Ye,27,14,"div",0),2&e&&Be.Bc("ngIf",t.query)},styles:[".wp-table--drag-and-drop-handle:hover{cursor:move}"],encapsulation:2,changeDetection:0})},"9nXh":function(e,t,i){"use strict";i.d(t,"b",(function(){return l})),i.d(t,"a",(function(){return d}));var n=i("mrSG"),s=i("iMRi"),a=i("ug4p"),r=i("6XbZ"),c=i("PtkW"),o=i("r0MM");const l="wp-timeline-cell";class d{constructor(e,t){this.injector=e,this.workPackageTable=t}build(e){const t=document.createElement("div");return t.classList.add(l,r.b),e&&(t.dataset.workPackageId=e),t}insert(e,t,i=[]){const n=this.build(e);n.classList.add(...i),t.appendChild(n)}}Object(n.c)([Object(o.a)(),Object(n.e)("design:type",s.a)],d.prototype,"states",void 0),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",c.a)],d.prototype,"wpTableTimeline",void 0),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",a.a)],d.prototype,"wpCacheService",void 0)},"9oW/":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("mrSG"),s=i("8zkO"),a=i("VNOR"),r=i("r0MM"),c=i("fXoL"),o=i("k8lp"),l=i("ofXK"),d=i("32V0");function u(e,t){if(1&e){const e=c.nc();c.mc(0,"edit-field-controls",4),c.uc("onSave",(function(){return c.Qc(e),c.wc().handleUserSubmit()}))("onCancel",(function(){return c.Qc(e),c.wc().handler.handleUserCancel()})),c.lc()}if(2&e){const e=c.wc();c.Bc("fieldController",e.field)("saveTitle",e.text.save)("cancelTitle",e.text.cancel)}}class h extends a.a{constructor(){super(...arguments),this.isBusy=!1}get name(){return"comment"}get required(){return!0}ngOnInit(){super.ngOnInit(),this.rawValue=this.rawValue||""}}h.\u0275fac=function(e){return p(e||h)},h.\u0275cmp=c.ac({type:h,selectors:[["ng-component"]],features:[c.Qb],decls:4,vars:4,consts:[[1,"textarea-wrapper"],[1,"op-ckeditor--wrapper","op-ckeditor-element"],[3,"context","content","ckEditorType","onContentChange","onInitializationFailed","onInitialized"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel",4,"ngIf"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel"]],template:function(e,t){1&e&&(c.mc(0,"div",0),c.mc(1,"div",1),c.mc(2,"op-ckeditor",2),c.uc("onContentChange",(function(e){return t.onContentChange(e)}))("onInitializationFailed",(function(){return t.initializationError=!0}))("onInitialized",(function(e){return t.onCkeditorSetup(e)})),c.lc(),c.lc(),c.Yc(3,u,1,3,"edit-field-controls",3),c.lc()),2&e&&(c.Tb(2),c.Bc("context",t.ckEditorContext)("content",t.rawValue)("ckEditorType",t.editorType),c.Tb(1),c.Bc("ngIf",!(t.handler.inEditMode||t.initializationError)))},directives:[o.a,l.q,d.a],encapsulation:2}),Object(n.c)([Object(r.a)(),Object(n.e)("design:type",s.a)],h.prototype,"ConfigurationService",void 0);const p=c.oc(h)},"9pt+":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("ug4p"),s=i("AEvm"),a=i("fXoL"),r=i("ofXK");function c(e,t){if(1&e&&a.hc(0,"span",1),2&e){const e=a.wc();a.Bc("textContent",e.count)}}class o extends s.a{constructor(e){super(),this.wpCacheService=e,this.count=0}ngOnInit(){this.wpCacheService.loadWorkPackage(this.wpId.toString()).values$().pipe(this.untilDestroyed()).subscribe(e=>{this.count=_.size(e.watchers.elements)})}}o.\u0275fac=function(e){return new(e||o)(a.gc(n.a))},o.\u0275cmp=a.ac({type:o,selectors:[["wp-watchers-count"]],inputs:{wpId:"wpId"},features:[a.Qb],decls:1,vars:1,consts:[["class","wp-tabs-count",3,"textContent",4,"ngIf"],[1,"wp-tabs-count",3,"textContent"]],template:function(e,t){1&e&&a.Yc(0,c,1,1,"span",0),2&e&&a.Bc("ngIf",t.count>0)},directives:[r.q],encapsulation:2})},"A0F/":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{blockedTransition(e){return!0}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.cc({token:s,factory:s.\u0275fac})},AA01:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{constructor(){super(...arguments),this.memoizedCurrentSchemas={}}$copy(){let e=super.$copy();return e.schema=this.schema,e}get id(){return this.filter.id}get name(){return this.filter.name}get currentSchema(){if(!this.schema||!this.operator)return null;let e=this.operator.href.toString();return void 0===this.memoizedCurrentSchemas[e]&&(this.memoizedCurrentSchemas[e]=this.schema.resultingSchema(this.operator)),this.memoizedCurrentSchemas[e]}isCompletelyDefined(){return this.values.length||this.currentSchema&&!this.currentSchema.isValueRequired()}findOperator(e){return _.find(this.schema.availableOperators,t=>t.id===e)}}},AAic:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this.mapping={}}add(e,t){this.mapping[e]=t}available(){return _.map(this.mapping,(e,t)=>({attribute:t,text:e.localizedName}))}get(e){if(this.mapping[e])return this.mapping[e];throw`No action service exists for ${e}`}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.cc({token:s,factory:s.\u0275fac,providedIn:"root"})},ABwi:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("iB+3"),s=i("Jui0"),a=i("pL6k"),r=i("d/TE"),c=i("wZYP"),o=i("/C7M"),l=i("fXoL"),d=i("tk/3");class u{constructor(e,t,i,n,s,a,r){this.http=e,this.$state=t,this.PathHelper=i,this.UrlParamsHelper=n,this.NotificationsService=s,this.I18n=a,this.halEvents=r,this.text={successful_delete:this.I18n.t("js.work_packages.message_successful_bulk_delete")}}performBulkDelete(e,t){const i={"ids[]":e},n=this.http.delete(this.PathHelper.workPackagesBulkDeletePath(),{params:i,withCredentials:!0}).toPromise();return t&&n.then(()=>{this.NotificationsService.addSuccess(this.text.successful_delete),e.forEach(e=>this.halEvents.push({_type:"WorkPackage",id:e},{eventType:"deleted"})),this.$state.includes("**.list.details.**")&&e.indexOf(this.$state.params.workPackageId)>-1&&this.$state.go("work-packages.partitioned.list",this.$state.params)}).catch(()=>{const e=this.UrlParamsHelper.buildQueryString(i);window.location.href=this.PathHelper.workPackagesBulkDeletePath()+"?"+e}),n}}u.\u0275fac=function(e){return new(e||u)(l.qc(d.b),l.qc(n.G),l.qc(s.a),l.qc(a.a),l.qc(r.a),l.qc(c.a),l.qc(o.a))},u.\u0275prov=l.cc({token:u,factory:u.\u0275fac})},AEvm:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("Hg4z"),s=i("fXoL");class a extends n.a{constructor(){super(...arguments),this.componentDestroyed=!1}ngOnDestroy(){this.componentDestroyed=!0,super.ngOnDestroy()}untilDestroyed(){return Object(n.c)(this)}}a.\u0275fac=function(e){return r(e||a)},a.\u0275dir=s.bc({type:a,features:[s.Qb]});const r=s.oc(a)},AcWF:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("8zkO"),s=i("wZYP"),a=i("F5Dh"),r=i("fXoL"),c=i("3Pt+"),o=i("ofXK");function l(e,t){if(1&e&&r.hc(0,"option",4),2&e){const e=t.$implicit,i=r.wc();r.Bc("textContent",i.text[e.id])("ngValue",e)}}class d{constructor(e,t,i,n){this.injector=e,this.I18n=t,this.wpTableFilters=i,this.ConfigurationService=n,this.relationFilterIds=["parent","precedes","follows","relates","duplicates","duplicated","blocks","blocked","partof","includes","requires","required"],this.availableRelationFilters=[],this.selectedRelationFilter=void 0,this.text={filter_work_packages_by_relation_type:this.I18n.t("js.work_packages.table_configuration.relation_filters.filter_work_packages_by_relation_type"),please_select:this.I18n.t("js.placeholders.selection"),parent:this.I18n.t("js.relation_labels.children"),precedes:this.I18n.t("js.relation_labels.follows"),follows:this.I18n.t("js.relation_labels.precedes"),relates:this.I18n.t("js.relation_labels.relates"),duplicates:this.I18n.t("js.relation_labels.duplicated"),duplicated:this.I18n.t("js.relation_labels.duplicates"),blocks:this.I18n.t("js.relation_labels.blocked"),blocked:this.I18n.t("js.relation_labels.blocks"),requires:this.I18n.t("js.relation_labels.required"),required:this.I18n.t("js.relation_labels.requires"),partof:this.I18n.t("js.relation_labels.includes"),includes:this.I18n.t("js.relation_labels.partof")}}ngOnInit(){let e=this;this.wpTableFilters.onReady().then(()=>{e.availableRelationFilters=e.relationFiltersOf(e.wpTableFilters.availableFilters),e.setSelectedRelationFilter()})}setSelectedRelationFilter(){let e=this.relationFiltersOf(this.wpTableFilters.current);e.length>0?this.selectedRelationFilter=_.find(this.availableRelationFilters,{id:e[0].id}):this.selectedRelationFilter=this.availableRelationFilters[0],this.onRelationFilterSelected()}onRelationFilterSelected(){this.selectedRelationFilter&&(this.removeRelationFiltersFromCurrentState(),this.addFilterToCurrentState(this.selectedRelationFilter))}removeRelationFiltersFromCurrentState(){let e=this.relationFiltersOf(this.wpTableFilters.current);this.wpTableFilters.remove(...e)}relationFiltersOf(e){return _.filter(e,e=>_.includes(this.relationFilterIds,e.id))}addFilterToCurrentState(e){let t=this.wpTableFilters.instantiate(e),i=this.getOperatorForId(t,"=");t.operator=i,t.values=[{href:"/api/v3/work_packages/{id}"}],this.wpTableFilters.add(t)}getOperatorForId(e,t){return _.find(e.schema.availableOperators,{id:t})}compareRelationFilters(e,t){return e&&t?e.id===t.id:e===t}}d.\u0275fac=function(e){return new(e||d)(r.gc(r.A),r.gc(s.a),r.gc(a.a),r.gc(n.a))},d.\u0275cmp=r.ac({type:d,selectors:[["wp-table-configuration-relation-selector"]],decls:6,vars:4,consts:[[1,"relation-filter-selector"],[3,"textContent"],["id","",1,"form--select","form--inline-select",3,"ngModel","compareWith","ngModelChange"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],[3,"textContent","ngValue"]],template:function(e,t){1&e&&(r.mc(0,"div",0),r.mc(1,"h5"),r.hc(2,"span",1),r.ad(3," "),r.mc(4,"select",2),r.uc("ngModelChange",(function(e){return t.selectedRelationFilter=e}))("ngModelChange",(function(){return t.onRelationFilterSelected()})),r.Yc(5,l,1,2,"option",3),r.lc(),r.lc(),r.lc()),2&e&&(r.Tb(2),r.Bc("textContent",t.text.filter_work_packages_by_relation_type),r.Tb(2),r.Bc("ngModel",t.selectedRelationFilter)("compareWith",t.compareRelationFilters),r.Tb(1),r.Bc("ngForOf",t.availableRelationFilters))},directives:[c.y,c.m,c.p,o.p,c.r,c.B],encapsulation:2})},AdL0:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("mrSG"),s=i("wZYP"),a=i("PUHT"),r=i("4lR/"),c=i("IaZ+"),o=i("fXoL"),l=i("N5AO");class d extends a.a{constructor(e,t,i,n,s,a){super(e,t),this.elementRef=e,this.opContextMenu=t,this.opModalService=i,this.injector=n,this.cdRef=s,this.I18n=a}open(e){return Object(n.b)(this,void 0,void 0,(function*(){this.items=yield this.buildItems(),this.opContextMenu.show(this,e)}))}positionArgs(e){let t=super.positionArgs(e);return _.assign(t,{my:"right top",at:"right bottom"}),t}buildItems(){return Object(n.b)(this,void 0,void 0,(function*(){let e=[];if(this.menuItems){const t=yield this.menuItems();return e.concat(t)}return e}))}}d.\u0275fac=function(e){return new(e||d)(o.gc(o.q),o.gc(r.a),o.gc(c.b),o.gc(o.A),o.gc(o.i),o.gc(s.a))},d.\u0275cmp=o.ac({type:d,selectors:[["icon-triggered-context-menu"]],inputs:{menuItems:["menu-items","menuItems"]},features:[o.Qb],decls:2,vars:0,consts:[["href","#"],["icon-classes","icon-show-more-horizontal"]],template:function(e,t){1&e&&(o.mc(0,"a",0),o.hc(1,"op-icon",1),o.lc())},directives:[l.a],styles:["a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:hover{color:var(--light-gray);text-decoration:none}"]})},AeZM:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("zqrF"),s=i("iMRi"),a=i("E2tj"),r=i("fXoL");class c extends n.a{constructor(e,t){super(t),this.states=e,this.querySpace=t}valueFromQuery(e){return e.groupBy||null}hasChanged(e){const t=e=>e?e.href:null;return!_.isEqual(t(e.groupBy),t(this.current))}applyToQuery(e){const t=this.current;return e.groupBy=null===t?void 0:t,!0}isGroupable(e){return!!_.find(this.available,t=>t.id===e.id)}disable(){this.update(null)}setBy(e){let t=_.find(this.available,t=>t.id===e.id);t&&this.update(t)}get current(){return this.lastUpdatedState.getValueOr(null)}get availableState(){return this.states.queries.groupBy}get isEnabled(){return!!this.current}get available(){return this.availableState.getValueOr([])}isCurrentlyGroupedBy(e){let t=this.current;return!(!t||t.id!==e.id)}}c.\u0275fac=function(e){return new(e||c)(r.qc(s.a),r.qc(a.a))},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac})},AytR:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={production:!0}},B4Ei:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("AA01"),s=i("Mo6U");class a extends s.a{$initialize(e){super.$initialize(e),this.filters=this.filters.map(e=>new n.a(this.injector,e,!0,this.halInitializer,"QueryFilterInstance"))}}},BV52:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));i("ii2/");var n=i("fXoL"),s=i("wZYP"),a=i("ofXK"),r=i("/Rze"),c=i("s/U8");const o=["wpRelationGroupByToggler"];function l(e,t){if(1&e){const e=n.nc();n.mc(0,"div",6),n.mc(1,"accessible-by-keyboard",7,8),n.uc("execute",(function(){return n.Qc(e),n.wc().toggleButton()})),n.hc(3,"span",9),n.lc(),n.lc()}if(2&e){const e=n.wc();n.Tb(1),n.Bc("linkAriaLabel",e.togglerText),n.Tb(2),n.Bc("textContent",e.togglerText)}}function d(e,t){if(1&e&&n.hc(0,"wp-relation-row",12),2&e){const e=t.$implicit,i=n.wc(2);n.Bc("workPackage",i.workPackage)("groupByWorkPackageType",i.groupByWorkPackageType)("relatedWorkPackage",e)}}function u(e,t){if(1&e&&(n.mc(0,"div",10),n.Yc(1,d,1,3,"wp-relation-row",11),n.lc()),2&e){const e=n.wc();n.Tb(1),n.Bc("ngForOf",e.relatedWorkPackages)}}class h{constructor(e){this.I18n=e,this.onToggleGroupBy=new n.s,this.text={groupByType:this.I18n.t("js.relation_buttons.group_by_wp_type"),groupByRelation:this.I18n.t("js.relation_buttons.group_by_relation_type")}}get togglerText(){return this.groupByWorkPackageType?this.text.groupByRelation:this.text.groupByType}toggleButton(){this.onToggleGroupBy.emit(),setTimeout(()=>{this.toggleElement.nativeElement.focus()},20)}}h.\u0275fac=function(e){return new(e||h)(n.gc(s.a))},h.\u0275cmp=n.ac({type:h,selectors:[["wp-relations-group"]],viewQuery:function(e,t){var i;(1&e&&n.fd(o,!0),2&e)&&(n.Nc(i=n.vc())&&(t.toggleElement=i.first))},inputs:{relatedWorkPackages:"relatedWorkPackages",workPackage:"workPackage",header:"header",firstGroup:"firstGroup",groupByWorkPackageType:"groupByWorkPackageType"},outputs:{onToggleGroupBy:"onToggleGroupBy"},decls:6,vars:3,consts:[[1,"attributes-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text","relation-group--header",3,"textContent"],["class","attributes-group--header-toggle",4,"ngIf"],["class","content",4,"ngIf"],[1,"attributes-group--header-toggle"],["id","wp-relation-group-by-toggle","linkClass","button -small -transparent -with-icon icon-group-by icon-small hide-when-print",3,"linkAriaLabel","execute"],["wpRelationGroupByToggler",""],[3,"textContent"],[1,"content"],[3,"workPackage","groupByWorkPackageType","relatedWorkPackage",4,"ngFor","ngForOf"],[3,"workPackage","groupByWorkPackageType","relatedWorkPackage"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.hc(3,"h3",3),n.lc(),n.Yc(4,l,4,2,"div",4),n.lc(),n.Yc(5,u,2,1,"div",5),n.lc()),2&e&&(n.Tb(3),n.Bc("textContent",t.header),n.Tb(1),n.Bc("ngIf",t.firstGroup),n.Tb(1),n.Bc("ngIf",t.relatedWorkPackages))},directives:[a.q,r.a,a.p,c.a],encapsulation:2})},BjK6:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("PkGb"),s=i("iMRi"),a=i("Y/CA"),r=i("iB+3"),c=i("xLNn"),o=i("wZYP"),l=i("fXoL"),d=i("ofXK"),u=i("kor4"),h=i("N5AO");const p=function(e){return{"-active":e}};class g extends c.a{constructor(e,t,i,n,s,a,r){super(t),this.$state=e,this.I18n=t,this.transitions=i,this.cdRef=n,this.states=s,this.wpTableFocus=a,this.keepTab=r,this.accessKey=8,this.activeState="work-packages.partitioned.list.details",this.listState="work-packages.partitioned.list",this.buttonId="work-packages-details-view-button",this.buttonClass="toolbar-icon",this.iconClass="icon-info2",this.activateLabel=t.t("js.button_open_details"),this.deactivateLabel=t.t("js.button_close_details"),this.transitionListener=this.transitions.onSuccess({},()=>{this.isActive=this.$state.includes(this.activeState),this.cdRef.detectChanges()})}ngOnDestroy(){super.ngOnDestroy(),this.transitionListener()}get label(){return this.isActive?this.deactivateLabel:this.activateLabel}isToggle(){return!0}performAction(e){this.isActive?this.openListView():this.openDetailsView()}openListView(){var e={projectPath:this.projectIdentifier};_.extend(e,this.$state.params),this.$state.go(this.listState,e)}openDetailsView(){var e={workPackageId:this.wpTableFocus.focusedWorkPackage,projectPath:this.projectIdentifier};_.extend(e,this.$state.params),this.$state.go(this.keepTab.currentDetailsState,e)}}g.\u0275fac=function(e){return new(e||g)(l.gc(r.G),l.gc(o.a),l.gc(r.O),l.gc(l.i),l.gc(s.a),l.gc(a.a),l.gc(n.a))},g.\u0275cmp=l.ac({type:g,selectors:[["wp-details-view-button"]],features:[l.Qb],decls:2,vars:11,consts:[["type","button",3,"ngClass","disabled","accessibleClick"],[3,"icon-classes"]],template:function(e,t){1&e&&(l.mc(0,"button",0),l.uc("accessibleClick",(function(e){return t.performAction(e)})),l.hc(1,"op-icon",1),l.lc()),2&e&&(l.Vb("button ",t.buttonClass,""),l.Bc("ngClass",l.Gc(9,p,t.isActive))("disabled",t.disabled||!t.isToggle()&&t.isActive),l.Ub("id",t.buttonId)("title",t.label)("accesskey",t.accessKey),l.Tb(1),l.Dc("icon-classes","",t.iconClass," button--icon"))},directives:[d.n,u.a,h.a],encapsulation:2,changeDetection:0})},BtrP:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t=null,i="",n="get",s=!1,a,r="application/json",c){this.requestMethod=e,this.href=t,this.title=i,this.method=n,this.templated=s,this.payload=a,this.type=r,this.identifier=c}static fromObject(e,t){return new n((t,i,n,s)=>e.request(t,i,n,s).toPromise(),t.href,t.title,t.method,t.templated,t.payload,t.type,t.identifier)}$fetch(...e){const[t,i]=e;return this.requestMethod(this.method,this.href,t,i)}$prepare(e){if(!this.templated)throw"The link "+this.href+" is not templated.";let t=_.clone(this.href)||"";return _.each(e,(e,i)=>{let n=new RegExp("{"+i+"}");t=t.replace(n,e)}),new n(this.requestMethod,t,this.title,this.method,!1,this.payload,this.type,this.identifier).$callable()}$callable(){const e=(...e)=>this.$fetch(...e);return _.extend(e,{$link:this,href:this.href,title:this.title,method:this.method,templated:this.templated,payload:this.payload,type:this.type,identifier:this.identifier}),e}}},Bz7v:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e){this.grid=e}get id(){return this.grid.id}get name(){return this.grid.name}get editable(){return!!this.grid.updateImmediately}get isFree(){return!this.isAction}get isAction(){return"action"===this.grid.options.type}get actionAttribute(){if(!this.isFree)return this.grid.options.attribute}set highlightingMode(e){this.grid.options.highlightingMode=e}get highlightingMode(){return this.grid.options.highlightingMode||"none"}set name(e){this.grid.name=e}addQuery(e){e.isNewWidget=!0,this.grid.widgets.push(e)}removeQuery(e){this.grid.widgets=this.grid.widgets.filter(t=>t.options.queryId!==e.options.queryId)}get queries(){return this.grid.widgets}get createdAt(){return this.grid.createdAt}get filters(){return this.grid.options.filters||[]}set filters(e){this.grid.options.filters=e}sortWidgets(){this.grid.widgets=this.grid.widgets.sort((e,t)=>e.startColumn-t.startColumn)}showStatusButton(){return"status"!==this.actionAttribute}}},C21z:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){function t(e,t){return e===t||e.contains(t)}e.whenOutside=function(e,i){setTimeout(()=>{t(e,document.activeElement)||i()},20)},e.insideOrSelf=t}(n||(n={}))},CBsm:function(e,t,i){"use strict";function n(e){return`__collapsed-group-${e}`}function s(e){return`__hierarchy-group-${e}`}function a(e){return`__hierarchy-root-${e}`}function r(e){return`wp-ancestor-row-${e}`}i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return s})),i.d(t,"d",(function(){return a})),i.d(t,"a",(function(){return r}))},CK39:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("oJ+N"),s=i("Ioun"),a=i("fXoL");class r extends n.a{externalQueryConfigurationComponent(){return s.a}}r.\u0275fac=function(e){return c(e||r)},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac});const c=a.oc(r)},CV67:function(e,t,i){"use strict";i.d(t,"c",(function(){return w})),i.d(t,"b",(function(){return v})),i.d(t,"a",(function(){return y}));var n=i("mrSG"),s=i("fXoL"),a=i("wZYP"),r=i("C21z"),c=i("r0MM"),o=i("ofXK"),l=i("3Pt+"),d=i("oUDv"),u=i("kor4");const h=["editableTitleInput"];function p(e,t){if(1&e){const e=s.nc();s.mc(0,"a",6),s.uc("accessibleClick",(function(t){return s.Qc(e),s.wc(2).save(t,!0)})),s.hc(1,"span",7),s.lc()}if(2&e){const e=s.wc(2);s.Ub("aria-label",e.text.query_has_changed_click_to_save)("title",e.text.query_has_changed_click_to_save)}}const g=function(e,t){return{"-error":e,"-changed":t}};function m(e,t){if(1&e){const e=s.nc();s.mc(0,"div",2),s.uc("focusout",(function(t){return s.Qc(e),s.wc().saveWhenFocusOutside(t)})),s.Yc(1,p,2,2,"a",3),s.mc(2,"input",4,5),s.uc("focus",(function(t){return s.Qc(e),s.wc().onFocus(t)}))("blur",(function(){return s.Qc(e),s.wc().onBlur()}))("keydown.escape",(function(t){return s.Qc(e),s.wc().reset(t)}))("keydown.enter",(function(t){return s.Qc(e),s.wc().save(t)}))("ngModelChange",(function(t){return s.Qc(e),s.wc().selectedTitle=t})),s.lc(),s.lc()}if(2&e){const e=s.wc();s.Tb(1),s.Bc("ngIf",e.showSave),s.Tb(1),s.Bc("focus",e.initialFocus||void 0)("ngModel",e.selectedTitle)("disabled",e.inFlight)("ngClass",s.Hc(8,g,e.isEmpty,e.showSave)),s.Ub("name",e.selectableTitleIdentifier)("placeholder",e.text.input_placeholder)("title",e.text.input_title)}}const f=function(e,t){return{"-disabled":e,"-small":t}};function b(e,t){if(1&e&&(s.mc(0,"h2",8),s.ad(1),s.lc()),2&e){const e=s.wc();s.Bc("ngClass",s.Hc(3,f,e.disabled,e.smallHeader)),s.Ub("title",e.selectedTitle),s.Tb(1),s.cd(" ",e.selectedTitle,"\n")}}const w="op:selectableTitle:trigger",v="editable-toolbar-title";class y{constructor(e){this.injector=e,this.editable=!0,this.inFlight=!1,this.showSaveCondition=!1,this.initialFocus=!1,this.smallHeader=!1,this.onSave=new s.s,this.onEmptySubmit=new s.s,this.selectableTitleIdentifier=v,this.text={click_to_edit:this.I18n.t("js.work_packages.query.click_to_edit_query_name"),press_enter_to_save:this.I18n.t("js.label_press_enter_to_save"),query_has_changed_click_to_save:this.I18n.t("js.label_view_has_changed"),input_title:"",input_placeholder:this.I18n.t("js.work_packages.query.rename_query_placeholder"),search_query_title:this.I18n.t("js.toolbar.search_query_title"),confirm_edit_cancel:this.I18n.t("js.work_packages.query.confirm_edit_cancel"),duplicate_query_title:this.I18n.t("js.work_packages.query.errors.duplicate_query_title")}}ngOnInit(){this.text.input_title=`${this.text.click_to_edit} ${this.text.press_enter_to_save}`,jQuery(this.elementRef.nativeElement).on(w,(e,t="")=>{this.inputField&&(this.selectedTitle=t,setTimeout(()=>{this.inputField.nativeElement.focus()},20),e.stopPropagation())})}ngOnChanges(e){if(e.inputTitle&&(this.selectedTitle=e.inputTitle.currentValue),e.initialFocus&&e.initialFocus.firstChange&&this.inputField){const e=this.inputField.nativeElement;this.selectInputOnInitalFocus(e)}}onFocus(e){this.toggleToolbarButtonVisibility(!0),this.selectInputOnInitalFocus(e.target)}onBlur(){this.toggleToolbarButtonVisibility(!1)}selectInputOnInitalFocus(e){this.initialFocus&&(e.select(),this.initialFocus=!1)}saveWhenFocusOutside(e){r.a.whenOutside(this.elementRef.nativeElement,()=>this.save(e))}reset(){this.resetInputField(),this.selectedTitle=this.inputTitle}get showSave(){return this.editable&&this.showSaveCondition}save(e,t=!1){e.preventDefault(),this.resetInputField(),this.selectedTitle=this.selectedTitle.trim(),this.isEmpty?this.onEmptyError():(t||this.inputTitle!==this.selectedTitle)&&(this.inputField&&this.inputField.nativeElement.blur(),this.inFlight||(this.inFlight=!0,this.emitSave(this.selectedTitle),setTimeout(()=>this.inFlight=!1,100)))}get isEmpty(){return""===this.selectedTitle}emitSave(e){this.onSave.emit(e)}onEmptyError(){this.onEmptySubmit.emit(),this.focusInputOnError()}focusInputOnError(){if(this.inputField){const e=this.inputField.nativeElement;e.classList.add("-error"),e.focus()}}resetInputField(){if(this.inputField){this.inputField.nativeElement.classList.remove("-error")}}toggleToolbarButtonVisibility(e){jQuery(".toolbar-items").toggleClass("hidden-for-mobile",e)}}y.\u0275fac=function(e){return new(e||y)(s.gc(s.A))},y.\u0275cmp=s.ac({type:y,selectors:[["editable-toolbar-title"]],viewQuery:function(e,t){var i;(1&e&&s.fd(h,!0),2&e)&&(s.Nc(i=s.vc())&&(t.inputField=i.first))},hostAttrs:[1,"title-container"],inputs:{inputTitle:["title","inputTitle"],editable:"editable",inFlight:"inFlight",showSaveCondition:"showSaveCondition",initialFocus:"initialFocus",smallHeader:"smallHeader"},outputs:{onSave:"onSave",onEmptySubmit:"onEmptySubmit"},features:[s.Rb],decls:2,vars:2,consts:[["class","editable-toolbar-title--container",3,"focusout",4,"ngIf"],["class","editable-toolbar-title--fixed",3,"ngClass",4,"ngIf"],[1,"editable-toolbar-title--container",3,"focusout"],["role","link","class","editable-toolbar-title--save",3,"accessibleClick",4,"ngIf"],["type","text","aria-required","true",1,"editable-toolbar-title--input","-border-on-hover-only","toolbar--editable-toolbar","ellipsis",3,"focus","ngModel","disabled","ngClass","blur","keydown.escape","keydown.enter","ngModelChange"],["editableTitleInput",""],["role","link",1,"editable-toolbar-title--save",3,"accessibleClick"],["aria-hidden","true",1,"icon","icon-save"],[1,"editable-toolbar-title--fixed",3,"ngClass"]],template:function(e,t){1&e&&(s.Yc(0,m,4,11,"div",0),s.Yc(1,b,2,6,"h2",1)),2&e&&(s.Bc("ngIf",t.editable),s.Tb(1),s.Bc("ngIf",!t.editable))},directives:[o.q,l.c,d.a,l.m,l.p,o.n,u.a],styles:[".editable-toolbar-title--container[_ngcontent-%COMP%]{display:flex;align-items:center}.editable-toolbar-title--fixed[_ngcontent-%COMP%]{padding:0;cursor:default}.editable-toolbar-title--save[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before{color:#5f5f5f}.editable-toolbar-title--save[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]:before{color:#2c2c2c}.editable-toolbar-title--input[_ngcontent-%COMP%]{padding-left:5px;color:#5f5f5f}.editable-toolbar-title--input.-changed[_ngcontent-%COMP%]{font-style:italic}"]}),Object(n.c)([Object(c.a)(),Object(n.e)("design:type",s.q)],y.prototype,"elementRef",void 0),Object(n.c)([Object(c.a)(),Object(n.e)("design:type",a.a)],y.prototype,"I18n",void 0)},CVKj:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("fXoL"),s=i("HEQ6"),a=i("72oW");class r{constructor(e){this.elementRef=e,this.initialLoadingIndicator=!0}ngOnInit(){const e=this.elementRef.nativeElement;e.getAttribute("query-props")&&this.getInputsFromData(e)}getInputsFromData(e){this.queryProps=JSON.parse(e.getAttribute("query-props")),this.configuration=JSON.parse(e.getAttribute("configuration"))}}r.\u0275fac=function(e){return new(e||r)(n.gc(n.q))},r.\u0275cmp=n.ac({type:r,selectors:[["wp-embedded-table-entry"]],inputs:{queryProps:"queryProps",configuration:"configuration",initialLoadingIndicator:"initialLoadingIndicator"},decls:2,vars:3,consts:[["wp-isolated-query-space",""],[3,"queryProps","initialLoadingIndicator","configuration"]],template:function(e,t){1&e&&(n.kc(0,0),n.hc(1,"wp-embedded-table",1),n.jc()),2&e&&(n.Tb(1),n.Bc("queryProps",t.queryProps)("initialLoadingIndicator",t.initialLoadingIndicator)("configuration",t.configuration))},directives:[s.a,a.a],encapsulation:2})},"CX+C":function(e,t,i){"use strict";i.d(t,"b",(function(){return p})),i.d(t,"a",(function(){return g}));var n=i("nfBx"),s=i("Ul5t"),a=i("wZYP"),r=i("IaZ+"),c=i("YIAj"),o=i("fXoL"),l=i("ofXK"),d=i("/Rze"),u=i("N5AO");function h(e,t){if(1&e){const e=o.nc();o.mc(0,"accessible-by-keyboard",1),o.uc("execute",(function(){return o.Qc(e),o.wc().handleClick()})),o.hc(1,"op-icon",2),o.ad(2),o.lc()}if(2&e){const e=o.wc();o.Dc("linkClass","icon help-text--entry help-text--for-",e.attribute,""),o.Bc("linkAriaLabel",e.text.open_dialog),o.Tb(2),o.cd(" ",e.additionalLabel,"\n")}}const p="attribute-help-text";class g{constructor(e,t,i,n,s,a,r){this.elementRef=e,this.helpTextDm=t,this.attributeHelpTexts=i,this.opModalService=n,this.cdRef=s,this.injector=a,this.I18n=r,this.exists=!1,this.text={open_dialog:this.I18n.t("js.help_texts.show_modal"),edit:this.I18n.t("js.button_edit"),close:this.I18n.t("js.button_close")}}ngOnInit(){const e=this.elementRef.nativeElement;e.dataset.helpTextId&&(this.helpTextId=e.dataset.helpTextId,this.attribute=e.dataset.attribute,this.attributeScope=e.dataset.attributeScope,this.additionalLabel=e.dataset.additionalLabel),this.helpTextId?this.exists=!0:this.load().then(e=>(this.exists=!!e,this.cdRef.detectChanges(),e))}handleClick(){this.load().then(e=>{this.opModalService.show(c.a,this.injector,{helpText:e})})}load(){return this.helpTextId?this.helpTextDm.load(this.helpTextId):this.attributeHelpTexts.require(this.attribute,this.attributeScope)}}g.\u0275fac=function(e){return new(e||g)(o.gc(o.q),o.gc(s.a),o.gc(n.a),o.gc(r.b),o.gc(o.i),o.gc(o.A),o.gc(a.a))},g.\u0275cmp=o.ac({type:g,selectors:[["attribute-help-text"]],inputs:{attribute:"attribute",additionalLabel:"additionalLabel",attributeScope:"attributeScope",helpTextId:"helpTextId"},decls:1,vars:1,consts:[[3,"linkAriaLabel","linkClass","execute",4,"ngIf"],[3,"linkAriaLabel","linkClass","execute"],["icon-classes","icon icon-help1"]],template:function(e,t){1&e&&o.Yc(0,h,3,3,"accessible-by-keyboard",0),2&e&&o.Bc("ngIf",t.exists)},directives:[l.q,d.a,u.a],encapsulation:2,changeDetection:0})},CZZR:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("mrSG"),s=i("Cfvw"),a=i("kTsZ"),r=i("Jui0"),c=i("n9mQ"),o=i("sjKJ"),l=i("vkgz"),d=i("lJxs"),u=i("Bz7v"),h=i("Kg8T"),p=i("fXoL");class g{constructor(e,t,i,n,s){this.GridDm=e,this.PathHelper=t,this.authorisationService=i,this.CurrentProject=n,this.halResourceService=s}allInScope(e=this.CurrentProject.identifier){const t=this.boardPath(e);return Object(s.a)(this.GridDm.list({filters:[["scope","=",[t]]]})).pipe(Object(l.a)(e=>this.authorisationService.initModelAuth("boards",e.$links)),Object(d.a)(e=>e.elements.map(e=>new u.a(e))))}one(e){return Object(s.a)(this.GridDm.one(e)).pipe(Object(d.a)(e=>new u.a(e)))}save(e){return this.fetchSchema(e).then(t=>this.GridDm.update(e.grid,t)).then(t=>(e.grid=t,e))}fetchSchema(e){return this.GridDm.updateForm(e.grid).then(e=>e.schema)}boardPath(e=this.CurrentProject.identifier){return this.PathHelper.projectBoardsPath(e)}create(e,t,i){return Object(n.b)(this,void 0,void 0,(function*(){return this.createGrid(e,t,i).then(e=>new u.a(e))}))}delete(e){return e.grid.delete?e.grid.delete():Promise.reject("Deletion not possible")}createGrid(e,t,i){const n=this.boardPath();let s=_.set({name:t},"_links.scope.href",n);return s.options={type:e},i&&(s.options.attribute=i),this.GridDm.createForm(s).then(e=>{let t=this.halResourceService.createHalResource(e.payload.$source);return this.GridDm.create(t,e.schema)})}}g.\u0275fac=function(e){return new(e||g)(p.qc(c.a),p.qc(r.a),p.qc(h.a),p.qc(o.a),p.qc(a.a))},g.\u0275prov=p.cc({token:g,factory:g.\u0275fac,providedIn:"root"})},CejQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("fXoL"),s=(i("PHo6"),i("wZYP")),a=i("GntA");class r extends a.a{}var c=i("AEvm");class o extends c.a{constructor(e,t){super(),this.i18n=e,this.injector=t,this.resourceChanged=new n.s}get widgetName(){var e,t;let i=null===(e=this.resource)||void 0===e?void 0:e.options.name,n=null===(t=this.resource)||void 0===t?void 0:t.identifier;return this.isEditable?i:this.i18n.t(`js.grid.widgets.${n}.title`,{defaultValue:i})}renameWidget(e){let t=this.setChangesetOptions({name:e});this.resourceChanged.emit(t)}get isEditable(){return!0}setChangesetOptions(e){let t=new r(this.resource);return t.setValue("options",Object.assign({},this.resource.options,e)),t}}o.\u0275fac=function(e){return new(e||o)(n.gc(s.a),n.gc(n.A))},o.\u0275dir=n.bc({type:o,hostVars:8,hostBindings:function(e,t){2&e&&n.Xc("grid-column-start",t.gridColumnStart)("grid-column-end",t.gridColumnEnd)("grid-row-start",t.gridRowStart)("grid-row-end",t.gridRowEnd)},inputs:{resource:"resource"},outputs:{resourceChanged:"resourceChanged"},features:[n.Qb]})},DDsP:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("ciXH"),s=i("fXoL");class a extends n.a{listUrl(){return this.pathHelper.api.v3.news.toString()}oneUrl(e){return this.pathHelper.api.v3.news.id(e).toString()}}a.\u0275fac=function(e){return r(e||a)},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac});const r=s.oc(a)},DHgU:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{get(...e){return _.get(window.gon,e,null)}get gon(){return window.gon}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.cc({token:s,factory:s.\u0275fac,providedIn:"root"})},DLfB:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("pQre"),s=i("wZYP"),a=i("fXoL"),r=i("/Rze"),c=i("N5AO");class o{constructor(e,t){this.backRoutingService=e,this.I18n=t,this.text={goBack:this.I18n.t("js.button_back")}}goBack(){this.customBackMethod?this.customBackMethod():this.backRoutingService.goBack()}classes(){let e="button ";return e+=this.linkClass?this.linkClass:"",e}}o.\u0275fac=function(e){return new(e||o)(a.gc(n.a),a.gc(s.a))},o.\u0275cmp=a.ac({type:o,selectors:[["back-button"]],inputs:{linkClass:"linkClass",customBackMethod:"customBackMethod"},decls:3,vars:3,consts:[[1,"wp-show--back-button","hide-when-print"],[3,"linkClass","linkAriaLabel","linkTitle","execute"],["icon-classes","button--icon icon-back-up"]],template:function(e,t){1&e&&(a.mc(0,"div",0),a.mc(1,"accessible-by-keyboard",1),a.uc("execute",(function(){return t.goBack()})),a.hc(2,"op-icon",2),a.lc(),a.lc()),2&e&&(a.Tb(1),a.Bc("linkClass",t.classes())("linkAriaLabel",t.text.goBack)("linkTitle",t.text.goBack))},directives:[r.a,c.a],encapsulation:2,changeDetection:0})},DP6S:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("kTsZ"),s=i("Jui0"),a=i("fXoL");class r{constructor(e,t){this.halResourceService=e,this.pathHelper=t}one(e){return this.halResourceService.get(this.pathHelper.api.v3.statuses.id(e).toString()).toPromise()}list(){return this.halResourceService.get(this.pathHelper.api.v3.statuses.toString()).toPromise()}}r.\u0275fac=function(e){return new(e||r)(a.qc(n.a),a.qc(s.a))},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac})},DhiE:function(e,t,i){"use strict";i.d(t,"a",(function(){return _}));var n=i("mrSG"),s=i("iMRi"),a=i("l4W+"),r=i("+oAL"),c=i("Kg8T"),o=i("iB+3"),l=i("E2tj"),d=i("OGNV"),u=i("0bag"),h=i("pL6k"),p=i("d/TE"),g=i("wZYP"),m=i("Cfvw"),f=i("LRne"),b=i("FnNU"),w=i("eIep"),v=i("5+tZ"),y=i("w1tV"),k=i("JIr8"),C=i("IzEk"),j=i("Zq3F"),x=i("8zkO"),T=i("kt6C"),S=i("fXoL");class _{constructor(e,t,i,n,s,a,r,c,o,l,d,u,h,p){this.NotificationsService=e,this.I18n=t,this.UrlParamsHelper=i,this.authorisationService=n,this.$state=s,this.QueryDm=a,this.QueryFormDm=r,this.states=c,this.querySpace=o,this.pagination=l,this.configuration=d,this.wpTablePagination=u,this.wpStatesInitialization=h,this.wpListInvalidQueryService=p,this.queryRequests=Object(b.f)(),this.queryLoading=this.queryRequests.values$().pipe(Object(w.a)(e=>Object(m.a)(this.ensurePerPageKnown().then(()=>e))),Object(w.a)(e=>this.streamQueryRequest(e.queryParams,e.projectIdentifier)),Object(v.a)(e=>(this.conditionallyLoadForm(e),this.wpStatesInitialization.initialize(e,e.results),Object(f.a)(e))),Object(y.a)())}streamQueryRequest(e,t){const i=this.getCurrentQueryProps(e),n=this.UrlParamsHelper.buildV3GetQueryFromJsonParams(i);return this.QueryDm.stream(n,e.query_id,t).pipe(Object(k.a)(n=>{const s=this.UrlParamsHelper.buildV3GetQueryFromJsonParams(i);return Object(m.a)(this.handleQueryLoadingError(n,s,e.query_id,t))}))}fromQueryParams(e,t){return this.queryRequests.clear(),this.queryRequests.putValue({queryParams:e,projectIdentifier:t}),this.queryLoading.pipe(Object(C.a)(1))}getCurrentQueryProps(e){return e.query_props?decodeURIComponent(e.query_props):null}loadDefaultQuery(e){return this.fromQueryParams({},e).toPromise()}reloadQuery(e,t){const i=Object.assign(Object.assign({},this.wpTablePagination.current),{page:1}),n=this.UrlParamsHelper.encodeQueryJsonParams(e,i);return this.queryRequests.clear(),this.queryRequests.putValue({queryParams:{query_id:e.id||void 0,query_props:n},projectIdentifier:t}),this.queryLoading.pipe(Object(C.a)(1))}loadResultsList(e,t){return this.QueryDm.loadResults(e,t).then(t=>(this.wpStatesInitialization.updateQuerySpace(t,t.results),this.wpStatesInitialization.updateChecksum(t,t.results),e.results))}reloadCurrentResultsList(){let e=this.getPaginationInfo(),t=this.currentQuery;return this.loadResultsList(t,e)}loadCurrentQueryFromParams(e){return this.fromQueryParams(this.$state.params,e).toPromise()}loadForm(e){return this.QueryFormDm.load(e).then(t=>(this.wpStatesInitialization.updateStatesFromForm(e,t),t))}create(e,t){let i=this.querySpace.queryForm.value;e.name=t;let n=this.QueryDm.create(e,i);return n.then(e=>(this.NotificationsService.addSuccess(this.I18n.t("js.notice_successful_create")),this.reloadQuery(e).subscribe(()=>{this.states.changes.queries.next(e.id)}),e)),n}delete(){let e=this.currentQuery,t=this.QueryDm.delete(e);return t.then(()=>{let t;this.NotificationsService.addSuccess(this.I18n.t("js.notice_successful_delete")),e.project&&(t=e.project.$href.split("/").pop()),this.loadDefaultQuery(t),this.states.changes.queries.next(e.id)}),t}save(e){e=e||this.currentQuery;let t=this.querySpace.queryForm.value,i=this.QueryDm.update(e,t).toPromise();return i.then(()=>{this.NotificationsService.addSuccess(this.I18n.t("js.notice_successful_update")),this.$state.go(".",{query_id:e.id,query_props:null},{reload:!0}),this.states.changes.queries.next(e.id)}).catch(e=>{this.NotificationsService.addError(e.message)}),i}toggleStarred(e){let t=this.QueryDm.toggleStarred(e);return t.then(e=>{this.querySpace.query.putValue(e),this.NotificationsService.addSuccess(this.I18n.t("js.notice_successful_update")),this.states.changes.queries.next(e.id)}),t}getPaginationInfo(){return this.wpTablePagination.paginationObject}conditionallyLoadForm(e){let t=this.querySpace.queryForm.value;t&&e.$links.update.$href===t.$href||setTimeout(()=>this.loadForm(e),0)}updateStatesFromQueryOnPromise(e){return e.then(e=>(this.wpStatesInitialization.initialize(e,e.results),e)),e}get currentQuery(){return this.querySpace.query.value}handleQueryLoadingError(e,t,i,n){return this.NotificationsService.addError(this.I18n.t("js.work_packages.faulty_query.description"),e.message),new Promise((e,s)=>{this.QueryFormDm.loadWithParams(t,i,n).then(a=>{this.QueryDm.findDefault({pageSize:0},n).then(n=>{this.wpListInvalidQueryService.restoreQuery(n,a),n.results.pageSize=t.pageSize,n.results.total=0,i&&(n.id=i),this.wpStatesInitialization.initialize(n,n.results),this.wpStatesInitialization.updateStatesFromForm(n,a),e(n)}).catch(s)}).catch(s)})}ensurePerPageKnown(){return Object(n.b)(this,void 0,void 0,(function*(){return!!this.pagination.isPerPageKnown||this.configuration.initialized}))}}_.\u0275fac=function(e){return new(e||_)(S.qc(p.a),S.qc(g.a),S.qc(h.a),S.qc(c.a),S.qc(o.G),S.qc(u.a),S.qc(d.a),S.qc(s.a),S.qc(l.a),S.qc(T.a),S.qc(x.a),S.qc(j.a),S.qc(r.a),S.qc(a.a))},_.\u0275prov=S.cc({token:_,factory:_.\u0275fac})},DiYd:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));i("AA01");var n=i("wZYP"),s=i("Y41n"),a=i("juWA"),r=i("wd/R"),c=i("AEvm"),o=i("Hg4z"),l=i("fXoL"),d=i("ecJW"),u=i("oUDv");class h extends c.a{constructor(e,t){super(),this.timezoneService=e,this.I18n=t,this.shouldFocus=!1,this.filterChanged=new s.a(Object(o.b)(this)),this.text={spacer:this.I18n.t("js.filter.value_spacer")}}get begin(){return this.filter.values[0]}set begin(e){this.filter.values[0]=e||"",this.filterChanged.emit(this.filter)}get end(){return this.filter.values[1]}set end(e){this.filter.values[1]=e||"",this.filterChanged.emit(this.filter)}parser(e){return r(e,"YYYY-MM-DD",!0).isValid()?e:null}formatter(e){if(r(e,"YYYY-MM-DD",!0).isValid()){var t=this.timezoneService.parseDate(e);return this.timezoneService.formattedISODate(t)}return null}}h.\u0275fac=function(e){return new(e||h)(l.gc(a.a),l.gc(n.a))},h.\u0275cmp=l.ac({type:h,selectors:[["filter-dates-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[l.Qb],decls:4,vars:9,consts:[[1,"inline-label",3,"id"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","focus","id","name","onChange"],[1,"advanced-filters--affix",3,"textContent"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","id","name","onChange"]],template:function(e,t){1&e&&(l.mc(0,"div",0),l.mc(1,"op-date-picker",1),l.uc("onChange",(function(e){return t.begin=t.parser(e)})),l.lc(),l.hc(2,"span",2),l.mc(3,"op-date-picker",3),l.uc("onChange",(function(e){return t.end=t.parser(e)})),l.lc(),l.lc()),2&e&&(l.Dc("id","div-values-",t.filter.id,""),l.Tb(1),l.Bc("initialDate",t.formatter(t.begin))("focus",t.shouldFocus)("id","values-"+t.filter.id+"-begin")("name","v["+t.filter.id+"]-begin"),l.Tb(1),l.Bc("textContent",t.text.spacer),l.Tb(1),l.Bc("initialDate",t.formatter(t.end))("id","values-"+t.filter.id+"-end")("name","v["+t.filter.id+"]-end"))},directives:[d.a,u.a],encapsulation:2})},Dp3K:function(e,t,i){"use strict";i.d(t,"a",(function(){return F}));var n=i("mrSG"),s=i("fXoL"),a=i("iB+3"),r=i("Kg8T"),c=i("E2tj"),o=i("zp1y"),l=i("pLZG"),d=i("IzEk"),u=i("Y0Nk"),h=i("wZYP"),p=i("kTg4"),g=i("2Qcm"),m=i("iMRi"),f=i("JY8V"),b=i("6yP5"),w=i("AeZM"),v=i("F5Dh"),y=i("EnRq"),k=i("PtkW"),C=i("wyKs"),j=i("Zq3F"),x=i("DhiE"),T=i("W6hW"),S=i("0bag"),_=i("+oAL"),P=i("Uyc6"),I=i("Va5K"),O=i("/C7M"),R=i("K247"),B=i("r0MM"),E=i("sjKJ"),M=i("AEvm");class F extends M.a{constructor(e){super(),this.injector=e,this.queryLoaded=!1,this.destroyed=!1}ngOnInit(){this.setupQueryObservers(),this.setupRefreshObserver(),this.setupQueryLoadedListener()}setupQueryObservers(){this.wpTablePagination.updates$().pipe(this.untilDestroyed(),Object(o.a)(this.querySpace.query.values$())).subscribe(([e,t])=>{this.wpListChecksumService.isQueryOutdated(t,e)&&(this.wpListChecksumService.update(t,e),this.refresh(!0,!1))}),this.setupChangeObserver(this.wpTableFilters,!0),this.setupChangeObserver(this.wpTableGroupBy),this.setupChangeObserver(this.wpTableSortBy),this.setupChangeObserver(this.wpTableSum),this.setupChangeObserver(this.wpTableTimeline),this.setupChangeObserver(this.wpTableHierarchies),this.setupChangeObserver(this.wpTableColumns),this.setupChangeObserver(this.wpTableHighlighting),this.setupChangeObserver(this.wpTableOrder),this.setupChangeObserver(this.wpDisplayRepresentation)}setupChangeObserver(e,t=!1){const i=this.querySpace.query;e.updates$().pipe(this.untilDestroyed(),Object(l.a)(()=>i.hasValue()&&e.hasChanged(i.value))).subscribe(()=>{const n=i.value,s=e.applyToQuery(n);this.querySpace.query.putValue(n),this.wpListChecksumService.updateIfDifferent(n,this.wpTablePagination.current).then(()=>{s&&this.refresh(!0,t)})})}get projectIdentifier(){return this.currentProject.identifier||void 0}setupRefreshObserver(){this.halEvents.aggregated$("WorkPackage").pipe(this.untilDestroyed(),Object(l.a)(e=>this.filterRefreshEvents(e))).subscribe(e=>{this.refresh(!1,!1)})}filterRefreshEvents(e){let t=new Set(this.querySpace.renderedWorkPackageIds.getValueOr([]));for(let i=0;i<e.length;i++){const n=e[i];if(t.has(n.id)||"created"===n.eventType)return!0}return!1}setupQueryLoadedListener(){this.querySpace.initialized.values$().pipe(Object(d.a)(1),Object(l.a)(()=>!this.componentDestroyed)).subscribe(()=>{this.queryLoaded=!0,this.cdRef.detectChanges()})}}F.\u0275fac=function(e){return new(e||F)(s.gc(s.A))},F.\u0275dir=s.bc({type:F,features:[s.Qb]}),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",a.G)],F.prototype,"$state",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",m.a)],F.prototype,"states",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",c.a)],F.prototype,"querySpace",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",r.a)],F.prototype,"authorisationService",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",f.a)],F.prototype,"wpTableColumns",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",g.a)],F.prototype,"wpTableHighlighting",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",b.a)],F.prototype,"wpTableSortBy",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",w.a)],F.prototype,"wpTableGroupBy",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",v.a)],F.prototype,"wpTableFilters",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",y.a)],F.prototype,"wpTableSum",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",k.a)],F.prototype,"wpTableTimeline",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",C.a)],F.prototype,"wpTableHierarchies",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",j.a)],F.prototype,"wpTablePagination",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",P.a)],F.prototype,"wpTableOrder",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",x.a)],F.prototype,"wpListService",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",T.a)],F.prototype,"wpListChecksumService",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",u.a)],F.prototype,"loadingIndicatorService",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",a.O)],F.prototype,"$transitions",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",h.a)],F.prototype,"I18n",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",p.a)],F.prototype,"wpStaticQueries",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",S.a)],F.prototype,"QueryDm",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",_.a)],F.prototype,"wpStatesInitialization",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",s.i)],F.prototype,"cdRef",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",I.a)],F.prototype,"wpDisplayRepresentation",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",O.a)],F.prototype,"halEvents",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",R.a)],F.prototype,"deviceService",void 0),Object(n.c)([Object(B.a)(),Object(n.e)("design:type",E.a)],F.prototype,"currentProject",void 0)},DvFC:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("8aTQ"),s=i("IaZ+"),a=i("fXoL");class r{constructor(e,t){this.opModalService=e,this.injector=t}confirm(e){return new Promise((t,i)=>{this.opModalService.show(n.a,this.injector,{options:e}).closingEvent.subscribe(e=>{e.confirmed?t():i()})})}}r.\u0275fac=function(e){return new(e||r)(a.qc(s.b),a.qc(a.A))},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac})},"E+lO":function(e,t,i){"use strict";i.r(t),i.d(t,"DynamicBootstrapper",(function(){return n}));class n{static register(...e){this.optionalBoostrapComponents.push(...e)}static bootstrapOptionalDocument(e,t,i=this.optionalBoostrapComponents){this.performBootstrap(e,t,!1,i)}static bootstrapOptionalEmbeddable(e,t,i=this.optionalBoostrapComponents){this.performBootstrap(e,t,!0,i)}static getEmbeddable(){return this.optionalBoostrapComponents.filter(e=>e.embeddable)}static performBootstrap(e,t,i,n){n.forEach(n=>{if(i&&!n.embeddable)return;const s=t.querySelectorAll(n.selector);for(let t=0;t<s.length;t++)e.bootstrap(n.cls,s[t])})}}n.optionalBoostrapComponents=[]},E05v:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("W6hW"),s=i("DhiE"),a=i("iB+3"),r=i("XNiG"),c=i("fXoL");class o{constructor(e){this.injector=e,this.wpListChecksumService=this.injector.get(n.a),this.wpListService=this.injector.get(s.a),this.$transitions=this.injector.get(a.O),this.observe$=new r.a,this.listenForQueryParamsChanged()}listenForQueryParamsChanged(){return this.queryChangeListener=this.$transitions.onSuccess({},e=>{let t=e.options();const i=e.params("to");let n=this.wpListService.getCurrentQueryProps(i),s=i.query_id?i.query_id.toString():null;return!!(t.reload||t.custom&&!1===t.custom.notify)||this.wpListChecksumService.executeIfOutdated(s,n,()=>{this.observe$.next(n)})})}removeQueryChangeListener(){this.queryChangeListener()}}o.\u0275fac=function(e){return new(e||o)(c.qc(c.A))},o.\u0275prov=c.cc({token:o,factory:o.\u0275fac})},E2tj:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("FnNU"),s=i("XNiG"),a=i("lJxs"),r=i("fXoL");class c extends n.a{constructor(){super(),this.name="IsolatedQuerySpace",this.query=Object(n.f)(),this.queryForm=Object(n.f)(),this.results=Object(n.f)(),this.groups=Object(n.f)(),this.columns=Object(n.f)(),this.collapsedGroups=Object(n.f)(),this.tableRendered=Object(n.f)(),this.timelineRendered=new s.a,this.renderedWorkPackages=Object(n.c)(this.tableRendered,e=>e.pipe(Object(a.a)(e=>e.filter(e=>!!e.workPackageId)))),this.renderedWorkPackageIds=Object(n.c)(this.renderedWorkPackages,e=>e.pipe(Object(a.a)(e=>e.map(e=>e.workPackageId.toString())))),this.stopAllSubscriptions=new s.a,this.additionalRequiredWorkPackages=Object(n.f)(),this.initialized=Object(n.f)()}}c.\u0275fac=function(e){return new(e||c)},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac})},E5Dd:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT_ARROW=37]="LEFT_ARROW",e[e.UP_ARROW=38]="UP_ARROW",e[e.RIGHT_ARROW=39]="RIGHT_ARROW",e[e.DOWN_ARROW=40]="DOWN_ARROW",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.KEY_0=48]="KEY_0",e[e.KEY_1=49]="KEY_1",e[e.KEY_2=50]="KEY_2",e[e.KEY_3=51]="KEY_3",e[e.KEY_4=52]="KEY_4",e[e.KEY_5=53]="KEY_5",e[e.KEY_6=54]="KEY_6",e[e.KEY_7=55]="KEY_7",e[e.KEY_8=56]="KEY_8",e[e.KEY_9=57]="KEY_9",e[e.KEY_A=65]="KEY_A",e[e.KEY_B=66]="KEY_B",e[e.KEY_C=67]="KEY_C",e[e.KEY_D=68]="KEY_D",e[e.KEY_E=69]="KEY_E",e[e.KEY_F=70]="KEY_F",e[e.KEY_G=71]="KEY_G",e[e.KEY_H=72]="KEY_H",e[e.KEY_I=73]="KEY_I",e[e.KEY_J=74]="KEY_J",e[e.KEY_K=75]="KEY_K",e[e.KEY_L=76]="KEY_L",e[e.KEY_M=77]="KEY_M",e[e.KEY_N=78]="KEY_N",e[e.KEY_O=79]="KEY_O",e[e.KEY_P=80]="KEY_P",e[e.KEY_Q=81]="KEY_Q",e[e.KEY_R=82]="KEY_R",e[e.KEY_S=83]="KEY_S",e[e.KEY_T=84]="KEY_T",e[e.KEY_U=85]="KEY_U",e[e.KEY_V=86]="KEY_V",e[e.KEY_W=87]="KEY_W",e[e.KEY_X=88]="KEY_X",e[e.KEY_Y=89]="KEY_Y",e[e.KEY_Z=90]="KEY_Z",e[e.LEFT_META=91]="LEFT_META",e[e.RIGHT_META=92]="RIGHT_META",e[e.SELECT=93]="SELECT",e[e.NUMPAD_0=96]="NUMPAD_0",e[e.NUMPAD_1=97]="NUMPAD_1",e[e.NUMPAD_2=98]="NUMPAD_2",e[e.NUMPAD_3=99]="NUMPAD_3",e[e.NUMPAD_4=100]="NUMPAD_4",e[e.NUMPAD_5=101]="NUMPAD_5",e[e.NUMPAD_6=102]="NUMPAD_6",e[e.NUMPAD_7=103]="NUMPAD_7",e[e.NUMPAD_8=104]="NUMPAD_8",e[e.NUMPAD_9=105]="NUMPAD_9",e[e.MULTIPLY=106]="MULTIPLY",e[e.ADD=107]="ADD",e[e.SUBTRACT=109]="SUBTRACT",e[e.DECIMAL=110]="DECIMAL",e[e.DIVIDE=111]="DIVIDE",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUM_LOCK=144]="NUM_LOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.SEMICOLON=186]="SEMICOLON",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.DASH=189]="DASH",e[e.PERIOD=190]="PERIOD",e[e.FORWARD_SLASH=191]="FORWARD_SLASH",e[e.GRAVE_ACCENT=192]="GRAVE_ACCENT",e[e.OPEN_BRACKET=219]="OPEN_BRACKET",e[e.BACK_SLASH=220]="BACK_SLASH",e[e.CLOSE_BRACKET=221]="CLOSE_BRACKET",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE"}(n||(n={}))},EnRq:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("zqrF"),s=i("E2tj"),a=i("fXoL");class r extends n.a{constructor(e){super(e)}valueFromQuery(e){return!!e.sums}initialize(e){this.pristineState.putValue(!!e.sums)}hasChanged(e){return e.sums!==this.isEnabled}applyToQuery(e){return e.sums=this.isEnabled,!0}toggle(){this.updatesState.putValue(!this.current)}setEnabled(e){this.updatesState.putValue(e)}get isEnabled(){return this.current}get current(){return this.lastUpdatedState.getValueOr(!1)}}r.\u0275fac=function(e){return new(e||r)(a.qc(s.a))},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac})},Eofd:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var n=i("fXoL"),s=(i("ii2/"),i("VgZ9")),a=i("wZYP"),r=i("qc15"),c=i("ofXK"),o=i("0loS"),l=i("/Rze"),d=i("MIK2");const u=function(e){return{workPackageId:e}};function h(e,t){if(1&e&&(n.mc(0,"a",5),n.hc(1,"span",6),n.lc()),2&e){const e=n.wc(2);n.Bc("uiParams",n.Gc(3,u,e.parent.id)),n.Ub("title",e.parent.name),n.Tb(1),n.Bc("textContent",e.parent.name)}}function p(e,t){if(1&e&&n.hc(0,"span",6),2&e){const e=n.wc(3);n.Bc("textContent",e.text.set_parent)}}function g(e,t){if(1&e){const e=n.nc();n.mc(0,"accessible-by-keyboard",7),n.uc("execute",(function(){return n.Qc(e),n.wc(2).open()})),n.Yc(1,p,1,1,"span",8),n.lc()}if(2&e){const e=n.wc(2);n.Dc("linkClass","wp-relation--parent-change -no-decoration hide-when-print icon-small ",e.parent?"icon-edit icon5":"icon-add icon4",""),n.Bc("linkTitle",e.parent?e.text.edit_parent:e.text.set_parent),n.Tb(1),n.Bc("ngIf",!e.parent)}}function m(e,t){if(1&e){const e=n.nc();n.mc(0,"accessible-by-keyboard",9),n.uc("execute",(function(){return n.Qc(e),n.wc(2).updateParent(null)})),n.lc()}if(2&e){const e=n.wc(2);n.Bc("linkTitle",e.text.remove_parent)}}function f(e,t){if(1&e&&(n.kc(0),n.Yc(1,h,2,5,"a",2),n.Yc(2,g,2,3,"accessible-by-keyboard",3),n.Yc(3,m,1,1,"accessible-by-keyboard",4),n.jc()),2&e){const e=n.wc();n.Tb(1),n.Bc("ngIf",e.parent),n.Tb(1),n.Bc("ngIf",e.canModifyParent()),n.Tb(1),n.Bc("ngIf",e.canModifyParent()&&e.parent)}}function b(e,t){if(1&e){const e=n.nc();n.mc(0,"wp-relations-autocomplete",10),n.uc("onCancel",(function(){return n.Qc(e),n.wc().close()}))("onSelected",(function(t){return n.Qc(e),n.wc().updateParent(t)})),n.lc()}if(2&e){const e=n.wc();n.Bc("inputPlaceholder",e.text.set_or_remove_parent)("workPackage",e.workPackage)}}class w{constructor(e,t,i){this.I18n=e,this.wpRelationsHierarchy=t,this.notificationService=i,this.onSwitch=new n.s,this.isSaving=!1,this.text={edit_parent:this.I18n.t("js.relation_buttons.change_parent"),set_or_remove_parent:this.I18n.t("js.relations_autocomplete.parent_placeholder"),remove_parent:this.I18n.t("js.relation_buttons.remove_parent"),set_parent:this.I18n.t("js.relation_buttons.set_parent")}}canModifyParent(){return!!this.workPackage.changeParent}get parent(){return this.workPackage&&this.workPackage.parent}get active(){return this.editing}close(){this.toggle(!1)}open(){this.toggle(!0)}updateParent(e){this.close();let t=e?e.id:null;_.get(this.parent,"id",null)!==t&&(this.isSaving=!0,this.wpRelationsHierarchy.changeParent(this.workPackage,t).catch(e=>{this.notificationService.handleRawError(e,this.workPackage)}).then(()=>this.isSaving=!1))}toggle(e){this.editing!==e&&(this.editing=e,this.onSwitch.emit(this.editing))}}w.\u0275fac=function(e){return new(e||w)(n.gc(a.a),n.gc(s.a),n.gc(r.a))},w.\u0275cmp=n.ac({type:w,selectors:[["wp-breadcrumb-parent"]],inputs:{workPackage:"workPackage"},outputs:{onSwitch:"onSwitch"},decls:2,vars:2,consts:[[4,"ngIf"],["filterCandidatesFor","parent",3,"inputPlaceholder","workPackage","onCancel","onSelected",4,"ngIf"],["uiSref","work-packages.show.activity","class","wp-breadcrumb-parent breadcrumb-project-title nocut",3,"uiParams",4,"ngIf"],[3,"linkTitle","linkClass","execute",4,"ngIf"],["linkClass","wp-relation--parent-remove hide-when-print -no-decoration icon-small icon-remove icon4",3,"linkTitle","execute",4,"ngIf"],["uiSref","work-packages.show.activity",1,"wp-breadcrumb-parent","breadcrumb-project-title","nocut",3,"uiParams"],[3,"textContent"],[3,"linkTitle","linkClass","execute"],[3,"textContent",4,"ngIf"],["linkClass","wp-relation--parent-remove hide-when-print -no-decoration icon-small icon-remove icon4",3,"linkTitle","execute"],["filterCandidatesFor","parent",3,"inputPlaceholder","workPackage","onCancel","onSelected"]],template:function(e,t){1&e&&(n.Yc(0,f,4,3,"ng-container",0),n.Yc(1,b,1,2,"wp-relations-autocomplete",1)),2&e&&(n.Bc("ngIf",!t.active),n.Tb(1),n.Bc("ngIf",t.active))},directives:[c.q,o.AnchorUISref,o.UISref,l.a,d.a],encapsulation:2})},EzE4:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("wZYP"),s=i("fXoL"),a=i("FDKb"),r=i("N5AO");class c{constructor(e){this.I18n=e,this.text={button_settings:this.I18n.t("js.button_settings")}}}c.\u0275fac=function(e){return new(e||c)(s.gc(n.a))},c.\u0275cmp=s.ac({type:c,selectors:[["ng-component"]],decls:2,vars:1,consts:[["id","work-packages-settings-button","opSettingsContextMenu","","opSettingsContextMenu-query","query",1,"button","last","work-packages-settings-button","toolbar-icon",3,"title"],["icon-classes","button--icon icon-show-more"]],template:function(e,t){1&e&&(s.mc(0,"button",0),s.hc(1,"op-icon",1),s.lc()),2&e&&s.Cc("title",t.text.button_settings)},directives:[a.a,r.a],encapsulation:2,changeDetection:0})},F3Jm:function(e,t,i){"use strict";i.d(t,"a",(function(){return x}));var n=i("JY8V"),s=i("SqdZ"),a=i("E2tj"),r=i("wZYP"),c=i("IaZ+"),o=i("yQm5"),l=i("Y0Nk"),d=i("eIep"),u=i("GJmQ"),h=i("lJxs"),p=i("l5mm"),g=i("d/TE"),m=i("fXoL"),f=i("tk/3"),b=i("ofXK"),w=i("N5AO");const v=["downloadLink"];function y(e,t){if(1&e){const e=m.nc();m.mc(0,"li"),m.mc(1,"a",12),m.uc("click",(function(i){m.Qc(e);const n=t.$implicit;return m.wc(2).triggerByLink(n.url,i)})),m.hc(2,"op-icon",13),m.hc(3,"span",14),m.lc(),m.lc()}if(2&e){const e=t.$implicit;m.Tb(1),m.Dc("id","export-",e.identifier,""),m.Ub("href",e.url,m.Tc),m.Tb(1),m.Dc("icon-classes","icon-export-",e.identifier," icon-big"),m.Tb(1),m.Bc("textContent",e.label)}}const k=function(e){return{"-hidden":e}};function C(e,t){if(1&e&&(m.mc(0,"ul",10),m.Yc(1,y,4,4,"li",11),m.lc()),2&e){const e=m.wc();m.Bc("ngClass",m.Gc(2,k,e.isLoading)),m.Tb(1),m.Bc("ngForOf",e.exportOptions)}}function j(e,t){if(1&e&&(m.mc(0,"div"),m.hc(1,"div",15),m.hc(2,"div",3),m.lc()),2&e){const e=m.wc();m.Tb(2),m.Bc("textContent",e.text.exportPreparing)}}class x extends s.a{constructor(e,t,i,n,s,a,r,c,o){super(e,s,i),this.locals=e,this.I18n=t,this.elementRef=i,this.querySpace=n,this.cdRef=s,this.httpClient=a,this.wpTableColumns=r,this.loadingIndicator=c,this.notifications=o,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.text={title:this.I18n.t("js.label_export"),closePopup:this.I18n.t("js.close_popup_title"),exportPreparing:this.I18n.t("js.label_export_preparing")},this.isLoading=!1}ngOnInit(){super.ngOnInit(),this.locals.link?this.downloadSwitched(this.locals.link):this.querySpace.results.valuesPromise().then(e=>this.exportOptions=this.buildExportOptions(e))}ngOnDestroy(){super.ngOnDestroy(),this.safeUnsubscribe()}buildExportOptions(e){return e.representations.map(e=>{const t=e.$link;return{identifier:t.identifier,label:t.title,url:this.addColumnsToHref(e.href)}})}triggerByLink(e,t){t.preventDefault(),this.downloadSwitched(e)}downloadSwitched(e){this.performRequest(e).subscribe(e=>{200===e.status&&this.download(e.url),202===e.status&&this.linkHeaderUrl(e)&&this.pollUntilDownload(this.linkHeaderUrl(e))},e=>this.handleError(e.message))}pollUntilDownload(e){this.isLoading=!0,this.subscription=Object(p.a)(1e3).pipe(Object(d.a)(()=>this.performRequest(e)),Object(u.a)(e=>200===e.status,!0),Object(h.a)(e=>JSON.parse(e.body)),Object(u.a)(e=>"Processing"===e.status,!0),Object(l.b)(this.loadingIndicator.getter("modal"))).subscribe(e=>{"Completed"===e.status?this.download(e.link):"Error"===e.status&&this.handleError(e.message)},e=>this.handleError(e.message),()=>this.isLoading=!1)}performRequest(e){return this.httpClient.get(e,{observe:"response",responseType:"text"})}handleError(e){this.isLoading=!1,this.notifications.addError(e||this.I18n.t("js.error.internal"))}addColumnsToHref(e){let t=this.wpTableColumns.getColumns().map((function(e){return e.id})),i=o(e);return i.removeSearch("columns[]"),i.addSearch("columns[]",t),i.toString()}get afterFocusOn(){return jQuery("#work-packages-settings-button")}download(e){this.downloadHref=e,setTimeout(()=>{this.downloadLink.nativeElement.click(),this.service.close()})}linkHeaderUrl(e){let t=e.headers.get("link");if(!t)return null;let i=t.match(/<([^>]+)>/);return i?i[1]:null}safeUnsubscribe(){this.subscription&&this.subscription.unsubscribe()}}x.\u0275fac=function(e){return new(e||x)(m.gc(c.a),m.gc(r.a),m.gc(m.q),m.gc(a.a),m.gc(m.i),m.gc(f.b),m.gc(n.a),m.gc(l.a),m.gc(g.a))},x.\u0275cmp=m.ac({type:x,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&m.fd(v,!0),2&e)&&(m.Nc(i=m.vc())&&(t.downloadLink=i.first))},features:[m.Qb],decls:10,vars:6,consts:[[1,"op-modal--portal"],["tabindex","0",1,"op-modal--modal-container","wp-table--configuration-modal"],[1,"op-modal--modal-header"],[3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],["class","export-options",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","download-link","download","",1,"button",3,"title"],["downloadLink",""],[1,"export-options",3,"ngClass"],[4,"ngFor","ngForOf"],[3,"id","click"],[3,"icon-classes"],[1,"export-label",3,"textContent"],["data-indicator-name","modal",1,"loading-indicator--location"]],template:function(e,t){1&e&&(m.mc(0,"div",0),m.mc(1,"div",1),m.mc(2,"div",2),m.hc(3,"h3",3),m.mc(4,"a",4),m.mc(5,"i",5),m.uc("click",(function(e){return t.closeMe(e)})),m.lc(),m.lc(),m.lc(),m.Yc(6,C,2,4,"ul",6),m.Yc(7,j,3,1,"div",7),m.hc(8,"a",8,9),m.lc(),m.lc()),2&e&&(m.Tb(3),m.Bc("textContent",t.text.title),m.Tb(2),m.Ub("title",t.text.closePopup),m.Tb(1),m.Bc("ngIf",t.exportOptions),m.Tb(1),m.Bc("ngIf",t.isLoading),m.Tb(1),m.Bc("title","Export"),m.Ub("href",t.downloadHref,m.Tc))},directives:[b.q,b.n,b.p,w.a],styles:["#download-link[_ngcontent-%COMP%]{display:none}.loading-indicator--location[_ngcontent-%COMP%]{height:220px}.export-options.-hidden[_ngcontent-%COMP%]{display:none}"]})},F5Dh:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("zqrF"),s=i("AA01"),a=i("E2tj"),r=i("FnNU"),c=i("PZVJ"),o=i("d4d5"),l=i("iMRi"),d=i("IzEk"),u=i("CqXF"),h=i("fXoL");class p extends n.a{constructor(e,t){super(t),this.states=e,this.querySpace=t,this.hidden=["id","parent","datesInterval","precedes","follows","relates","duplicates","duplicated","blocks","blocked","partof","includes","requires","required","search","subjectOrId"],this.incomplete=Object(r.f)(!1)}initializeFilters(e,t){let i=Object(c.a)(e.filters);this.loadCurrentFiltersSchemas(i).then(()=>{this.availableState.putValue(t.filtersSchemas.elements),this.pristineState.putValue(i)})}get isEmpty(){const e=this.lastUpdatedState.value;return!e||0===e.length}get availableState(){return this.states.queries.filters}get incomplete$(){return this.incomplete.values$()}add(e){this.updatesState.putValue([...this.rawFilters,e])}replace(e,t){let i=this.instantiate(e),n=[...this.rawFilters];t(i);const s=this.findIndex(e);-1===s?n.push(i):n.splice(s,1,i),this.update(n)}modify(e,t){const i=this.findIndex(e);if(-1===i)return!1;let n=[...this.rawFilters];return t(n[i]),this.update(n),!0}instantiate(e){let t=e instanceof o.a?e.id:e;return _.find(this.availableSchemas,e=>e.filter.allowedValues[0].id===t).getFilter()}remove(...e){let t=e=>e instanceof s.a?e.id:e,i=new Set(e.map(t));this.update(this.rawFilters.filter(e=>!i.has(t(e))))}remainingVisibleFilters(e=this.current){return this.remainingFilters(e).filter(e=>-1===this.hidden.indexOf(e.id))}get availableFilters(){return this.availableSchemas.map(e=>e.allowedFilterValue)}get availableSchemas(){return this.availableState.getValueOr([])}isComplete(e){return _.every(e,e=>e.isCompletelyDefined())}hasChanged(e){const t=e=>e.map(e=>e.$source);return!_.isEqual(t(e.filters),t(this.rawFilters))}valueFromQuery(e){}update(e){super.update(e),this.incomplete.putValue(!1)}find(e){const t=this.findIndex(e);if(-1!==t)return this.rawFilters[t]}findIndex(e){return _.findIndex(this.current,t=>t.id===e)}applyToQuery(e){return e.filters=this.cloneFilters(),!0}get current(){return[...this.rawFilters]}cloneFilters(){return Object(c.a)(this.rawFilters)}get rawFilters(){return this.lastUpdatedState.value||[]}get currentlyVisibleFilters(){const e=new Set(this.hidden);return e.delete("search"),_.reject(this.currentFilterResources,t=>e.has(t.id))}replaceIfComplete(e){this.isComplete(e)?this.update(e):this.incomplete.putValue(!0)}onReady(){return Object(r.b)(this.pristineState,this.availableState).values$().pipe(Object(d.a)(1),Object(u.a)(null)).toPromise()}remainingFilters(e=this.rawFilters){return _.differenceBy(this.availableFilters,e,e=>e.id)}get currentFilterResources(){return this.rawFilters.map(e=>e.filter)}loadCurrentFiltersSchemas(e){return Promise.all(e.map(e=>{const t=`/api/v3/queries/filter_instance_schemas/${e.id}`;return e.schema?e.schema.$load():this.states.schemas.get(t).valuesPromise().then(t=>e.schema=t)}))}}p.\u0275fac=function(e){return new(e||p)(h.qc(l.a),h.qc(a.a))},p.\u0275prov=h.cc({token:p,factory:p.\u0275fac})},FB4C:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("JY8V"),s=i("zqrF"),a=i("kTsZ"),r=i("E2tj"),c=i("ug4p"),o=i("uSJ+"),l=i("QOiP"),d=i("fXoL");class u extends s.b{constructor(e,t,i,n,s){super(e),this.querySpace=e,this.wpTableColumns=t,this.halResourceService=i,this.wpCacheService=n,this.wpRelations=s}valueFromQuery(e){return this.current}relationsToExtendFor(e,t,i){if(!this.wpTableColumns.hasRelationColumns()||!this.lastUpdatedState.hasValue())return;if(_.isNil(t))return;const n=this.getExpandFor(e.id);if(void 0===n)return;const s=this.wpTableColumns.findById(n),a=this.relationColumnType(s);null!==a&&_.each(this.relationsForColumn(e,t,s),e=>i(e,s,a))}relationsForColumn(e,t,i){if(_.isNil(t))return[];const n=this.relationColumnType(i);if("toType"===n){const n=i.type.href;return _.filter(t,t=>{const i=t.denormalized(e),s=this.wpCacheService.state(i.targetId).value;return _.get(s,"type.href")===n})}if("ofType"===n){const n=i.relationType;return _.filter(t,t=>t.denormalized(e).relationType===n)}return[]}relationColumnType(e){switch(e._type){case l.b.RELATION_TO_TYPE:return"toType";case l.b.RELATION_OF_TYPE:return"ofType";default:return null}}getExpandFor(e){return this.current[e]}setExpandFor(e,t){const i=Object.assign({},this.current);i[e]=t,this.update(i)}collapse(e){const t=Object.assign({},this.current);delete t[e],this.update(t)}get current(){return this.lastUpdatedState.getValueOr({})}}u.\u0275fac=function(e){return new(e||u)(d.qc(r.a),d.qc(n.a),d.qc(a.a),d.qc(c.a),d.qc(o.a))},u.\u0275prov=d.cc({token:u,factory:u.\u0275fac})},FDFi:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("mrSG"),s=i("XNiG"),a=i("wZYP"),r=i("Kg8T"),c=i("r0MM"),o=i("fXoL");class l{constructor(e){this.injector=e,this.referenceComponentClass=null,this.referenceTarget=null,this.buttonTexts={reference:"",create:this.I18n.t("js.label_create_work_package")},this.newInlineWorkPackageCreated=new s.a,this.newInlineWorkPackageReferenced=new s.a}get canAdd(){return this.canCreateWorkPackages||this.authorisationService.can("work_package","addChild")}get canReference(){return!1}get canCreateWorkPackages(){return this.authorisationService.can("work_packages","createWorkPackage")&&this.authorisationService.can("work_packages","editWorkPackage")}ngOnDestroy(){this.newInlineWorkPackageCreated.complete(),this.newInlineWorkPackageReferenced.complete()}}l.\u0275fac=function(e){return new(e||l)(o.qc(o.A))},l.\u0275prov=o.cc({token:l,factory:l.\u0275fac}),Object(n.c)([Object(c.a)(),Object(n.e)("design:type",a.a)],l.prototype,"I18n",void 0),Object(n.c)([Object(c.a)(),Object(n.e)("design:type",r.a)],l.prototype,"authorisationService",void 0)},FDKb:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("wZYP"),s=i("Kg8T"),a=i("PUHT"),r=i("4lR/"),c=i("iMRi"),o=i("DhiE"),l=(i("B4Ei"),i("IaZ+")),d=i("F3Jm"),u=i("VPzE"),h=i("u/Nd"),p=i("sngl"),g=i("E2tj"),m=i("CV67"),f=i("fXoL");class b extends a.a{constructor(e,t,i,n,s,a,r,c,o){super(e,t),this.elementRef=e,this.opContextMenu=t,this.opModalService=i,this.wpListService=n,this.authorisationService=s,this.states=a,this.injector=r,this.querySpace=c,this.I18n=o,this.focusAfterClose=!0}ngAfterViewInit(){super.ngAfterViewInit(),this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.query=e}),this.loadingPromise=this.querySpace.queryForm.valuesPromise(),this.querySpace.queryForm.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.form=e})}open(e){this.loadingPromise.then(()=>{this.buildItems(),this.opContextMenu.show(this,e)})}get locals(){return{contextMenuId:"settingsDropdown",items:this.items}}positionArgs(e){let t=super.positionArgs(e);return _.assign(t,{my:"right top",at:"right bottom"}),t}onClose(){this.focusAfterClose&&this.afterFocusOn.focus()}allowQueryAction(e,t){return this.allowAction(e,"query",t)}allowWorkPackageAction(e,t){return this.allowAction(e,"work_packages",t)}allowFormAction(e,t){return!!this.form.$links[t]||(e.stopPropagation(),!1)}allowAction(e,t,i){return!!this.authorisationService.can(t,i)||(e.stopPropagation(),!1)}buildItems(){this.items=[{disabled:!1,linkText:this.I18n.t("js.toolbar.settings.configure_view"),icon:"icon-settings",onClick:e=>(this.opContextMenu.close(),this.opModalService.show(p.a,this.injector),!0)},{linkText:this.I18n.t("js.work_packages.query.insert_columns"),icon:"icon-columns",class:"hidden-for-mobile",onClick:()=>(this.opModalService.show(p.a,this.injector,{initialTab:"columns"}),!0)},{linkText:this.I18n.t("js.toolbar.settings.sort_by"),icon:"icon-sort-by",onClick:()=>(this.opModalService.show(p.a,this.injector,{initialTab:"sort-by"}),!0)},{linkText:this.I18n.t("js.toolbar.settings.group_by"),icon:"icon-group-by",class:"hidden-for-mobile",onClick:()=>(this.opModalService.show(p.a,this.injector,{initialTab:"display-settings"}),!0)},{disabled:!this.query.id||this.authorisationService.cannot("query","updateImmediately"),linkText:this.I18n.t("js.toolbar.settings.page_settings"),icon:"icon-edit",onClick:e=>(this.allowQueryAction(e,"update")&&(this.focusAfterClose=!1,jQuery(`${m.b}`).trigger(m.c)),!0)},{disabled:this.authorisationService.cannot("query","updateImmediately"),linkText:this.I18n.t("js.toolbar.settings.save"),icon:"icon-save",onClick:e=>{const t=this.query;return!t.persisted&&this.allowQueryAction(e,"updateImmediately")?this.opModalService.show(u.a,this.injector):t.id&&this.allowQueryAction(e,"updateImmediately")&&this.wpListService.save(t),!0}},{disabled:this.form?!this.form.$links.create_new:this.authorisationService.cannot("query","updateImmediately"),linkText:this.I18n.t("js.toolbar.settings.save_as"),icon:"icon-save",onClick:e=>(this.allowFormAction(e,"create_new")&&this.opModalService.show(u.a,this.injector),!0)},{disabled:this.authorisationService.cannot("query","delete"),linkText:this.I18n.t("js.toolbar.settings.delete"),icon:"icon-delete",onClick:e=>(this.allowQueryAction(e,"delete")&&window.confirm(this.I18n.t("js.text_query_destroy_confirmation"))&&this.wpListService.delete(),!0)},{disabled:this.authorisationService.cannot("work_packages","representations"),linkText:this.I18n.t("js.toolbar.settings.export"),icon:"icon-export",onClick:e=>(this.allowWorkPackageAction(e,"representations")&&this.opModalService.show(d.a,this.injector),!0)},{disabled:this.authorisationService.cannot("query","unstar")&&this.authorisationService.cannot("query","star"),linkText:this.I18n.t("js.toolbar.settings.visibility_settings"),icon:"icon-watched",onClick:e=>((this.allowQueryAction(e,"unstar")||this.allowQueryAction(e,"star"))&&this.opModalService.show(h.a,this.injector),!0)},{divider:!0,hidden:!(this.query.results.customFields&&this.form.configureForm)},{hidden:!this.query.results.customFields,href:this.query.results.customFields&&this.query.results.customFields.href,linkText:this.query.results.customFields&&this.query.results.customFields.name,icon:"icon-custom-fields",onClick:()=>!1}]}}b.\u0275fac=function(e){return new(e||b)(f.gc(f.q),f.gc(r.a),f.gc(l.b),f.gc(o.a),f.gc(s.a),f.gc(c.a),f.gc(f.A),f.gc(g.a),f.gc(n.a))},b.\u0275dir=f.bc({type:b,selectors:[["","opSettingsContextMenu",""]],inputs:{query:["opSettingsContextMenu-query","query"]},features:[f.Qb]})},FlxY:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));const n={id:"__internal-sorthandle"},s={id:"__internal-contextMenu"}},GDA9:function(e,t,i){i("/ur0"),i("7k/7"),i("z2n6"),i("/Su4"),i("RMHK"),i("brli"),i("0loS"),i("fPeS"),i("Jchv"),i("Vn+K"),i("2nA0"),i("9/yf"),i("NvoQ"),i("+NVk"),i("wEvd"),i("HmDX"),i("cZ/E"),i("2nA0"),i("O2Hw"),i("Oaa7"),i("tGlX"),i("TiIQ"),i("yFkT"),i("/+cc"),i("+WSP"),i("mKGy"),i("cnmK"),i("cK71"),i("5GLZ")},GLdX:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("E+lO"),s=i("fXoL");class a{constructor(e,t,i){this.componentFactoryResolver=e,this.appRef=t,this.injector=i}render(e,t){e.innerHTML=t;let i=[];return n.DynamicBootstrapper.getEmbeddable().forEach(t=>{const n=e.querySelectorAll(t.selector);for(let e=0,s=n.length;e<s;e++){const s=this.componentFactoryResolver.resolveComponentFactory(t.cls).create(this.injector,[],n[e]);i.push(s),this.appRef.attachView(s.hostView),s.changeDetectorRef.detectChanges()}}),()=>{i.forEach(e=>{this.appRef.detachView(e.hostView),e.destroy()}),i.length=0,e.innerHTML=""}}}a.\u0275fac=function(e){return new(e||a)(s.qc(s.l),s.qc(s.f),s.qc(s.A))},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac})},GZlY:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("u4T9"),s=i("oT5z"),a=i("8VVp"),r=i("fXoL");class c{}c.\u0275mod=r.ec({type:c}),c.\u0275inj=r.dc({factory:function(e){return new(e||c)},imports:[[n.a,a.a,s.a]]})},GjwL:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n,s=i("qHU1");!function(e){e.setPosition=function(e,t){try{e.setSelectionRange(t,t)}catch(i){Object(s.a)("Failed to set click position for edit field.",i)}},e.getPosition=function(e){const t=e.originalEvent;try{if(document.caretRangeFromPoint)return document.caretRangeFromPoint(e.clientX,e.clientY).startOffset;if(t.rangeParent){let e=document.createRange();return e.setStart(t.rangeParent,t.rangeOffset),e.startOffset}return 0}catch(i){return Object(s.a)("Failed to get click position for edit field.",i),0}}}(n||(n={}))},GntA:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));class n{constructor(){this.changes={}}contains(e){return this.changes.hasOwnProperty(e)}get changed(){return _.keys(this.changes)}get all(){return this.changes}reset(...e){e.forEach(e=>{delete this.changes[e]})}clear(){this.changes={}}set(e,t,i){this.changes[e]={from:i,to:t}}getItem(e){return this.changes[e]}getValue(e){var t;return null===(t=this.getItem(e))||void 0===t?void 0:t.to}getPristine(e){var t;return null===(t=this.changes[e])||void 0===t?void 0:t.from}}var s=i("FnNU"),a=i("qHU1"),r=i("IzEk");class c{constructor(e,t,i=null){this.state=t,this.changeset=new n,this.form$=Object(s.f)(),this.cache={},this.inFlight=!1,this.updatePristineResource(e),i&&this.form$.putValue(i)}push(){this.state&&this.state.putValue(this)}buildRequestPayload(){return this.getForm().then(()=>this.buildPayloadFromChanges())}updatePristineResource(e){if(e.__is_changeset_proxy)throw"You're trying to pass proxy object as a pristine resource. This will cause errors";this._pristineResource=e,this.projectedResource=new Proxy(this._pristineResource,{get:(e,t)=>this.proxyGet(t),set:(e,t,i)=>(this.setValue(t,i),!0)})}get pristineResource(){return this._pristineResource}getSchemaName(e){return this.projectedResource.getSchemaName?this.projectedResource.getSchemaName(e):e}getForm(){return this.form$.isPristine()&&!this.form$.hasActivePromiseRequest()?this.updateForm():this.form$.values$().pipe(Object(r.a)(1)).toPromise()}updateForm(){let e=this.buildPayloadFromChanges();const t=this.pristineResource.$links.update(e).then(e=>(this.cache={},this.form$.putValue(e),this.setNewDefaults(e),this.push(),e));return this.form$.putFromPromiseIfPristine(()=>t),t}isEmpty(){return 0===this.changeset.changed.length}get id(){return this.pristineResource.id}get href(){return this.pristineResource.href}get changes(){let e={};return _.each(this.changeset.all,(t,i)=>{e[i]=t.to}),e}get changeMap(){return Object.assign({},this.changeset.all)}get changedAttributes(){return this.changeset.changed}isWritable(e){const t=this.schema[e];return!(!t||!t.writable)}humanName(e){return _.get(this.schema,`${e}.name`,e)}contains(e){return this.changeset.contains(e)}proxyGet(e){return"schema"===e?this.schema:"__is_proxy"===e||this.value(e)}value(e){return this.changeset.contains(e)?this.changeset.getValue(e):this.pristineResource[e]}valueExists(e){return this.changeset.contains(e)||this.pristineResource.hasOwnProperty(e)}setValue(e,t){this.changeset.set(e,t,this.pristineResource[e])}clearValue(...e){this.changeset.reset(...e)}clear(){this.state&&this.state.clear(),this.changeset.clear(),this.cache={},this.form$.clear()}reset(e){this.changeset.reset(e)}isOverridden(e){return this.changes.hasOwnProperty(e)}get schema(){return this.form$.getValueOr(this.pristineResource).schema}cacheValue(e,t){return this.cache[e]?this.cache[e]:this.cache[e]=t()}get minimalPayload(){return{lockVersion:this.pristineResource.lockVersion,_links:{}}}applyChanges(e){let t=this.pristineResource.$source;return this.form$.value&&(t=this.form$.value.payload.$source),_.each(this.changeset.all,(i,n)=>{const s=this.schema[n];"object"==typeof s&&s.writable?t._links[n]?e._links[n]=this.getLinkedValue(i.to,s):e[n]=i.to:Object(a.a)(`Trying to write ${n} but is not writable in schema`)}),e}buildPayloadFromChanges(){let e;return this.pristineResource.isNew?(e=this.form$.value?_.cloneDeep(this.form$.value.payload.$source):_.cloneDeep(this.pristineResource.$source),this.pristineResource.attachments&&(e._links.attachments=this.pristineResource.attachments.elements.map(e=>({href:e.href})))):e=this.minimalPayload,this.applyChanges(e)}getLinkedValue(e,t){if(_.isNil(e))return{href:null};let i=(t.type||"").startsWith("[]"),n=!1;if((e.forEach||e.elements)&&(n=!0),n&&i){let t=[];if(e){(e.forEach&&e||e.elements).forEach(e=>{e.href&&t.push({href:e.href})})}return t}return{href:_.get(e,"href",null)}}setNewDefaults(e){_.each(e.payload,(e,t)=>{const i=this.schema[t];"object"==typeof i&&i.writable&&this.setNewDefaultFor(t,e)})}setNewDefaultFor(e,t){this.valueExists(e)||(Object(a.a)("Taking over default value from form for "+e),this.setValue(e,t))}}},Gyz5:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("Jui0"),s=i("fXoL"),a=i("tk/3");class r{constructor(e,t){this.http=e,this.pathHelper=t}get(e){return this.http.get(this.orderPath(e)).toPromise().then(e=>e||{})}update(e,t){return this.http.patch(this.orderPath(e),{delta:t},{withCredentials:!0}).toPromise().then(e=>e.t)}delete(e,...t){let i={};return t.forEach(e=>i[e]=-1),this.update(e,i)}orderPath(e){return this.pathHelper.api.v3.queries.id(e).order.toString()}}r.\u0275fac=function(e){return new(e||r)(s.qc(a.b),s.qc(n.a))},r.\u0275prov=s.cc({token:r,factory:r.\u0275fac})},H3ou:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("+rOU");class s{constructor(e,t,i,n,s){this.availableTabs=e,this.outletElement=t,this.componentFactoryResolver=i,this.appRef=n,this.injector=s,this.activeTabs={},this.currentTab=null}get activeComponents(){return _.values(this.activeTabs).map(e=>e.componentRef.instance)}switchTo(e){const t=_.find(this.availableTabs,t=>t.name===e);if(!t)throw`Trying to switch to unknown tab ${e}.`;if(null!=t.disableBecause)return!1;this.detach();const i=this.activateInstance(t);return this.outletElement.innerHTML="",this.outletElement.appendChild(this._getComponentRootNode(i.componentRef)),this.outletElement.dataset.tabName=t.title,this.currentTab=i,!1}detach(){const e=this.currentTab;null!==e&&(e.portal.setAttachedHost(null),this.currentTab=null)}dispose(){_.each(this.activeTabs,e=>e.dispose()),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}activateInstance(e){return this.activeTabs[e.name]||(this.activeTabs[e.name]=this.createComponent(e)),this.activeTabs[e.name]||null}createComponent(e){const t=this.componentFactoryResolver.resolveComponentFactory(e.componentClass).create(this.injector),i=new n.c(e.componentClass,null,this.injector);return this.appRef.attachView(t.hostView),{name:e.name,portal:i,componentRef:t,dispose:()=>{this.appRef.detachView(t.hostView),t.destroy()}}}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}},HEQ6:function(e,t,i){"use strict";i.d(t,"a",(function(){return N}));var n=i("E2tj"),s=i("ooSb"),a=i("FB4C"),r=i("Zq3F"),c=i("AeZM"),o=i("wyKs"),l=i("6yP5"),d=i("JY8V"),u=i("F5Dh"),h=i("PtkW"),p=i("eyhC"),g=i("EnRq"),m=i("ONn1"),f=i("2Qcm"),b=i("4n9w"),w=i("+oAL"),v=i("Y/CA"),y=i("SKFm"),k=i("DhiE"),C=i("ABwi"),j=i("VgZ9"),x=i("l08T"),T=i("Q6HB"),S=i("FDFi"),_=i("f9kS"),P=i("Yblc"),I=i("W6hW"),O=i("qHU1"),R=i("pSHE"),B=i("Uyc6"),E=i("x5It"),M=i("WW/2"),F=i("Va5K"),A=i("7xci"),D=i("POAS"),q=i("qc15"),L=i("xQCb"),$=i("fXoL");class N{constructor(e,t,i){this.elementRef=e,this.querySpace=t,this.injector=i,Object(O.a)("Opening isolated query space %O in %O",i,e.nativeElement)}}N.\u0275fac=function(e){return new(e||N)($.gc($.q),$.gc(n.a),$.gc($.A))},N.\u0275dir=$.bc({type:N,selectors:[["","wp-isolated-query-space",""]],features:[$.Sb([{provide:D.a,useExisting:q.a},n.a,s.a,I.a,k.a,a.a,r.a,c.a,o.a,l.a,d.a,u.a,h.a,p.a,g.a,m.a,v.a,f.a,F.a,B.a,A.a,E.a,C.a,j.a,x.a,T.a,S.a,_.a,P.a,M.a,y.a,L.a,b.a,w.a,R.a])]})},HGdY:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{intercept(e,t){const i=jQuery("meta[name=csrf-token]").attr("content");if(!1!==e.withCredentials){let n=e.headers.set("X-Authentication-Scheme","Session").set("X-Requested-With","XMLHttpRequest");i&&(n=n.set("X-CSRF-TOKEN",i));const s=e.clone({withCredentials:!0,headers:n});return t.handle(s)}return t.handle(e)}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.cc({token:s,factory:s.\u0275fac})},HN1l:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return a}));var n=i("fXoL");class s{constructor(e){this.elementRef=e}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.thead=this.$element.parent("colgroup").siblings("thead"),this.thead.on("mouseenter","th",e=>{this.$element.index()===jQuery(e.currentTarget).index()&&this.$element.addClass("hover")}),this.thead.on("mouseleave","th",e=>{this.$element.index()===jQuery(e.currentTarget).index()&&this.$element.removeClass("hover")})}ngOnDestroy(){this.thead.off("mouseenter mouseleave")}}s.\u0275fac=function(e){return new(e||s)(n.gc(n.q))},s.\u0275cmp=n.ac({type:s,selectors:[["col","highlight-col",""]],attrs:["highlight-col",""],decls:0,vars:0,template:function(e,t){},encapsulation:2});const a={selector:"col[highlight-col]",cls:s}},IYP9:function(e,t,i){"use strict";i.d(t,"b",(function(){return w})),i.d(t,"a",(function(){return v}));var n=i("fXoL"),s=i("kTsZ"),a=i("Jui0"),r=i("RhL0"),c=i("wZYP"),o=i("lJxs"),l=i("iuWW"),d=i("POAS"),u=i("ZOsW"),h=i("3Pt+"),p=i("oUDv"),g=i("ofXK"),m=i("u8Ab");function f(e,t){if(1&e&&n.hc(0,"user-avatar",3),2&e){const e=n.wc().item;n.Bc("user",e)}}function b(e,t){if(1&e&&(n.Yc(0,f,1,1,"user-avatar",2),n.ad(1)),2&e){const e=t.item;n.Bc("ngIf",e&&e.id),n.Tb(1),n.cd(" ",e.name," ")}}const w="user-autocompleter";class v{constructor(e,t,i,s,a,c){this.elementRef=e,this.halResourceService=t,this.I18n=i,this.halNotification=s,this.pathHelper=a,this.injector=c,this.userTracker=e=>e.href||e.id,this.onChange=new n.s,this.clearAfterSelection=!1,this.url=this.pathHelper.api.v3.users.path,this.allowEmpty=!1,this.appendTo="",this.multiple=!1,this.initialSelection=null,this.requests=new l.a(e=>this.getAvailableUsers(this.url,e),Object(l.b)(this.halNotification)),this.inputFilters=new r.a}ngOnInit(){const e=this.elementRef.nativeElement.dataset.updateInput,t=this.elementRef.nativeElement.dataset.allowEmpty,i=this.elementRef.nativeElement.dataset.appendTo,n=this.elementRef.nativeElement.dataset.multiple,s=this.elementRef.nativeElement.dataset.url;e&&(this.updateInputField=document.getElementsByName(e)[0],this.setInitialSelection());let a=this.elementRef.nativeElement.dataset.additionalFilter;a&&JSON.parse(a).forEach(e=>{this.inputFilters.add(e.selector,e.operator,e.values)}),"true"===t&&(this.allowEmpty=!0),i&&(this.appendTo=i),"true"===n&&(this.multiple=!0),s&&(this.url=s)}onFocus(){this.requests.lastRequestedValue||this.requests.input$.next("")}onModelChange(e){e&&(this.onChange.emit(e),this.requests.input$.next(""),this.clearAfterSelection&&this.ngSelectComponent.clearItem(e),this.updateInputField&&(this.multiple?this.updateInputField.value=e.map(e=>e.id):this.updateInputField.value=e.id))}getAvailableUsers(e,t){let i=this.inputFilters.clone();return t&&t.length&&i.add("name","~",[t]),this.halResourceService.get(e,{filters:i.toJson()}).pipe(Object(o.a)(e=>{let t=e.elements.map(e=>({name:e.name,id:e.id,href:e.href,avatar:e.avatar}));return this.allowEmpty&&t.unshift({name:this.I18n.t("js.timelines.filter.noneSelection"),href:null,id:null}),t}))}setInitialSelection(){if(this.updateInputField){const e=parseInt(this.updateInputField.value);this.initialSelection=isNaN(e)?null:e}}}v.\u0275fac=function(e){return new(e||v)(n.gc(n.q),n.gc(s.a),n.gc(c.a),n.gc(d.a),n.gc(a.a),n.gc(n.A))},v.\u0275cmp=n.ac({type:v,selectors:[["user-autocompleter"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(u.a,!0),2&e)&&(n.Nc(i=n.vc())&&(t.ngSelectComponent=i.first))},inputs:{clearAfterSelection:"clearAfterSelection",url:"url",allowEmpty:"allowEmpty",appendTo:"appendTo",multiple:"multiple",initialSelection:"initialSelection"},outputs:{onChange:"onChange"},decls:4,vars:12,consts:[["bindLabel","name","bindValue","id",3,"items","ngModel","virtualScroll","trackByFn","typeahead","loading","appendTo","multiple","focus","change"],["ng-option-tmp",""],["data-class-list","avatar-mini",3,"user",4,"ngIf"],["data-class-list","avatar-mini",3,"user"]],template:function(e,t){1&e&&(n.mc(0,"ng-select",0),n.uc("focus",(function(){return t.onFocus()}))("change",(function(e){return t.onModelChange(e)})),n.xc(1,"async"),n.xc(2,"async"),n.Yc(3,b,2,2,"ng-template",1),n.lc()),2&e&&n.Bc("items",n.yc(1,8,t.requests.output$))("ngModel",t.initialSelection)("virtualScroll",!0)("trackByFn",t.userTracker)("typeahead",t.requests.input$)("loading",n.yc(2,10,t.requests.loading$))("appendTo",t.appendTo)("multiple",t.multiple)},directives:[u.a,h.m,h.p,p.a,u.c,g.q,m.a],pipes:[g.a],encapsulation:2})},"IaZ+":function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return l}));var n=i("fXoL"),s=i("+rOU"),a=i("iB+3"),r=i("E5Dd"),c=i("7ond");const o=new n.z("OP_MODAL_LOCALS");class l{constructor(e,t,i,n,a){this.componentFactoryResolver=e,this.FocusHelper=t,this.appRef=i,this.$transitions=n,this.injector=a,this.active=null,this.opening=!1;const c=this.portalHostElement=document.createElement("div");c.classList.add("op-modals--overlay"),document.body.appendChild(c),jQuery(window).on("keydown",e=>(this.active&&this.active.closeOnEscape&&e.which===r.a.ESCAPE&&this.active.closeOnEscapeFunction(e),!0)),jQuery(window).on("click",e=>{this.active&&!this.opening&&this.active.closeOnOutsideClick&&this.activeModal[0]===e.target&&this.close()}),this.bodyPortalHost=new s.d(c,this.componentFactoryResolver,this.appRef,this.injector)}show(e,t,i={}){this.close(),this.opening=!0,"global"===t&&(t=this.injector);const n=new s.c(e,null,this.injectorFor(t,i)),a=this.bodyPortalHost.attach(n).instance;return this.active=a,this.portalHostElement.style.display="block",setTimeout(()=>{this.active&&this.active.onOpen(this.activeModal),this.opening=!1},20),jQuery(".op-modal--modal-container").focus(),this.active}isActive(e){return this.active&&this.active===e}close(){this.active&&this.active.onClose()&&(this.active.closingEvent.emit(this.active),this.bodyPortalHost.detach(),this.portalHostElement.style.display="none",this.active=null)}get activeModal(){return jQuery(this.portalHostElement).find(".op-modal--portal")}injectorFor(e,t){const i=new WeakMap;return t.service=this,i.set(o,t),new s.f(e,i)}}l.\u0275fac=function(e){return new(e||l)(n.qc(n.l),n.qc(c.a),n.qc(n.f),n.qc(a.O),n.qc(n.A))},l.\u0275prov=n.cc({token:l,factory:l.\u0275fac,providedIn:"root"})},"Ie+Q":function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("+rOU"),s=i("7MH/"),a=i("57Du"),r=i("IzEk"),c=i("Jui0"),o=i("mrSG"),l=i("E5Dd"),d=i("wZYP"),u=i("8zkO"),h=i("7ond"),p=i("kgyZ"),g=i("GjwL"),m=i("qHU1"),f=i("XNiG"),b=i("r0MM");class w extends p.a{constructor(e,t,i,n,s,a,r){super(),this.injector=e,this.form=t,this.fieldName=i,this.schema=n,this.element=s,this.pathHelper=a,this.withErrors=r,this.$onUserActivate=new f.a,void 0!==r&&this.setErrors(r)}stopPropagation(e){return e.stopPropagation(),!1}get inEditMode(){return this.form.editMode}get inFlight(){return this.form.change.inFlight}get active(){return!0}focus(e){const t=this.element.querySelector(".inline-edit--field");t?(t.focus(),e&&"INPUT"===t.tagName&&g.a.setPosition(t,e)):Object(m.a)(`Tried to focus on ${this.fieldName}, but element does not (yet) exist.`)}onFocusOut(){this.resource.subject&&this.withErrors&&0===this.withErrors.length&&this.handleUserSubmit()}setErrors(e){this.errors=e,this.element.classList.toggle("-error",this.isErrorenous)}handleUserSubmit(){return this.inFlight||this.form.editMode?Promise.resolve():this.onSubmit().then(()=>this.form.submit())}handleUserKeydown(e,t=!1){return this.inEditMode&&!t?e.which!==l.a.ENTER||(this.form.submit(),!1):e.which!==l.a.ESCAPE||(this.handleUserCancel(),!1)}handleUserCancel(){this.reset()}reset(){this.form.change.reset(this.fieldName),this.deactivate(!0)}deactivate(e=!1){delete this.form.activeFields[this.fieldName],this.onDestroy.next(),this.onDestroy.complete(),this.form.reset(this.fieldName,e)}get isErrorenous(){return this.errors.length>0}isChanged(){return this.form.change.contains(this.fieldName)}get resource(){return this.form.resource}get project(){return this.form.change.projectedResource.project}get htmlId(){return`wp-${this.resource.id}-inline-edit--field-${this.fieldName}`}get fieldLabel(){return this.schema.name||this.fieldName}get errorMessageOnLabel(){return this.isErrorenous?this.I18n.t("js.inplace.errors.messages_on_field",{messages:this.errors.join(" ")}):""}previewContext(e){return e.previewPath()}}Object(o.c)([Object(b.a)(),Object(o.e)("design:type",h.a)],w.prototype,"FocusHelper",void 0),Object(o.c)([Object(b.a)(),Object(o.e)("design:type",u.a)],w.prototype,"ConfigurationService",void 0),Object(o.c)([Object(b.a)(),Object(o.e)("design:type",d.a)],w.prototype,"I18n",void 0);var v=i("fXoL");class y{constructor(e,t,i){this.appRef=e,this.componentFactoryResolver=t,this.pathHelper=i}create(e,t,i,c,o,l){const d=this.createDomOutlet(e,t),u=new w(t,i,o,c,e,this.pathHelper,l);u.onDestroy.pipe(Object(r.a)(1)).subscribe(()=>d.detach());const h=Object(a.a)(t,i.change,u,c),p=new n.c(s.a,null,h);return e.innerHTML="",d.attachComponentPortal(p).instance.onEditFieldReady.pipe(Object(r.a)(1)).toPromise().then(()=>u)}createDomOutlet(e,t){return new n.d(e,this.componentFactoryResolver,this.appRef,t)}}y.\u0275fac=function(e){return new(e||y)(v.qc(v.f),v.qc(v.l),v.qc(c.a))},y.\u0275prov=v.cc({token:y,factory:y.\u0275fac,providedIn:"root"})},Ioun:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("tN7n"),s=i("0zio"),a=i("AcWF"),r=i("sngl"),c=i("WgCp"),o=i("fXoL"),l=i("HEQ6"),d=i("72oW");const u=function(){return{}},h=function(){return{tableVisible:!1}};class p extends c.a{}p.\u0275fac=function(e){return g(e||p)},p.\u0275cmp=o.ac({type:p,selectors:[["ng-component"]],features:[o.Sb([[{provide:n.a,useClass:s.a}],{provide:r.b,useValue:a.a}]),o.Qb],decls:3,vars:4,consts:[["wp-isolated-query-space",""],[3,"queryProps","configuration"],["embeddedTableForConfiguration",""]],template:function(e,t){1&e&&(o.kc(0,0),o.hc(1,"wp-embedded-table",1,2),o.jc()),2&e&&(o.Tb(1),o.Bc("queryProps",t.locals.currentQuery||o.Fc(2,u))("configuration",o.Fc(3,h)))},directives:[l.a,d.a],encapsulation:2});const g=o.oc(p)},J30J:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("8ocD"),s=i("fXoL");class a extends n.a{getField(e,t,i,n){let s=new(this.getSpecificClassFor(e._type,t,i.type))(t,n);return s.apply(e,i),s}}a.\u0275fac=function(e){return r(e||a)},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac,providedIn:"root"});const r=s.oc(a)},JLFs:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));class n{constructor(e,t,i){this.basePath=e,this.segment=t,this.resource=i,this.path=`${this.basePath}/${t}`}id(e){return new(this.resource||s)(this.path,e)}optionalId(e){return _.isNil(e)?this:this.id(e)}toString(){return this.path}toPath(){return this.path}filtered(e){return this.toString()+"/?"+e.toParams()}}class s{constructor(e,t){this.basePath=e,this.id=t,this.path=`${this.basePath}/${t}`}toString(){return this.path}toPath(){return this.path}}},JY8V:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("zqrF"),s=i("E2tj"),a=i("iMRi"),r=i("PZVJ"),c=i("QOiP"),o=i("fXoL");class l extends n.a{constructor(e,t){super(t),this.states=e,this.querySpace=t}valueFromQuery(e){return[...e.columns]}hasChanged(e){return!this.isCurrentlyEqualTo(e.columns)}isCurrentlyEqualTo(e){const t=e=>e.map(e=>e.href);return _.isEqual(t(e),t(this.getColumns()))}applyToQuery(e){const t=this.getColumns(),i=e.columns.map(e=>e.id),n=t.map(e=>e.id);return e.columns=Object(r.a)(t),!(0===_.difference(n,i).length)&&this.hasRelationColumns()}hasRelationColumns(){const e=[c.b.RELATION_OF_TYPE,c.b.RELATION_TO_TYPE];return!!_.find(this.getColumns(),t=>e.indexOf(t._type)>=0)}getColumns(){return[...this.current]}index(e){return _.findIndex(this.getColumns(),t=>t.id===e)}findById(e){return _.find(this.getColumns(),t=>t.id===e)}previous(e){let t=this.index(e.id);return t<=0?null:this.getColumns()[t-1]}next(e){let t=this.index(e.id);return-1===t||this.isLast(name)?null:this.getColumns()[t+1]}isFirst(e){return 0===this.index(e.id)}isLast(e){return this.index(e.id)===this.columnCount-1}setColumns(e){this.isCurrentlyEqualTo(e)||this.update(e)}setColumnsById(e){const t=e.map(e=>_.find(this.all,t=>t.id===e));this.setColumns(_.compact(t))}moveColumn(e,t){let i=this.getColumns();t>=i.length&&(t=i.length-1),t<0&&(t=0);let n=i[e];i.splice(e,1),i.splice(t,0,n),this.setColumns(i)}shift(e,t){let i=this.index(e.id);-1!==i&&this.moveColumn(i,i+t)}addColumn(e,t){let i=this.getColumns();if(void 0===t&&(t=i.length),-1===this.index(e)){let n=_.find(this.all,t=>t.id===e);if(!n)throw"Column with provided name is not found";i.splice(t,0,n),this.setColumns(i)}}removeColumn(e){let t=this.index(e.id);if(-1!==t){let e=this.getColumns();e.splice(t,1),this.setColumns(e)}}get current(){return this.lastUpdatedState.getValueOr([])}get availableState(){return this.states.queries.columns}get columnCount(){return this.getColumns().length}get all(){return this.availableState.getValueOr([])}get allPropertyColumns(){return this.all.filter(e=>e._type===c.b.PROPERTY)}get unused(){return _.differenceBy(this.all,this.getColumns(),"$href")}}l.\u0275fac=function(e){return new(e||l)(o.qc(a.a),o.qc(s.a))},l.\u0275prov=o.cc({token:l,factory:l.\u0275fac})},Jui0:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var n=i("JLFs");class s extends n.a{constructor(e,t){super(e,t),this.workPackageId=t,this.relations=this.path+"/relations",this.revisions=this.path+"/revisions",this.activities=this.path+"/activities",this.available_watchers=this.path+"/available_watchers",this.available_projects=this.path+"/available_projects"}}class a extends n.b{constructor(e){super(e,"work_packages"),this.form=new n.a(this.path,"form")}id(e){return new s(this.path,e)}}class r extends n.a{constructor(e,t){super(e,t),this.userId=t,this.avatar=this.path+"/avatar"}}class c extends n.b{constructor(e){super(e,"users"),this.me=this.path+"/me"}id(e){return new r(this.path,e)}}class o extends n.a{constructor(e,t){super(e,t),this.form=new n.a(this.path,"form"),this.order=new n.a(this.path,"order")}}class l extends n.b{constructor(e){super(e,"queries"),this.form=new n.a(this.path,"form"),this.default=new n.a(this.path,"default")}id(e){return new o(this.path,e)}}class d extends n.b{constructor(e){super(e,"types")}}class u extends n.b{constructor(e){super(e,"versions"),this.form=new n.a(this.path,"form"),this.availableProjects=new n.a(this.path,"available_projects")}}class h extends n.a{constructor(e,t){super(e,t),this.projectId=t,this.available_assignees=this.path+"/available_assignees",this.queries=new l(this.path),this.types=new d(this.path),this.work_packages=new a(this.path),this.versions=new u(this.path)}}class p extends n.b{constructor(e){super(e,"projects"),this.schema=this.path+"/schema"}id(e){return new h(this.path,e)}}var g=i("RhL0");class m extends n.a{constructor(e,t){super(e,t),this.form=new n.a(this.path,"form")}}class f extends n.b{constructor(e){super(e,"grids")}id(e){return new m(this.path,e)}form(){return new n.a(this.path,"form")}}class b extends n.a{constructor(e,t){super(e,t)}}class w extends n.b{constructor(e){super(e,"news")}id(e){return new b(this.path,e)}}class v extends n.a{constructor(e,t){super(e,t),this.form=new n.a(this.path,"form")}}class y extends n.b{constructor(e){super(e,"time_entries"),this.form=new n.a(this.path,"form")}id(e){return new v(this.path,e)}}class k extends n.b{constructor(e){super(e,"memberships"),this.available_projects=this.path+"/available_projects"}}class C extends n.b{constructor(e){super(e,"groups")}toString(){throw"Backend does not yet offer this end point"}}class j{constructor(e){this.appBasePath=e,this.apiV3Base=this.appBasePath+"/api/v3",this.attachments=new n.a(this.apiV3Base,"attachments"),this.configuration=new n.a(this.apiV3Base,"configuration"),this.root=new n.a(this.apiV3Base,""),this.statuses=new n.b(this.apiV3Base,"statuses"),this.relations=new n.b(this.apiV3Base,"relations"),this.priorities=new n.b(this.apiV3Base,"priorities"),this.time_entries=new y(this.apiV3Base),this.memberships=new k(this.apiV3Base),this.news=new w(this.apiV3Base),this.types=new d(this.apiV3Base),this.versions=new u(this.apiV3Base),this.work_packages=new a(this.apiV3Base),this.queries=new l(this.apiV3Base),this.projects=new p(this.apiV3Base),this.users=new c(this.apiV3Base),this.help_texts=new n.b(this.apiV3Base,"help_texts"),this.grids=new f(this.apiV3Base),this.groups=new C(this.apiV3Base)}withOptionalProject(e){return _.isNil(e)?this:this.projects.id(e)}resource(e){return e.startsWith("/")||(e="/"+e),this.apiV3Base+e}previewMarkup(e){let t=this.apiV3Base+"/render/markdown";return e?t+`?context=${e}`:t}principals(e,t){let i=new g.a;return i.add("status","!",["3"]),i.add("member","=",[e.toString()]),i.add("type","=",["User","Group"]),i.add("id","!",["me"]),t&&t.length>0&&i.add("name","~",[t]),this.apiV3Base+"/principals?"+i.toParams({sortBy:'[["name","asc"]]',offset:"1",pageSize:"10"})}wpBySubjectOrId(e,t=!1){let i=new g.a;return t?i.add("id","=",[e]):i.add("subjectOrId","**",[e]),this.apiV3Base+"/work_packages?"+i.toParams({sortBy:'[["updatedAt","desc"]]',offset:"1",pageSize:"10"})}}var x=i("fXoL");class T{constructor(){this.appBasePath=window.appBasePath?window.appBasePath:"",this.api={v3:new j(this.appBasePath)}}get staticBase(){return this.appBasePath}attachmentDownloadPath(e,t){let i=this.staticBase+"/attachments/"+e;return t?i+"/"+t:i}ifcModelsPath(e){return this.staticBase+`/projects/${e}/ifc_models`}bimDetailsPath(e,t,i=null){let n=this.projectPath(e)+`/bcf/split/details/${t}`;return null!==i&&(n+=`?viewpoint=${i}`),n}highlightingCssPath(){return this.staticBase+"/highlighting/styles"}forumPath(e,t){return this.projectForumPath(e)+"/"+t}keyboardShortcutsHelpPath(){return this.staticBase+"/help/keyboard_shortcuts"}messagePath(e){return this.staticBase+"/topics/"+e}myPagePath(){return this.staticBase+"/my/page"}newsPath(e){return this.staticBase+"/news/"+e}loginPath(){return this.staticBase+"/login"}projectsPath(){return this.staticBase+"/projects"}projectPath(e){return this.projectsPath()+"/"+e}projectActivityPath(e){return this.projectPath(e)+"/activity"}projectForumPath(e){return this.projectPath(e)+"/forums"}projectCalendarPath(e){return this.projectPath(e)+"/work_packages/calendar"}projectMembershipsPath(e){return this.projectPath(e)+"/members"}projectNewsPath(e){return this.projectPath(e)+"/news"}projectTimelinesPath(e){return this.projectPath(e)+"/timelines"}projectTimeEntriesPath(e){return this.projectPath(e)+"/time_entries"}projectWikiPath(e){return this.projectPath(e)+"/wiki"}projectWorkPackagePath(e,t){return this.projectWorkPackagesPath(e)+"/"+t}projectWorkPackagesPath(e){return this.projectPath(e)+"/work_packages"}projectWorkPackageNewPath(e){return this.projectWorkPackagesPath(e)+"/new"}projectBoardsPath(e){return e?this.projectPath(e)+"/boards":this.staticBase+"/boards"}projectDashboardsPath(e){return this.projectPath(e)+"/dashboards"}timeEntriesPath(e){return e?this.workPackagePath(e)+"/time_entries":this.staticBase+"/time_entries"}usersPath(){return this.staticBase+"/users"}userPath(e){return this.usersPath()+"/"+e}versionsPath(){return this.staticBase+"/versions"}versionEditPath(e){return this.staticBase+"/versions/"+e+"/edit"}versionShowPath(e){return this.staticBase+"/versions/"+e}workPackagesPath(){return this.staticBase+"/work_packages"}workPackagePath(e){return this.staticBase+"/work_packages/"+e}workPackageCopyPath(e){return this.workPackagePath(e)+"/copy"}workPackageDetailsCopyPath(e,t){return this.projectWorkPackagesPath(e)+"/details/"+t+"/copy"}workPackagesBulkDeletePath(){return this.workPackagesPath()+"/bulk"}projectLevelListPath(){return this.projectsPath()+"/level_list.json"}textFormattingHelp(){return this.staticBase+"/help/text_formatting"}}T.\u0275fac=function(e){return new(e||T)},T.\u0275prov=x.cc({token:T,factory:T.\u0275fac,providedIn:"root"})},K018:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("2Vo4"),s=i("pLZG"),a=i("IzEk"),r=i("fXoL");class c{constructor(){this.navigationEvents$=new n.a("")}onActivate(...e){return this.navigationEvents$.pipe(Object(s.a)(t=>-1!==e.indexOf(t)),Object(a.a)(1))}recreateToggler(){let e=this;jQuery("#main-menu .toggler").remove();var t=jQuery('<a class="toggler" href="#"><i class="icon6 icon-toggler icon-arrow-right3" aria-hidden="true"></i><span class="hidden-for-sighted"></span></a>').on("click",(function(){let t=jQuery(this);if(t.hasClass("toggler")){jQuery("#sidebar").toggleClass("-hidden",!0),jQuery(".menu_root li").removeClass("open"),jQuery(".menu_root").removeClass("open").addClass("closed");let i=t.closest("li");i.addClass("open").find("li > a:first, .tree-menu--title:first").first().focus(),console.log("Activating "+i.data("name")),e.navigationEvents$.next(i.data("name"))}return!1}));return t.attr("title",I18n.t("js.project_menu_details")),t}wrapMainItem(){var e=jQuery("#main-menu li > a").not("ul ul a");e.wrap(t=>{var i=e[t].id,n=jQuery('<div class="main-item-wrapper"/>');return i&&n.attr("id",i+"-wrapper"),n})}register(){this.wrapMainItem();const e=jQuery(".main-item-wrapper a.selected");e.length>0&&e[0].scrollIntoView();const t=this.recreateToggler();let i=jQuery("#main-menu .menu_root > li.open").data("name"),n=jQuery("#main-menu .menu_root.open > li").data("name");function s(e){e.preventDefault();var t=jQuery(this);jQuery(t).parents("li").first().removeClass("open"),jQuery(".menu_root").removeClass("closed").addClass("open"),t.parents("li").first().find(".toggler").first().focus(),jQuery("#sidebar").toggleClass("-hidden",!1)}(i||n)&&this.navigationEvents$.next(i||n),jQuery("#main-menu li:has(ul) .main-item-wrapper > a").not("ul ul a").unbind("click").wrapInner('<span class="ellipsis"/>').after(t),jQuery("#main-menu ul.main-menu--children").each((function(e,t){var i=jQuery(t).parents("li").find(".main-item-wrapper .menu-item--title").contents()[0].textContent,n=jQuery(t).parents("li").find(".main-item-wrapper > a").attr("href"),a=jQuery('<div class="main-menu--children-menu-header"></div>'),r=jQuery('<a class="main-menu--arrow-left-to-project" href="#"><i class="icon-arrow-left1" aria-hidden="true"></i></a>'),c=jQuery('<a href="'+n+'" class="main-menu--parent-node ellipsis">'+i+"</a>");r.attr("title",I18n.t("js.label_up")),r.on("click",s),a.append(r),a.append(c),jQuery(t).before(a)})),jQuery(".menu_root").hasClass("closed")&&jQuery("#sidebar").toggleClass("-hidden",!0)}}c.\u0275fac=function(e){return new(e||c)},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac,providedIn:"root"})},K247:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this.mobileWidthTreshold=680}get isMobile(){return window.innerWidth<this.mobileWidthTreshold}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.cc({token:s,factory:s.\u0275fac,providedIn:"root"})},K8b8:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));i("ii2/");var n=i("SKFm"),s=i("wZYP"),a=i("RGDJ"),r=i("ug4p"),c=i("AEvm"),o=i("fXoL"),l=i("ofXK"),d=i("t7qP"),u=i("N5AO");function h(e,t){1&e&&(o.mc(0,"span",6),o.hc(1,"op-icon",7),o.lc())}function p(e,t){if(1&e&&(o.mc(0,"div",1),o.mc(1,"button",2),o.Yc(2,h,2,0,"span",3),o.hc(3,"span",4),o.hc(4,"op-icon",5),o.lc(),o.lc()),2&e){const e=o.wc();o.Bc("ngClass",e.containerClass),o.Ub("title",e.buttonTitle),o.Tb(1),o.Bc("ngClass",e.statusHighlightClass)("disabled",!e.allowed)("wpStatusDropdown-workPackage",e.workPackage),o.Ub("aria-label",e.text.explanation),o.Tb(1),o.Bc("ngIf",e.workPackage.isReadonly),o.Tb(1),o.Bc("textContent",e.status.name)}}class g extends c.a{constructor(e,t,i,n){super(),this.I18n=e,this.cdRef=t,this.wpCacheService=i,this.halEditing=n,this.text={explanation:this.I18n.t("js.label_edit_status"),workPackageReadOnly:this.I18n.t("js.work_packages.message_work_package_read_only"),workPackageStatusBlocked:this.I18n.t("js.work_packages.message_work_package_status_blocked")}}ngOnInit(){this.halEditing.temporaryEditResource(this.workPackage).values$().pipe(this.untilDestroyed()).subscribe(e=>{this.workPackage=e,this.workPackage.status&&this.workPackage.status.$load(),this.cdRef.detectChanges()})}get buttonTitle(){return this.workPackage.isReadonly?this.text.workPackageReadOnly:this.workPackage.isEditable&&!this.allowed?this.text.workPackageStatusBlocked:""}get statusHighlightClass(){let e=this.status;if(e)return a.a.backgroundClass("status",e.id)}get status(){return this.workPackage.status}get allowed(){return this.workPackage.isAttributeEditable("status")}}g.\u0275fac=function(e){return new(e||g)(o.gc(s.a),o.gc(o.i),o.gc(r.a),o.gc(n.a))},g.\u0275cmp=o.ac({type:g,selectors:[["wp-status-button"]],inputs:{workPackage:"workPackage",containerClass:"containerClass"},features:[o.Qb],decls:1,vars:1,consts:[["class","wp-status-button",3,"ngClass",4,"ngIf"],[1,"wp-status-button",3,"ngClass"],["wpStatusDropdown","",1,"button",3,"ngClass","disabled","wpStatusDropdown-workPackage"],["class","button--text",4,"ngIf"],["aria-hidden","true",1,"button--text",3,"textContent"],["icon-classes","button--icon icon-small icon-pulldown"],[1,"button--text"],["icon-classes","button--icon icon-locked"]],template:function(e,t){1&e&&o.Yc(0,p,5,8,"div",0),2&e&&o.Bc("ngIf",t.status)},directives:[l.q,l.n,d.a,u.a],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.wp-status-button[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;padding:5px;margin-bottom:0;background-color:var(--status-selector-bg-color);border:none;color:#fff;max-width:100%}.wp-status-button[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .button--text[_ngcontent-%COMP%]{margin:0 5px}.wp-status-button.-small[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{font-size:12px;padding:4px;margin-right:0}"]})},Kg8T:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("FnNU"),s=i("1G5W"),a=i("fXoL");class r{constructor(){this.links=Object(n.f)({})}initModelAuth(e,t){this.links.doModify(i=>{let n=Object.assign({},i);return n[e]=t,n})}observeUntil(e){return this.links.values$().pipe(Object(s.a)(e))}can(e,t){const i=this.links.getValueOr({});return i[e]&&t in i[e]}cannot(e,t){return!this.can(e,t)}}r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac,providedIn:"root"})},LHWx:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("0To3");class s extends n.a{constructor(e,t,i){super(e,t,i),this.injector=e,this.workPackageTable=t,this.rowBuilder=i}doRender(){this.workPackageTable.originalRows.forEach(e=>{let t=this.workPackageTable.originalRowIndex[e],[i]=this.rowBuilder.buildEmpty(t.object);t.element=i,this.appendRow(t.object,i),this.tableBody.appendChild(i)})}}},LrpJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("/8SZ"),s=i("ZsX/"),a=i("POAS"),r=i("Jui0"),c=i("d/TE");function o(e){return class extends e{get canAddAttachments(){return!!this.$links.addAttachment||this.isNew}get hasAttachments(){return _.get(this.attachments,"elements.length",0)>0}lookupDownloadLocationByName(e){if(!this.attachments||!this.attachments.elements)return null;const t=_.find(this.attachments.elements,t=>t.name===e);return _.get(t,"staticDownloadLocation.href",null)}removeAttachment(e){return _.pull(this.attachments.elements,e),e.$isHal?e.delete().then(()=>{this.attachmentsBackend?this.updateAttachments():this.attachments.count=Math.max(this.attachments.count-1,0)}).catch(t=>{this.halNotification.handleRawError(t,this),this.attachments.elements.push(e)}):Promise.resolve()}updateAttachments(){return this.attachments.updateElements().then(()=>(this.updateState(),this.attachments))}uploadAttachments(e){const{uploads:t,finished:i}=this.performUpload(e),n=I18n.t("js.label_upload_notification"),s=this.NotificationsService.addAttachmentUpload(n,t);return i.then(e=>(setTimeout(()=>this.NotificationsService.remove(s),700),this.attachments.count+=e.length,e.forEach(e=>{this.attachments.elements.push(e.response)}),this.updateState(),e)).catch(e=>{let t;return console.error("Error while uploading: %O",e),t=e.error instanceof ErrorEvent?this.I18n.t("js.error_attachment_upload",{error:e}):"Error"===_.get(e,"error._type")?e.error.message:e.error,this.halNotification.handleRawError(t),t||I18n.t("js.error.internal")})}performUpload(e){let t="";return t=!this.isNew&&this.id&&this.attachmentsBackend?this.addAttachment.$link.href:this.pathHelper.api.v3.attachments.path,this.opFileUpload.uploadAndMapResponse(t,e)}updateState(){this.state&&this.state.putValue(this)}$initialize(e){this.NotificationsService||(this.NotificationsService=this.injector.get(c.a)),this.halNotification||(this.halNotification=this.injector.get(a.a)),this.opFileUpload||(this.opFileUpload=this.injector.get(s.a)),this.pathHelper||(this.pathHelper=this.injector.get(r.a)),super.$initialize(e);let t=this.attachments||{$source:{},elements:[]};this.attachments=new n.a(this.injector,t,!1,this.halInitializer,"HalResource")}}}},M0J3:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("AEvm");class s extends n.a{get displayName(){return this.schema.name||this.name}get value(){return this.resource[this.name]}get type(){return this.constructor.type}get required(){return!!this.schema.required}get writable(){return this.schema.writable&&this.resource.isAttributeEditable(this.name)}get hasDefault(){return this.schema.hasDefault}get options(){return this.schema.options}isEmpty(){return!this.value}get unknownAttribute(){return this.isEmpty&&!this.schema}}},MIK2:function(e,t,i){"use strict";i.d(t,"a",(function(){return x}));var n=i("fXoL"),s=i("wZYP"),a=(i("ii2/"),i("XNiG")),r=i("LRne"),c=i("Cfvw"),o=i("Kj3r"),l=i("/uUt"),d=i("vkgz"),u=i("eIep"),h=i("lJxs"),p=i("JIr8"),g=i("ZOsW"),m=i("E2tj"),f=i("Jui0"),b=i("sjKJ"),w=i("kTsZ"),v=i("dMmB"),y=i("qc15"),k=i("ofXK");function C(e,t){if(1&e&&n.ad(0),2&e){const e=t.item;n.ed(" ",e.type.name," #",e.id," ",e.subject," ")}}function j(e,t){if(1&e&&n.ad(0),2&e){const e=t.item;n.ed(" ",e.type.name," #",e.id," ",e.subject," ")}}class x{constructor(e,t,i,s,r,c,h,p){this.querySpace=e,this.pathHelper=t,this.notificationService=i,this.CurrentProject=s,this.halResourceService=r,this.schemaCacheService=c,this.cdRef=h,this.I18n=p,this.text={placeholder:this.I18n.t("js.relations_autocomplete.placeholder")},this.inputPlaceholder=this.text.placeholder,this.additionalFilters=[],this.hiddenOverflowContainer="body",this.onCancel=new n.s,this.onSelected=new n.s,this.onEmptySelected=new n.s,this.isLoading=!1,this.searchInput$=new a.a,this.appendToContainer="body",this.results$=this.searchInput$.pipe(Object(o.a)(250),Object(l.a)(),Object(d.a)(()=>this.isLoading=!0),Object(u.a)(e=>this.autocompleteWorkPackages(e)))}reset(){this.cancel()}ngAfterContentInit(){this.ngSelectComponent&&setTimeout(()=>{this.ngSelectComponent.focus()},25)}cancel(){this.onCancel.emit()}onWorkPackageSelected(e){e&&this.schemaCacheService.ensureLoaded(e).then(()=>{this.onSelected.emit(e),this.ngSelectComponent.close()})}autocompleteWorkPackages(e){return null===e||0===e.length?(this.isLoading=!1,Object(r.a)([])):(e=e.replace(/^#/,""),Object(c.a)(this.workPackage.availableRelationCandidates.$link.$fetch({query:e,filters:JSON.stringify(this.additionalFilters),type:this.filterCandidatesFor||this.selectedRelationType})).pipe(Object(h.a)(e=>e.elements),Object(p.a)(e=>(this.notificationService.handleRawError(e),Object(r.a)([]))),Object(d.a)(()=>this.isLoading=!1)))}onOpen(){setTimeout(()=>{const e=this.ngSelectComponent;e&&e.dropdownPanel&&e.dropdownPanel._updatePosition(),jQuery(this.hiddenOverflowContainer).one("scroll",()=>{this.ngSelectComponent.close()})},25)}}x.\u0275fac=function(e){return new(e||x)(n.gc(m.a),n.gc(f.a),n.gc(y.a),n.gc(b.a),n.gc(w.a),n.gc(v.a),n.gc(n.i),n.gc(s.a))},x.\u0275cmp=n.ac({type:x,selectors:[["wp-relations-autocomplete"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(g.a,!0),2&e)&&(n.Nc(i=n.vc())&&(t.ngSelectComponent=i.first))},hostBindings:function(e,t){1&e&&n.uc("keydown.escape",(function(){return t.reset()}))},inputs:{inputPlaceholder:"inputPlaceholder",workPackage:"workPackage",selectedRelationType:"selectedRelationType",filterCandidatesFor:"filterCandidatesFor",additionalFilters:"additionalFilters",hiddenOverflowContainer:"hiddenOverflowContainer"},outputs:{onCancel:"onCancel",onSelected:"onSelected",onEmptySelected:"onEmptySelected"},decls:5,vars:9,consts:[[1,"wp-relations--autocomplete"],["ngClass","wp-inline-create--reference-autocompleter",3,"items","appendTo","multiple","loading","placeholder","typeahead","closeOnSelect","open","change"],["ng-label-tmp",""],["ng-option-tmp",""]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"ng-select",1),n.uc("open",(function(){return t.onOpen()}))("change",(function(e){return t.onWorkPackageSelected(e)})),n.xc(2,"async"),n.Yc(3,C,1,3,"ng-template",2),n.Yc(4,j,1,3,"ng-template",3),n.lc(),n.lc()),2&e&&(n.Tb(1),n.Bc("items",n.yc(2,7,t.results$))("appendTo",t.appendToContainer)("multiple",!1)("loading",t.isLoading)("placeholder",t.inputPlaceholder)("typeahead",t.searchInput$)("closeOnSelect",!0))},directives:[g.a,k.n,g.e,g.c],pipes:[k.a],styles:["ng-select.wp-inline-create--reference-autocompleter{border:none}ng-select.wp-inline-create--reference-autocompleter .ng-clear-wrapper{display:none}"],encapsulation:2})},Mo6U:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("mrSG"),s=i("iMRi"),a=i("wZYP"),r=i("r0MM");class c{constructor(e,t,i,n,s){this.injector=e,this.$source=t,this.$loaded=i,this.halInitializer=n,this.$links={},this.$embedded={},this.$halType=s,this.$initialize(t)}static getEmptyResource(e={href:null}){return{_links:{self:e}}}static idFromLink(e){return e.split("/").pop()}get idFromLink(){return this.$href?c.idFromLink(this.$href):""}$initialize(e){this.$source=e.$source||e,this.halInitializer(this)}toString(){return this.$href?`[HalResource href=${this.$href}]`:`[HalResource id=${this.id}]`}get id(){if(this.$source.id)return this.$source.id.toString();const e=this.idFromLink;return e.match(/^\d+$/)?e:null}set id(e){this.$source.id=e}get isNew(){return"new"===this.id}get persisted(){return!(!this.id||"new"===this.id)}isAttributeEditable(e){const t=this.schema[e];return this.$links.update&&t&&t.writable}retainFrom(e){this.__initialized_at=e.__initialized_at}$copy(e={}){return new(0,this.constructor)(this.injector,_.merge(this.$plain(),e),this.$loaded,this.halInitializer,this.$halType)}$plain(){return _.cloneDeep(this.$source)}get $isHal(){return!0}get $link(){return this.$links.self.$link}get name(){return this._name||this.$link.title||""}set name(e){this._name=e}get href(){return this.$link.href}get $href(){return this.$link.href}get state(){return null}push(e){return this.state&&this.state.putValue(e),Promise.resolve()}previewPath(){if(this.isNew&&this.project)return this.project.href}getEditorTypeFor(e){return"constrained"}$load(e=!1){if(!this.state)return this.$loadResource(e);const t=this.state;return e&&t.clear(),t.putFromPromiseIfPristine(()=>this.$loadResource(e)),t.valuesPromise().then(e=>(this.$initialize(e),this.$loaded=!0,this))}$loadResource(e=!1){if(!e){if(this.$loaded)return Promise.resolve(this);if(!this.$loaded&&this.$self)return this.$self}return this.$loaded=!1,this.$self=this.$links.self({}).then(e=>(this.$loaded=!0,this.$initialize(e.$source),this)),this.$self}$update(){return this.$load(!0)}$embeddableKeys(){const e=Object.keys(this.$source);return _.without(e,"_links","_embedded","id")}$linkableKeys(){const e=Object.keys(this.$links);return _.without(e,"self")}}Object(n.c)([Object(r.a)(),Object(n.e)("design:type",s.a)],c.prototype,"states",void 0),Object(n.c)([Object(r.a)(),Object(n.e)("design:type",a.a)],c.prototype,"I18n",void 0)},N5AO:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("fXoL"),s=i("ofXK");function a(e,t){if(1&e&&n.hc(0,"span",2),2&e){const e=n.wc();n.Bc("textContent",e.iconTitle)}}class r{constructor(){this.iconTitle=""}}r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=n.ac({type:r,selectors:[["op-icon"]],hostAttrs:[1,"op-icon--wrapper"],inputs:{iconClasses:["icon-classes","iconClasses"],iconTitle:["icon-title","iconTitle"]},decls:2,vars:3,consts:[["aria-hidden","true",3,"ngClass","title"],["class","hidden-for-sighted",3,"textContent",4,"ngIf"],[1,"hidden-for-sighted",3,"textContent"]],template:function(e,t){1&e&&(n.hc(0,"i",0),n.Yc(1,a,1,1,"span",1)),2&e&&(n.Bc("ngClass",t.iconClasses)("title",t.iconTitle),n.Tb(1),n.Bc("ngIf",t.iconTitle))},directives:[s.n,s.q],encapsulation:2})},NNMa:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("iMRi"),s=i("UD+K"),a=i("Ywds"),r=i("dMmB"),c=i("fXoL");class o extends s.a{constructor(e,t,i){super(),this.states=e,this.schemaCacheService=t,this.projectDmService=i}loadAll(e){return Promise.all(e.map(e=>this.load(e))).then(e=>{})}updateValue(e,t){this.schemaCacheService.ensureLoaded(t).then(()=>{super.updateValue(e,t)})}load(e){return this.projectDmService.one(parseInt(e)).then(e=>this.schemaCacheService.ensureLoaded(e).then(()=>e))}get multiState(){return this.states.projects}}o.\u0275fac=function(e){return new(e||o)(c.qc(n.a),c.qc(r.a),c.qc(a.a))},o.\u0275prov=c.cc({token:o,factory:o.\u0275fac,providedIn:"root"})},NawS:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("Mo6U"),s=i("ii2/");class a extends n.a{static RELATION_TYPES(e=!0){const t=["relates","duplicates","duplicated","blocks","blocked","precedes","follows","includes","partof","requires","required"];return e&&t.push("parent","children"),t}static LOCALIZED_RELATION_TYPES(e=!0){return a.RELATION_TYPES(e).map(e=>({name:e,label:I18n.t("js.relation_labels."+e)}))}static DEFAULT(){return"relates"}normalizedType(e){return this.denormalized(e).relationType}denormalized(e){const t=this.to.href===e.$href?"from":"to";return{target:this[t],targetId:this[t].id,relationType:"from"===t?this.reverseType:this.type,reverseRelationType:"from"===t?this.type:this.reverseType}}isInvolved(e){return _.values(this.ids).indexOf(e.toString())>=0}get ids(){return{from:s.a.idFromLink(this.from.href),to:s.a.idFromLink(this.to.href)}}updateDescription(e){return this.$links.updateImmediately({description:e})}updateType(e){return this.$links.updateImmediately({type:e})}}},Ncnr:function(e,t,i){"use strict";i.d(t,"d",(function(){return f})),i.d(t,"e",(function(){return b})),i.d(t,"b",(function(){return w})),i.d(t,"c",(function(){return v})),i.d(t,"a",(function(){return y}));var n=i("mrSG"),s=i("wZYP"),a=i("J30J"),r=i("Q2x2"),c=i("4rda");class o extends r.a{render(e,t){const i=this.value;e.setAttribute("title",t),e.textContent=t,e.innerHTML="",0===i.length?this.renderEmpty(e):this.renderValues(i,e)}renderValues(e,t){e.forEach(e=>{const i=document.createElement("div");i.classList.add(c.b,"-multiple-lines"),i.setAttribute("title",e),i.textContent=e,t.appendChild(i)})}}var l=i("Nvnm");class d extends l.a{render(e,t){const i=this.percentLabel;e.setAttribute("title",i),e.innerHTML="",e.textContent=i}}var u=i("r0MM"),h=i("3uR5");class p extends r.a{render(e,t){const i=this.attribute;e.setAttribute("title",t),e.textContent=t,e.innerHTML="",0===i.length?this.renderEmpty(e):this.renderValues(i,e)}renderValues(e,t){this.avatarRenderer.renderMultiple(t,e,!0,!0)}}Object(n.c)([Object(u.a)(),Object(n.e)("design:type",h.a)],p.prototype,"avatarRenderer",void 0);var g=i("ayqa");class m extends g.a{constructor(){super(...arguments),this.text={placeholder:{startDate:this.I18n.t("js.label_no_start_date"),dueDate:this.I18n.t("js.label_no_due_date")}}}render(e,t){var i=this.createDateDisplayField("startDate"),n=this.createDateDisplayField("dueDate"),s=document.createElement("span");s.textContent=" - ",e.appendChild(i),e.appendChild(s),e.appendChild(n)}createDateDisplayField(e){var t=document.createElement("span"),i=new g.a(e,this.context),n=this.resource[e]?this.timezoneService.formattedDate(this.resource[e]):this.text.placeholder[e];return i.apply(this.resource,this.schema),i.render(t,n),t}}const f="-editable",b="-read-only",w="inline-edit--display-field",v="inline-edit--container";class y{constructor(e,t,i={}){this.injector=e,this.container=t,this.options=i,this.fieldCache={}}render(e,t,i,n){const[s,a]=this.renderFieldValue(e,t,i,n);return null===s||this.setSpanAttributes(a,s,t,e),a}renderFieldValue(e,t,i,n){const s=document.createElement("span"),a=this.getSchemaName(e,i,t),r=e.schema[a];if(!r)return[null,s];const c=this.getField(e,r,a,i);c.render(s,this.getText(c,r,n),r.options);const o=c.title;return o&&s.setAttribute("title",o),s.setAttribute("aria-label",this.getAriaLabel(c,e)),[c,s]}getField(e,t,i,n){let s=this.fieldCache[i];return s||(s=this.fieldCache[i]=this.getFieldForCurrentContext(e,i,t)),s.apply(e,t),s.activeChange=n,s}getFieldForCurrentContext(e,t,i){const n={container:this.container,injector:this.injector,options:this.options},s=["[]CustomOption"].indexOf(i.type)>=0;if("single-view"===this.container&&s)return new o(t,n);const a=["[]User"].indexOf(i.type)>=0;return"single-view"===this.container&&a?new p(t,n):"single-view"===this.container&&"startDate"===t?new m(t,n):"timeline"===this.container&&"percentageDone"===t?new d(t,n):this.displayFieldService.getField(e,t,i,n)}getText(e,t,i){return e.isEmpty()?i||this.getDefaultPlaceholder(t):e.valueString}setSpanAttributes(e,t,i,n){e.classList.add(w,i),e.dataset.fieldName=i,e.setAttribute("tabindex","id"===i?"-1":"0"),t.required&&e.classList.add("-required"),t.isEmpty()&&e.classList.add("-placeholder"),t.writable?(e.classList.add(f),e.setAttribute("role","button")):e.classList.add(b)}getAriaLabel(e,t){let i,n=this.getLabelContent(e);if(e.isFormattable&&!e.isEmpty())try{i=_.escape(jQuery(`<div>${n}</div>`).text())}catch(s){console.error("Failed to parse formattable labelContent"),i="Label for "+e.displayName}else i=n;return e.writable&&t.isAttributeEditable(e.name)?this.I18n.t("js.inplace.button_edit",{attribute:`${e.displayName} ${i}`}):`${e.displayName} ${i}`}getLabelContent(e){return e.isEmpty()?this.I18n.t("js.inplace.null_value_label"):e.valueString}getSchemaName(e,t,i){return t?t.getSchemaName(i):e.getSchemaName?e.getSchemaName(i):i}getDefaultPlaceholder(e){return"Formattable"===e.type?this.I18n.t("js.work_packages.placeholders.formattable",{name:e.name}):"-"}}Object(n.c)([Object(u.a)(),Object(n.e)("design:type",a.a)],y.prototype,"displayFieldService",void 0),Object(n.c)([Object(u.a)(),Object(n.e)("design:type",s.a)],y.prototype,"I18n",void 0)},Ndcw:function(e,t,i){"use strict";i.d(t,"a",(function(){return E}));var n=i("fXoL"),s=i("wZYP"),a=i("l08T"),r=i("4EDS"),c=(i("AA01"),i("fbLK")),o=i("F5Dh"),l=i("3Pt+"),d=i("ofXK"),u=i("/Rze"),h=i("N5AO"),p=i("ahm3"),g=i("72I8"),m=i("DiYd"),f=i("67Ga"),b=i("SgrZ"),w=i("q/QC"),v=i("TAxG"),y=i("OhNT");function k(e,t){if(1&e&&n.hc(0,"option",10),2&e){const e=t.$implicit;n.Bc("textContent",e.name)("ngValue",e)}}function C(e,t){if(1&e){const e=n.nc();n.mc(0,"filter-integer-value",14),n.uc("filterChanged",(function(t){return n.Qc(e),n.wc(2).onFilterUpdated(t)})),n.lc()}if(2&e){const e=n.wc(2);n.Bc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function j(e,t){if(1&e){const e=n.nc();n.mc(0,"filter-date-value",14),n.uc("filterChanged",(function(t){return n.Qc(e),n.wc(2).onFilterUpdated(t)})),n.lc()}if(2&e){const e=n.wc(2);n.Bc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function x(e,t){if(1&e){const e=n.nc();n.mc(0,"filter-dates-value",14),n.uc("filterChanged",(function(t){return n.Qc(e),n.wc(2).onFilterUpdated(t)})),n.lc()}if(2&e){const e=n.wc(2);n.Bc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function T(e,t){if(1&e){const e=n.nc();n.mc(0,"filter-date-time-value",14),n.uc("filterChanged",(function(t){return n.Qc(e),n.wc(2).onFilterUpdated(t)})),n.lc()}if(2&e){const e=n.wc(2);n.Bc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function S(e,t){if(1&e){const e=n.nc();n.mc(0,"filter-date-times-value",14),n.uc("filterChanged",(function(t){return n.Qc(e),n.wc(2).onFilterUpdated(t)})),n.lc()}if(2&e){const e=n.wc(2);n.Bc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function _(e,t){if(1&e){const e=n.nc();n.mc(0,"filter-string-value",14),n.uc("filterChanged",(function(t){return n.Qc(e),n.wc(2).onFilterUpdated(t)})),n.lc()}if(2&e){const e=n.wc(2);n.Bc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function P(e,t){if(1&e){const e=n.nc();n.mc(0,"filter-string-value",14),n.uc("filterChanged",(function(t){return n.Qc(e),n.wc(2).onFilterUpdated(t)})),n.lc()}if(2&e){const e=n.wc(2);n.Bc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function I(e,t){if(1&e){const e=n.nc();n.mc(0,"filter-boolean-value",14),n.uc("filterChanged",(function(t){return n.Qc(e),n.wc(2).onFilterUpdated(t)})),n.lc()}if(2&e){const e=n.wc(2);n.Bc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function O(e,t){if(1&e){const e=n.nc();n.mc(0,"filter-toggled-multiselect-value",14),n.uc("filterChanged",(function(t){return n.Qc(e),n.wc(2).onFilterUpdated(t)})),n.lc()}if(2&e){const e=n.wc(2);n.Bc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function R(e,t){if(1&e&&(n.kc(0),n.mc(1,"div",11),n.Yc(2,C,1,2,"filter-integer-value",12),n.Yc(3,j,1,2,"filter-date-value",12),n.Yc(4,x,1,2,"filter-dates-value",12),n.Yc(5,T,1,2,"filter-date-time-value",12),n.Yc(6,S,1,2,"filter-date-times-value",12),n.Yc(7,_,1,2,"filter-string-value",12),n.Yc(8,P,1,2,"filter-string-value",12),n.Yc(9,I,1,2,"filter-boolean-value",12),n.Yc(10,O,1,2,"filter-toggled-multiselect-value",13),n.lc(),n.jc()),2&e){const e=n.wc();n.Tb(1),n.Bc("ngSwitch",e.valueType),n.Tb(1),n.Bc("ngSwitchCase","[1]Integer"),n.Tb(1),n.Bc("ngSwitchCase","[1]Date"),n.Tb(1),n.Bc("ngSwitchCase","[2]Date"),n.Tb(1),n.Bc("ngSwitchCase","[1]DateTime"),n.Tb(1),n.Bc("ngSwitchCase","[2]DateTime"),n.Tb(1),n.Bc("ngSwitchCase","[1]String"),n.Tb(1),n.Bc("ngSwitchCase","[1]Float"),n.Tb(1),n.Bc("ngSwitchCase","[1]Boolean")}}function B(e,t){1&e&&n.hc(0,"div",15)}class E{constructor(e,t,i,s){this.wpTableFilters=e,this.wpFiltersService=t,this.I18n=i,this.bannerService=s,this.shouldFocus=!1,this.filterChanged=new n.s,this.deactivateFilter=new n.s,this.showValuesInput=!1,this.eeShowBanners=!1,this.trackByHref=r.a.halHref,this.compareByHref=r.a.compareByHref,this.text={open_filter:this.I18n.t("js.filter.description.text_open_filter"),close_filter:this.I18n.t("js.filter.description.text_close_filter"),label_filter_add:this.I18n.t("js.work_packages.label_filter_add"),upsale_for_more:this.I18n.t("js.filter.upsale_for_more"),upsale_link:this.I18n.t("js.filter.upsale_link"),button_delete:this.I18n.t("js.button_delete")}}onFilterUpdated(e){this.filter=e,this.showValuesInput=this.filter.currentSchema.isValueRequired(),this.filterChanged.emit(this.filter)}removeThisFilter(){this.deactivateFilter.emit(this.filter)}get valueType(){if(this.filter.currentSchema&&this.filter.currentSchema.values)return this.filter.currentSchema.values.type}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners,this.availableOperators=this.filter.schema.availableOperators,this.showValuesInput=this.filter.currentSchema.isValueRequired()}}E.\u0275fac=function(e){return new(e||E)(n.gc(o.a),n.gc(a.a),n.gc(s.a),n.gc(c.a))},E.\u0275cmp=n.ac({type:E,selectors:[["","query-filter",""]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged",deactivateFilter:"deactivateFilter"},attrs:["query-filter",""],decls:12,vars:14,consts:[[1,"advanced-filters--filter-name",3,"for","textContent"],[1,"advanced-filters--filter-operator"],[1,"hidden-for-sighted",3,"for"],["required","",1,"advanced-filters--select",2,"vertical-align","top",3,"id","name","ngModel","compareWith","ngModelChange"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],[4,"ngIf"],["class","advanced-filters--filter-value",4,"ngIf"],[1,"advanced-filters--remove-filter"],[3,"execute"],["icon-classes","icon-close advanced-filters--remove-filter-icon",3,"icon-title"],[3,"textContent","ngValue"],[1,"advanced-filters--filter-value",3,"ngSwitch"],[3,"shouldFocus","filter","filterChanged",4,"ngSwitchCase"],[3,"shouldFocus","filter","filterChanged",4,"ngSwitchDefault"],[3,"shouldFocus","filter","filterChanged"],[1,"advanced-filters--filter-value"]],template:function(e,t){1&e&&(n.kc(0),n.hc(1,"label",0),n.mc(2,"div",1),n.mc(3,"label",2),n.ad(4),n.lc(),n.mc(5,"select",3),n.uc("ngModelChange",(function(e){return t.filter.operator=e}))("ngModelChange",(function(){return t.onFilterUpdated(t.filter)})),n.Yc(6,k,1,2,"option",4),n.lc(),n.lc(),n.Yc(7,R,11,9,"ng-container",5),n.Yc(8,B,1,0,"div",6),n.mc(9,"div",7),n.mc(10,"accessible-by-keyboard",8),n.uc("execute",(function(){return t.removeThisFilter()})),n.hc(11,"op-icon",9),n.lc(),n.lc(),n.jc()),2&e&&(n.Tb(1),n.Dc("for","operators-",t.filter.id,""),n.Bc("textContent",t.filter.name),n.Ub("title",t.filter.name),n.Tb(2),n.Dc("for","operators-",t.filter.id,""),n.Tb(1),n.dd(" ",t.filter.name," ",t.text.open_filter," "),n.Tb(1),n.Dc("id","operators-",t.filter.id,""),n.Dc("name","op[",t.filter.id,"]"),n.Bc("ngModel",t.filter.operator)("compareWith",t.compareByHref),n.Tb(1),n.Bc("ngForOf",t.availableOperators),n.Tb(1),n.Bc("ngIf",t.showValuesInput&&t.valueType),n.Tb(1),n.Bc("ngIf",!t.showValuesInput),n.Tb(3),n.Bc("icon-title",t.text.button_delete))},directives:[l.y,l.x,l.m,l.p,d.p,d.q,u.a,h.a,l.r,l.B,d.u,d.v,d.w,p.a,g.a,m.a,f.a,b.a,w.a,v.a,y.a],encapsulation:2})},Ng29:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}},Nnhs:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{isLocked(){return"locked"===this.status}isOpen(){return"open"===this.status}isClosed(){return"closed"===this.status}}},Nolp:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("mrSG"),s=i("IzEk"),a=i("zOhy"),r=i("uSJ+"),c=i("SKFm"),o=i("r0MM"),l=i("fXoL");class d extends a.a{constructor(){super(...arguments),this.copying=!0}ngOnInit(){super.ngOnInit(),this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed()).subscribe(e=>{e.__initialized_at===this.__initialized_at&&this.wpRelations.addCommonRelation(e.id,"relates",this.copiedWorkPackageId)})}createdWorkPackage(){return this.copiedWorkPackageId=this.stateParams.copiedFromWorkPackageId,new Promise((e,t)=>{this.wpCacheService.loadWorkPackage(this.copiedWorkPackageId).values$().pipe(Object(s.a)(1)).subscribe(i=>{this.createCopyFrom(i).then(e,t)})})}setTitle(){this.titleService.setFirstPart(this.I18n.t("js.work_packages.copy.title"))}createCopyFrom(e){let t=this.halEditing.changeFor(e);return this.wpCreate.copyWorkPackage(t).then(e=>(this.__initialized_at=e.pristineResource.__initialized_at,this.wpCacheService.updateWorkPackage(e.pristineResource),this.halEditing.updateValue("new",e),e))}}d.\u0275fac=function(e){return u(e||d)},d.\u0275dir=l.bc({type:d,features:[l.Qb]}),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",r.a)],d.prototype,"wpRelations",void 0),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",c.a)],d.prototype,"halEditing",void 0);const u=l.oc(d)},Nvnm:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("4rda");class s extends n.a{get value(){return this.schema?this.resource[this.name]||0:null}get percentLabel(){return this.roundedProgress+"%"}get roundedProgress(){return Math.round(Number(this.value))||0}render(e,t){e.setAttribute("title",t),e.innerHTML=`\n      <span>\n        <span style="width: 80px" class="progress-bar">\n          <span style="width: ${this.roundedProgress}%" class="inner-progress closed"></span>\n          <span style="width: 0%" class="inner-progress done"></span>\n        </span>\n        <span class="progress-bar-legend">${this.percentLabel}</span>\n      </span>\n    `}}},ODu2:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("4zHP"),s=i("4EDS"),a=i("fXoL"),r=i("vd15"),c=i("ofXK"),o=i("Tcty"),l=i("/Rze");function d(e,t){if(1&e){const e=a.nc();a.mc(0,"accessible-by-keyboard",10),a.uc("execute",(function(){return a.Qc(e),a.wc(4).toggleComments()})),a.hc(1,"span",11),a.lc()}if(2&e){const e=a.wc(4);a.Bc("linkAriaLabel",e.togglerText),a.Tb(1),a.Bc("textContent",e.togglerText)}}const u=function(e){return{"-with-toggler":e}};function h(e,t){if(1&e&&(a.mc(0,"h3",7),a.hc(1,"span",8),a.Yc(2,d,2,2,"accessible-by-keyboard",9),a.lc()),2&e){const e=a.wc(),t=e.first,i=e.$implicit,n=a.wc(2);a.Bc("ngClass",a.Gc(3,u,t&&n.showToggler)),a.Tb(1),a.Bc("textContent",i.date),a.Tb(1),a.Bc("ngIf",t&&n.showToggler)}}function p(e,t){if(1&e&&(a.mc(0,"div",4),a.Yc(1,h,3,5,"h3",5),a.hc(2,"activity-entry",6),a.lc()),2&e){const e=t.$implicit,i=t.first,n=a.wc(2);a.Tb(1),a.Bc("ngIf",i||e.isNextDate),a.Tb(1),a.Bc("workPackage",n.workPackage)("activity",e.activity)("activityNo",e.number(e.isReversed))("isInitial",e.isInitial())}}function g(e,t){if(1&e&&(a.mc(0,"div",1),a.mc(1,"div",2),a.Yc(2,p,3,5,"div",3),a.lc(),a.lc()),2&e){const e=a.wc();a.Tb(2),a.Bc("ngForOf",e.visibleActivities)("ngForTrackBy",e.trackByHref)}}class m extends n.a{constructor(){super(...arguments),this.tabName=this.I18n.t("js.work_packages.tabs.activity"),this.trackByHref=s.a.trackByHrefAndProperty("version")}ngOnInit(){this.workPackageId=this.$transition.params("to").workPackageId,super.ngOnInit()}}m.\u0275fac=function(e){return f(e||m)},m.\u0275cmp=a.ac({type:m,selectors:[["wp-activity-tab"]],features:[a.Qb],decls:2,vars:1,consts:[[3,"workPackage"],[1,"detail-activity"],[1,"work-package-details-activities-list"],["class","work-package-details-activities-activity",4,"ngFor","ngForOf","ngForTrackBy"],[1,"work-package-details-activities-activity"],["class","activity-date",3,"ngClass",4,"ngIf"],[3,"workPackage","activity","activityNo","isInitial"],[1,"activity-date",3,"ngClass"],[1,"activity-date--label",3,"textContent"],["linkClass","activity-comments--toggler button -small -transparent -with-icon icon-filter icon-small hide-when-print",3,"linkAriaLabel","execute",4,"ngIf"],["linkClass","activity-comments--toggler button -small -transparent -with-icon icon-filter icon-small hide-when-print",3,"linkAriaLabel","execute"],[3,"textContent"]],template:function(e,t){1&e&&(a.mc(0,"work-package-comment",0),a.Yc(1,g,3,2,"ng-template"),a.lc()),2&e&&a.Bc("workPackage",t.workPackage)},directives:[r.a,c.p,c.q,o.a,c.n,l.a],encapsulation:2});const f=a.oc(m)},OGNV:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("kTsZ"),s=i("Jui0"),a=i("yQm5"),r=i("fXoL");class c{constructor(e,t){this.halResourceService=e,this.pathHelper=t}load(e){let t={name:e.name||"!!!__O__o__O__!!!"};return e.project&&(t._links={project:{href:e.project.$href}}),e.$links.update(t)}loadWithParams(e,t,i,n={}){t||n.name||(n.name="!!!__O__o__O__!!!"),i&&(n._links=n._links||{},n._links.project={href:this.pathHelper.api.v3.projects.id(i).toString()});let s=this.pathHelper.api.v3.queries.optionalId(t).form.toString();return s=a(s).search(e).toString(),this.halResourceService.post(s,n).toPromise()}buildQueryResource(e){return this.halResourceService.createHalResourceOfType("Query",e.payload)}}c.\u0275fac=function(e){return new(e||c)(r.qc(n.a),r.qc(s.a))},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac})},ONn1:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("JY8V"),s=i("wyKs"),a=i("E2tj"),r=i("kTsZ"),c=i("ug4p"),o=i("uSJ+"),l=i("qc15"),d=i("fXoL");class u{constructor(e,t,i,n,s,a,r){this.querySpace=e,this.wpTableHierarchies=t,this.wpTableColumns=i,this.notificationService=n,this.halResourceService=s,this.wpCacheService=a,this.wpRelations=r}initialize(e){Promise.all([this.requireInvolvedRelations(e.map(e=>e.id)),this.requireHierarchyElements(e)]).then(e=>{this.loadAdditional(_.flatten(e))})}loadAdditional(e){this.wpCacheService.requireAll(e).then(()=>{this.querySpace.additionalRequiredWorkPackages.putValue(null,"All required work packages are loaded")}).catch(e=>{this.querySpace.additionalRequiredWorkPackages.putValue(null,"Failure loading required work packages"),this.notificationService.handleRawError(e)})}requireInvolvedRelations(e){return this.wpTableColumns.hasRelationColumns()?this.wpRelations.requireAll(e,!0).then(()=>{const t=this.getInvolvedWorkPackages(e.map(e=>this.wpRelations.state(e).value));return _.flatten(t)}):Promise.resolve([])}requireHierarchyElements(e){if(!this.wpTableHierarchies.isEnabled)return Promise.resolve([]);const t=_.flatten(e.map(e=>e.ancestorIds));return Promise.resolve(t)}getInvolvedWorkPackages(e){const t=[];return _.each(e,e=>{_.each(e,e=>{t.push(e.ids.from,e.ids.to)})}),t}}u.\u0275fac=function(e){return new(e||u)(d.qc(a.a),d.qc(s.a),d.qc(n.a),d.qc(l.a),d.qc(r.a),d.qc(c.a),d.qc(o.a))},u.\u0275prov=d.cc({token:u,factory:u.\u0275fac})},OW6k:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("PTRy");class s{constructor(e,t){this.down=!1,this.elements=e,this.scrollWhenOutside=t.scrollWhenOutside||!1,this.maxSpeed=t.maxSpeed||5,this.margin=t.margin||10,this.scrollWhenOutside=t.scrollWhenOutside||!1,this.autoScroll=t.autoScroll,this.point={},this.pointCB=Object(n.createPointCB)(this.point),this.init()}init(){jQuery(window).on("mousemove.domautoscroll touchmove.domautoscroll",e=>{this.pointCB(e),this.onMove(e)}),jQuery(window).on("mouseup.domautoscroll touchend.domautoscroll",()=>this.onUp()),jQuery(window).on("scroll.domautoscroll",e=>this.setScroll(e))}destroy(){jQuery(window).off(".domautoscroll"),this.elements=[],this.cleanAnimation()}add(e){this.elements.push(e)}onUp(){cancelAnimationFrame(this.animationFrame),cancelAnimationFrame(this.windowAnimationFrame)}setScroll(e){for(let t=0;t<this.elements.length;t++)if(this.elements[t]===e.target){this.scrolling=!0;break}this.scrolling&&requestAnimationFrame(()=>this.scrolling=!1)}cleanAnimation(){cancelAnimationFrame(this.animationFrame),cancelAnimationFrame(this.windowAnimationFrame)}getTarget(e){if(!e)return[];let t=[];this.elements.includes(e)&&t.push(e);let i=e;for(;i=i.parentNode;)this.elements.includes(i)&&t.push(i);return t}getElementsUnderPoint(){let e=[];for(var t=0;t<this.elements.length;t++)this.inside(this.point,this.elements[t])&&e.push(this.elements[t]);return e}onMove(e){if(!this.autoScroll())return;if(e.dispatched)return;let t=[];null!==e.target&&t.push(e.target);let i=document.body;t.length>0&&t[0].parentNode===i?t=this.getElementsUnderPoint():(t=this.getTarget(t[0]),0===t.length&&(t=this.getElementsUnderPoint())),this.current=t,0===this.current.length&&(this.current=[this.outerScrollContainer]),cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(this.scrollTick.bind(this))}setOuterScrollContainer(e){this.outerScrollContainer=e}scrollTick(){0!==this.current.length&&(this.current.forEach(e=>{e&&this.scrollAutomatically(e)}),cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(this.scrollTick.bind(this)))}scrollAutomatically(e){let t,i,s=Object(n.getClientRect)(e);t=this.point.x<s.left+this.margin?-this.maxSpeed:this.point.x>s.right-this.margin?this.maxSpeed:0,i=this.point.y<s.top+this.margin?-this.maxSpeed:this.point.y>s.bottom-this.margin?this.maxSpeed:0,setTimeout(()=>{i&&this.scrollY(e,i),t&&this.scrollX(e,t)})}scrollY(e,t){e===window?window.scrollTo(e.pageXOffset,e.pageYOffset+t):e.scrollTop+=t}scrollX(e,t){e===window?window.scrollTo(e.pageXOffset+t,e.pageYOffset):e.scrollLeft+=t}inside(e,t,i){return i?e.y>i.top&&e.y<i.bottom&&e.x>i.left&&e.x<i.right:Object(n.pointInside)(e,t)}}},OhNT:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));i("AA01");var n=i("9cVk"),s=i("fXoL"),a=i("wZYP"),r=i("4EDS"),c=i("kTsZ"),o=i("iHm1"),l=i("Jui0"),d=i("ZOsW"),u=i("3Pt+"),h=i("ofXK");const p=["ngSelectInstance"],g=function(e){return{"-required-highlighting":e}};class m{constructor(e,t,i,n,a,c){this.RootDm=e,this.halResourceService=t,this.halSorting=i,this.PathHelper=n,this.cdRef=a,this.I18n=c,this.shouldFocus=!1,this.filterChanged=new s.s,this._availableOptions=[],this.compareByHrefOrString=r.a.compareByHrefOrString,this.text={placeholder:this.I18n.t("js.placeholders.selection")}}ngOnInit(){this.fetchAllowedValues()}ngAfterViewInit(){this.ngSelectInstance&&this.shouldFocus&&this.ngSelectInstance.focus()}get value(){return this.filter.values}setValues(e){this.filter.values=_.castArray(e),this.filterChanged.emit(this.filter),this.cdRef.detectChanges()}get availableOptions(){return this._availableOptions}set availableOptions(e){this._availableOptions=this.halSorting.sort(e)}get isEmpty(){return this._isEmpty=0===this.value.length}repositionDropdown(){this.ngSelectInstance&&setTimeout(()=>{const e=this.ngSelectInstance;e&&e.dropdownPanel&&e.dropdownPanel._updatePosition()},25)}get isUserResource(){let e=_.get(this.filter.currentSchema,"values.type",null);return e&&e.indexOf("User")>0}fetchAllowedValues(){this.filter.currentSchema.values.allowedValues.$load?this.loadAllowedValues():this.availableOptions=this.filter.currentSchema.values.allowedValues}loadAllowedValues(){let e=[this.filter.currentSchema.values.allowedValues.$load()];this.isUserResource&&e.push(this.RootDm.load()),Promise.all(e).then(e=>{let t=e[0].elements;this.availableOptions=t,this.isUserResource&&"memberOfGroup"!==this.filter.filter.id&&this.addMeValue(e[1].user)})}addMeValue(e){if(!e||!e.$href)return;let t=this.halResourceService.createHalResource({_links:{self:{href:this.PathHelper.api.v3.users.me,title:this.I18n.t("js.label_me")}}},!0);this._availableOptions.unshift(t)}}m.\u0275fac=function(e){return new(e||m)(s.gc(n.a),s.gc(c.a),s.gc(o.a),s.gc(l.a),s.gc(s.i),s.gc(a.a))},m.\u0275cmp=s.ac({type:m,selectors:[["filter-toggled-multiselect-value"]],viewQuery:function(e,t){var i;(1&e&&s.Wc(p,!0),2&e)&&(s.Nc(i=s.vc())&&(t.ngSelectInstance=i.first))},inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},decls:3,vars:14,consts:[[1,"inline-label","ng-select-container",3,"id"],["appendTo","body","bindLabel","name",1,"advanced-filters--ng-select","-multi-select",3,"ngModel","compareWith","clearSearchOnAdd","placeholder","ngClass","id","items","multiple","closeOnSelect","hideSelected","virtualScroll","change","add","remove","open"],["ngSelectInstance",""]],template:function(e,t){1&e&&(s.mc(0,"div",0),s.mc(1,"ng-select",1,2),s.uc("change",(function(e){return t.setValues(e)}))("add",(function(){return t.repositionDropdown()}))("remove",(function(){return t.repositionDropdown()}))("open",(function(){return t.repositionDropdown()})),s.lc(),s.lc()),2&e&&(s.Dc("id","div-values-",t.filter.id,""),s.Tb(1),s.Bc("ngModel",t.filter.values)("compareWith",t.compareByHrefOrString)("clearSearchOnAdd",!0)("placeholder",t.text.placeholder)("ngClass",s.Gc(12,g,t.isEmpty))("id","values-"+t.filter.id)("items",t.availableOptions)("multiple",!0)("closeOnSelect",!1)("hideSelected",!0)("virtualScroll",!0))},directives:[d.a,u.m,u.p,h.n],encapsulation:2,changeDetection:0})},P7xQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var n=i("mrSG"),s=i("iB+3"),a=i("13ri"),r=i("Kg8T"),c=i("Jui0"),o=(i("ii2/"),i("g1AQ")),l=i("UUNb"),d=i("PUHT"),u=i("4lR/"),h=i("TM9v"),p=i("IaZ+");class g{constructor(e,t,i){this.workPackage=e,this.PathHelper=t,this.$state=i,this.project=e.project}get allActions(){return{workPackage:this.workPackage,project:this.project}}copyLink(){return 0===this.$state.current.name.indexOf("work-packages.partitioned.list.details")?this.PathHelper.workPackageDetailsCopyPath(this.project.identifier,this.workPackage.id):this.PathHelper.workPackageCopyPath(this.workPackage.id)}linkForAction(e){return"copy"===e.key?e.link=this.copyLink():e.link=this.allActions[e.resource][e.link].href,e}isPermitted(e){return void 0!==this.allActions[e.resource]&&void 0!==this.allActions[e.resource][e.link]}permittedActionKeys(e){var t=_.filter(e,e=>this.isPermitted(e));return _.map(t,(function(e){return e.key}))}permittedActionsWithLinks(e){var t=_.filter(_.cloneDeep(e),e=>this.isPermitted(e));return _.map(t,e=>this.linkForAction(e))}}var m=i("r0MM"),f=i("xQCb"),b=i("fXoL");class w extends d.a{constructor(e,t,i,n,s,a,r,c){super(s,r),this.HookService=e,this.$state=t,this.injector=i,this.PathHelper=n,this.elementRef=s,this.opModalService=a,this.opContextMenuService=r,this.authorisationService=c}open(e){this.workPackage.project.$load().then(()=>{this.authorisationService.initModelAuth("work_package",this.workPackage.$links);var t=new g(this.workPackage,this.PathHelper,this.$state);const i=this.getPermittedActions(t);this.buildItems(i),this.opContextMenu.show(this,e)})}triggerContextMenuAction(e,t){const i=e.link;switch(t){case"copy":this.$state.go("work-packages.copy",{copiedFromWorkPackageId:this.workPackage.id});break;case"delete":this.opModalService.show(l.a,this.injector,{workPackages:[this.workPackage]});break;case"log_time":this.timeEntryCreateService.create(moment(new Date),this.workPackage,!1).catch(()=>{});break;default:window.location.href=i}}positionArgs(e){let t=super.positionArgs(e);return _.assign(t,{my:"right top",at:"right bottom"}),t}getPermittedActions(e){let t=e.permittedActionsWithLinks(h.a);return _.each(this.getPermittedPluginActions(e),e=>{let i=e.indexBy?e.indexBy(t):t.length;t.splice(i,0,e)}),t}getPermittedPluginActions(e){let t=this.HookService.call("workPackageSingleContextMenu");return e.permittedActionsWithLinks(t)}buildItems(e){const t=this.workPackage.configureForm;return this.items=e.map(e=>{const t=e.key;return{disabled:!1,linkText:I18n.t("js.button_"+t),href:e.link,icon:e.icon||`icon-${t}`,onClick:i=>(!e.link||!a.a.isClickedWithModifier(i))&&(this.triggerContextMenuAction(e,t),!0)}}),t&&this.items.push({href:t.href,icon:"icon-settings3",linkText:I18n.t("js.button_configure-form"),onClick:()=>!1}),this.items}}w.\u0275fac=function(e){return new(e||w)(b.gc(o.a),b.gc(s.G),b.gc(b.A),b.gc(c.a),b.gc(b.q),b.gc(p.b),b.gc(u.a),b.gc(r.a))},w.\u0275dir=b.bc({type:w,selectors:[["","wpSingleContextMenu",""]],inputs:{workPackage:["wpSingleContextMenu-workPackage","workPackage"]},features:[b.Qb]}),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",f.a)],w.prototype,"timeEntryCreateService",void 0)},PBJw:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("zwY0"),s=i.n(n),a=i("wZYP");class r{constructor(e,t,i,n,s){this.datepickerElemIdentifier=e,this.date=t,this.options=i,this.datepickerTarget=n,this.configurationService=s,this.datepickerFormat="Y-m-d",this.datepickerCont=jQuery(this.datepickerElemIdentifier),this.initialize(i)}initialize(e){var t;const i=new a.a,n=(null===(t=this.configurationService)||void 0===t?void 0:t.startOfWeekPresent())?this.configurationService.startOfWeek():1,r=_.extend({},e,{weekNumbers:!0,dateFormat:this.datepickerFormat,defaultDate:this.date,locale:{weekdays:{shorthand:i.t("date.abbr_day_names"),longhand:i.t("date.day_names")},months:{shorthand:i.t("date.abbr_month_names").slice(1),longhand:i.t("date.month_names").slice(1)},firstDayOfWeek:n,weekAbbreviation:i.t("date.abbr_week")}});var c;c=this.datepickerTarget?s()(this.datepickerTarget,r):s()(this.datepickerElemIdentifier,r),this.datepickerInstance=Array.isArray(c)?c[0]:c}clear(){this.datepickerInstance.clear()}destroy(){this.hide(),this.datepickerInstance.destroy()}hide(){this.isOpen&&this.datepickerInstance.close(),this.datepickerCont.scrollParent().off("scroll")}show(){this.datepickerInstance.open(),this.hideDuringScroll()}setDates(e){this.datepickerInstance.setDate(e)}get isOpen(){return this.datepickerInstance.isOpen}hideDuringScroll(){let e=null;this.datepickerCont.scrollParent().scroll(()=>{this.datepickerInstance.close(),e&&clearTimeout(e),e=setTimeout(()=>{this.visibleAndActive()&&this.datepickerInstance.open()},50)})}visibleAndActive(){var e=this.datepickerCont;try{return document.elementFromPoint(e.offset().left,e.offset().top)===e[0]&&document.activeElement===e[0]}catch(t){return console.error("Failed to test visibleAndActive "+t),!1}}}},PHo6:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{get height(){return this.endRow-this.startRow}get width(){return this.endColumn-this.startColumn}}},POAS:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("mrSG"),s=i("XZsv"),a=i("iB+3"),r=i("kTsZ"),c=i("Y0Nk"),o=i("d/TE"),l=i("wZYP"),d=i("tk/3"),u=i("Mo6U"),h=i("r0MM"),p=i("fXoL");class g{constructor(e){this.injector=e}showSave(e,t=!1){let i={message:this.I18n.t("js.notice_successful_"+(t?"create":"update"))};this.NotificationsService.addSuccess(i)}handleRawError(e,t){if(console.error("Handling error message %O for work package %O",e,t),e instanceof s.a)return this.handleErrorResponse(e,t);const i=this.retrieveError(e);if(i instanceof u.a)return this.handleErrorResponse(i,t);"string"!=typeof e?this.showGeneralError(i||e):this.NotificationsService.addError(e)}retrieveErrorMessage(e){const t=this.retrieveError(e);return t instanceof s.a?t.message:"string"==typeof t?t:this.I18n.t("js.error.internal")}retrieveError(e){let t=e;return e instanceof d.d&&(t=e.message||e.error),"Error"===_.get(e,"data._type")&&(t=e.data),t&&"Error"===t._type?this.halResourceService.createHalResourceOfClass(s.a,t):t}handleErrorResponse(e,t){return e instanceof s.a?t?this.showError(e,t):void this.showApiErrorMessages(e):this.showGeneralError(e)}showError(e,t){this.showCustomError(e,t)||this.showApiErrorMessages(e)}showGeneralError(e){let t=this.I18n.t("js.error.internal");("string"==typeof e||_.has(e,"toString"))&&(t+=" "+e.toString()),this.NotificationsService.addError(t)}showEditingBlockedError(e){this.NotificationsService.addError(this.I18n.t("js.hal.error.edit_prohibited",{attribute:e}))}showCustomError(e,t){if("urn:openproject-org:api:v3:errors:PropertyFormatError"===e.errorIdentifier){let i=t.schema[e.details.attribute].name,n="js.hal.error.format."+t.schema[e.details.attribute].type.toLowerCase();return void 0!==this.I18n.lookup(n)&&(this.NotificationsService.addError(this.I18n.t(n,{attribute:i})),!0)}return!1}showApiErrorMessages(e){let t=e.errorMessages;return t.length>1?this.NotificationsService.addError("",t):this.NotificationsService.addError(t[0]),!0}}g.\u0275fac=function(e){return new(e||g)(p.qc(p.A))},g.\u0275prov=p.cc({token:g,factory:g.\u0275fac}),Object(n.c)([Object(h.a)(),Object(n.e)("design:type",l.a)],g.prototype,"I18n",void 0),Object(n.c)([Object(h.a)(),Object(n.e)("design:type",a.G)],g.prototype,"$state",void 0),Object(n.c)([Object(h.a)(),Object(n.e)("design:type",r.a)],g.prototype,"halResourceService",void 0),Object(n.c)([Object(h.a)(),Object(n.e)("design:type",o.a)],g.prototype,"NotificationsService",void 0),Object(n.c)([Object(h.a)(),Object(n.e)("design:type",c.a)],g.prototype,"loadingIndicator",void 0)},PSqx:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("ciXH"),s=i("fXoL");class a extends n.a{listAvailableProjects(e){return this.listRequest(this.availableProjectsUrl(),e)}listUrl(){return this.pathHelper.api.v3.memberships.toString()}oneUrl(e){return this.pathHelper.api.v3.memberships.id(e).toString()}availableProjectsUrl(){return this.pathHelper.api.v3.memberships.available_projects.toString()}}a.\u0275fac=function(e){return r(e||a)},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac});const r=s.oc(a)},PUHT:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("4lR/"),s=i("9+6k"),a=i("fXoL");class r extends s.a{constructor(e,t){super(t),this.elementRef=e,this.opContextMenu=t,this.items=[]}ngAfterViewInit(){this.$element=jQuery(this.elementRef.nativeElement),this.$element.on("click",e=>(e.preventDefault(),e.stopPropagation(),this.opContextMenu.isActive(this)?(this.opContextMenu.close(),!1):(this.open(e),!1))),Mousetrap(this.$element[0]).bind("shift+alt+f10",e=>{this.open(e)})}positionArgs(e){return{my:"left top",at:"left bottom",of:this.$element,collision:"flipfit"}}}r.\u0275fac=function(e){return new(e||r)(a.gc(a.q),a.gc(n.a))},r.\u0275dir=a.bc({type:r,selectors:[["","opContextMenuTrigger",""]],features:[a.Qb]})},PZVJ:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return c})),function(e){e.lazy=function(e,t,i,n){if(_.isObject(e)){let s,a=!1,r={get:()=>(a||(s=i(),a=!0),s),set:()=>{},configurable:!0,enumerable:!0};n&&(r.set=e=>{s=n(e),a=!0}),Object.defineProperty(e,t,r)}}}(n||(n={}));var s=i("BtrP");const a=i("NAZG");function r(e){return _.isNil(e)?[]:e.map(e=>e.$copy())}function c(e,t){function i(t,i=!0){return _.isNil(t)?t:t._links||t._embedded||t._type?e.createHalResource(t,i):t}function r(e,i){const s="$"+e,a="_"+e,r=t.$source[a];_.isObject(r)&&Object.keys(r).forEach(e=>{n.lazy(t[s],e,()=>i(r[e]))})}function c(e,i){const n=Array.isArray(e);if(e)if(n)t.$source._links[i]=e.map(e=>({href:e.href}));else if(e.hasOwnProperty("$link")){const n=e.$link;n.href&&(t.$source._links[i]=n)}else"href"in e&&(t.$source._links[i]={href:e.href});else t.$source._links[i]={href:null};return t.$embedded&&t.$embedded[i]&&(t.$embedded[i]=e,t.$source._embedded[i]=n?e.map(e=>e.$source):_.get(e,"$source",e)),e}!function(){t.$source._links||(t.$source._links={});t.$source._links.self||(t.$source._links.self={href:null})}(),r("links",t=>Array.isArray(t)?t.map(t=>s.a.fromObject(e,t).$callable()):s.a.fromObject(e,t).$callable()),r("embedded",e=>Array.isArray(e)?e.map(e=>i(e,!0)):(_.isObject(e)&&_.each(e,(t,s)=>{t&&(t._embedded||t._links)&&n.lazy(e,s,()=>i(t,!0))}),i(e,!0))),t.$embeddableKeys().forEach(e=>{Object.defineProperty(t,e,{get:()=>i(t.$source[e],!0),set(i){t.$source[e]=i},enumerable:!0,configurable:!0})}),t.$linkableKeys().forEach(i=>{n.lazy(t,i,()=>{const n=t.$links[i].$link||t.$links[i];if(Array.isArray(n)){var r=n.map(n=>e.createLinkedResource(t,i,n.$link)),c=new a(...r).on("change",()=>{c.forEach(e=>{e.$link||c.splice(c.indexOf(e),1)}),t.$source._links[i]=c.map(e=>e.$link)});return c}return n.href?"get"!==n.method?s.a.fromObject(e,n).$callable():e.createLinkedResource(t,i,n):null},e=>c(e,i))}),function(){if(!t.$source._embedded)return;Object.keys(t.$source._embedded).forEach(e=>{n.lazy(t,e,()=>t.$embedded[e],t=>c(t,e))})}()}},PkGb:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("iB+3"),s=i("jtHE"),a=i("fXoL");class r{constructor(e,t){this.$state=e,this.$transitions=t,this.currentTab="overview",this.subject=new s.a(1),this.updateTabs(),t.onSuccess({},e=>{this.updateTabs(e.to().name)})}get observable(){return this.subject}get lastActiveTab(){return this.isCurrentState("show")?this.currentShowTab:this.currentDetailsTab}get currentShowState(){return"work-packages.show."+this.currentShowTab}get currentDetailsState(){return"work-packages.partitioned.list.details."+this.currentDetailsTab}isDetailsState(e){return"work-packages.partitioned.list.details"===e}get currentShowTab(){return"overview"===this.currentTab?"activity":this.currentTab}get currentDetailsTab(){return this.currentTab}notify(){this.subject.next({active:this.lastActiveTab,show:this.currentShowState,details:this.currentDetailsState})}updateTab(e){if(this.isCurrentState(e)){const e=this.$state.current.name;this.currentTab=e.split(".").pop(),this.notify()}}isCurrentState(e){return"show"===e?this.$state.includes("work-packages.show.*"):"details"===e&&this.$state.includes("work-packages.partitioned.list.details.*")}updateTabs(e){if("work-packages.show.activity"===e)return this.currentTab="overview",this.notify();this.updateTab("show"),this.updateTab("details")}}r.\u0275fac=function(e){return new(e||r)(a.qc(n.G),a.qc(n.O))},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac})},PtkW:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("E2tj"),s=i("FnNU"),a=i("zqrF"),r=i("4jc8"),c=i("fXoL");class o extends a.a{constructor(e){super(e),this.querySpace=e,this.appliedZoomLevel$=Object(s.f)("auto")}valueFromQuery(e){return Object.assign(Object.assign({},this.defaultState),{visible:e.timelineVisible,zoomLevel:e.timelineZoomLevel,labels:e.timelineLabels})}set appliedZoomLevel(e){this.appliedZoomLevel$.putValue(e)}get appliedZoomLevel(){return this.appliedZoomLevel$.value}hasChanged(e){const t=this.isVisible!==e.timelineVisible,i=this.zoomLevel!==e.timelineZoomLevel,n=!_.isEqual(this.current.labels,e.timelineLabels);return t||i||n}applyToQuery(e){return e.timelineVisible=this.isVisible,e.timelineZoomLevel=this.zoomLevel,e.timelineLabels=this.current.labels,!1}toggle(){let e=this.current;this.setVisible(!e.visible)}setVisible(e){this.updatesState.putValue(Object.assign(Object.assign({},this.current),{visible:e}))}get isVisible(){return this.current.visible}get zoomLevel(){return this.current.zoomLevel}get labels(){return _.isEmpty(this.current.labels)?this.defaultLabels:this.current.labels}updateLabels(e){this.modify({labels:e})}getNormalizedLabels(e){let t=this.defaultLabels;return _.each(this.current.labels,(e,i)=>{const n=i;t[n]=""===e?null:e}),t}setZoomLevel(e){this.modify({zoomLevel:e})}updateZoomWithDelta(e){let t=this.current.zoomLevel;if("auto"!==t)return this.applyZoomLevel(t,e);const i=this.appliedZoomLevel;if(i&&"auto"!==i)this.applyZoomLevel(i,e);else{const t=e<0?"days":"years";this.setZoomLevel(t)}}isAutoZoom(){return"auto"===this.current.zoomLevel}enableAutozoom(){this.modify({zoomLevel:"auto"})}get current(){return this.lastUpdatedState.getValueOr(this.defaultState)}modify(e){this.update(Object.assign(Object.assign({},this.current),e))}applyZoomLevel(e,t){let i=r.n.indexOf(e);i+=t,i>=0&&i<r.n.length&&this.setZoomLevel(r.n[i])}get defaultLabels(){return{left:"",right:"",farRight:"subject"}}get defaultState(){return{zoomLevel:"auto",visible:!1,labels:this.defaultLabels}}}o.\u0275fac=function(e){return new(e||o)(c.qc(n.a))},o.\u0275prov=c.cc({token:o,factory:o.\u0275fac})},PvNn:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{toHsl(e){return`hsl(${this.valueHash(e)}, 50%, 50%)`}toHsla(e,t){return`hsla(${this.valueHash(e)}, 50%, 50%, ${t}%)`}valueHash(e){let t=0;for(let i=0;i<e.length;i++)t=e.charCodeAt(i)+((t<<5)-t);return t%360}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.cc({token:s,factory:s.\u0275fac,providedIn:"root"})},"PwL/":function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var n=i("iB+3"),s=i("Y/CA"),a=i("iMRi"),r=i("oqKi"),c=i("PkGb"),o=i("eyhC"),l=i("rOco"),d=i("POAS"),u=i("qc15"),h=i("pQre"),p=i("fXoL"),g=i("ofXK"),m=i("0loS"),f=i("S2zE"),b=i("/Rze"),w=i("f24R"),v=i("9pt+"),y=i("oUDv"),k=i("2orT"),C=i("711n"),j=i("ZAVI"),x=i("DLfB"),T=i("m3nR");function S(e,t){if(1&e&&(p.mc(0,"li",17),p.hc(1,"a",5),p.hc(2,"wp-watchers-count",8),p.lc()),2&e){const e=p.wc(2);p.Tb(1),p.Bc("textContent",e.text.tabs.watchers),p.Tb(1),p.Bc("wpId",e.workPackage.id)}}function _(e,t){if(1&e&&p.hc(0,"back-button",26),2&e){const e=p.wc(3);p.Bc("customBackMethod",e.backToList.bind(e))}}function P(e,t){if(1&e&&(p.mc(0,"div",18),p.hc(1,"span",19),p.hc(2,"wp-breadcrumb",20),p.mc(3,"edit-form",21),p.mc(4,"div",22),p.Yc(5,_,1,1,"back-button",23),p.mc(6,"div",24),p.hc(7,"wp-subject"),p.lc(),p.lc(),p.hc(8,"div",25),p.lc(),p.lc()),2&e){const e=p.wc(2);p.Tb(1),p.Bc("textContent",e.focusAnchorLabel),p.Tb(1),p.Bc("workPackage",e.workPackage),p.Tb(1),p.Bc("resource",e.workPackage),p.Tb(2),p.Bc("ngIf",e.showBackButton())}}function I(e,t){if(1&e&&(p.mc(0,"div",27),p.hc(1,"wp-details-toolbar",20),p.lc()),2&e){const e=p.wc(2);p.Tb(1),p.Bc("workPackage",e.workPackage)}}function O(e,t){if(1&e){const e=p.nc();p.mc(0,"div",1),p.mc(1,"div",2),p.mc(2,"ul",3),p.mc(3,"li",4),p.hc(4,"a",5),p.lc(),p.mc(5,"li",6),p.hc(6,"a",5),p.lc(),p.mc(7,"li",7),p.hc(8,"a",5),p.hc(9,"wp-relations-count",8),p.lc(),p.Yc(10,S,3,2,"li",9),p.mc(11,"li",10),p.mc(12,"accessible-by-keyboard",11),p.uc("execute",(function(){return p.Qc(e),p.wc().switchToFullscreen()})),p.lc(),p.lc(),p.mc(13,"li",10),p.mc(14,"accessible-by-keyboard",12),p.uc("execute",(function(){return p.Qc(e),p.wc().close()})),p.lc(),p.lc(),p.lc(),p.lc(),p.Yc(15,P,9,4,"div",13),p.Yc(16,I,2,1,"div",14),p.mc(17,"div",15),p.hc(18,"wp-resizer",16),p.lc(),p.lc()}if(2&e){const e=p.wc();p.Tb(4),p.Bc("textContent",e.text.tabs.overview),p.Tb(2),p.Bc("textContent",e.text.tabs.activity),p.Tb(2),p.Bc("textContent",e.text.tabs.relations),p.Tb(1),p.Bc("wpId",e.workPackage.id),p.Tb(1),p.Bc("ngIf",e.canViewWorkPackageWatchers()),p.Tb(2),p.Bc("linkAriaLabel",e.text.goTofullScreen)("linkTitle",e.text.goTofullScreen),p.Tb(2),p.Bc("linkAriaLabel",e.text.closeDetailsView)("linkTitle",e.text.closeDetailsView),p.Tb(1),p.Bc("ngIf",e.workPackage),p.Tb(1),p.Bc("ngIf",e.workPackage),p.Tb(2),p.Bc("elementClass","work-packages-partitioned-page--content-right")("localStorageKey","openProject-splitViewFlexBasis")}}class R extends l.a{constructor(e,t,i,n,s,a,r,c){super(e,r.params.workPackageId),this.injector=e,this.states=t,this.firstRoute=i,this.keepTab=n,this.wpTableSelection=s,this.wpTableFocus=a,this.$state=r,this.backRouting=c,this.baseRoute=this.$state.current.data.baseRoute}ngOnInit(){this.observeWorkPackage();let e=this.$state.params.workPackageId;if(this.wpTableFocus.focusedWorkPackage)this.wpTableFocus.updateFocus(e,!1);else{const t=this.firstRoute.name===`${this.baseRoute}.details.overview`,i=this.firstRoute.params&&e===this.firstRoute.params.workPackageI;this.wpTableFocus.updateFocus(e,t&&i)}this.wpTableSelection.isEmpty&&this.wpTableSelection.setRowState(e,!0),this.wpTableFocus.whenChanged().pipe(this.untilDestroyed()).subscribe(t=>{!(e.toString()===t.toString())&&this.$state.includes(`${this.baseRoute}.details`)&&this.$state.go(this.$state.current.name,{workPackageId:t,focus:!1})})}close(){this.$state.go(this.baseRoute,this.$state.params)}switchToFullscreen(){this.$state.go(this.keepTab.currentShowState,this.$state.params)}get shouldFocus(){return!0===this.$state.params.focus}showBackButton(){return this.baseRoute.includes("bim")}backToList(){this.backRouting.goToBaseState()}initializeTexts(){super.initializeTexts(),this.text.closeDetailsView=this.I18n.t("js.button_close_details"),this.text.goTofullScreen=this.I18n.t("js.work_packages.message_successful_show_in_fullscreen")}}R.\u0275fac=function(e){return new(e||R)(p.gc(p.A),p.gc(a.a),p.gc(r.a),p.gc(c.a),p.gc(o.a),p.gc(s.a),p.gc(n.G),p.gc(h.a))},R.\u0275cmp=p.ac({type:R,selectors:[["wp-split-view-entry"]],features:[p.Sb([{provide:d.a,useClass:u.a}]),p.Qb],decls:1,vars:1,consts:[["class","work-packages--details loading-indicator--location","data-indicator-name","wpDetails",4,"ngIf"],["data-indicator-name","wpDetails",1,"work-packages--details","loading-indicator--location"],["id","tabs"],[1,"tabrow"],["uiSref",".overview","uiSrefActive","selected"],["href","",3,"textContent"],["uiSref",".activity","uiSrefActive","selected"],["uiSref",".relations","uiSrefActive","selected"],[3,"wpId"],["uiSref",".watchers","uiSrefActive","selected",4,"ngIf"],[1,"tab-icon"],["linkClass","work-packages--details-fullscreen-icon","spanClass","icon-context icon-to-fullscreen",3,"linkAriaLabel","linkTitle","execute"],["linkClass","work-packages--details-close-icon","spanClass","icon-context icon-close",3,"linkAriaLabel","linkTitle","execute"],["class","work-packages--details-content work-packages-tab-view--overflow",4,"ngIf"],["class","work-packages--details-toolbar-container",4,"ngIf"],[1,"work-packages--details--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"],["uiSref",".watchers","uiSrefActive","selected"],[1,"work-packages--details-content","work-packages-tab-view--overflow"],["tabindex","-1","focus","shouldFocus",1,"hidden-for-sighted",3,"textContent"],[3,"workPackage"],[3,"resource"],[1,"wp-show--header-container"],["linkClass","work-packages-back-button",3,"customBackMethod",4,"ngIf"],[1,"subject-header"],["ui-view","",1,"work-package-details-tab"],["linkClass","work-packages-back-button",3,"customBackMethod"],[1,"work-packages--details-toolbar-container"]],template:function(e,t){1&e&&p.Yc(0,O,19,13,"div",0),2&e&&p.Bc("ngIf",t.workPackage)},directives:[g.q,m.UISref,m.UISrefActive,m.UISrefStatus,f.a,b.a,w.a,v.a,y.a,k.a,C.a,j.a,m.UIView,x.a,T.a],encapsulation:2,changeDetection:0})},Q2ix:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("fXoL"),s=i("wZYP"),a=i("F5Dh"),r=i("ug4p"),c=i("XNiG"),o=i("lJxs"),l=i("/uUt"),d=i("vkgz"),u=i("Kj3r"),h=i("E2tj"),p=i("FnNU"),g=i("AEvm"),m=i("3Pt+"),f=i("ofXK");class b extends g.a{constructor(e,t,i,s){super(),this.I18n=e,this.querySpace=t,this.wpTableFilters=i,this.wpCacheService=s,this.deactivateFilter=new n.s,this.text={createWithDropdown:this.I18n.t("js.work_packages.create.button"),createButton:this.I18n.t("js.label_work_package"),explanation:this.I18n.t("js.label_create_work_package"),placeholder:this.I18n.t("js.work_packages.placeholder_filter_by_text")},this.searchTerm=Object(p.f)(""),this.searchTermChanged=new c.a,this.wpTableFilters.pristine$().pipe(this.untilDestroyed(),Object(o.a)(()=>{const e=this.wpTableFilters.find("search");return e?e.values[0]:""})).subscribe(e=>{console.log("upstream "+e+" "+this.searchTerm.timestampOfLastValue),this.searchTerm.value&&!this.searchTerm.isValueOlderThan(500)||(console.log("Upstream value setting to "+e),this.searchTerm.putValue(e))}),this.searchTermChanged.pipe(this.untilDestroyed(),Object(l.a)(),Object(d.a)(e=>this.searchTerm.putValue(e)),Object(u.a)(500)).subscribe(e=>{if(e.length>0)this.wpTableFilters.replace("search",t=>{t.operator=t.findOperator("**"),t.values=[e]});else{let e=this.wpTableFilters.find("search");this.wpTableFilters.remove(e),this.deactivateFilter.emit(e)}})}}b.\u0275fac=function(e){return new(e||b)(n.gc(s.a),n.gc(h.a),n.gc(a.a),n.gc(r.a))},b.\u0275cmp=n.ac({type:b,selectors:[["wp-filter-by-text-input"]],outputs:{deactivateFilter:"deactivateFilter"},features:[n.Qb],decls:2,vars:4,consts:[["id","filter-by-text-input","type","text",3,"placeholder","ngModel","ngModelChange"]],template:function(e,t){1&e&&(n.mc(0,"input",0),n.uc("ngModelChange",(function(e){return t.searchTermChanged.next(e)})),n.xc(1,"async"),n.lc()),2&e&&(n.Cc("placeholder",t.text.placeholder),n.Bc("ngModel",n.yc(1,2,t.searchTerm.values$())))},directives:[m.c,m.m,m.p],pipes:[f.a],encapsulation:2})},Q2x2:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("4rda");class s extends n.a{isEmpty(){return _.isEmpty(this.value)}get value(){let e=this.resource[this.name];return this.schema&&e?e.elements?e.elements.map(e=>e.name):e.map?e.map(e=>e.name):e.name?[e.name]:["error: "+JSON.stringify(e)]:[]}render(e,t){const i=this.value;e.innerHTML="",e.setAttribute("title",i.join(", ")),0===i.length?this.renderEmpty(e):this.renderValues(i,e)}renderValues(e,t){const i=document.createDocumentFragment(),n=this.optionDiv(this.valueAbridged(e));if(i.appendChild(n),e.length>2){const t=this.optionDiv(e.length.toString(),"badge","-secondary");i.appendChild(t)}t.appendChild(i)}optionDiv(e,...t){const i=document.createElement("div"),s=document.createElement("span");return i.classList.add(n.b),s.classList.add(...t),s.textContent=e,i.appendChild(s),i}valueAbridged(e){const t=_.take(e,2);return e.length>2&&t.push("... "),t.join(", ")}}},Q6HB:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("Jui0"),s=i("pL6k"),a=i("g1AQ"),r=i("PtkW"),c=i("7xci"),o=i("Va5K"),l=i("fXoL");class d{constructor(e,t,i,n,s,a){this.HookService=e,this.UrlParamsHelper=t,this.wpViewRepresentation=i,this.wpViewTimeline=n,this.wpViewIndent=s,this.PathHelper=a,this.BULK_ACTIONS=[{text:I18n.t("js.work_packages.bulk_actions.edit"),key:"edit",link:"update",href:this.PathHelper.staticBase+"/work_packages/bulk/edit"},{text:I18n.t("js.work_packages.bulk_actions.move"),key:"move",link:"move",href:this.PathHelper.staticBase+"/work_packages/move/new"},{text:I18n.t("js.work_packages.bulk_actions.copy"),key:"copy",link:"copy",href:this.PathHelper.staticBase+"/work_packages/move/new?copy=true"},{text:I18n.t("js.work_packages.bulk_actions.delete"),key:"delete",link:"delete",href:this.PathHelper.staticBase+"/work_packages/bulk?_method=delete"}]}getPermittedActionLinks(e,t,i){let n=[],s=this.getAllowedActions(e,t);return s=s.concat(this.getAllowedParentActions(e)),s=s.concat(this.getAllowedRelationActions(e,i)),_.each(s,t=>{n.push({key:t.key,text:t.text,icon:t.icon,link:t.link?e[t.link].href:void 0})}),n}getIntersectOfPermittedActions(e){let t=[],i=_.filter(this.BULK_ACTIONS,t=>_.every(e,e=>this.getAllowedActions(e,[t]).length>=1));return _.each(i,i=>{t.push({key:i.key,text:i.text,link:this.getBulkActionLink(i,e)})}),t}getBulkActionLink(e,t){let i={"ids[]":t.map((function(e){return e.id}))},n=this.UrlParamsHelper.buildQueryString(i),s=e.href.split("?");return s.shift()+"?"+s.concat(new Array(n)).join("&")}getAllowedActions(e,t){let i=[];return _.each(t,t=>{t.link&&e.hasOwnProperty(t.link)&&(t.text=t.text||I18n.t("js.button_"+t.key),i.push(t))}),_.each(this.HookService.call("workPackageTableContextMenu"),t=>{if(e.hasOwnProperty(t.link)){let e=t.indexBy?t.indexBy(i):i.length;i.splice(e,0,t)}}),i}getAllowedParentActions(e){let t=[];return this.wpViewRepresentation.isList?(this.wpViewIndent.canOutdent(e)&&t.push({key:"hierarchy-outdent",icon:"icon-paragraph-left",text:I18n.t("js.relation_buttons.hierarchy_outdent")}),this.wpViewIndent.canIndent(e)&&t.push({key:"hierarchy-indent",icon:"icon-paragraph-right",text:I18n.t("js.relation_buttons.hierarchy_indent")}),t):[]}getAllowedRelationActions(e,t){let i=[];return e.addRelation&&this.wpViewTimeline.isVisible&&(i.push({key:"relation-precedes",text:I18n.t("js.relation_buttons.add_predecessor"),link:"addRelation"}),i.push({key:"relation-follows",text:I18n.t("js.relation_buttons.add_follower"),link:"addRelation"})),e.addChild&&t&&i.push({key:"relation-new-child",text:I18n.t("js.relation_buttons.add_new_child"),link:"addChild"}),i}getPermittedActions(e,t,i){return 1===e.length?this.getPermittedActionLinks(e[0],t,i):this.getIntersectOfPermittedActions(e)}}d.\u0275fac=function(e){return new(e||d)(l.qc(a.a),l.qc(s.a),l.qc(o.a),l.qc(r.a),l.qc(c.a),l.qc(n.a))},d.\u0275prov=l.cc({token:d,factory:d.\u0275fac})},QOiP:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));const n={PROPERTY:"QueryColumn::Property",RELATION_OF_TYPE:"QueryColumn::RelationOfType",RELATION_TO_TYPE:"QueryColumn::RelationToType"};function s(e){return[n.RELATION_TO_TYPE,n.RELATION_OF_TYPE].indexOf(e._type)>=0}},QihR:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("juWA"),s=i("fXoL");class a{constructor(e){this.timezoneService=e}ngOnInit(){var e=this.timezoneService.formattedDatetimeComponents(this.dateTimeValue);this.date=e[0],this.time=e[1]}}a.\u0275fac=function(e){return new(e||a)(s.gc(n.a))},a.\u0275cmp=s.ac({type:a,selectors:[["op-date-time"]],inputs:{dateTimeValue:"dateTimeValue"},decls:5,vars:4,consts:[[3,"title"],[3,"textContent"]],template:function(e,t){1&e&&(s.mc(0,"span",0),s.hc(1,"span",1),s.mc(2,"span"),s.ad(3,"\xa0"),s.lc(),s.hc(4,"span",1),s.lc()),2&e&&(s.Ec("title","",t.date," ",t.time,""),s.Tb(1),s.Bc("textContent",t.date),s.Tb(3),s.Bc("textContent",t.time))},encapsulation:2})},Qs0b:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));const n="https://www.openproject.org/enterprise-edition/?op_edtion=community-edition",s="https://www.openproject.org/enterprise-demo/"},R9pB:function(e,t,i){"use strict";function n(e=16){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i="";for(let n of new Array(e))i+=t.charAt(Math.floor(Math.random()*t.length));return i}i.d(t,"a",(function(){return n}))},RGDJ:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.backgroundClass=function(e,t){return`__hl_background_${e}_${t}`},e.inlineClass=function(e,t){return`__hl_inline_${e}_${t}`},e.colorClass=function(e,t){return e?`__hl_inline_color_${t}_text`:`__hl_inline_color_${t}_dot`},e.overdueDate=function(e){return 0===e?"__hl_date_due_today":e<=-1?"__hl_date_overdue":"__hl_date_not_overdue"},e.isBright=function(e,t,i){const n=`--hl-${t}-${i}-dark`;return""!==e.getPropertyValue(n)}}(n||(n={}))},"RN/J":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("7ond"),s=i("fXoL");class a{constructor(e,t){this.el=e,this.focusHelper=t,this.condition=!0}ngAfterContentInit(){this.condition&&setTimeout(()=>{this.focusHelper.focusElement(jQuery(this.el.nativeElement))},100)}}a.\u0275fac=function(e){return new(e||a)(s.gc(s.q),s.gc(n.a))},a.\u0275dir=s.bc({type:a,selectors:[["","autoFocus",""]],inputs:{condition:["autoFocus-condition","condition"]}})},RWlv:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{}},RhL0:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return s}));class n{constructor(){this.filterMap={}}add(e,t,i){return this.filterMap[e]={operator:t,values:i},this}remove(e){delete this.filterMap[e]}toFilterObject(e){let t={};return e.forEach(e=>{_.each(e,(e,i)=>{t[i]=e})}),t}merge(e,...t){const i=_.pickBy(this.toFilterObject(e),(e,i)=>t.includes(i));this.filterMap=Object.assign(Object.assign({},this.filterMap),i)}get filters(){let e=[];return _.each(this.filterMap,(t,i)=>{e.push({[i]:t})}),e}toJson(){return JSON.stringify(this.filters)}toParams(e={}){let t=[];t=this.filters.map(e=>this.serializeFilter(e));let i=Object.assign({filters:`[${t.join(",")}]`},e);return new URLSearchParams(i).toString()}clone(){let e=new n;return this.filters.forEach(t=>{Object.keys(t).forEach(i=>{e.add(i,t[i].operator,t[i].values)})}),e}serializeFilter(e){let t,i;i=Object.keys(e);let n=i[0],s=e[n];return t=`{"${n}":{"operator":"${s.operator}","values":[${s.values.map(e=>this.serializeFilterValue(e)).join(",")}]}}`,t}serializeFilterValue(e){return`"${e}"`}}function s(e,t,i){return(new n).add(e,t,i)}},"Rky/":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));i("72oW");var n=i("B4Ei"),s=i("pL6k"),a=i("AEvm"),r=i("fXoL");const c=["embeddedTable"];class o extends a.a{constructor(e){super(),this.queryUrlParamsHelper=e,this.hidden=!1}refreshTable(){this.embeddedTable.isInitialized&&this.embeddedTable.loadQuery(!0,!1)}handleQueryLoaded(e){if(!(this.query instanceof n.a))return;const t=this.projectValuesCount(this.query),i=this.projectValuesCount(e);null!==t&&null===i&&(this.hidden=!0),t&&i&&t>0&&0===i&&(this.hidden=!0)}projectValuesCount(e){const t=e.filters.find(e=>"project"===e.id);return t?t.values.length:null}buildQueryProps(){return this.query instanceof n.a?this.queryUrlParamsHelper.buildV3GetQueryFromQueryResource(this.query,{valid_subset:!0},{id:this.workPackage.id}):this.query}}o.\u0275fac=function(e){return new(e||o)(r.gc(s.a))},o.\u0275dir=r.bc({type:o,viewQuery:function(e,t){var i;(1&e&&r.fd(c,!0),2&e)&&(r.Nc(i=r.vc())&&(t.embeddedTable=i.first))},features:[r.Qb]})},RnhZ:function(e,t,i){var n={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-SG":"zavE","./en-SG.js":"zavE","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./ga":"USCx","./ga.js":"USCx","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it-ch":"bxKX","./it-ch.js":"bxKX","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ku":"JCF/","./ku.js":"JCF/","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function s(e){var t=a(e);return i(t)}function a(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=a,e.exports=s,s.id="RnhZ"},RuUM:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("wZYP"),s=i("d/TE"),a=i("XNiG"),r=i("qc15"),c=i("fXoL");class o{constructor(e,t,i){this.I18n=e,this.workPackageNotificationService=t,this.NotificationsService=i,this.quoteEvents=new a.a}createComment(e,t){return e.addComment({comment:t},{"Content-Type":"application/json; charset=UTF-8"}).catch(t=>this.errorAndReject(t,e))}updateComment(e,t){JSON.stringify({comment:t});return e.update({comment:t},{"Content-Type":"application/json; charset=UTF-8"}).then(e=>(this.NotificationsService.addSuccess(this.I18n.t("js.work_packages.comment_updated")),e)).catch(e=>this.errorAndReject(e))}errorAndReject(e,t){return this.workPackageNotificationService.handleRawError(e,t),Promise.reject(e)}}o.\u0275fac=function(e){return new(e||o)(c.qc(n.a),c.qc(r.a),c.qc(s.a))},o.\u0275prov=c.cc({token:o,factory:o.\u0275fac})},S2zE:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("uSJ+"),s=i("ug4p"),a=i("itXk"),r=i("AEvm"),c=i("fXoL"),o=i("ofXK");function l(e,t){if(1&e&&c.hc(0,"span",1),2&e){const e=c.wc();c.Bc("textContent",e.count)}}class d extends r.a{constructor(e,t){super(),this.wpCacheService=e,this.wpRelations=t,this.count=0}ngOnInit(){this.wpRelations.require(this.wpId.toString()),Object(a.a)(this.wpRelations.state(this.wpId.toString()).values$(),this.wpCacheService.loadWorkPackage(this.wpId.toString()).values$()).pipe(this.untilDestroyed()).subscribe(([e,t])=>{let i=_.size(e),n=_.size(t.children);this.count=i+n})}}d.\u0275fac=function(e){return new(e||d)(c.gc(s.a),c.gc(n.a))},d.\u0275cmp=c.ac({type:d,selectors:[["wp-relations-count"]],inputs:{wpId:"wpId"},features:[c.Qb],decls:1,vars:1,consts:[["class","wp-tabs-count",3,"textContent",4,"ngIf"],[1,"wp-tabs-count",3,"textContent"]],template:function(e,t){1&e&&c.Yc(0,l,1,1,"span",0),2&e&&c.Bc("ngIf",t.count>0)},directives:[o.q],encapsulation:2})},SIjI:function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var n=i("fXoL"),s=(i("ii2/"),i("cd/7")),a=i("Jui0"),r=i("RGDJ"),c=i("iB+3"),o=i("eyhC"),l=i("WW/2"),d=i("wZYP"),u=i("AEvm"),h=i("Y/CA"),p=i("2G+H"),g=i("ofXK"),m=i("kor4"),f=i("N5AO"),b=i("711n"),w=i("80WE"),v=i("0loS"),y=i("K8b8"),k=i("u8Ab");function C(e,t){if(1&e){const e=n.nc();n.mc(0,"a",7),n.uc("accessibleClick",(function(){n.Qc(e);const t=n.wc();return t.openSplitScreen(t.workPackage)})),n.hc(1,"op-icon",8),n.lc()}if(2&e){const e=n.wc();n.Bc("title",e.text.detailsView)}}const j=function(e){return{"-show":e}};function x(e,t){if(1&e){const e=n.nc();n.mc(0,"a",9),n.uc("accessibleClick",(function(){n.Qc(e);const t=n.wc();return t.onRemoved(t.workPackage)})),n.hc(1,"op-icon",10),n.lc()}if(2&e){const e=n.wc();n.Bc("ngClass",n.Gc(2,j,e.workPackage.isNew))("title",e.text.removeCard)}}function T(e,t){if(1&e&&(n.mc(0,"edit-form",11),n.mc(1,"div",12),n.hc(2,"editable-attribute-field",13),n.hc(3,"editable-attribute-field",14),n.lc(),n.lc()),2&e){const e=n.wc();n.Bc("resource",e.workPackage)("inEditMode",e.workPackage.isNew),n.Tb(2),n.Bc("resource",e.workPackage)("wrapperClasses","work-packages--type-selector")("fieldName","type"),n.Tb(1),n.Bc("resource",e.workPackage)}}function S(e,t){if(1&e&&n.hc(0,"img",23),2&e){const e=n.wc(2);n.Bc("src",e.bcfSnapshotPath(e.workPackage),n.Tc)}}function _(e,t){if(1&e&&n.hc(0,"wp-status-button",24),2&e){const e=n.wc(2);n.Bc("workPackage",e.workPackage)}}function P(e,t){if(1&e&&n.hc(0,"user-avatar",25),2&e){const e=n.wc(2);n.Bc("user",e.workPackage.assignee)}}const I=function(e){return{workPackageId:e}};function O(e,t){if(1&e&&(n.mc(0,"div",15),n.hc(1,"span",16),n.hc(2,"span",17),n.mc(3,"a",18),n.ad(4),n.lc(),n.hc(5,"span",19),n.Yc(6,S,1,1,"img",20),n.Yc(7,_,1,1,"wp-status-button",21),n.Yc(8,P,1,1,"user-avatar",22),n.lc()),2&e){const e=n.wc();n.Tb(1),n.Bc("textContent",e.wpProjectName(e.workPackage)),n.Tb(1),n.Bc("textContent",e.wpTypeAttribute(e.workPackage))("ngClass",e.typeHighlightingClass(e.workPackage)),n.Tb(1),n.Bc("uiParams",n.Gc(10,I,e.workPackage.id))("ngClass",e.uiStateLinkClass),n.Tb(1),n.cd(" #",e.workPackage.id," "),n.Tb(1),n.Bc("textContent",e.wpSubject(e.workPackage)),n.Tb(1),n.Bc("ngIf",e.cardCoverImageShown(e.workPackage)),n.Tb(1),n.Bc("ngIf",e.showStatusButton),n.Tb(1),n.Bc("ngIf",e.workPackage.assignee)}}class R extends u.a{constructor(e,t,i,a,r,c,o){super(),this.pathHelper=e,this.I18n=t,this.$state=i,this.wpTableSelection=a,this.wpTableFocus=r,this.cardView=c,this.cdRef=o,this.showInfoButton=!1,this.showStatusButton=!0,this.showRemoveButton=!1,this.highlightingMode="inline",this.draggable=!1,this.orientation="vertical",this.shrinkOnMobile=!1,this.onRemove=new n.s,this.uiStateLinkClass=s.c,this.text={removeCard:this.I18n.t("js.card.remove_from_list"),detailsView:this.I18n.t("js.button_open_details")}}ngOnInit(){this.wpTableSelection.live$().pipe(this.untilDestroyed()).subscribe(()=>{this.cdRef.detectChanges()})}classIdentifier(e){return this.cardView.classIdentifier(e)}openSplitScreen(e){let t=this.classIdentifier(e);this.wpTableSelection.setSelection(e.id,this.cardView.findRenderedCard(t)),this.wpTableFocus.updateFocus(e.id),this.$state.go(Object(p.a)(this.$state),{workPackageId:e.id})}cardClasses(){let e=this.isSelected(this.workPackage)?s.b:"";return e+=this.draggable?" -draggable":"",e+=this.workPackage.isNew?" -new":"",e+=" wp-card-"+this.workPackage.id,e+=" -"+this.orientation,e+=this.shrinkOnMobile?" -shrink":"",e}wpTypeAttribute(e){return e.type.name}wpSubject(e){return e.subject}wpProjectName(e){var t;return null===(t=e.project)||void 0===t?void 0:t.name}cardHighlightingClass(e){return this.cardHighlighting(e)}typeHighlightingClass(e){return this.attributeHighlighting("type",e)}onRemoved(e){this.onRemove.emit(e)}cardCoverImageShown(e){return null!==this.bcfSnapshotPath(e)}bcfSnapshotPath(e){return e.bcfViewpoints&&e.bcfViewpoints.length>0?e.bcfViewpoints[0].href+"/snapshot":null}isSelected(e){return this.wpTableSelection.isSelected(e.id)}cardHighlighting(e){return["status","priority","type"].includes(this.highlightingMode)?r.a.backgroundClass(this.highlightingMode,e[this.highlightingMode].id):""}attributeHighlighting(e,t){return r.a.inlineClass(e,t.type.id)}}R.\u0275fac=function(e){return new(e||R)(n.gc(a.a),n.gc(d.a),n.gc(c.G),n.gc(o.a),n.gc(h.a),n.gc(l.a),n.gc(n.i))},R.\u0275cmp=n.ac({type:R,selectors:[["wp-single-card"]],inputs:{workPackage:"workPackage",showInfoButton:"showInfoButton",showStatusButton:"showStatusButton",showRemoveButton:"showRemoveButton",highlightingMode:"highlightingMode",draggable:"draggable",orientation:"orientation",shrinkOnMobile:"shrinkOnMobile"},outputs:{onRemove:"onRemove"},features:[n.Qb],decls:7,vars:6,consts:[[1,"wp-card",3,"ngClass"],[1,"wp-card--highlighting",3,"ngClass"],[1,"wp-card--inline-buttons","hidden-for-mobile"],["class","wp-card--details-button -no-decoration",3,"title","accessibleClick",4,"ngIf"],["class","wp-card--inline-cancel-button -no-decoration",3,"ngClass","title","accessibleClick",4,"ngIf"],[3,"resource","inEditMode",4,"ngIf"],["class","wp-card--content",4,"ngIf"],[1,"wp-card--details-button","-no-decoration",3,"title","accessibleClick"],["icon-classes","icon icon-info2"],[1,"wp-card--inline-cancel-button","-no-decoration",3,"ngClass","title","accessibleClick"],["icon-classes","icon icon-close"],[3,"resource","inEditMode"],[1,"wp-card--content","-new"],[1,"wp-card--type",3,"resource","wrapperClasses","fieldName"],["fieldName","subject",1,"wp-card--subject","-bold",3,"resource"],[1,"wp-card--content"],[1,"wp-card--project-name",3,"textContent"],[1,"wp-card--type",3,"textContent","ngClass"],["uiSref","work-packages.show",1,"wp-card--id",3,"uiParams","ngClass"],[1,"wp-card--subject",3,"textContent"],["class","wp-card--cover-image",3,"src",4,"ngIf"],["class","wp-card--status",3,"workPackage",4,"ngIf"],["data-class-list","avatar-mini","class","wp-card--assignee",3,"user",4,"ngIf"],[1,"wp-card--cover-image",3,"src"],[1,"wp-card--status",3,"workPackage"],["data-class-list","avatar-mini",1,"wp-card--assignee",3,"user"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.hc(1,"div",1),n.mc(2,"div",2),n.Yc(3,C,2,1,"a",3),n.Yc(4,x,2,4,"a",4),n.lc(),n.Yc(5,T,4,6,"edit-form",5),n.Yc(6,O,9,12,"div",6),n.lc()),2&e&&(n.Bc("ngClass",t.cardClasses()),n.Tb(1),n.Bc("ngClass",t.cardHighlightingClass(t.workPackage)),n.Tb(2),n.Bc("ngIf",!t.workPackage.isNew&&t.showInfoButton),n.Tb(1),n.Bc("ngIf",t.workPackage.isNew||t.showRemoveButton),n.Tb(1),n.Bc("ngIf",t.workPackage.isNew),n.Tb(1),n.Bc("ngIf",!t.workPackage.isNew))},directives:[g.n,g.q,m.a,f.a,b.a,w.a,v.AnchorUISref,v.UISref,y.a,k.a],styles:['.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.wp-card[_ngcontent-%COMP%]{display:flex;-webkit-user-select:none;user-select:none;width:100%;border:1px solid var(--widget-box-block-border-color);border-radius:2px;padding:10px;position:relative;box-shadow:1px 1px 3px 0 #d3d3d3;background:var(--body-background);font-size:var(--card-font-size);max-width:400px}.wp-card[_ngcontent-%COMP%]:hover{box-shadow:0 0 10px #d3d3d3}.wp-card.-new[_ngcontent-%COMP%]{padding-right:25px}.wp-card.-checked[_ngcontent-%COMP%]{background-color:var(--table-row-highlighting-color)}.wp-card.-horizontal[_ngcontent-%COMP%]{height:100%}.wp-card.-vertical[_ngcontent-%COMP%]{margin-top:10px}.wp-card.-vertical[_ngcontent-%COMP%]:last-of-type{margin-bottom:5px}wp-single-card.gu-transit[_nghost-%COMP%]   .wp-card[_ngcontent-%COMP%]{border:1px dashed var(--primary-color);pointer-events:none}wp-single-card.gu-transit[_nghost-%COMP%]   .wp-card[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{visibility:hidden}.wp-card--content[_ngcontent-%COMP%]:not(.-new){display:grid;grid-template-columns:auto 1fr auto;grid-template-rows:auto auto auto 1fr auto;grid-row-gap:10px;grid-template-areas:"project project project" "type type type" "subject subject subject" "image image image" "attributeTag avatar idlink";overflow:hidden;flex-grow:1}.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--project-name[_ngcontent-%COMP%]{grid-area:project;font-style:italic;color:var(--gray-dark);font-size:12px;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis}.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--type[_ngcontent-%COMP%]{grid-area:type}.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--subject[_ngcontent-%COMP%]{grid-area:subject;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis}.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--assignee[_ngcontent-%COMP%]{grid-area:avatar;place-self:center left}.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--id[_ngcontent-%COMP%]{grid-area:idlink;place-self:center right}.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--status[_ngcontent-%COMP%]{grid-area:attributeTag;max-width:120px;margin-right:5px;overflow:hidden}.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--cover-image[_ngcontent-%COMP%]{grid-area:image;max-height:350px}@media screen and (max-width:679px){.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--cover-image[_ngcontent-%COMP%]{max-height:250px}}.wp-card--highlighting[_ngcontent-%COMP%]{width:5px;height:100%;position:absolute;top:0;left:0;border-radius:2px 0 0 2px}.wp-card--inline-buttons[_ngcontent-%COMP%]{position:absolute;right:0;top:5px;opacity:0}.wp-card--inline-buttons.-show[_ngcontent-%COMP%], .wp-card[_ngcontent-%COMP%]:hover   .wp-card--inline-buttons[_ngcontent-%COMP%]{opacity:1}@media only screen and (max-width:679px){.wp-card[_ngcontent-%COMP%]{max-width:none}.wp-card.-shrink[_ngcontent-%COMP%]{border:none;box-shadow:none;padding:15px}}'],changeDetection:0})},SJoB:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("mrSG"),s=i("eyhC"),a=i("iB+3"),r=i("r0MM");class c{constructor(e,t){this.injector=e}get EVENT(){return"dblclick.cardView.card"}get SELECTOR(){return".wp-card"}eventScope(e){return jQuery(e.container.nativeElement)}handleEvent(e,t){let i=jQuery(t.target);if(i.is("a")||i.parent().is("a"))return!0;let n=i.closest("wp-single-card").data("workPackageId");return!n||(this.handleWorkPackage(n),!1)}handleWorkPackage(e){this.$state.go("work-packages.show",{workPackageId:e})}}Object(n.c)([Object(r.a)(),Object(n.e)("design:type",a.G)],c.prototype,"$state",void 0),Object(n.c)([Object(r.a)(),Object(n.e)("design:type",s.a)],c.prototype,"wpTableSelection",void 0)},SKFm:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("mrSG"),s=i("FnNU"),a=i("pLZG"),r=i("lJxs"),c=i("XNiG"),o=i("GntA"),l=i("UD+K"),d=i("g1AQ"),u=i("/C7M"),h=i("fXoL");class p extends s.a{constructor(){super(),this.name="Changesets",this.changesets=Object(s.g)(),this.initializeMembers()}}class g{constructor(e,t){this.wasNew=!1,this.id=t.id.toString(),this.wasNew=e.pristineResource.isNew,this.resource=t,this.changes=e.changeMap}}class m extends l.a{constructor(e,t,i){super(),this.injector=e,this.halEvents=t,this.hook=i,this.comittedChanges=new c.a,this.stateGroup=new p}save(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=yield e.buildRequestPayload(),i=yield e.pristineResource.$links.updateImmediately(t);return i.retainFrom(e.pristineResource),yield this.onSaved(i),this.complete(e,i)}))}complete(e,t){const i=new g(e,t);this.comittedChanges.next(i),this.reset(e);const n=i.wasNew?"created":"updated";return this.halEvents.push(i.resource,{eventType:n,commit:i}),i}reset(e){e.clear(),this.clearSome(e.href)}typedState(e){return this.multiState.get(e.href)}edit(e,t){const i=this.multiState.get(e.href),n=this.newChangeset(e,i,t);return i.putValue(n),n}newChangeset(e,t,i){return new(this.hook.call("halResourceChangesetClass",e).pop()||o.a)(e,t,i)}changeFor(e){const t=this.multiState.get(e.href);let i=e;e.state&&(i=e.state.getValueOr(e));let n=t.value;return n&&!n.isEmpty()?n:n?i.hasOwnProperty("lockVersion")&&n.pristineResource.lockVersion<i.lockVersion?this.edit(i):(n.updatePristineResource(i),n):this.edit(i)}temporaryEditResource(e){const t=Object(s.b)(e.state,this.typedState(e));return Object(s.d)(t,e=>e.pipe(Object(a.a)(([e,t])=>!!e),Object(r.a)(([e,t])=>t?(t.updatePristineResource(e),t.projectedResource):e)))}stopEditing(e){this.multiState.get(e.href).clear()}load(e){return Promise.reject("Loading not applicable for changesets.")}onSaved(e){return e.state?e.push(e):Promise.resolve()}loadAll(e){return Promise.all(e.map(e=>this.load(e)))}get multiState(){return this.stateGroup.changesets}}m.\u0275fac=function(e){return new(e||m)(h.qc(h.A),h.qc(u.a),h.qc(d.a))},m.\u0275prov=h.cc({token:m,factory:m.\u0275fac})},SU55:function(e,t){!function(e){"use strict";e((function(){e("[data-selected-page].tree-menu--container").each((function(t,i){let n=e(i).data("selected-page");n&&e("[slug="+n+"]",i).toggleClass("-selected",!0)})),e(".pages-hierarchy.-with-hierarchy .tree-menu--hierarchy-span").on("click keypress",(function(t){return"keypress"===t.type&&13!==t.which||e(t.target).closest("ul.-with-hierarchy > li").toggleClass("-hierarchy-collapsed -hierarchy-expanded"),!1}))}))}(jQuery)},SgrZ:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));i("AA01");var n=i("59tY"),s=i("wZYP"),a=i("Y41n"),r=i("juWA"),c=i("Hg4z"),o=i("fXoL"),l=i("ecJW"),d=i("oUDv"),u=i("ofXK"),h=i("N5AO");function p(e,t){if(1&e&&(o.mc(0,"span",5),o.hc(1,"op-icon",6),o.lc()),2&e){const e=o.wc();o.Ub("data-tooltip",e.timeZoneText)}}class g extends n.a{constructor(e,t){super(e,t),this.I18n=e,this.timezoneService=t,this.shouldFocus=!1,this.filterChanged=new a.a(Object(c.b)(this)),this.text={spacer:this.I18n.t("js.filter.value_spacer")}}get begin(){return this.filter.values[0]}set begin(e){this.filter.values[0]=e||"",this.filterChanged.emit(this.filter)}get end(){return this.filter.values[1]}set end(e){this.filter.values[1]=e||"",this.filterChanged.emit(this.filter)}get lowerBoundary(){return this.begin&&this.timezoneService.isValidISODateTime(this.begin.toString())?this.timezoneService.parseDatetime(this.begin.toString()):null}get upperBoundary(){return this.end&&this.timezoneService.isValidISODateTime(this.end.toString())?this.timezoneService.parseDatetime(this.end.toString()):null}}g.\u0275fac=function(e){return new(e||g)(o.gc(s.a),o.gc(r.a))},g.\u0275cmp=o.ac({type:g,selectors:[["filter-date-times-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[o.Qb],decls:5,vars:10,consts:[[1,"inline-label",3,"id"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","focus","id","name","onChange"],[1,"advanced-filters--affix",3,"textContent"],["classes","advanced-filters--date-field","size","10",3,"initialDate","id","name","onChange"],["class","advanced-filters--tooltip-trigger -multiline",4,"ngIf"],[1,"advanced-filters--tooltip-trigger","-multiline"],["icon-classes","icon icon-warning"]],template:function(e,t){1&e&&(o.mc(0,"div",0),o.mc(1,"op-date-picker",1),o.uc("onChange",(function(e){return t.begin=t.isoDateParser(e)})),o.lc(),o.hc(2,"span",2),o.mc(3,"op-date-picker",3),o.uc("onChange",(function(e){return t.end=t.isoDateParser(e)})),o.lc(),o.Yc(4,p,2,1,"span",4),o.lc()),2&e&&(o.Dc("id","div-values-",t.filter.id,""),o.Tb(1),o.Bc("initialDate",t.isoDateFormatter(t.begin))("focus",t.shouldFocus)("id","values-"+t.filter.id+"-begin")("name","v["+t.filter.id+"]-begin"),o.Tb(1),o.Bc("textContent",t.text.spacer),o.Tb(1),o.Bc("initialDate",t.isoDateFormatter(t.end))("id","values-"+t.filter.id+"-end")("name","v["+t.filter.id+"]-end"),o.Tb(1),o.Bc("ngIf",t.isTimeZoneDifferent))},directives:[l.a,d.a,u.q,h.a],encapsulation:2})},SqdZ:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(e,t,i){this.locals=e,this.cdRef=t,this.elementRef=i,this.closeOnEscape=!0,this.closeOnEscapeFunction=this.closeMe,this.closeOnOutsideClick=!0,this.service=this.locals.service,this.closingEvent=new n.s,this.openingEvent=new n.s}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement)}ngOnDestroy(){this.closingEvent.complete(),this.openingEvent.complete()}onClose(){return this.afterFocusOn&&this.afterFocusOn.focus(),!0}closeMe(e){this.service.close(),e&&(e.stopPropagation(),e.preventDefault())}onOpen(e){this.openingEvent.emit(),this.cdRef.detectChanges()}get afterFocusOn(){return this.$element}}s.\u0275fac=function(e){n.tc()},s.\u0275dir=n.bc({type:s})},Sulb:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("mrSG"),s=i("2Vo4"),a=i("wZYP"),r=i("sjKJ"),c=i("K247"),o=i("r0MM"),l=i("fXoL");class d{constructor(e,t,i){this.I18n=e,this.injector=t,this.deviceService=i,this.elementMinWidth=11,this.defaultWidth=230,this.localStorageKey="openProject-mainMenuWidth",this.localStorageStateKey="openProject-mainMenuCollapsed",this.global=window,this.htmlNode=document.getElementsByTagName("html")[0],this.mainMenu=jQuery("#main-menu")[0],this.hideElements=jQuery(".can-hide-navigation"),this.titleData=new s.a(""),this.titleData$=this.titleData.asObservable(),this.changeData=new s.a({}),this.changeData$=this.changeData.asObservable()}initializeMenu(){if(!this.mainMenu)return;this.elementWidth=parseInt(window.OpenProject.guardedLocalStorage(this.localStorageKey));const e=window.OpenProject.guardedLocalStorage(this.localStorageStateKey);this.elementWidth?e&&JSON.parse(e)?this.closeMenu():this.setWidth():this.saveWidth(this.mainMenu.offsetWidth);let t=this.injector.get(r.a);(jQuery(document.body).hasClass("controller-my")&&0===this.elementWidth||null===t.id)&&this.saveWidth(this.defaultWidth),this.closeWhenOnMobile()}toggleNavigation(e){if(e&&(e.stopPropagation(),e.preventDefault()),this.showNavigation)this.closeMenu();else if(this.deviceService.isMobile)this.setWidth(window.innerWidth);else{const e=parseInt(window.OpenProject.guardedLocalStorage(this.localStorageKey)),t=e>=this.elementMinWidth?e:this.defaultWidth;this.saveWidth(t)}setTimeout((function(){jQuery('#main-menu [class*="-menu-item"]:visible').first().focus()}),500)}closeMenu(){this.setWidth(0),window.OpenProject.guardedLocalStorage(this.localStorageStateKey,"true"),jQuery(".wp-query-menu--search-input").blur()}closeWhenOnMobile(){this.deviceService.isMobile&&(this.closeMenu(),window.OpenProject.guardedLocalStorage(this.localStorageStateKey,"false"))}saveWidth(e){this.setWidth(e),window.OpenProject.guardedLocalStorage(this.localStorageKey,String(this.elementWidth)),window.OpenProject.guardedLocalStorage(this.localStorageStateKey,String(0===this.elementWidth))}setWidth(e){if(void 0!==e){let t=this.deviceService.isMobile?window.innerWidth-120:window.innerWidth-520;this.elementWidth=e>t?t:e}this.snapBack(),this.setToggleTitle(),this.toggleClassHidden(),this.global.showNavigation=this.showNavigation,this.htmlNode.style.setProperty("--main-menu-width",this.elementWidth+"px");let t=jQuery.Event("change");jQuery("#content-wrapper").on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",()=>{this.changeData.next(t)})}get showNavigation(){return this.elementWidth>=this.elementMinWidth}snapBack(){this.elementWidth<this.elementMinWidth&&(this.elementWidth=0)}setToggleTitle(){this.showNavigation?this.toggleTitle=this.I18n.t("js.label_hide_project_menu"):this.toggleTitle=this.I18n.t("js.label_expand_project_menu"),this.titleData.next(this.toggleTitle)}toggleClassHidden(){this.hideElements.toggleClass("hidden-navigation",!this.showNavigation)}}d.\u0275fac=function(e){return new(e||d)(l.qc(a.a),l.qc(l.A),l.qc(c.a))},d.\u0275prov=l.cc({token:d,factory:d.\u0275fac,providedIn:"root"}),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",r.a)],d.prototype,"currentProject",void 0)},T9ri:function(e,t,i){"use strict";function n(e){let t=e.value||"nullValue";if(e.href)try{t+=e.href.map(e=>e.href).join("-")}catch(i){console.error("Failed to extract group identifier for "+e.value)}return t=t.toLowerCase().replace(/[^a-z0-9]+/g,"-"),`${a(e)}-${t}`}function s(e){let t=e.value;return null===t?"-":t}function a(e){return e._links.groupBy.href.split("/").pop()}function r(e){return`__row-group-${e}`}i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return s})),i.d(t,"a",(function(){return a})),i.d(t,"d",(function(){return r}))},TAxG:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("fXoL"),s=i("wZYP"),a=(i("AA01"),i("3Pt+")),r=i("oUDv"),c=i("ofXK");function o(e,t){if(1&e&&n.hc(0,"option",4),2&e){const e=n.wc();n.Bc("textContent",e.text.placeholder)}}function l(e,t){if(1&e&&n.hc(0,"option",5),2&e){const e=t.$implicit,i=n.wc();n.Bc("textContent",i.text[e])("ngValue",e)}}class d{constructor(e){this.I18n=e,this.shouldFocus=!1,this.filterChanged=new n.s,this.text={placeholder:this.I18n.t("js.placeholders.selection"),true:this.I18n.t("js.general_text_Yes"),false:this.I18n.t("js.general_text_No")}}get value(){return this.filter.values[0]}set value(e){this.filter.values[0]=e,this.filterChanged.emit(this.filter)}get hasNoValue(){return _.isEmpty(this.filter.values)}get availableOptions(){return[!0,!1]}}d.\u0275fac=function(e){return new(e||d)(n.gc(s.a))},d.\u0275cmp=n.ac({type:d,selectors:[["filter-boolean-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},decls:4,vars:7,consts:[[3,"id"],[1,"advanced-filters--select-field",3,"ngModel","focus","id","name","ngModelChange"],["value","","disabled","",3,"textContent",4,"ngIf"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],["value","","disabled","",3,"textContent"],[3,"textContent","ngValue"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"select",1),n.uc("ngModelChange",(function(e){return t.value=e})),n.Yc(2,o,1,1,"option",2),n.Yc(3,l,1,2,"option",3),n.lc(),n.lc()),2&e&&(n.Dc("id","div-values-",t.filter.name,""),n.Tb(1),n.Dc("id","values-",t.filter.name,""),n.Dc("name","v[",t.filter.name,"]"),n.Bc("ngModel",t.value)("focus",t.shouldFocus),n.Tb(1),n.Bc("ngIf",t.hasNoValue),n.Tb(1),n.Bc("ngForOf",t.availableOptions))},directives:[a.y,a.m,a.p,r.a,c.q,c.p,a.r,a.B],encapsulation:2})},TKcc:function(e,t,i){var n={"./apl/apl.js":["4kmW",0,26],"./asciiarmor/asciiarmor.js":["Jt+K",0,27],"./asn.1/asn.1.js":["0OHD",0,28],"./asterisk/asterisk.js":["yGjk",0,29],"./brainfuck/brainfuck.js":["oF4/",0,30],"./clike/clike.js":["S6bl",0,5],"./clojure/clojure.js":["LA1u",0,31],"./cmake/cmake.js":["qE+Q",0,32],"./cobol/cobol.js":["JNJg",0,33],"./coffeescript/coffeescript.js":["oL3q",0,1],"./commonlisp/commonlisp.js":["kmAK",0,34],"./crystal/crystal.js":["JRJP",0,35],"./css/css.js":["ewDg",0,3],"./cypher/cypher.js":["vW+e",0,36],"./d/d.js":["zRyg",0,37],"./dart/dart.js":["6q/U",0,5,38],"./diff/diff.js":["3fnu",0,39],"./django/django.js":["SzTn",0,2,3,1,17],"./dockerfile/dockerfile.js":["R6x9",0,1,40],"./dtd/dtd.js":["/YIB",0,41],"./dylan/dylan.js":["PLH4",0,42],"./ebnf/ebnf.js":["AvIz",0,43],"./ecl/ecl.js":["rSpl",0,44],"./eiffel/eiffel.js":["t86p",0,45],"./elm/elm.js":["Rba3",0,46],"./erlang/erlang.js":["9RTS",0,47],"./factor/factor.js":["yv4w",0,1,48],"./fcl/fcl.js":["xvvs",0,49],"./forth/forth.js":["CDkR",0,50],"./fortran/fortran.js":["UYub",0,51],"./gas/gas.js":["Upog",0,52],"./gfm/gfm.js":["RKCW",0,7,1,53],"./gherkin/gherkin.js":["tkAH",0,54],"./go/go.js":["T/QY",0,55],"./groovy/groovy.js":["X7TR",0,56],"./haml/haml.js":["c+b1",0,2,3,1,18],"./handlebars/handlebars.js":["4d6s",0,1],"./haskell-literate/haskell-literate.js":["INem",0,1,57],"./haskell/haskell.js":["0+DK",0,1],"./haxe/haxe.js":["We/1",0,58],"./htmlembedded/htmlembedded.js":["dLt8",0,2,3,1,19],"./htmlmixed/htmlmixed.js":["1p+/",0,2,3,24],"./http/http.js":["scEK",0,59],"./idl/idl.js":["HqpV",0,60],"./javascript/javascript.js":["+dQi",0,2],"./jinja2/jinja2.js":["ToA7",0,61],"./jsx/jsx.js":["onn/",0,2,25],"./julia/julia.js":["NGrM",0,62],"./livescript/livescript.js":["5RX+",0,63],"./lua/lua.js":["jrMQ",0,64],"./markdown/markdown.js":["lZu9",0,7],"./mathematica/mathematica.js":["ztbM",0,65],"./mbox/mbox.js":["6mA5",0,66],"./mirc/mirc.js":["o5kb",0,67],"./mllike/mllike.js":["NU+Z",0,68],"./modelica/modelica.js":["lQiH",0,69],"./mscgen/mscgen.js":["6gTk",0,70],"./mumps/mumps.js":["Q7su",0,71],"./nginx/nginx.js":["srmC",0,72],"./nsis/nsis.js":["bYLO",0,1,73],"./ntriples/ntriples.js":["PWBO",0,74],"./octave/octave.js":["mybg",0,75],"./oz/oz.js":["yhmh",0,76],"./pascal/pascal.js":["lB9V",0,77],"./pegjs/pegjs.js":["ZGb1",0,2,78],"./perl/perl.js":["kG+r",0,79],"./php/php.js":["RNWO",0,2,3,5,20],"./pig/pig.js":["860+",0,80],"./powershell/powershell.js":["naPG",0,81],"./properties/properties.js":["3Fvf",0,82],"./protobuf/protobuf.js":["cHwl",0,83],"./pug/pug.js":["W+/v",0,2,3,6],"./puppet/puppet.js":["cwoo",0,84],"./python/python.js":["25Eh",0,1],"./q/q.js":["MiqB",0,85],"./r/r.js":["kD6b",0,86],"./rpm/rpm.js":["Qs4+",0,87],"./rst/rst.js":["jIQM",0,1,88],"./ruby/ruby.js":["hTYL",0,1],"./rust/rust.js":["sY4N",0,1,89],"./sas/sas.js":["Sh3j",0,90],"./sass/sass.js":["G2Pi",0,3,1],"./scheme/scheme.js":["8wdy",0,91],"./shell/shell.js":["AvDn",0,92],"./sieve/sieve.js":["1dRh",0,93],"./slim/slim.js":["VI2i",0,2,3,1,21],"./smalltalk/smalltalk.js":["n4Nj",0,94],"./smarty/smarty.js":["QWhe",0,95],"./solr/solr.js":["xhF3",0,96],"./soy/soy.js":["vH+N",0,2,3,22],"./sparql/sparql.js":["++e5",0,97],"./spreadsheet/spreadsheet.js":["bEWP",0,98],"./sql/sql.js":["/9rB",0,99],"./stex/stex.js":["+NIl",0,1],"./stylus/stylus.js":["dtKC",0,8],"./swift/swift.js":["wOIU",0,100],"./tcl/tcl.js":["BEBj",0,101],"./textile/textile.js":["TD3l",0,102],"./tiddlywiki/tiddlywiki.js":["9+NH",0,103],"./tiki/tiki.js":["Km7L",0,104],"./toml/toml.js":["0sou",0,105],"./tornado/tornado.js":["xbNY",0,2,3,1,23],"./troff/troff.js":["s1o1",0,106],"./ttcn-cfg/ttcn-cfg.js":["hmTv",0,107],"./ttcn/ttcn.js":["TYrp",0,108],"./turtle/turtle.js":["P3N9",0,109],"./twig/twig.js":["SII/",0,1,110],"./vb/vb.js":["Kr55",0,111],"./vbscript/vbscript.js":["axah",0,112],"./velocity/velocity.js":["/kYp",0,113],"./verilog/verilog.js":["m2bc",0,114],"./vhdl/vhdl.js":["PP56",0,115],"./vue/vue.js":["aT2M",0,2,3,8,6,1,116],"./webidl/webidl.js":["PVgs",0,117],"./xml/xml.js":["1eCo",0,118],"./xquery/xquery.js":["bJEP",0,119],"./yacas/yacas.js":["WThJ",0,120],"./yaml-frontmatter/yaml-frontmatter.js":["0gIM",0,1,121],"./yaml/yaml.js":["ztCB",0,1],"./z80/z80.js":["dRHf",0,122]};function s(e){if(!i.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],s=t[0];return Promise.all(t.slice(1).map(i.e)).then((function(){return i.t(s,7)}))}s.keys=function(){return Object.keys(n)},s.id="TKcc",e.exports=s},TM9v:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=[{key:"log_time",link:"logTime",resource:"workPackage"},{key:"change_project",icon:"icon-move",link:"move",resource:"workPackage"},{key:"copy",link:"copy",resource:"workPackage"},{key:"delete",link:"delete",resource:"workPackage"},{key:"export-pdf",link:"pdf",resource:"workPackage"},{key:"export-atom",link:"atom",resource:"workPackage"}]},TTfU:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("kTsZ"),s=i("Jui0"),a=i("fXoL");class r{constructor(e,t){this.halResourceService=e,this.pathHelper=t}load(e){const t=this.pathHelper.api.v3.users.id(e).toString();return this.halResourceService.get(t).toPromise()}}r.\u0275fac=function(e){return new(e||r)(a.qc(n.a),a.qc(s.a))},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac})},Tac9:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("IaZ+"),s=i("TrTv"),a=i("SqdZ"),r=i("wZYP"),c=i("fXoL"),o=i("ofXK"),l=i("3Pt+");const d=["selectedPageInput"];function u(e,t){if(1&e){const e=c.nc();c.mc(0,"a",18),c.mc(1,"i",19),c.uc("click",(function(t){return c.Qc(e),c.wc().closeMe(t)})),c.lc(),c.lc()}if(2&e){const e=c.wc();c.Tb(1),c.Ub("title",e.text.close_popup)}}class h extends a.a{constructor(e,t,i,n){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.I18n=n,this.changed=!1,this.showClose=!0,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.page="",this.text={title:this.I18n.t("js.editor.macro.wiki_page_include.button"),hint:this.I18n.t("js.editor.macro.wiki_page_include.hint"),page:this.I18n.t("js.editor.macro.wiki_page_include.page"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.selectedPage=this.page=this.locals.page}applyAndClose(e){this.changed=!0,this.page=this.selectedPage,this.closeMe(e)}ngAfterViewInit(){this.selectedPageInput.nativeElement.focus()}}h.\u0275fac=function(e){return new(e||h)(c.gc(c.q),c.gc(n.a),c.gc(c.i),c.gc(r.a))},h.\u0275cmp=c.ac({type:h,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&c.Wc(d,!0),2&e)&&(c.Nc(i=c.vc())&&(t.selectedPageInput=i.first))},features:[c.Qb],decls:22,vars:10,consts:[[1,"op-modal--portal","op-modal--macro-modal","ngdialog-theme-openproject"],["tabindex","1",1,"op-modal--modal-container"],[1,"op-modal--modal-header"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"icon-context","icon-attention",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[1,"form","-vertical",3,"submit"],[1,"form--fieldset"],[3,"textContent"],[1,"form--field"],["for","selected-page",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["tabindex","2","type","text","id","selected-page","name","selected-page",1,"form--select",3,"value","change"],["selectedPageInput",""],[1,"op-modal--modal-footer"],["tabindex","4",1,"op-modal--cancel-button","button",3,"textContent","click"],["tabindex","3",1,"op-modal--submit-button","button","-highlight",3,"textContent","click"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"]],template:function(e,t){1&e&&(c.mc(0,"div",0),c.mc(1,"div",1),c.mc(2,"div",2),c.Yc(3,u,2,1,"a",3),c.hc(4,"h3",4),c.lc(),c.mc(5,"div",5),c.mc(6,"form",6),c.uc("submit",(function(e){return t.applyAndClose(e)})),c.mc(7,"fieldset",7),c.hc(8,"legend",8),c.mc(9,"div",9),c.hc(10,"label",10),c.mc(11,"div",11),c.mc(12,"div",12),c.mc(13,"input",13,14),c.uc("change",(function(e){return t.selectedPage=e.target.value})),c.lc(),c.lc(),c.lc(),c.hc(15,"p",8),c.mc(16,"p"),c.mc(17,"kbd"),c.ad(18,"project-identifier:my-wiki-page"),c.lc(),c.lc(),c.lc(),c.lc(),c.lc(),c.lc(),c.mc(19,"div",15),c.mc(20,"button",16),c.uc("click",(function(e){return t.closeMe(e)})),c.lc(),c.mc(21,"button",17),c.uc("click",(function(e){return t.applyAndClose(e)})),c.lc(),c.lc(),c.lc(),c.lc()),2&e&&(c.Tb(3),c.Bc("ngIf",t.showClose),c.Tb(1),c.Bc("textContent",t.text.title),c.Tb(4),c.Bc("textContent",t.text.page),c.Tb(2),c.Bc("textContent",t.text.page),c.Tb(3),c.Bc("value",t.selectedPage),c.Tb(2),c.Bc("textContent",t.text.hint),c.Tb(5),c.Bc("textContent",t.text.button_cancel),c.Ub("title",t.text.button_cancel),c.Tb(1),c.Bc("textContent",t.text.button_save),c.Ub("title",t.text.button_save))},directives:[o.q,l.C,l.n,l.o],encapsulation:2});const p=["codeMirrorPane"];function g(e,t){if(1&e){const e=c.nc();c.mc(0,"a",19),c.mc(1,"i",20),c.uc("click",(function(t){return c.Qc(e),c.wc().closeMe(t)})),c.lc(),c.lc()}if(2&e){const e=c.wc();c.Tb(1),c.Ub("title",e.text.close_popup)}}class m extends a.a{constructor(e,t,i,n){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.I18n=n,this.changed=!1,this.showClose=!0,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this._language="",this.debouncedLanguageLoader=_.debounce(()=>this.loadLanguageAsMode(this.language),300),this.text={title:this.I18n.t("js.editor.macro.code_block.title"),language:this.I18n.t("js.editor.macro.code_block.language"),language_hint:this.I18n.t("js.editor.macro.code_block.language_hint"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.languageClass=t.languageClass||"language-text",this.content=t.content;const s=this.languageClass.match(/language-(\w+)/);this.language=s?s[1]:"text"}applyAndClose(e){this.content=this.codeMirrorInstance.getValue();const t=this.language||"text";this.languageClass=`language-${t}`,this.changed=!0,this.closeMe(e)}ngAfterViewInit(){i.e(0).then(i.t.bind(null,"VrN/",7)).then(e=>{const t=e.default;this.codeMirrorInstance=t.fromTextArea(this.codeMirrorPane.nativeElement,{lineNumbers:!0,smartIndent:!0,autofocus:!0,value:this.content,mode:""})})}get language(){return this._language}set language(e){this._language=e,this.debouncedLanguageLoader()}loadLanguageAsMode(e){if(!e||"text"===e)return this.updateCodeMirrorMode("");i("TKcc")(`./${e}/${e}.js`).then(()=>{this.updateCodeMirrorMode(e)}).catch(t=>{console.error(`Failed to load language ${e}: ${t}`),this.updateCodeMirrorMode("")})}updateCodeMirrorMode(e){const t=this.codeMirrorInstance;t&&t.setOption("mode",e)}updateLanguage(e){e?e.match(/^\w+$/)?this.language=e:console.error("Not updating non-matching language: "+e):this.language=""}}m.\u0275fac=function(e){return new(e||m)(c.gc(c.q),c.gc(n.a),c.gc(c.i),c.gc(r.a))},m.\u0275cmp=c.ac({type:m,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&c.Wc(p,!0),2&e)&&(c.Nc(i=c.vc())&&(t.codeMirrorPane=i.first))},features:[c.Qb],decls:20,vars:10,consts:[[1,"op-modal--portal","op-modal--macro-modal","ngdialog-theme-openproject"],["tabindex","1",1,"op-modal--modal-container","-wide"],[1,"op-modal--modal-header"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"icon-context","icon-attention",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[1,"form","-vertical"],["name","codemirror-element","id","codemirror-element",3,"ngModel"],["codeMirrorPane",""],[1,"form--field"],["for","selected-language",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["tabindex","2","type","text","id","selected-language","name","selected-language",1,"form--select",3,"ngModel","ngModelChange"],["selectedLanguage",""],[3,"textContent"],[1,"op-modal--modal-footer"],["tabindex","4",1,"op-modal--cancel-button","button",3,"textContent","click"],["tabindex","3",1,"op-modal--submit-button","button","-highlight",3,"textContent","click"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"]],template:function(e,t){1&e&&(c.mc(0,"div",0),c.mc(1,"div",1),c.mc(2,"div",2),c.Yc(3,g,2,1,"a",3),c.hc(4,"h3",4),c.lc(),c.mc(5,"div",5),c.mc(6,"form",6),c.hc(7,"textarea",7,8),c.hc(9,"hr"),c.mc(10,"div",9),c.hc(11,"label",10),c.mc(12,"div",11),c.mc(13,"div",12),c.mc(14,"input",13,14),c.uc("ngModelChange",(function(e){return t.updateLanguage(e)})),c.lc(),c.lc(),c.lc(),c.hc(16,"p",15),c.lc(),c.lc(),c.lc(),c.mc(17,"div",16),c.mc(18,"button",17),c.uc("click",(function(e){return t.closeMe(e)})),c.lc(),c.mc(19,"button",18),c.uc("click",(function(e){return t.applyAndClose(e)})),c.lc(),c.lc(),c.lc(),c.lc()),2&e&&(c.Tb(3),c.Bc("ngIf",t.showClose),c.Tb(1),c.Bc("textContent",t.text.title),c.Tb(3),c.Bc("ngModel",t.content),c.Tb(4),c.Bc("textContent",t.text.language),c.Tb(3),c.Bc("ngModel",t.language),c.Tb(2),c.Bc("textContent",t.text.language_hint),c.Tb(2),c.Bc("textContent",t.text.button_cancel),c.Ub("title",t.text.button_cancel),c.Tb(1),c.Bc("textContent",t.text.button_save),c.Ub("title",t.text.button_save))},directives:[o.q,l.C,l.n,l.o,l.c,l.m,l.p],encapsulation:2});const f=["selectedPageInput"];function b(e,t){if(1&e){const e=c.nc();c.mc(0,"a",22),c.mc(1,"i",23),c.uc("click",(function(t){return c.Qc(e),c.wc().closeMe(t)})),c.lc(),c.lc()}if(2&e){const e=c.wc();c.Tb(1),c.Ub("title",e.text.close_popup)}}class w extends a.a{constructor(e,t,i,n){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.I18n=n,this.changed=!1,this.showClose=!0,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.page="",this.includeParent=!1,this.text={title:this.I18n.t("js.editor.macro.child_pages.button"),hint:this.I18n.t("js.editor.macro.child_pages.hint"),page:this.I18n.t("js.editor.macro.child_pages.page"),include_parent:this.I18n.t("js.editor.macro.child_pages.include_parent"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.selectedPage=this.page=this.locals.page,this.selectedIncludeParent=this.includeParent=this.locals.includeParent}applyAndClose(e){this.changed=!0,this.page=this.selectedPage,this.includeParent=this.selectedIncludeParent,this.closeMe(e)}ngAfterViewInit(){this.selectedPageInput.nativeElement.focus()}updateIncludeParent(e){this.selectedIncludeParent=e}}w.\u0275fac=function(e){return new(e||w)(c.gc(c.q),c.gc(n.a),c.gc(c.i),c.gc(r.a))},w.\u0275cmp=c.ac({type:w,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&c.Wc(f,!0),2&e)&&(c.Nc(i=c.vc())&&(t.selectedPageInput=i.first))},features:[c.Qb],decls:26,vars:12,consts:[[1,"op-modal--portal","op-modal--macro-modal","ngdialog-theme-openproject"],["tabindex","1",1,"op-modal--modal-container"],[1,"op-modal--modal-header"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"icon-context","icon-attention",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[1,"form","-vertical",3,"submit"],[1,"form--fieldset"],[3,"textContent"],[1,"form--field"],["for","selected-page",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["tabindex","2","type","text","id","selected-page","name","selected-page","placeholder","my-project:my-page",1,"form--select",3,"value","change"],["selectedPageInput",""],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["tabindex","3","type","checkbox","id","include-parent","name","include-parent",1,"form--check-box",3,"ngModel","ngModelChange"],["parentIncludedInput",""],[1,"op-modal--modal-footer"],["tabindex","4",1,"op-modal--cancel-button","button",3,"textContent","click"],["tabindex","3",1,"op-modal--submit-button","button","-highlight",3,"textContent","click"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"]],template:function(e,t){1&e&&(c.mc(0,"div",0),c.mc(1,"div",1),c.mc(2,"div",2),c.Yc(3,b,2,1,"a",3),c.hc(4,"h3",4),c.lc(),c.mc(5,"div",5),c.mc(6,"form",6),c.uc("submit",(function(e){return t.applyAndClose(e)})),c.mc(7,"fieldset",7),c.hc(8,"legend",8),c.mc(9,"div",9),c.hc(10,"label",10),c.mc(11,"div",11),c.mc(12,"div",12),c.mc(13,"input",13,14),c.uc("change",(function(e){return t.selectedPage=e.target.value})),c.lc(),c.lc(),c.lc(),c.lc(),c.mc(15,"div",9),c.mc(16,"div",11),c.mc(17,"label",15),c.mc(18,"div",16),c.mc(19,"input",17,18),c.uc("ngModelChange",(function(e){return t.updateIncludeParent(e)})),c.lc(),c.lc(),c.ad(21),c.lc(),c.lc(),c.lc(),c.hc(22,"p",8),c.lc(),c.lc(),c.lc(),c.mc(23,"div",19),c.mc(24,"button",20),c.uc("click",(function(e){return t.closeMe(e)})),c.lc(),c.mc(25,"button",21),c.uc("click",(function(e){return t.applyAndClose(e)})),c.lc(),c.lc(),c.lc(),c.lc()),2&e&&(c.Tb(3),c.Bc("ngIf",t.showClose),c.Tb(1),c.Bc("textContent",t.text.title),c.Tb(4),c.Bc("textContent",t.text.page),c.Tb(2),c.Bc("textContent",t.text.page),c.Tb(3),c.Bc("value",t.selectedPage),c.Tb(6),c.Bc("ngModel",t.selectedIncludeParent),c.Tb(2),c.cd(" ",t.text.include_parent," "),c.Tb(1),c.Bc("textContent",t.text.hint),c.Tb(2),c.Bc("textContent",t.text.button_cancel),c.Ub("title",t.text.button_cancel),c.Tb(1),c.Bc("textContent",t.text.button_save),c.Ub("title",t.text.button_save))},directives:[o.q,l.C,l.n,l.o,l.a,l.m,l.p],encapsulation:2});class v{constructor(e,t){this.opModalService=e,this.injector=t}configureWorkPackageButton(e,t){return new Promise((i,n)=>{this.opModalService.show(s.a,this.injector,{type:e,classes:t}).closingEvent.subscribe(e=>{e.changed&&i({type:e.type,classes:e.classes})})})}configureWikiPageInclude(e){return new Promise((t,i)=>{const n=e||"";this.opModalService.show(h,this.injector,{page:n}).closingEvent.subscribe(e=>{e.changed&&t(e.page)})})}editCodeBlock(e,t){return new Promise((i,n)=>{this.opModalService.show(m,this.injector,{content:e,languageClass:t}).closingEvent.subscribe(e=>{e.changed&&i({languageClass:e.languageClass,content:e.content})})})}configureChildPages(e,t){return new Promise((i,n)=>{this.opModalService.show(w,this.injector,{page:e,includeParent:t}).closingEvent.subscribe(e=>{e.changed&&i({page:e.page,includeParent:e.includeParent})})})}}v.\u0275fac=function(e){return new(e||v)(c.qc(n.b),c.qc(c.A))},v.\u0275prov=c.cc({token:v,factory:v.\u0275fac})},Tcty:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));i("ii2/");var n=i("Jui0"),s=i("wZYP"),a=i("fXoL"),r=i("ofXK"),c=i("oLh2"),o=i("Wo/B");function l(e,t){if(1&e&&a.hc(0,"revision-activity",4),2&e){const e=a.wc();a.Bc("workPackage",e.workPackage)("activity",e.activity)("activityNo",e.activityNo)}}function d(e,t){if(1&e&&a.hc(0,"user-activity",5),2&e){const e=a.wc();a.Bc("workPackage",e.workPackage)("activity",e.activity)("activityNo",e.activityNo)("isInitial",e.isInitial)}}class u{constructor(e,t){this.PathHelper=e,this.I18n=t}ngOnInit(){this.projectId=this.workPackage.project.idFromLink,this.activityType=this.activity._type}}u.\u0275fac=function(e){return new(e||u)(a.gc(n.a),a.gc(s.a))},u.\u0275cmp=a.ac({type:u,selectors:[["activity-entry"]],inputs:{workPackage:"workPackage",activity:"activity",activityNo:"activityNo",isInitial:"isInitial"},decls:4,vars:3,consts:[[3,"id"],[3,"ngSwitch"],[3,"workPackage","activity","activityNo",4,"ngSwitchCase"],[3,"workPackage","activity","activityNo","isInitial",4,"ngSwitchDefault"],[3,"workPackage","activity","activityNo"],[3,"workPackage","activity","activityNo","isInitial"]],template:function(e,t){1&e&&(a.mc(0,"div",0),a.mc(1,"div",1),a.Yc(2,l,1,3,"revision-activity",2),a.Yc(3,d,1,4,"user-activity",3),a.lc(),a.lc()),2&e&&(a.Dc("id","activity-",t.activityNo,""),a.Tb(1),a.Bc("ngSwitch",t.activityType),a.Tb(1),a.Bc("ngSwitchCase","Revision"))},directives:[r.u,r.v,r.w,c.a,o.a],encapsulation:2})},TrTv:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("SqdZ"),s=i("IaZ+"),a=i("wZYP"),r=i("sjKJ"),c=i("5JuZ"),o=i("fXoL"),l=i("ofXK"),d=i("3Pt+");const u=["typeSelect"];function h(e,t){if(1&e){const e=o.nc();o.mc(0,"a",25),o.mc(1,"i",26),o.uc("click",(function(t){return o.Qc(e),o.wc().closeMe(t)})),o.lc(),o.lc()}if(2&e){const e=o.wc();o.Tb(1),o.Ub("title",e.text.close_popup)}}function p(e,t){if(1&e&&o.hc(0,"option",15),2&e){const e=t.$implicit,i=o.wc();o.Bc("textContent",e.name)("selected",i.selectedType===e.name)("value",e.name)}}class g extends n.a{constructor(e,t,i,n,s,a){super(t,s,e),this.elementRef=e,this.locals=t,this.currentProject=i,this.workPackageDmService=n,this.cdRef=s,this.I18n=a,this.changed=!1,this.showClose=!0,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.type="",this.classes="",this.text={title:this.I18n.t("js.editor.macro.work_package_button.button"),none:this.I18n.t("js.label_none"),selected_type:this.I18n.t("js.editor.macro.work_package_button.type"),button_style:this.I18n.t("js.editor.macro.work_package_button.button_style"),button_style_hint:this.I18n.t("js.editor.macro.work_package_button.button_style_hint"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.selectedType=this.type=this.locals.type,this.classes=this.locals.classes,this.buttonStyle="button"===this.classes,this.workPackageDmService.emptyCreateForm({},this.currentProject.identifier).then(e=>{this.availableTypes=e.schema.type.allowedValues})}applyAndClose(e){this.changed=!0,this.classes=this.buttonStyle?"button":"",this.type=this.selectedType,this.closeMe(e)}ngAfterViewInit(){this.typeSelect.nativeElement.focus()}}g.\u0275fac=function(e){return new(e||g)(o.gc(o.q),o.gc(s.a),o.gc(r.a),o.gc(c.a),o.gc(o.i),o.gc(a.a))},g.\u0275cmp=o.ac({type:g,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&o.Wc(u,!0),2&e)&&(o.Nc(i=o.vc())&&(t.typeSelect=i.first))},features:[o.Qb],decls:27,vars:14,consts:[[1,"op-modal--portal","op-modal--macro-modal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","loading-indicator--location"],[1,"op-modal--modal-header"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"icon-context","icon-attention",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[1,"form","-vertical",3,"submit"],[1,"form--fieldset"],[3,"textContent"],[1,"form--field"],["for","selected-type",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["id","selected-type","tabindex","1","name","selected-type",1,"form--select",3,"change"],["typeSelect",""],[3,"textContent","selected","value"],[3,"textContent","selected","value",4,"ngFor","ngForOf"],[1,"form--field","-wide-label"],[1,"form--field-container","-vertical"],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["type","checkbox","tabindex","2","id","wp_button_macro_style","name","button_style",3,"checked","change"],[1,"op-modal--modal-footer"],["tabindex","4",1,"op-modal--cancel-button","button",3,"textContent","click"],["tabindex","3",1,"op-modal--submit-button","button","-highlight",3,"textContent","click"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"]],template:function(e,t){1&e&&(o.mc(0,"div",0),o.mc(1,"div",1),o.mc(2,"div",2),o.Yc(3,h,2,1,"a",3),o.hc(4,"h3",4),o.lc(),o.mc(5,"div",5),o.mc(6,"form",6),o.uc("submit",(function(e){return t.applyAndClose(e)})),o.mc(7,"fieldset",7),o.hc(8,"legend",8),o.mc(9,"div",9),o.hc(10,"label",10),o.mc(11,"div",11),o.mc(12,"div",12),o.mc(13,"select",13,14),o.uc("change",(function(e){return t.selectedType=e.target.value})),o.hc(15,"option",15),o.Yc(16,p,1,3,"option",16),o.lc(),o.lc(),o.lc(),o.lc(),o.lc(),o.mc(17,"div",17),o.mc(18,"div",18),o.mc(19,"label",19),o.mc(20,"div",20),o.mc(21,"input",21),o.uc("change",(function(e){return t.buttonStyle=e.target.checked})),o.lc(),o.lc(),o.ad(22),o.lc(),o.lc(),o.lc(),o.hc(23,"p",8),o.lc(),o.lc(),o.mc(24,"div",22),o.mc(25,"button",23),o.uc("click",(function(e){return t.closeMe(e)})),o.lc(),o.mc(26,"button",24),o.uc("click",(function(e){return t.applyAndClose(e)})),o.lc(),o.lc(),o.lc(),o.lc()),2&e&&(o.Tb(3),o.Bc("ngIf",t.showClose),o.Tb(1),o.Bc("textContent",t.text.title),o.Tb(4),o.Bc("textContent",t.text.selected_type),o.Tb(2),o.Bc("textContent",t.text.selected_type),o.Tb(5),o.Bc("textContent",t.text.none)("selected",!t.selectedType),o.Tb(1),o.Bc("ngForOf",t.availableTypes),o.Tb(5),o.Bc("checked",t.buttonStyle),o.Tb(1),o.cd(" ",t.text.button_style," "),o.Tb(1),o.Bc("textContent",t.text.button_style_hint),o.Tb(2),o.Bc("textContent",t.text.button_cancel),o.Ub("title",t.text.button_cancel),o.Tb(1),o.Bc("textContent",t.text.button_save),o.Ub("title",t.text.button_save))},directives:[l.q,d.C,d.n,d.o,d.r,d.B,l.p],encapsulation:2})},"U/vl":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t,i){this.page=e,this.total=t,this.perPage=i}getLowerPageBound(){return this.perPage*(this.page-1)+1}getUpperPageBound(e){return Math.min(this.perPage*this.page,e)}nextPage(){this.page+=1}previousPage(){this.page-=1}}},U1xf:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e){this.tableVisible=!0,this.compactTableStyle=!1,this.actionsColumnEnabled=!0,this.contextMenuEnabled=!0,this.columnMenuEnabled=!0,this.projectContext=!0,this.projectIdentifier=null,this.inlineCreateEnabled=!0,this.hierarchyToggleEnabled=!0,this.dragAndDropEnabled=!1,this.isEmbedded=!1,this.isCardView=!1,this.withFilters=!1,this.filtersExpanded=!1,this.showFilterButton=!1,this.filterButtonText=I18n.t("js.button_filter"),_.each(e,(e,t)=>{this[t]=e})}}},"UD+K":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("JX91"),s=i("3UWI"),a=i("lJxs");class r{constructor(e=3600){this.holdValuesForSeconds=e,this.cacheDurationInMs=1e3*e}state(e){return this.multiState.get(e)}touch(e){const t=this.multiState.get(e);t.putValue(t.value,"Touching the state")}current(e,t){return this.state(e).getValueOr(t)}updateValue(e,t){this.multiState.get(e).putValue(t)}observe(e){return this.state(e).values$()}changes$(e){return this.state(e).changes$()}observeAll(){return this.multiState.observeChange().pipe(Object(n.a)([]),Object(s.a)(250),Object(a.a)(()=>{let e=[];return _.each(this.multiState.getValueOr({}),t=>{t.value&&e.push(t.value)}),e}))}clearSome(...e){e.forEach(e=>this.multiState.get(e).clear())}require(e,t=!1){const i=this.multiState.get(e);if(this.stale(i)||t){let t=this.load(e);return i.clearAndPutFromPromise(t),t}return i.valuesPromise()}requireAndStream(e,t=!1){const i=this.multiState.get(e);return(this.stale(i)||t)&&(i.clear(),i.putFromPromiseIfPristine(()=>this.load(e))),i.values$()}requireAll(e,t=!1){let i;return i=t?e:e.filter(e=>this.stale(this.multiState.get(e))),0===i.length?Promise.resolve(void 0):this.loadAll(i)}stale(e){return!e.hasActivePromiseRequest()&&(e.isPristine()||e.isValueOlderThan(this.cacheDurationInMs))}}},UUNb:function(e,t,i){"use strict";i.d(t,"a",(function(){return j}));var n=i("DhiE"),s=i("iMRi"),a=i("SqdZ"),r=i("IaZ+"),c=i("Y/CA"),o=i("iB+3"),l=i("wZYP"),d=i("ABwi"),u=i("pQre"),h=i("qc15"),p=i("fXoL"),g=i("ofXK"),m=i("3Pt+");function f(e,t){if(1&e&&(p.mc(0,"li"),p.ad(1," #"),p.hc(2,"span",11),p.hc(3,"span",11),p.lc()),2&e){const e=t.$implicit;p.Tb(2),p.Bc("textContent",e.id),p.Tb(1),p.Bc("textContent",e.subject||"")}}function b(e,t){if(1&e&&(p.mc(0,"div"),p.mc(1,"p",12),p.hc(2,"span",13),p.hc(3,"strong",11),p.ad(4,": "),p.hc(5,"span",11),p.lc(),p.mc(6,"ul"),p.Yc(7,f,4,2,"li",14),p.lc(),p.mc(8,"p"),p.hc(9,"span",11),p.lc(),p.lc()),2&e){const e=p.wc(2);p.Tb(3),p.Bc("textContent",e.text.warning),p.Tb(2),p.Bc("textContent",e.text.hasChildren(e.singleWorkPackage)),p.Tb(2),p.Bc("ngForOf",e.singleWorkPackageChildren),p.Tb(2),p.Bc("textContent",e.text.deletesChildren)}}function w(e,t){if(1&e&&(p.kc(0),p.mc(1,"p"),p.hc(2,"span",11),p.hc(3,"br"),p.mc(4,"strong"),p.ad(5),p.lc(),p.lc(),p.Yc(6,b,10,4,"div",7),p.jc()),2&e){const e=p.wc();p.Tb(2),p.Bc("textContent",e.text.text),p.Tb(3),p.ed(" ",e.singleWorkPackage.type.name," #",e.singleWorkPackage.id," ",e.singleWorkPackage.subject," "),p.Tb(1),p.Bc("ngIf",e.singleWorkPackageChildren&&e.singleWorkPackageChildren.length>0)}}function v(e,t){if(1&e&&(p.mc(0,"strong"),p.ad(1),p.lc()),2&e){const e=p.wc().$implicit,t=p.wc(2);p.Tb(1),p.cd(" (+ ",t.text.childCount(e),") ")}}function y(e,t){if(1&e&&(p.mc(0,"li"),p.ad(1," #"),p.hc(2,"span",11),p.ad(3," "),p.hc(4,"span",11),p.Yc(5,v,2,1,"strong",7),p.lc()),2&e){const e=t.$implicit,i=p.wc(2);p.Tb(2),p.Bc("textContent",e.id),p.Tb(2),p.Bc("textContent",e.subject),p.Tb(1),p.Bc("ngIf",i.children(e).length>0)}}function k(e,t){if(1&e&&(p.kc(0),p.mc(1,"p",12),p.hc(2,"span",13),p.hc(3,"strong",11),p.lc(),p.mc(4,"ul"),p.Yc(5,y,6,3,"li",14),p.lc(),p.jc()),2&e){const e=p.wc();p.Tb(3),p.Bc("textContent",e.text.text),p.Tb(2),p.Bc("ngForOf",e.workPackages)}}function C(e,t){if(1&e){const e=p.nc();p.mc(0,"div"),p.mc(1,"label",15),p.mc(2,"div",16),p.mc(3,"input",17),p.uc("ngModelChange",(function(t){return p.Qc(e),p.wc().childrenDeletionConfirmed=t})),p.lc(),p.lc(),p.ad(4),p.lc(),p.lc()}if(2&e){const e=p.wc();p.Tb(3),p.Bc("ngModel",e.childrenDeletionConfirmed),p.Tb(1),p.cd(" ",e.text.label_confirm_children_deletion," ")}}class j extends a.a{constructor(e,t,i,n,s,a,r,c,o,l,d){super(i,s,e),this.elementRef=e,this.WorkPackageService=t,this.locals=i,this.I18n=n,this.cdRef=s,this.$state=a,this.states=r,this.wpTableFocus=c,this.wpListService=o,this.notificationService=l,this.backRoutingService=d,this.busy=!1,this.childrenDeletionConfirmed=!1,this.text={label_visibility_settings:this.I18n.t("js.label_visibility_settings"),button_save:this.I18n.t("js.modals.button_save"),confirm:this.I18n.t("js.button_confirm"),warning:this.I18n.t("js.label_warning"),cancel:this.I18n.t("js.button_cancel"),close:this.I18n.t("js.close_popup_title"),label_confirm_children_deletion:this.I18n.t("js.modals.destroy_work_package.confirm_deletion_children")}}ngOnInit(){super.ngOnInit(),this.workPackages=this.locals.workPackages,this.workPackageLabel=this.I18n.t("js.units.workPackage",{count:this.workPackages.length}),1===this.workPackages.length&&(this.singleWorkPackage=this.workPackages[0],this.singleWorkPackageChildren=this.singleWorkPackage.children),this.text.title=this.I18n.t("js.modals.destroy_work_package.title",{label:this.workPackageLabel}),this.text.text=this.I18n.t("js.modals.destroy_work_package.text",{label:this.workPackageLabel,count:this.workPackages.length}),this.text.childCount=e=>{const t=this.children(e).length;return this.I18n.t("js.units.child_work_packages",{count:t})},this.text.hasChildren=e=>this.I18n.t("js.modals.destroy_work_package.has_children",{childUnits:this.text.childCount(e)}),this.text.deletesChildren=this.I18n.t("js.modals.destroy_work_package.deletes_children")}get blockedDueToUnconfirmedChildren(){return this.mustConfirmChildren&&!this.childrenDeletionConfirmed}get mustConfirmChildren(){if(this.singleWorkPackage&&this.singleWorkPackageChildren){this.singleWorkPackageChildren.length}return!!_.find(this.workPackages,e=>e.children&&e.children.length>0)}confirmDeletion(e){return this.busy||this.blockedDueToUnconfirmedChildren||(this.busy=!0,this.WorkPackageService.performBulkDelete(this.workPackages.map(e=>e.id),!0).then(()=>{this.busy=!1,this.closeMe(e),this.wpTableFocus.clear("Clearing after destroying work packages"),this.$state.current.data.baseRoute&&this.backRoutingService.goBack(!0)}).catch(()=>{this.busy=!1})),!1}children(e){return e.hasOwnProperty("children")?e.children:[]}}j.\u0275fac=function(e){return new(e||j)(p.gc(p.q),p.gc(d.a),p.gc(r.a),p.gc(l.a),p.gc(p.i),p.gc(o.G),p.gc(s.a),p.gc(c.a),p.gc(n.a),p.gc(h.a),p.gc(u.a))},j.\u0275cmp=p.ac({type:j,selectors:[["ng-component"]],features:[p.Qb],decls:13,vars:8,consts:[[1,"op-modal--portal"],["id","wp_destroy_modal","data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","wp-table--configuration-modal","loading-indicator--location","-highlight","-danger-zone"],[1,"op-modal--modal-header"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[1,"icon-context","icon-attention",3,"textContent"],[1,"op-modal--modal-body"],[4,"ngIf"],[1,"op-modal--modal-footer"],[1,"button","-danger",3,"textContent","click"],[1,"button",3,"textContent","click"],[3,"textContent"],[1,"danger-zone--warning"],[1,"icon-context","icon-error"],[4,"ngFor","ngForOf"],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["type","checkbox","name","confirm-children-deletion","id","confirm-children-deletion",1,"form--check-box",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(p.mc(0,"div",0),p.mc(1,"div",1),p.mc(2,"div",2),p.mc(3,"a",3),p.mc(4,"i",4),p.uc("click",(function(e){return t.closeMe(e)})),p.lc(),p.lc(),p.hc(5,"h3",5),p.lc(),p.mc(6,"div",6),p.Yc(7,w,7,5,"ng-container",7),p.Yc(8,k,6,2,"ng-container",7),p.Yc(9,C,5,2,"div",7),p.lc(),p.mc(10,"div",8),p.mc(11,"button",9),p.uc("click",(function(e){return t.confirmDeletion(e)})),p.lc(),p.mc(12,"button",10),p.uc("click",(function(e){return t.closeMe(e)})),p.lc(),p.lc(),p.lc(),p.lc()),2&e&&(p.Tb(4),p.Ub("title",t.text.close),p.Tb(1),p.Bc("textContent",t.text.title),p.Tb(2),p.Bc("ngIf",t.singleWorkPackage),p.Tb(1),p.Bc("ngIf",t.workPackages.length>1),p.Tb(1),p.Bc("ngIf",t.mustConfirmChildren),p.Tb(2),p.Bc("textContent",t.text.confirm),p.Ub("disabled",t.busy||t.blockedDueToUnconfirmedChildren||void 0),p.Tb(1),p.Bc("textContent",t.text.cancel))},directives:[g.q,g.p,m.a,m.m,m.p],encapsulation:2})},Ul5t:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("kTsZ"),s=i("Jui0"),a=i("fXoL");class r{constructor(e,t){this.halResourceService=e,this.pathHelper=t}loadAll(){return this.halResourceService.get(this.pathHelper.api.v3.help_texts.toString()).toPromise()}load(e){return this.halResourceService.get(this.pathHelper.api.v3.help_texts.id(e).toString()).toPromise()}}r.\u0275fac=function(e){return new(e||r)(a.qc(n.a),a.qc(s.a))},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac})},Uprc:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("wZYP"),s=i("AeZM"),a=i("wyKs"),r=i("EnRq"),c=i("fXoL"),o=i("3Pt+"),l=i("N5AO"),d=i("ofXK");function u(e,t){if(1&e&&c.hc(0,"span",6),2&e){const e=c.wc();c.Bc("textContent",e.text.display_mode.hierarchy_hint)}}function h(e,t){if(1&e&&c.hc(0,"option",15),2&e){const e=t.$implicit,i=c.wc();c.Bc("textContent",e.name)("selected",i.currentGroup&&i.currentGroup.href===e.href)("value",e.href)}}class p{constructor(e,t,i,n,s){this.injector=e,this.I18n=t,this.wpTableGroupBy=i,this.wpTableHierarchies=n,this.wpTableSums=s,this.displayMode="default",this.availableGroups=[],this.displaySums=!1,this.text={choose_mode:this.I18n.t("js.work_packages.table_configuration.choose_display_mode"),label_group_by:this.I18n.t("js.label_group_by"),title:this.I18n.t("js.label_group_by"),placeholder:this.I18n.t("js.placeholders.default"),please_select:this.I18n.t("js.placeholders.selection"),default:"\u2014 "+this.I18n.t("js.work_packages.table_configuration.default"),display_sums:this.I18n.t("js.work_packages.query.display_sums"),display_sums_hint:"\u2014 "+this.I18n.t("js.work_packages.table_configuration.display_sums_hint"),display_mode:{default:this.I18n.t("js.work_packages.table_configuration.default_mode"),grouped:this.I18n.t("js.work_packages.table_configuration.grouped_mode"),hierarchy:this.I18n.t("js.work_packages.table_configuration.hierarchy_mode"),hierarchy_hint:"\u2014 "+this.I18n.t("js.work_packages.table_configuration.hierarchy_hint")}}}onSave(){this.wpTableHierarchies.setEnabled("hierarchy"===this.displayMode);let e="grouped"===this.displayMode?this.currentGroup:null;this.wpTableGroupBy.update(e),this.wpTableSums.setEnabled(this.displaySums)}updateGroup(e){this.displayMode="grouped",this.currentGroup=_.find(this.availableGroups,t=>t.href===e)||null}ngOnInit(){this.wpTableHierarchies.isEnabled?this.displayMode="hierarchy":this.wpTableGroupBy.current&&(this.displayMode="grouped"),this.displaySums=this.wpTableSums.current,this.wpTableGroupBy.onReady().then(()=>{this.availableGroups=_.sortBy(this.wpTableGroupBy.available,"name"),this.currentGroup=this.wpTableGroupBy.current})}}p.\u0275fac=function(e){return new(e||p)(c.gc(c.A),c.gc(n.a),c.gc(s.a),c.gc(a.a),c.gc(r.a))},p.\u0275cmp=c.ac({type:p,selectors:[["ng-component"]],decls:39,vars:16,consts:[[3,"textContent"],[1,"form--field","-full-width"],[1,"form--field-container"],[1,"option-label"],["type","radio","value","default","name","display_mode_switch",3,"ngModel","ngModelChange"],["icon-classes","icon-no-hierarchy"],[1,"form--inline-instructions",3,"textContent"],["type","radio","value","hierarchy","name","display_mode_switch",3,"ngModel","ngModelChange"],["icon-classes","icon-hierarchy"],["class","form--inline-instructions",3,"textContent",4,"ngIf"],["type","radio","value","grouped","name","display_mode_switch",3,"ngModel","ngModelChange"],["icon-classes","icon-group-by"],["id","selected_grouping","name","selected_grouping",1,"form--select","form--inline-select",3,"change"],[3,"textContent","selected","value",4,"ngFor","ngForOf"],["type","checkbox","name","display_sums_switch",3,"checked","change"],[3,"textContent","selected","value"]],template:function(e,t){1&e&&(c.mc(0,"div"),c.mc(1,"form"),c.hc(2,"p",0),c.mc(3,"div",1),c.mc(4,"div",2),c.mc(5,"label",3),c.mc(6,"input",4),c.uc("ngModelChange",(function(e){return t.displayMode=e})),c.lc(),c.hc(7,"op-icon",5),c.ad(8," "),c.hc(9,"span",0),c.ad(10," "),c.hc(11,"span",6),c.lc(),c.lc(),c.lc(),c.mc(12,"div",1),c.mc(13,"div",2),c.mc(14,"label",3),c.mc(15,"input",7),c.uc("ngModelChange",(function(e){return t.displayMode=e})),c.lc(),c.hc(16,"op-icon",8),c.ad(17," "),c.hc(18,"span",0),c.ad(19," "),c.Yc(20,u,1,1,"span",9),c.lc(),c.lc(),c.lc(),c.mc(21,"div",1),c.mc(22,"div",2),c.mc(23,"label",3),c.mc(24,"input",10),c.uc("ngModelChange",(function(e){return t.displayMode=e})),c.lc(),c.hc(25,"op-icon",11),c.ad(26," "),c.hc(27,"span",0),c.ad(28," "),c.mc(29,"select",12),c.uc("change",(function(e){return t.updateGroup(e.target.value)})),c.Yc(30,h,1,3,"option",13),c.lc(),c.lc(),c.lc(),c.lc(),c.hc(31,"hr"),c.mc(32,"div"),c.mc(33,"div",1),c.mc(34,"div",2),c.mc(35,"label",3),c.mc(36,"input",14),c.uc("change",(function(){return t.displaySums=!t.displaySums})),c.lc(),c.ad(37),c.hc(38,"span",6),c.lc(),c.lc(),c.lc(),c.lc(),c.lc(),c.lc()),2&e&&(c.Tb(2),c.Bc("textContent",t.text.choose_mode),c.Tb(4),c.Bc("ngModel",t.displayMode),c.Tb(1),c.Ub("icon-title",t.text.display_mode.default),c.Tb(2),c.Bc("textContent",t.text.display_mode.default),c.Tb(2),c.Bc("textContent",t.text.default),c.Tb(4),c.Bc("ngModel",t.displayMode),c.Tb(1),c.Ub("icon-title",t.text.display_mode.hierarchy),c.Tb(2),c.Bc("textContent",t.text.display_mode.hierarchy),c.Tb(2),c.Bc("ngIf","hierarchy"===t.displayMode),c.Tb(4),c.Bc("ngModel",t.displayMode),c.Tb(1),c.Ub("icon-title",t.text.label_group_by),c.Tb(2),c.Bc("textContent",t.text.label_group_by),c.Tb(3),c.Bc("ngForOf",t.availableGroups),c.Tb(6),c.Bc("checked",t.displaySums),c.Tb(1),c.cd(" ",t.text.display_sums," "),c.Tb(1),c.Bc("textContent",t.text.display_sums_hint))},directives:[o.C,o.n,o.o,o.u,o.c,o.m,o.p,l.a,d.q,d.p,o.r,o.B],encapsulation:2})},Uyc6:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("mrSG"),s=i("zqrF"),a=i("E2tj"),r=i("Jui0"),c=i("iMRi"),o=i("qHU1");class l{constructor(e,t,i,n,s){this.order=e,this.positions=t,this.wpId=i,this.index=n,this.fromIndex=s,this.delta={}}buildDelta(){return Object(o.b)(`Building delta for ${this.wpId}@${this.index}`,()=>{this.isAscendingOrder()?this.buildInsertPosition():this.rebuildPositions()}),Object(o.a)("Order DELTA was built as %O",this.delta),this.delta}isAscendingOrder(){let e;for(let t=0,i=this.order.length;t<i;t++){const i=this.order[t],n=this.positions[i];if(t!==this.index)if(void 0!==e&&void 0!==n){if(n<e)return!1}else e=n}return!0}rebuildPositions(){let[e,t]=this.minMaxPositions;this.redistribute(e,t)}buildInsertPosition(){if(this.order.length<=1&&void 0===this.positions[this.wpId])return void(this.delta[this.wpId]=0);if(null!==this.fromIndex&&1===Math.abs(this.fromIndex-this.index)&&this.positionSwap())return;if(0===this.index)return this.insertAsFirst();const e=this.buildUpPredecessorPosition();if(e>=2147483647)return Object(o.a)("Predecessor position is at max order, need to reorder"),this.reorderedInsert();const t=this.positionFor(this.index+1);if(void 0===t)return void(this.delta[this.wpId]=e+8192);if(t>=2147483647)return Object(o.a)("Successor position is at max order, need to reorder"),this.reorderedInsert();const i=Math.floor((t-e)/2);if(i<1)return Object(o.a)("Cannot insert at optimal position, no space left. Need to reorder"),this.reorderedInsert();this.delta[this.wpId]=e+i}insertAsFirst(){const e=this.positionFor(this.index+1);this.delta[this.wpId]=void 0===e?0:e-8192}positionSwap(){const e=this.positionFor(this.index),t=this.order[this.fromIndex],i=this.positionFor(this.fromIndex);return void 0!==e&&void 0!==i&&(this.delta[this.wpId]=i,this.delta[t]=e,!0)}buildUpPredecessorPosition(){let e=-16384;for(let t=0;t<this.index;t++){const i=this.order[t],n=this.positions[i];e=void 0===n?this.delta[i]=e+16384:n}return e}positionFor(e){const t=this.order[e];return this.livePosition(t)}livePosition(e){return this.delta[e]||this.positions[e]}reorderedInsert(){let e=this.firstPosition,t=this.lastPosition;this.redistribute(e,t)}redistribute(e,t){const i=this.order.length;let n=Math.floor((t-e)/(i-1));if(n<1){if(t+i<=2147483647)t+=i;else{if(!(e-i>=-2147483647))throw"Elements cannot be moved further and no space is left. Too many elements";e-=i}n=Math.floor((t-e)/(i-1))}for(let s=0;s<i;s++){const t=this.order[s];this.delta[t]=e+s*n}}get minMaxPositions(){let e=2147483647,t=-2147483647,i=!1;for(let n=this.order.length-1;n>=0;n--){let s=this.order[n],a=this.livePosition(s);void 0!==a&&(e=Math.min(a,e),t=Math.max(a,t),i=!0)}return i&&e!==t?[e,t]:[0,16384*this.order.length]}get firstPosition(){const e=this.order[0];return this.livePosition(e)}get lastPosition(){for(let e=this.order.length-1;e>=0;e--){let t=this.order[e],i=this.livePosition(t);if(void 0!==i)return i}}}var d=i("Gyz5"),u=i("IzEk"),h=i("6yP5"),p=i("x5It"),g=i("fXoL");class m extends s.a{constructor(e,t,i,n,s,a){super(e),this.querySpace=e,this.queryOrderDm=t,this.states=i,this.causedUpdates=n,this.wpTableSortBy=s,this.pathHelper=a}initialize(e,t,i){return!e.persisted&&this.positions.hasValue()&&this.applyToQuery(e),this.wpTableSortBy.isManualSortingMode?this.withLoadedPositions():Promise.resolve()}move(e,t,i){return Object(n.b)(this,void 0,void 0,(function*(){let n=e.findIndex(e=>e===t);return e.splice(n,1),e.splice(i,0,t),yield this.assignPosition(e,t,i,n),e}))}remove(e,t){return _.remove(e,e=>e===t),this.update({[t]:-1}),e}add(e,t,i=-1){return Object(n.b)(this,void 0,void 0,(function*(){return-1===i?(e.push(t),i=e.length-1):e.splice(i,0,t),yield this.assignPosition(e,t,i),e}))}get applicable(){return this.currentQuery.persisted}get currentQuery(){return this.querySpace.query.value}assignPosition(e,t,i,s=null){return Object(n.b)(this,void 0,void 0,(function*(){const n=yield this.withLoadedPositions(),a=new l(e,n,t,i,s).buildDelta();yield this.update(a)}))}get positions(){return this.updatesState}update(e){return Object(n.b)(this,void 0,void 0,(function*(){let t=this.positions.getValueOr({});if(this.positions.putValue(Object.assign(Object.assign({},t),e)),this.currentQuery.persisted){const t=yield this.queryOrderDm.update(this.currentQuery.id,e);this.currentQuery.updatedAt=t,this.causedUpdates.add(this.currentQuery)}this.applyToQuery(this.currentQuery),this.querySpace.query.putValue(this.currentQuery)}))}withLoadedPositions(){if(this.currentQuery.persisted){(this.positions.value==={}||this.positions.isValueOlderThan(6e4))&&this.positions.clear("Clearing old positions value"),this.positions.putFromPromiseIfPristine(()=>this.queryOrderDm.get(this.currentQuery.id))}else this.positions.isPristine()&&this.positions.putValue({});return this.positions.values$().pipe(Object(u.a)(1)).toPromise()}valueFromQuery(e){}orderedWorkPackages(){const e=this.querySpace.results.value.elements.map(e=>this.states.workPackages.get(e.id).getValueOr(e));if(this.currentQuery.persisted||this.positions.isPristine())return e;{const t=this.positions.value;return _.sortBy(e,e=>{const i=t[e.id];return void 0!==i?i:2147483647})}}applyToQuery(e){return e.orderedWorkPackages=this.positions.getValueOr({}),!1}hasChanged(e){return!1}}m.\u0275fac=function(e){return new(e||m)(g.qc(a.a),g.qc(d.a),g.qc(c.a),g.qc(p.a),g.qc(h.a),g.qc(r.a))},m.\u0275prov=g.cc({token:m,factory:m.\u0275fac})},V4eP:function(e,t,i){"use strict";i.d(t,"d",(function(){return r})),i.d(t,"c",(function(){return c})),i.d(t,"b",(function(){return o})),i.d(t,"e",(function(){return l})),i.d(t,"a",(function(){return d}));var n=i("fXoL"),s=(i("kgyZ"),i("wZYP")),a=i("M0J3");i("GntA");const r=new n.z("editing-portal--schema"),c=new n.z("editing-portal--handler"),o=new n.z("editing-portal--changeset"),l="-editing";class d extends a.a{constructor(e,t,i,n,s,a,r){super(),this.I18n=e,this.elementRef=t,this.change=i,this.schema=n,this.handler=s,this.cdRef=a,this.injector=r,this.self=this,this.schema=this.schema||this.change.schema[this.name],this.change.state&&this.change.state.values$().pipe(this.untilDestroyed()).subscribe(e=>{if(!e.schema[this.name])return s.deactivate(!1);this.change=e,this.schema=e.schema[this.name],this.initialize(),this.cdRef.markForCheck()})}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.initialize()}get overflowingSelector(){return this.$element?this.$element.closest(".__overflowing_element_container").data("overflowingIdentifier"):null}get inFlight(){return this.handler.inFlight}get value(){return this.resource[this.name]}get name(){return this.change.getSchemaName(this.handler.fieldName)}set value(e){this.resource[this.name]=this.parseValue(e)}get placeholder(){return"subject"===this.name?this.I18n.t("js.placeholders.subject"):""}get resource(){return this.change.projectedResource}initialize(){}parseValue(e){return e}}d.\u0275fac=function(e){return new(e||d)(n.gc(s.a),n.gc(n.q),n.gc(o),n.gc(r),n.gc(c),n.gc(n.i),n.gc(n.A))},d.\u0275dir=n.bc({type:d,features:[n.Qb]})},VFHb:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("hgso"),s=i("fXoL");class a extends n.a{load(e){return e.watchers.$update().then(e=>e.elements)}}a.\u0275fac=function(e){return r(e||a)},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac});const r=s.oc(a)},VNOR:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("V4eP"),s=i("k8lp"),a=i("fXoL"),r=i("ofXK"),c=i("32V0");function o(e,t){if(1&e){const e=a.nc();a.mc(0,"edit-field-controls",4),a.uc("onSave",(function(){return a.Qc(e),a.wc().handleUserSubmit()}))("onCancel",(function(){return a.Qc(e),a.wc().handler.handleUserCancel()})),a.lc()}if(2&e){const e=a.wc();a.Bc("fieldController",e.field)("saveTitle",e.text.save)("cancelTitle",e.text.cancel)}}class l extends n.a{constructor(){super(...arguments),this.field=this,this.initializationError=!1,this.isPreview=!1,this.previewHtml="",this.text={},this.editorType=this.resource.getEditorTypeFor(this.field.name)}ngOnInit(){super.ngOnInit(),this.handler.registerOnSubmit(()=>this.getCurrentValue()),this.text={attachmentLabel:this.I18n.t("js.label_formattable_attachment_hint"),save:this.I18n.t("js.inplace.button_save",{attribute:this.schema.name}),cancel:this.I18n.t("js.inplace.button_cancel",{attribute:this.schema.name})}}onCkeditorSetup(e){this.resource.isNew||setTimeout(()=>e.editing.view.focus())}getCurrentValue(){return this.editor.getTransformedContent().then(e=>{this.rawValue=e})}onContentChange(e){this.rawValue!==e&&(this.rawValue=e)}handleUserSubmit(){return this.getCurrentValue().then(()=>{this.handler.handleUserSubmit()}),!1}get ckEditorContext(){return{resource:this.change.pristineResource,macros:"none",previewContext:this.previewContext,options:{rtl:this.schema.options&&this.schema.options.rtl}}}get previewContext(){return this.handler.previewContext(this.resource)}reset(){this.editor&&this.editor.initialized&&(this.editor.content=this.rawValue,this.cdRef.markForCheck())}get rawValue(){return this.value&&this.value.raw?this.value.raw:""}set rawValue(e){this.value={raw:e}}isEmpty(){return!(this.value&&this.value.raw)}initialize(){this.resource.isNew&&this.editor&&this.reset()}}l.\u0275fac=function(e){return d(e||l)},l.\u0275cmp=a.ac({type:l,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&a.Wc(s.a,!0),2&e)&&(a.Nc(i=a.vc())&&(t.editor=i.first))},features:[a.Qb],decls:4,vars:4,consts:[[1,"textarea-wrapper"],[1,"op-ckeditor--wrapper","op-ckeditor-element"],[3,"context","content","ckEditorType","onContentChange","onInitializationFailed","onInitialized"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel",4,"ngIf"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel"]],template:function(e,t){1&e&&(a.mc(0,"div",0),a.mc(1,"div",1),a.mc(2,"op-ckeditor",2),a.uc("onContentChange",(function(e){return t.onContentChange(e)}))("onInitializationFailed",(function(){return t.initializationError=!0}))("onInitialized",(function(e){return t.onCkeditorSetup(e)})),a.lc(),a.lc(),a.Yc(3,o,1,3,"edit-field-controls",3),a.lc()),2&e&&(a.Tb(2),a.Bc("context",t.ckEditorContext)("content",t.rawValue)("ckEditorType",t.editorType),a.Tb(1),a.Bc("ngIf",!(t.handler.inEditMode||t.initializationError)))},directives:[s.a,r.q,c.a],encapsulation:2,changeDetection:0});const d=a.oc(l)},VPzE:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("iMRi"),s=i("POAS"),a=i("d/TE"),r=i("SqdZ"),c=i("IaZ+"),o=i("wZYP"),l=i("E2tj"),d=i("DhiE"),u=i("fXoL"),h=i("kor4"),p=i("3Pt+"),g=i("k1Xe");const m=["queryNameField"];class f extends r.a{constructor(e,t,i,n,s,a,r,c,o){super(t,c,e),this.elementRef=e,this.locals=t,this.I18n=i,this.states=n,this.querySpace=s,this.wpListService=a,this.halNotification=r,this.cdRef=c,this.notificationsService=o,this.queryName="",this.isStarred=!1,this.isPublic=!1,this.isBusy=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text"),save_as:this.I18n.t("js.label_save_as"),label_name:this.I18n.t("js.modals.label_name"),label_visibility_settings:this.I18n.t("js.label_visibility_settings"),button_save:this.I18n.t("js.modals.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")}}setValues(e){this.isStarred=e.isStarred,this.isPublic=e.isPublic}onOpen(){this.queryNameField.nativeElement.focus()}get afterFocusOn(){return jQuery("#work-packages-settings-button")}saveQueryAs(e){if(this.isBusy||!this.queryName)return;this.isBusy=!0;const t=this.querySpace.query.value;t.public=this.isPublic,this.wpListService.create(t,this.queryName).then(t=>this.isStarred&&!t.starred?this.wpListService.toggleStarred(t).then(()=>this.closeMe(e)):(this.closeMe(e),Promise.resolve(!0))).catch(e=>this.halNotification.handleRawError(e)).then(()=>this.isBusy=!1)}}f.\u0275fac=function(e){return new(e||f)(u.gc(u.q),u.gc(c.a),u.gc(o.a),u.gc(n.a),u.gc(l.a),u.gc(d.a),u.gc(s.a),u.gc(u.i),u.gc(a.a))},f.\u0275cmp=u.ac({type:f,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&u.Wc(m,!0),2&e)&&(u.Nc(i=u.vc())&&(t.queryNameField=i.first))},features:[u.Qb],decls:19,vars:11,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","wp-table--configuration-modal","loading-indicator--location"],[1,"op-modal--modal-header"],[3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"accessibleClick"],["name","modalSaveForm",1,"form"],[1,"form--field","-required"],["for","save-query-name",1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--text-field-container"],["type","text","name","save-query-name","id","save-query-name","required","",1,"form--text-field",3,"ngModel","ngModelChange"],["queryNameField",""],[1,"form--section"],[3,"isSave","isStarred","isPublic","onChange"],[1,"form--space"],[1,"button","-highlight","-with-icon","icon-checkmark",3,"textContent","disabled","click"],[1,"button","-with-icon","icon-cancel",3,"textContent","click"]],template:function(e,t){1&e&&(u.mc(0,"div",0),u.mc(1,"div",1),u.mc(2,"div",2),u.hc(3,"h3",3),u.mc(4,"a",4),u.mc(5,"i",5),u.uc("accessibleClick",(function(e){return t.closeMe(e)})),u.lc(),u.lc(),u.lc(),u.mc(6,"form",6),u.mc(7,"div",7),u.hc(8,"label",8),u.mc(9,"div",9),u.mc(10,"div",10),u.mc(11,"input",11,12),u.uc("ngModelChange",(function(e){return t.queryName=e})),u.lc(),u.lc(),u.lc(),u.lc(),u.mc(13,"section",13),u.hc(14,"h3",3),u.mc(15,"query-sharing-form",14),u.uc("onChange",(function(e){return t.setValues(e)})),u.lc(),u.lc(),u.mc(16,"div",15),u.mc(17,"button",16),u.uc("click",(function(e){return t.saveQueryAs(e)})),u.lc(),u.mc(18,"button",17),u.uc("click",(function(e){return t.closeMe(e)})),u.lc(),u.lc(),u.lc(),u.lc(),u.lc()),2&e&&(u.Tb(3),u.Bc("textContent",t.text.save_as),u.Tb(2),u.Ub("title",t.text.close_popup),u.Tb(3),u.Bc("textContent",t.text.label_name),u.Tb(3),u.Bc("ngModel",t.queryName),u.Tb(3),u.Bc("textContent",t.text.label_visibility_settings),u.Tb(1),u.Bc("isSave",!0)("isStarred",t.isStarred)("isPublic",t.isPublic),u.Tb(2),u.Bc("textContent",t.text.button_save)("disabled",t.isBusy||!t.queryName),u.Tb(1),u.Bc("textContent",t.text.button_cancel))},directives:[h.a,p.C,p.n,p.o,p.c,p.x,p.m,p.p,g.a],encapsulation:2})},"VQC/":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("kTsZ"),s=i("Jui0"),a=i("RhL0"),r=i("fXoL");class c{constructor(e,t){this.halResourceService=e,this.pathHelper=t}createVersion(e){return this.halResourceService.post(this.pathHelper.api.v3.versions.path,e).toPromise()}emptyCreateForm(e){return this.halResourceService.post(this.pathHelper.api.v3.versions.form.toString(),e).toPromise()}one(e){return this.halResourceService.get(this.pathHelper.api.v3.versions.id(e).toString()).toPromise()}list(){return this.halResourceService.get(this.pathHelper.api.v3.versions.toString()).toPromise()}listForProject(e){return this.halResourceService.get(this.pathHelper.api.v3.projects.id(e).versions.toString()).toPromise()}canCreateVersionInProject(e){return this.halResourceService.get(this.pathHelper.api.v3.versions.availableProjects.toString(),{filters:Object(a.b)("id","=",[e]).toJson()}).toPromise().then(e=>1===e.elements.length)}listProjectsAvailableForVersions(){return this.halResourceService.get(this.pathHelper.api.v3.versions.availableProjects.toString()).toPromise()}patch(e,t){return this.halResourceService.patch(this.pathHelper.api.v3.versions.id(e.id).toString(),t).toPromise()}}c.\u0275fac=function(e){return new(e||c)(r.qc(n.a),r.qc(s.a))},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac})},VYxi:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("Nolp"),s=i("fXoL"),a=i("ofXK"),r=i("711n"),c=i("XZlt"),o=i("qvi4"),l=i("1zMF"),d=i("aveh"),u=i("2bW2");const h=function(){return["status","type"]};function p(e,t){if(1&e){const e=s.nc();s.mc(0,"div",1),s.mc(1,"edit-form",2),s.uc("onSaved",(function(t){return s.Qc(e),s.wc().onSaved(t)})),s.mc(2,"div",3),s.mc(3,"div",4),s.hc(4,"wp-type-status",5),s.lc(),s.mc(5,"ul",6),s.mc(6,"li",7),s.hc(7,"zen-mode-toggle-button"),s.lc(),s.mc(8,"li",7),s.mc(9,"button",8),s.hc(10,"i",9),s.lc(),s.lc(),s.lc(),s.lc(),s.hc(11,"wp-single-view",10),s.mc(12,"wp-edit-actions-bar",11),s.uc("onCancel",(function(){return s.Qc(e),s.wc().cancelAndBackToList()})),s.lc(),s.lc(),s.lc()}if(2&e){const e=s.wc();s.Tb(1),s.Bc("resource",e.newWorkPackage)("skippedFields",s.Fc(7,h))("inEditMode",!0),s.Tb(3),s.Bc("workPackage",e.newWorkPackage),s.Tb(5),s.Ub("title",e.text.button_settings),s.Tb(2),s.Bc("workPackage",e.newWorkPackage)("showProject",e.copying)}}class g extends n.a{constructor(){super(...arguments),this.successState="work-packages.show"}}g.\u0275fac=function(e){return m(e||g)},g.\u0275cmp=s.ac({type:g,selectors:[["wp-copy-full-view"]],hostAttrs:[1,"work-packages-page--ui-view"],features:[s.Qb],decls:1,vars:1,consts:[["class","work-package--new-state work-packages--new work-packages--show-view toolbar-container",4,"ngIf"],[1,"work-package--new-state","work-packages--new","work-packages--show-view","toolbar-container"],[3,"resource","skippedFields","inEditMode","onSaved"],[1,"toolbar"],[1,"title-container"],[3,"workPackage"],[1,"toolbar-items","hide-when-print"],[1,"toolbar-item","hidden-for-mobile"],["id","create-wp-menu-button","wpCreateSettingsMenu","",1,"button","last","work-packages-settings-button","toolbar-icon"],[1,"button--icon","icon-show-more"],[3,"workPackage","showProject"],[3,"onCancel"]],template:function(e,t){1&e&&s.Yc(0,p,13,8,"div",0),2&e&&s.Bc("ngIf",t.newWorkPackage)},directives:[a.q,r.a,c.a,o.a,l.a,d.a,u.a],encapsulation:2,changeDetection:0});const m=s.oc(g)},Va5K:function(e,t,i){"use strict";i.d(t,"c",(function(){return c})),i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return l}));var n=i("zqrF"),s=i("iMRi"),a=i("E2tj"),r=i("fXoL");const c="list",o="card";class l extends n.a{constructor(e,t){super(t),this.states=e,this.querySpace=t}hasChanged(e){return this.current!==e.displayRepresentation}valueFromQuery(e){return e.displayRepresentation||null}applyToQuery(e){const t=this.current;return e.displayRepresentation=null===t?void 0:t,!1}get current(){return this.lastUpdatedState.getValueOr(null)}get isList(){const e=this.current;return!e||e===c}get isCards(){return this.current===o}setDisplayRepresentation(e){this.update(e)}}l.\u0275fac=function(e){return new(e||l)(r.qc(s.a),r.qc(a.a))},l.\u0275prov=r.cc({token:l,factory:l.\u0275fac})},VgZ9:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("ug4p"),s=i("iMRi"),a=i("iB+3"),r=i("Jui0"),c=i("/C7M"),o=i("qc15"),l=i("fXoL");class d{constructor(e,t,i,n,s,a){this.$state=e,this.states=t,this.halEvents=i,this.notificationService=n,this.pathHelper=s,this.wpCacheService=a}changeParent(e,t){let i={lockVersion:e.lockVersion};return i._links=t?{parent:{href:this.pathHelper.api.v3.work_packages.id(t).toString()}}:{parent:{href:null}},e.changeParent(i).then(i=>(this.wpCacheService.updateWorkPackage(i),this.notificationService.showSave(i),this.halEvents.push(e,{eventType:"association",relatedWorkPackage:t,relationType:"parent"}),i)).catch(t=>(this.notificationService.handleRawError(t,e),Promise.reject(t)))}removeParent(e){return this.changeParent(e,null)}addExistingChildWp(e,t){return this.wpCacheService.require(t).then(t=>this.changeParent(t,e.id).then(i=>(this.wpCacheService.loadWorkPackage(e.id,!0),this.halEvents.push(e,{eventType:"association",relatedWorkPackage:t.id,relationType:"child"}),i)))}addNewChildWp(e,t){t.project.$load().then(()=>{const i=[e+".new",{parent_id:t.id}];this.$state.includes("work-packages.show")&&(i[0]="work-packages.new"),this.$state.go(...i)})}removeChild(e){return e.$load().then(()=>{let t=e.parent;return e.changeParent({_links:{parent:{href:null}},lockVersion:e.lockVersion}).then(e=>{t&&this.wpCacheService.require(t.id,!0),this.wpCacheService.updateWorkPackage(e)}).catch(t=>(this.notificationService.handleRawError(t,e),Promise.reject(t)))})}}d.\u0275fac=function(e){return new(e||d)(l.qc(a.G),l.qc(s.a),l.qc(c.a),l.qc(o.a),l.qc(r.a),l.qc(n.a))},d.\u0275prov=l.cc({token:d,factory:d.\u0275fac})},VpST:function(e,t,i){"use strict";i.d(t,"a",(function(){return $n}));var n=i("u4T9"),s=i("wZYP"),a=(i("ii2/"),i("711n")),r=i("fXoL"),c=i("ofXK"),o=i("+ytV"),l=i("CX+C"),d=i("80WE");function u(e,t){1&e&&(r.mc(0,"span",10),r.ad(1," *"),r.lc())}function h(e,t){if(1&e&&(r.mc(0,"div",6),r.mc(1,"wp-replacement-label",7),r.ad(2),r.Yc(3,u,2,0,"span",8),r.lc(),r.hc(4,"attribute-help-text",9),r.lc()),2&e){const e=r.wc(2).$implicit;r.Tb(1),r.Bc("fieldName",e.name),r.Tb(1),r.cd(" ",e.label," "),r.Tb(1),r.Bc("ngIf",e.field.required&&e.field.writable),r.Tb(1),r.Bc("attribute",e.name)("attributeScope","WorkPackage")}}function p(e,t){if(1&e&&r.hc(0,"editable-attribute-field",14),2&e){const e=r.wc(3).$implicit,t=r.wc();r.Bc("resource",t.workPackage)("isDropTarget",!0)("fieldName",e.name)}}function g(e,t){if(1&e&&r.hc(0,"editable-attribute-field",15),2&e){const e=r.wc(3).$implicit,t=r.wc();r.Bc("resource",t.workPackage)("fieldName",e.name)}}function m(e,t){if(1&e&&(r.mc(0,"div",11),r.Yc(1,p,1,3,"editable-attribute-field",12),r.Yc(2,g,1,2,"editable-attribute-field",13),r.lc()),2&e){const e=r.wc(2).$implicit;r.Tb(1),r.Bc("ngIf",e.field.isFormattable),r.Tb(1),r.Bc("ngIf",!e.field.isFormattable)}}function f(e,t){if(1&e&&(r.Yc(0,h,5,5,"div",4),r.Yc(1,m,3,2,"div",5)),2&e){const e=r.wc().$implicit;r.Bc("ngIf",!e.multiple&&e.field),r.Tb(1),r.Bc("ngIf",!e.multiple&&e.field)}}const b=function(e){return{"-span-all-columns":e}};function w(e,t){if(1&e&&(r.mc(0,"div",2),r.Yc(1,f,2,2,"ng-template",3),r.lc()),2&e){const e=t.$implicit,i=r.wc();r.Bc("ngClass",r.Gc(2,b,e.spanAll)),r.Tb(1),r.Bc("ngIf",!i.shouldHideField(e))}}class v{constructor(e,t,i){this.I18n=e,this.wpeditForm=t,this.injector=i}trackByName(e,t){return t.name}shouldHideField(e){const t=e.field||e.fields[0];return this.wpeditForm.editMode&&!t.writable}}v.\u0275fac=function(e){return new(e||v)(r.gc(s.a),r.gc(a.a),r.gc(r.A))},v.\u0275cmp=r.ac({type:v,selectors:[["wp-attribute-group"]],inputs:{workPackage:"workPackage",group:"group"},decls:2,vars:2,consts:[[1,"-columns-2"],["class","attributes-key-value",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"attributes-key-value",3,"ngClass"],[3,"ngIf"],["class","attributes-key-value--key",4,"ngIf"],["class","attributes-key-value--value-container",4,"ngIf"],[1,"attributes-key-value--key"],[3,"fieldName"],["class","required",4,"ngIf"],[3,"attribute","attributeScope"],[1,"required"],[1,"attributes-key-value--value-container"],["class","wp-edit-formattable-field",3,"resource","isDropTarget","fieldName",4,"ngIf"],[3,"resource","fieldName",4,"ngIf"],[1,"wp-edit-formattable-field",3,"resource","isDropTarget","fieldName"],[3,"resource","fieldName"]],template:function(e,t){1&e&&(r.mc(0,"div",0),r.Yc(1,w,2,4,"div",1),r.lc()),2&e&&(r.Tb(1),r.Bc("ngForOf",t.group.members)("ngForTrackBy",t.trackByName))},directives:[c.p,c.n,c.q,o.a,l.a,d.a],encapsulation:2});var y=i("oT5z"),k=i("aveh"),C=i("g1AQ"),j=i("72oW"),x=i("CVKj"),T=i("9hh2"),S=i("lmDM"),P=i("f24R"),I=i("d/TE"),O=i("E2tj"),R=i("wd/R"),B=i("1G5W"),E=i("pLZG"),M=i("4jc8"),F=i("FnNU"),A=i("mrSG"),D=i("iMRi"),q=i("ug4p"),L=i("0bag"),$=i("E5Dd"),N=i("IzEk");function Q(e,t,i,n,s,a,r,c,o,l,d,u,h){e.get(O.a);let p,g,m=null;h.change=s.changeFor(h.workPackage);const f=jQuery("body");function b(e,t){const n=i.getAbsoluteLeftCoordinates(),s=t.clientX-n;return Math.floor(s/e.viewParams.pixelPerDay)}function w(e){return t=>{const i=b(h,t.originalEvent)-m,n=Math.floor(t.offsetX/h.viewParams.pixelPerDay),s=h.viewParams.dateDisplayStart.clone().add(n,"days");p=u.onDaysMoved(h.change,s,i,e),function(e,t){u.assignDateValues(e.change,d,t)}(h,p),u.update(l,d,h)}}function v(e){e.keyCode===$.a.ESCAPE&&k(!0)}function y(e){const t=h.workPackage;u.isEmpty(t)&&(t.isLeaf&&u.canMoveDates(t)?(o.style.cursor="",g&&g.remove(),g=u.displayPlaceholderUnderCursor(e,h),o.appendChild(g),o.onmouseleave=()=>{g.remove()},o.onmousedown=e=>{g.remove(),l.style.pointerEvents="none",e.preventDefault();const t=Math.floor(e.offsetX/h.viewParams.pixelPerDay),i=h.viewParams.dateDisplayStart.clone().add(t,"days").format("YYYY-MM-DD"),n=u.onMouseDown(e,i,h,d,l);if(u.update(l,d,h),"create"===n)return k(!1),void e.preventDefault();o.onmousemove=e=>{const i=Math.floor(e.offsetX/h.viewParams.pixelPerDay),s=h.viewParams.dateDisplayStart.clone().add(i,"days"),a=i-t,r=u.onDaysMoved(h.change,s,a,n);u.assignDateValues(h.change,d,r),u.update(l,d,h)},o.onmouseleave=()=>{k(!0)},o.onmouseup=()=>{k(!1)},f.on("keyup.timelinecell",v)}):o.style.cursor="not-allowed")}function k(t){if(i.disableViewParamsCalculation=!1,o.onmousemove=y,o.onmousedown=_.noop,o.onmouseleave=_.noop,o.onmouseup=_.noop,l.style.pointerEvents="auto",f.off(".timelinecell"),i.resetCursor(),m=null,p={},t||h.change.isEmpty())h.change.clear(),u.update(l,d,h),u.onMouseDownEnd(d,h.change),i.refreshView();else{const t=()=>{h.change.clear(),u.onMouseDownEnd(d,h.change)};(function(t){const i=e.get(L.a),o=e.get(O.a),l=R().toISOString();return c.table.promise=s.save(t).then(e=>{r.showSave(e.resource);const t=_.map(o.tableRendered.value,e=>e.workPackageId);return i.loadIdsUpdatedSince(t,l).then(t=>(n.updateWorkPackageList(t.elements),a.push(e.resource,{eventType:"updated"}),o.timelineRendered.pipe(Object(N.a)(1)).toPromise()))}).catch(e=>{r.handleRawError(e,h.workPackage)})})(h.change).then(t).catch(t)}}l.onmousedown=e=>{1===e.which&&function(e,t){t.preventDefault();if(e.classList.add("active-drag"),f.on("mouseup.timelinecell",()=>e.classList.remove("active-drag")),i.disableViewParamsCalculation=!0,m=b(h,t),!h.workPackage.isLeaf&&!h.viewParams.activeSelectionMode)return;const n=u.onMouseDown(t,null,h,d,e);f.on("mousemove.timelinecell",w(n)),f.on("keyup.timelinecell",v),f.on("mouseup.timelinecell",()=>k(!1))}(l,e)},o.onmousemove=y}var V=i("Y0Nk"),H=i("SKFm"),z=i("/C7M"),Y=i("qc15"),W=i("r0MM");class U{constructor(e,t,i,n,s,a){this.center=e,this.left=t,this.leftHover=i,this.right=n,this.rightHover=s,this.farRight=a}}class G{constructor(e,t,i,n,s,a){this.injector=e,this.workPackageTimeline=t,this.renderers=i,this.latestRenderInfo=n,this.classIdentifier=s,this.workPackageId=a,this.wpElement=null}getMarginLeftOfLeftSide(){return this.cellRenderer(this.latestRenderInfo.workPackage).getMarginLeftOfLeftSide(this.latestRenderInfo)}getMarginLeftOfRightSide(){return this.cellRenderer(this.latestRenderInfo.workPackage).getMarginLeftOfRightSide(this.latestRenderInfo)}getPaddingLeftForIncomingRelationLines(){return this.cellRenderer(this.latestRenderInfo.workPackage).getPaddingLeftForIncomingRelationLines(this.latestRenderInfo)}getPaddingRightForOutgoingRelationLines(){return this.cellRenderer(this.latestRenderInfo.workPackage).getPaddingRightForOutgoingRelationLines(this.latestRenderInfo)}canConnectRelations(){const e=this.latestRenderInfo.workPackage;return e.isMilestone?!_.isNil(e.date):!_.isNil(e.startDate)||!_.isNil(e.dueDate)}clear(){this.cellElement.html(""),this.wpElement=null}get cellContainer(){return this.workPackageTimeline.timelineBody}get cellElement(){return this.cellContainer.find(`.${this.classIdentifier}`)}lazyInit(e,t){const i=this.workPackageTimeline.timelineBody[0],n=this.cellElement;return n.length?(null!==this.wpElement&&i.contains(this.wpElement)&&this.elementShape===e.type||(this.clear(),this.wpElement=e.render(t),this.labels=e.createAndAddLabels(t,this.wpElement),this.elementShape=e.type,n.append(this.wpElement),e.canMoveDates(t.workPackage)&&(this.wpElement.classList.add("-editable"),Q(this.injector,0,this.workPackageTimeline,this.wpCacheService,this.halEditing,this.halEvents,this.notificationService,this.loadingIndicator,n[0],this.wpElement,this.labels,e,t))),Promise.resolve()):Promise.reject("uninitialized")}cellRenderer(e){return e.isMilestone?this.renderers.milestone:this.renderers.generic}refreshView(e){this.latestRenderInfo=e;const t=this.cellRenderer(e.workPackage);this.lazyInit(t,e).then(()=>{t.update(this.wpElement,this.labels,e)||this.clear()}).catch(()=>null)}}Object(A.c)([Object(W.a)(),Object(A.e)("design:type",q.a)],G.prototype,"wpCacheService",void 0),Object(A.c)([Object(W.a)(),Object(A.e)("design:type",H.a)],G.prototype,"halEditing",void 0),Object(A.c)([Object(W.a)(),Object(A.e)("design:type",z.a)],G.prototype,"halEvents",void 0),Object(A.c)([Object(W.a)(),Object(A.e)("design:type",Y.a)],G.prototype,"notificationService",void 0),Object(A.c)([Object(W.a)(),Object(A.e)("design:type",D.a)],G.prototype,"states",void 0),Object(A.c)([Object(W.a)(),Object(A.e)("design:type",V.a)],G.prototype,"loadingIndicator",void 0);var X=i("Ncnr"),K=i("juWA"),Z=i("RGDJ"),J=i("PtkW");class ee{constructor(e,t){this.injector=e,this.workPackageTimeline=t,this.fieldRenderer=new X.a(this.injector,"timeline"),this.dateDisplaysOnMouseMove={}}get type(){return"bar"}canMoveDates(e){return e.schema.startDate.writable&&e.schema.dueDate.writable&&e.isAttributeEditable("startDate")}isEmpty(e){const t=R(e.startDate),i=R(e.dueDate);return _.isNaN(t.valueOf())&&_.isNaN(i.valueOf())}displayPlaceholderUnderCursor(e,t){const i=Math.floor(e.offsetX/t.viewParams.pixelPerDay),n=document.createElement("div");return n.style.pointerEvents="none",n.style.position="absolute",n.style.height="1em",n.style.width="30px",n.style.zIndex="9999",n.style.left=i*t.viewParams.pixelPerDay+"px",this.applyTypeColor(t,n),n}assignDateValues(e,t,i){this.assignDate(e,"startDate",i.startDate),this.assignDate(e,"dueDate",i.dueDate),this.updateLabels(!0,t,e)}onDaysMoved(e,t,i,n){const s=e.pristineResource.startDate,a=e.pristineResource.dueDate,r=R().format("YYYY-MM-DD"),c=R(e.projectedResource.startDate),o=R(e.projectedResource.dueDate);let l={};return"left"===n?l.startDate=R(s||a).add(i,"days"):"right"===n?l.dueDate=R(a||r).add(i,"days"):"both"===n?(s&&(l.startDate=R(s).add(i,"days")),a&&(l.dueDate=R(a).add(i,"days"))):"dragright"===n&&(l.dueDate=c.clone().add(i,"days")),"both"!==n&&(void 0!==l.startDate&&l.startDate.isAfter(o)?l.startDate=o:void 0!==l.dueDate&&l.dueDate.isBefore(c)&&(l.dueDate=c)),l}onMouseDown(e,t,i,n,s){if(i.viewParams.activeSelectionMode)return i.viewParams.activeSelectionMode(i.workPackage),e.preventDefault(),"both";const a=i.change.projectedResource;let r;return jQuery(e.target).hasClass("leftHandle")?(r="left",this.workPackageTimeline.forceCursor("col-resize"),null===a.startDate&&(a.startDate=a.dueDate)):jQuery(e.target).hasClass("rightHandle")||t?(r="right",this.workPackageTimeline.forceCursor("col-resize")):(r="both",this.workPackageTimeline.forceCursor("ew-resize")),t&&(a.startDate=t,a.dueDate=t,r="dragright"),this.updateLabels(!0,n,i.change),r}onMouseDownEnd(e,t){this.updateLabels(!1,e,t)}update(e,t,i){const n=i.change,s=e.querySelector(`.${M.h}`),a=i.viewParams;let r=R(n.projectedResource.startDate),c=R(n.projectedResource.dueDate);_.isNaN(r.valueOf())&&_.isNaN(c.valueOf())?e.style.visibility="hidden":e.style.visibility="visible",_.isNaN(c.valueOf())&&!_.isNaN(r.valueOf())&&(c=R(),s.style.backgroundImage="linear-gradient(90deg, rgba(255,255,255,0) 0%, #F1F1F1 100%)"),_.isNaN(r.valueOf())&&!_.isNaN(c.valueOf())&&(r=c.clone(),s.style.backgroundImage="linear-gradient(90deg, #F1F1F1 0%, rgba(255,255,255,0) 80%)");const o=r.diff(a.dateDisplayStart,"days");e.style.left=Object(M.c)(a,o);const l=c.diff(r,"days")+1;if(e.style.width=Object(M.c)(a,l),!_.isNaN(r.valueOf())||!_.isNaN(c.valueOf())){const t=_.max([i.viewParams.pixelPerDay,2]);e.style.minWidth=t+"px"}return t&&this.updateLabels(!1,t,n),this.checkForActiveSelectionMode(i,s),this.checkForSpecialDisplaySituations(i,s),this.applyTypeColor(i,s),!0}checkForActiveSelectionMode(e,t){e.viewParams.activeSelectionMode&&(t.style.backgroundImage="",e.viewParams.selectionModeStart===""+e.workPackage.id&&(jQuery(t).addClass(M.m),t.style.background="none"))}getMarginLeftOfLeftSide(e){const t=e.change.projectedResource;let i=R(t.startDate),n=R(t.dueDate);i=_.isNaN(i.valueOf())?n.clone():i;const s=i.diff(e.viewParams.dateDisplayStart,"days");return Object(M.d)(e.viewParams,s)}getMarginLeftOfRightSide(e){const t=e.change.projectedResource;let i=R(t.startDate),n=R(t.dueDate);i=_.isNaN(i.valueOf())?n.clone():i,n=_.isNaN(n.valueOf())?i.clone():n;const s=i.diff(e.viewParams.dateDisplayStart,"days"),a=n.diff(i,"days")+1;return Object(M.d)(e.viewParams,s+a)}getPaddingLeftForIncomingRelationLines(e){return e.viewParams.pixelPerDay/8}getPaddingRightForOutgoingRelationLines(e){return 0}render(e){const t=document.createElement("div"),i=document.createElement("div"),n=document.createElement("div"),s=document.createElement("div");return t.className=M.i+" "+this.type,i.className=M.h,n.className="leftHandle",s.className="rightHandle",t.appendChild(i),t.appendChild(n),t.appendChild(s),t}createAndAddLabels(e,t){const i=document.createElement("div");i.classList.add("bar-label"),this.applyTypeColor(e,i),t.appendChild(i);const n=document.createElement("div");n.classList.add("labelLeft","hide-on-hover"),t.appendChild(n);const s=document.createElement("div");s.classList.add("containerRight"),t.appendChild(s);const a=document.createElement("div");a.classList.add("labelRight","hide-on-hover"),s.appendChild(a);const r=document.createElement("div");r.classList.add("labelFarRight","hide-on-hover"),s.appendChild(r);const c=document.createElement("div");c.classList.add("labelHoverLeft","show-on-hover","-label-style"),t.appendChild(c);const o=document.createElement("div");o.classList.add("labelHoverRight","show-on-hover","-label-style"),t.appendChild(o);const l=new U(i,n,c,a,o,r);return this.updateLabels(!1,l,e.change),l}applyTypeColor(e,t){let i=e.workPackage,n=i.type,s=e.viewParams.activeSelectionMode;const a=n.id;s||this.isParentWithVisibleChildren(i)?t.classList.remove(Z.a.backgroundClass("type",a)):t.classList.add(Z.a.backgroundClass("type",a))}assignDate(e,t,i){i&&(e.projectedResource[t]=i.format("YYYY-MM-DD"))}checkForSpecialDisplaySituations(e,t){const i=e.workPackage;let n=e.viewParams.activeSelectionMode;i.isLeaf||n?t.classList.remove("-readonly"):t.classList.add("-readonly"),this.isParentWithVisibleChildren(i)&&(t.classList.add("-clamp-style"),t.style.borderStyle="solid",t.style.borderWidth="2px",t.style.borderBottom="none",t.style.background="none")}updateLabels(e,t,i){const n=this.wpTableTimeline.getNormalizedLabels(i.projectedResource);e||(this.renderLabel(i,t,"left",n.left),this.renderLabel(i,t,"right",n.right),this.renderLabel(i,t,"farRight",n.farRight)),this.renderHoverLabels(t,i)}renderHoverLabels(e,t){this.renderLabel(t,e,"leftHover","startDate"),this.renderLabel(t,e,"rightHover","dueDate")}renderLabel(e,t,i,n){let s=t[i];if(!s)return;if(s.innerHTML="",null===n)return void s.classList.remove("not-empty");let[a,r]=this.fieldRenderer.renderFieldValue(e.projectedResource,n,e);s&&a&&r?(r.classList.add("label-content"),s.appendChild(r),s.classList.add("not-empty")):s&&s.classList.remove("not-empty")}isParentWithVisibleChildren(e){if(!this.workPackageTimeline.inHierarchyMode)return!1;const t=this.workPackageTimeline.workPackageTable.lastRenderPass;return!!t&&!!t.parentsWithVisibleChildren[e.id]}}Object(A.c)([Object(W.a)(),Object(A.e)("design:type",J.a)],ee.prototype,"wpTableTimeline",void 0),Object(A.c)([Object(W.a)(),Object(A.e)("design:type",K.a)],ee.prototype,"TimezoneService",void 0);class te extends ee{get type(){return"milestone"}isEmpty(e){const t=R(e.date);return _.isNaN(t.valueOf())}canMoveDates(e){return e.schema.date.writable&&e.isAttributeEditable("date")}displayPlaceholderUnderCursor(e,t){const i=Math.floor(e.offsetX/t.viewParams.pixelPerDay),n=document.createElement("div");n.className="timeline-element milestone",n.style.pointerEvents="none",n.style.height="1em",n.style.width="1em",n.style.left=i*t.viewParams.pixelPerDay+"px";const s=document.createElement("div");return s.className="diamond",s.style.left="0.5em",s.style.height="1em",s.style.width="1em",n.appendChild(s),this.applyTypeColor(t,s),n}assignDateValues(e,t,i){this.assignDate(e,"date",i.date),this.updateLabels(!0,t,e)}onDaysMoved(e,t,i,n){const s=e.pristineResource.date;let a={};return s&&(a.date=R(s).add(i,"days")),a}onMouseDown(e,t,i,n,s){if(i.viewParams.activeSelectionMode)return i.viewParams.activeSelectionMode(i.workPackage),e.preventDefault(),"both";let a="both";return this.workPackageTimeline.forceCursor("ew-resize"),t?(i.change.projectedResource.date=t,a="create",a):(this.updateLabels(!0,n,i.change),a)}update(e,t,i){const n=i.viewParams,s=R(i.change.projectedResource.date);if(_.isNaN(s.valueOf()))return!1;const a=jQuery(".diamond",e)[0];a.style.width="15px",a.style.height="15px",a.style.width="15px",a.style.height="15px",a.style.marginLeft=i.viewParams.pixelPerDay/2-7.5+"px",this.applyTypeColor(i,a);const r=s.diff(n.dateDisplayStart,"days");return e.style.left=Object(M.d)(n,r)+"px",t&&this.updateLabels(!1,t,i.change),this.checkForActiveSelectionMode(i,a),!0}getMarginLeftOfLeftSide(e){const t=e.change;const i=R(t.projectedResource.date).diff(e.viewParams.dateDisplayStart,"days");return Object(M.d)(e.viewParams,i)}getMarginLeftOfRightSide(e){return this.getMarginLeftOfLeftSide(e)+e.viewParams.pixelPerDay}getPaddingLeftForIncomingRelationLines(e){return e.viewParams.pixelPerDay/2-1}getPaddingRightForOutgoingRelationLines(e){return 7.5}render(e){const t=document.createElement("div");t.className=M.i+" "+this.type;const i=document.createElement("div");return i.className="diamond",t.appendChild(i),t}createAndAddLabels(e,t){const i=document.createElement("div");i.classList.add("labelLeft","hide-on-hover"),t.appendChild(i);const n=document.createElement("div");n.classList.add("containerRight"),t.appendChild(n);const s=document.createElement("div");s.classList.add("labelRight","hide-on-hover"),n.appendChild(s);const a=document.createElement("div");a.classList.add("labelFarRight","hide-on-hover"),n.appendChild(a);const r=document.createElement("div");r.classList.add("labelHoverRight","show-on-hover","-label-style"),t.appendChild(r);const c=new U(null,i,null,s,r,a);return this.updateLabels(!1,c,e.change),c}renderHoverLabels(e,t){this.renderLabel(t,e,"rightHover","date")}updateLabels(e,t,i){const n=this.wpTableTimeline.getNormalizedLabels(i.projectedResource);e||("startDate"===n.left&&"dueDate"===n.right?(this.renderLabel(i,t,"left",null),this.renderLabel(i,t,"right","date")):(this.renderLabel(i,t,"left",n.left),this.renderLabel(i,t,"right",n.right)),this.renderLabel(i,t,"farRight",n.farRight)),this.renderHoverLabels(t,i)}renderLabel(e,t,i,n){"startDate"!==n&&"dueDate"!==n||(n="date"),super.renderLabel(e,t,i,n)}}class ie{constructor(e,t){this.injector=e,this.wpTimeline=t,this.cells={},this.cellRenderers={milestone:new te(this.injector,t),generic:new ee(this.injector,t)}}hasCell(e){return this.getCellsFor(e).length>0}getCellsFor(e){return _.filter(this.cells,t=>t.workPackageId===e)||[]}refreshAllCells(){this.synchronizeCells(),_.each(this.cells,e=>this.refreshSingleCell(e))}refreshCellsFor(e){_.each(this.getCellsFor(e),e=>this.refreshSingleCell(e))}refreshSingleCell(e){const t=this.renderInfoFor(e.workPackageId);t.workPackage&&e.refreshView(t)}synchronizeCells(){const e=Object.keys(this.cells),t=[];_.each(this.wpTimeline.workPackageIdOrder,e=>{const i=e.workPackageId;if(!i)return;if(this.states.workPackages.get(i).isPristine())return;const n=e.classIdentifier;this.cells[n]||(this.cells[n]=this.buildCell(n,i.toString())),t.push(n)}),_.difference(e,t).forEach(e=>{this.cells[e].clear(),delete this.cells[e]})}buildCell(e,t){return new G(this.injector,this.wpTimeline,this.cellRenderers,this.renderInfoFor(t),e,t)}renderInfoFor(e){const t=this.states.workPackages.get(e).value;return{viewParams:this.wpTimeline.viewParameters,workPackage:t,change:this.halEditing.changeFor(t)}}}Object(A.c)([Object(W.a)(),Object(A.e)("design:type",D.a)],ie.prototype,"states",void 0),Object(A.c)([Object(W.a)(),Object(A.e)("design:type",H.a)],ie.prototype,"halEditing",void 0);var ne=i("uSJ+"),se=i("wyKs"),ae=i("5iud"),re=i("qHU1"),ce=i("itXk"),oe=i("AEvm");class le extends oe.a{constructor(e,t,i,n,s,a,r,c,o,l,d,u){super(),this.injector=e,this.elementRef=t,this.states=i,this.wpTableDirective=n,this.NotificationsService=s,this.wpTableTimeline=a,this.notificationService=r,this.wpRelations=c,this.wpTableHierarchies=o,this.halEvents=l,this.querySpace=d,this.I18n=u,this._viewParameters=new M.a,this.disableViewParamsCalculation=!1,this.workPackageIdOrder=[],this.renderers={},this.cellsRenderer=new ie(this.injector,this),this.selectionParams={notification:null},this.refreshRequest=Object(F.f)()}ngAfterViewInit(){this.$element=jQuery(this.elementRef.nativeElement),this.text={selectionMode:this.I18n.t("js.timelines.selection_mode.notification")},this.outerContainer=this.$element.find(".wp-table-timeline--outer"),this.timelineBody=this.$element.find(".wp-table-timeline--body"),this.wpTableDirective.registerTimeline(this,this.timelineBody[0]),window.addEventListener("wp-resize.timeline",()=>this.refreshRequest.putValue(void 0)),Object(ce.a)([this.querySpace.tableRendered.values$(),this.refreshRequest.changes$(),this.wpTableTimeline.live$()]).pipe(this.untilDestroyed(),Object(B.a)(this.querySpace.stopAllSubscriptions),Object(E.a)(()=>this.initialized&&this.wpTableTimeline.isVisible)).subscribe(([e,t,i])=>{this.workPackageIdOrder=e.filter(e=>!e.hidden),this.refreshView()})}workPackageCells(e){return this.cellsRenderer.getCellsFor(e)}workPackageIndex(e){return this.workPackageIdOrder.findIndex(t=>t.classIdentifier===e)}onRefreshRequested(e,t){this.renderers[e]=t}getAbsoluteLeftCoordinates(){return this.$element.offset().left}getParentScrollContainer(){return this.outerContainer.closest(ae.b)[0]}get viewParameters(){return this._viewParameters}get inHierarchyMode(){return this.wpTableHierarchies.isEnabled}get initialized(){return this.workPackageTable&&this.querySpace.tableRendered.hasValue()}refreshView(){this.wpTableTimeline.isVisible?(this.wpTableTimeline.isAutoZoom()?this.applyAutoZoomLevel():(this._viewParameters.settings.zoomLevel=this.wpTableTimeline.zoomLevel,this.wpTableTimeline.appliedZoomLevel=this.wpTableTimeline.zoomLevel),Object(re.b)("refreshView() in timeline container",()=>{this.outerContainer.css("width","auto"),this.calculateViewParams(this._viewParameters),this.cellsRenderer.refreshAllCells(),_.each(this.renderers,(e,t)=>{Object(re.a)(`Refreshing timeline member ${t}`),e(this._viewParameters)});const e=this.$element.find(M.l)[0].scrollWidth;this.outerContainer.width(e),setTimeout(()=>{this.querySpace.timelineRendered.next(null)})})):Object(re.a)("refreshView() requested, but TL is invisible.")}startAddRelationPredecessor(e){this.activateSelectionMode(e.id,t=>{this.wpRelations.addCommonRelation(e.id,"follows",t.id).then(()=>{this.halEvents.push(e,{eventType:"association",relatedWorkPackage:t.id,relationType:"follows"})}).catch(e=>this.notificationService.handleRawError(e,t))})}startAddRelationFollower(e){this.activateSelectionMode(e.id,t=>{this.wpRelations.addCommonRelation(e.id,"precedes",t.id).then(()=>{this.halEvents.push(e,{eventType:"association",relatedWorkPackage:t.id,relationType:"precedes"})}).catch(e=>this.notificationService.handleRawError(e,t))})}getFirstDayInViewport(){const e=this.getParentScrollContainer().scrollLeft,t=Math.floor(e/this.viewParameters.pixelPerDay);return this.viewParameters.dateDisplayStart.clone().add(t,"days")}getLastDayInViewport(){const e=this.getParentScrollContainer(),t=e.scrollLeft+e.offsetWidth,i=Math.ceil(t/this.viewParameters.pixelPerDay)+1;return this.viewParameters.dateDisplayStart.clone().add(i,"days")}forceCursor(e){jQuery("."+M.i).css("cursor",e),jQuery(".wp-timeline-cell").css("cursor",e),jQuery(".hascontextmenu").css("cursor",e),jQuery(".leftHandle").css("cursor",e),jQuery(".rightHandle").css("cursor",e)}resetCursor(){jQuery("."+M.i).css("cursor",""),jQuery(".wp-timeline-cell").css("cursor",""),jQuery(".hascontextmenu").css("cursor",""),jQuery(".leftHandle").css("cursor",""),jQuery(".rightHandle").css("cursor","")}resetSelectionMode(){this._viewParameters.activeSelectionMode=null,this._viewParameters.selectionModeStart=null,this.selectionParams.notification&&this.NotificationsService.remove(this.selectionParams.notification),Mousetrap.unbind("esc"),this.$element.removeClass("active-selection-mode"),jQuery("."+M.m).removeClass(M.m),this.refreshView()}activateSelectionMode(e,t){e=e.toString(),this._viewParameters.activeSelectionMode=e=>{t(e),this.resetSelectionMode()},this._viewParameters.selectionModeStart=e,Mousetrap.bind("esc",()=>this.resetSelectionMode()),this.selectionParams.notification=this.NotificationsService.addNotice(this.text.selectionMode),this.$element.addClass("active-selection-mode"),this.refreshView()}calculateViewParams(e){if(this.disableViewParamsCalculation)return!1;const t=new M.a;let i=!1;this.workPackageIdOrder.forEach(i=>{const n=i.workPackageId;if(!n)return;const s=this.states.workPackages.get(n).value;if(!s)return;const a=s.startDate?R(s.startDate):e.now,r=s.dueDate?R(s.dueDate):e.now,c=s.date?R(s.date):e.now;t.dateDisplayStart=R.min(t.dateDisplayStart,e.now,a,c),t.dateDisplayEnd=R.max(t.dateDisplayEnd,e.now,r,c)}),t.dateDisplayStart=t.dateDisplayStart.subtract(e.dayCountForMarginLeft,"days");const n=this.$element.children().width(),s=e.pixelPerDay,a=Math.ceil(n/s*1.5);t.dateDisplayEnd=t.dateDisplayEnd.add(a,"days"),t.dateDisplayStart.isSame(this._viewParameters.dateDisplayStart)||(i=!0,this._viewParameters.dateDisplayStart=t.dateDisplayStart),t.dateDisplayEnd.isSame(this._viewParameters.dateDisplayEnd)||(i=!0,this._viewParameters.dateDisplayEnd=t.dateDisplayEnd);const r=[this.getFirstDayInViewport(),this.getLastDayInViewport()];return this._viewParameters.visibleViewportAtCalculationTime=r,i}applyAutoZoomLevel(){if(0===this.workPackageIdOrder.length)return;const e=Object(M.b)(this.workPackageIdOrder,this.states.workPackages,this._viewParameters),t=this.$element.parent().width()-2*M.g;for(let i of M.n){if(t/Object(M.e)(i)>=e||i===_.last(M.n)){return this._viewParameters.settings.zoomLevel!==i&&(this._viewParameters.settings.zoomLevel=i,this.wpTableDirective.timeline.scrollLeft=0),void(this.wpTableTimeline.appliedZoomLevel=i)}}}}le.\u0275fac=function(e){return new(e||le)(r.gc(r.A),r.gc(r.q),r.gc(D.a),r.gc(T.a),r.gc(I.a),r.gc(J.a),r.gc(Y.a),r.gc(ne.a),r.gc(se.a),r.gc(z.a),r.gc(O.a),r.gc(s.a))},le.\u0275cmp=r.ac({type:le,selectors:[["wp-timeline-container"]],features:[r.Qb],decls:7,vars:0,consts:[[1,"wp-table-timeline--outer"],[1,"wp-table-timeline--container"],[1,"wp-table-timeline--body"]],template:function(e,t){1&e&&(r.mc(0,"div",0),r.mc(1,"div",1),r.hc(2,"wp-timeline-header"),r.hc(3,"wp-timeline-static-elements"),r.hc(4,"wp-timeline-grid"),r.hc(5,"wp-timeline-relations"),r.hc(6,"div",2),r.lc(),r.lc())},encapsulation:2});var de=i("6p3c"),ue=i("8YXA"),he=i("PUHT"),pe=i("4lR/"),ge=i("IaZ+"),me=i("JY8V"),fe=i("AeZM"),be=i("6yP5"),we=(i("5HGI"),i("sngl")),ve=i("DvFC"),ye=i("qg8y");class ke extends he.a{constructor(e,t,i,n,s,a,r,c,o,l){super(e,t),this.elementRef=e,this.opContextMenu=t,this.wpTableColumns=i,this.wpTableSortBy=n,this.wpTableGroupBy=s,this.wpTableHierarchies=a,this.opModalService=r,this.injector=c,this.I18n=o,this.confirmDialog=l,this.text={confirmDelete:{text:this.I18n.t("js.work_packages.table_configuration.sorting_mode.warning"),title:this.I18n.t("js.modals.form_submit.title")}}}open(e){this.table.configuration.columnMenuEnabled&&(this.buildItems(),this.opContextMenu.show(this,e))}get locals(){return{showAnchorRight:this.column&&"id"!==this.column.id,contextMenuId:"column-context-menu",items:this.items}}positionArgs(e){let t={of:this.$element.find(".generic-table--sort-header-outer")},i=super.positionArgs(e);return _.assign(i,t),i}get afterFocusOn(){return this.$element.find(`#${this.column.id}`)}buildItems(){let e=this.column;this.items=[{hidden:!this.wpTableSortBy.isSortable(e),linkText:this.I18n.t("js.work_packages.query.sort_descending"),icon:"icon-sort-descending",onClick:t=>this.wpTableSortBy.isManualSortingMode?(this.confirmDialog.confirm({text:this.text.confirmDelete}).then(()=>(this.wpTableSortBy.setAsSingleSortCriteria(e,ye.b),!0)),!1):(this.wpTableSortBy.addSortCriteria(e,ye.b),!0)},{hidden:!this.wpTableSortBy.isSortable(e),linkText:this.I18n.t("js.work_packages.query.sort_ascending"),icon:"icon-sort-ascending",onClick:t=>this.wpTableSortBy.isManualSortingMode?(this.confirmDialog.confirm({text:this.text.confirmDelete}).then(()=>(this.wpTableSortBy.setAsSingleSortCriteria(e,ye.a),!0)),!1):(this.wpTableSortBy.addSortCriteria(e,ye.a),!0)},{hidden:!this.wpTableGroupBy.isGroupable(e)||this.wpTableGroupBy.isCurrentlyGroupedBy(e),linkText:this.I18n.t("js.work_packages.query.group"),icon:"icon-group-by",onClick:()=>(this.wpTableHierarchies.isEnabled&&this.wpTableHierarchies.setEnabled(!1),this.wpTableGroupBy.setBy(e),!0)},{hidden:this.wpTableColumns.isFirst(e),linkText:this.I18n.t("js.work_packages.query.move_column_left"),icon:"icon-column-left",onClick:()=>(this.wpTableColumns.shift(e,-1),!0)},{hidden:this.wpTableColumns.isLast(e),linkText:this.I18n.t("js.work_packages.query.move_column_right"),icon:"icon-column-right",onClick:()=>(this.wpTableColumns.shift(e,1),!0)},{linkText:this.I18n.t("js.work_packages.query.hide_column"),icon:"icon-delete",onClick:()=>{let t=this.wpTableColumns.previous(e)||this.wpTableColumns.next(e);return this.wpTableColumns.removeColumn(e),setTimeout(()=>{t&&jQuery(`#${t.id}`).focus()}),!0}},{linkText:this.I18n.t("js.work_packages.query.insert_columns"),icon:"icon-columns",onClick:()=>(this.opModalService.show(we.a,this.injector,{initialTab:"columns"}),!0)}]}}ke.\u0275fac=function(e){return new(e||ke)(r.gc(r.q),r.gc(pe.a),r.gc(me.a),r.gc(be.a),r.gc(fe.a),r.gc(se.a),r.gc(ge.b),r.gc(r.A),r.gc(s.a),r.gc(ve.a))},ke.\u0275dir=r.bc({type:ke,selectors:[["","opColumnsContextMenu",""]],inputs:{column:["opColumnsContextMenu-column","column"],table:["opColumnsContextMenu-table","table"]},features:[r.Qb]});var Ce=i("FDKb"),je=i("t7qP"),xe=i("1zMF"),Te=i("P7xQ"),Se=i("5gqY");class _e{constructor(e,t,i,n){this.I18n=t,this.wpTimelineService=i,this.workPackageTimelineTableController=n,this.$element=jQuery(e.nativeElement)}ngOnInit(){this.workPackageTimelineTableController.onRefreshRequested("header",e=>this.refreshView(e))}refreshView(e){this.innerHeader=this.$element.find(".wp-table-timeline--header-inner"),this.renderLabels(e)}renderLabels(e){if(this.activeZoomLevel!==e.settings.zoomLevel){switch(this.innerHeader.empty(),this.innerHeader.attr("data-current-zoom-level",this.wpTimelineService.zoomLevel),e.settings.zoomLevel){case"days":return this.renderLabelsDays(e);case"weeks":return this.renderLabelsWeeks(e);case"months":return this.renderLabelsMonths(e);case"quarters":return this.renderLabelsQuarters(e);case"years":return this.renderLabelsYears(e)}this.activeZoomLevel=e.settings.zoomLevel}}renderLabelsDays(e){this.renderTimeSlices(e,"month",0,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("MMM YYYY"),t.classList.add("wp-timeline--header-top-bold-element"),t.style.height="13px"}),this.renderTimeSlices(e,"week",13,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("ww"),t.classList.add("-top-border"),t.style.height="32px"}),this.renderTimeSlices(e,"day",23,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("D"),t.classList.add("-top-border"),t.style.height="22px"}),this.renderTimeSlices(e,"day",33,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("dd"),t.classList.add("wp-timeline--header-day-element")})}renderLabelsWeeks(e){this.renderTimeSlices(e,"month",0,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("MMM YYYY"),t.classList.add("wp-timeline--header-top-bold-element")}),this.renderTimeSlices(e,"week",15,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("ww"),t.classList.add("-top-border"),t.style.height="22px"}),this.renderTimeSlices(e,"day",25,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("D"),t.classList.add("wp-timeline--header-middle-element")})}renderLabelsMonths(e){this.renderTimeSlices(e,"year",0,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("YYYY"),t.classList.add("wp-timeline--header-top-bold-element")}),this.renderTimeSlices(e,"month",15,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("MMM"),t.classList.add("-top-border"),t.style.height="30px"}),this.renderTimeSlices(e,"week",25,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("ww"),t.classList.add("wp-timeline--header-middle-element")})}renderLabelsQuarters(e){this.renderTimeSlices(e,"year",0,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("wp-timeline--header-top-bold-element"),t.innerHTML=e.format("YYYY")}),this.renderTimeSlices(e,"quarter",15,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=this.I18n.t("js.timelines.quarter_label",{quarter_number:e.format("Q")}),t.classList.add("-top-border"),t.style.height="30px"}),this.renderTimeSlices(e,"month",25,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("MMM"),t.classList.add("wp-timeline--header-middle-element")})}renderLabelsYears(e){this.renderTimeSlices(e,"year",0,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("YYYY"),t.classList.add("wp-timeline--header-top-bold-element")}),this.renderTimeSlices(e,"quarter",15,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=this.I18n.t("js.timelines.quarter_label",{quarter_number:e.format("Q")}),t.classList.add("-top-border"),t.style.height="30px"}),this.renderTimeSlices(e,"month",25,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("M"),t.classList.add("wp-timeline--header-middle-element")})}renderTimeSlices(e,t,i,n,s,a){const{inViewportAndBoundaries:r,rest:c}=Object(M.f)(e,t,n,s);for(let[o,l]of r){const t=this.addLabelCell();t.style.top=i+"px",t.style.left=Object(M.c)(e,o.diff(n,"days")),t.style.width=Object(M.c)(e,l.diff(o,"days")+1),a(o,t)}setTimeout(()=>{for(let[t,s]of c){const r=this.addLabelCell();r.style.top=i+"px",r.style.left=Object(M.c)(e,t.diff(n,"days")),r.style.width=Object(M.c)(e,s.diff(t,"days")+1),a(t,r)}},0)}addLabelCell(){const e=document.createElement("div");return e.className=M.k,this.innerHeader.append(e),e}}_e.\u0275fac=function(e){return new(e||_e)(r.gc(r.q),r.gc(s.a),r.gc(J.a),r.gc(le))},_e.\u0275cmp=r.ac({type:_e,selectors:[["wp-timeline-header"]],decls:2,vars:0,consts:[[1,"wp-table-timeline--header"],[1,"wp-table-timeline--header-inner"]],template:function(e,t){1&e&&(r.mc(0,"div",0),r.hc(1,"div",1),r.lc())},encapsulation:2});var Pe=i("lJxs");function Ie(e){return`__tl-relation-${e}`}class Oe{constructor(e,t){this.belongsToId=e,this.relation=t}get classNames(){return[Ie(this.relation.ids.from),Ie(this.relation.ids.to)]}}function Re(e,t,i,n,s,a,r,c){const o=document.createElement("div");return o.classList.add(M.i,"relation-line",...t),o.style.top=40*i+n+"px",o.style.left=s+"px",o.style.width=a+"px",o.style.height=r+"px",o}class Be extends oe.a{constructor(e,t,i,n,s,a){super(),this.injector=e,this.elementRef=t,this.states=i,this.workPackageTimelineTableController=n,this.wpTableTimeline=s,this.wpRelations=a,this.workPackagesWithRelations={}}ngOnInit(){const e=jQuery(this.elementRef.nativeElement);this.container=e.find(".wp-table-timeline--relations"),this.workPackageTimelineTableController.onRefreshRequested("relations",e=>this.refreshView()),this.setupRelationSubscription()}refreshView(){this.update()}get workPackageIdOrder(){return this.workPackageTimelineTableController.workPackageIdOrder}setupRelationSubscription(){Object(ce.a)([this.querySpace.renderedWorkPackages.values$(),this.wpTableTimeline.live$()]).pipe(Object(E.a)(([e,t])=>t.visible),this.untilDestroyed(),Object(Pe.a)(([e,t])=>e)).subscribe(e=>{const t=_.compact(e.map(e=>e.workPackageId));this.wpRelations.requireAll(t),t.forEach(e=>{const t=this.wpRelations.state(e);this.workPackagesWithRelations[e]=t,t.values$().pipe(Object(N.a)(1)).subscribe(()=>{this.renderWorkPackagesRelations([e])})})}),this.states.workPackages.observeChange().pipe(this.untilDestroyed(),Object(E.a)(()=>this.wpTableTimeline.isVisible)).subscribe(([e])=>{this.renderWorkPackagesRelations([e])})}renderWorkPackagesRelations(e){e.forEach(e=>{const t=this.workPackagesWithRelations[e];if(_.isNil(t))return;this.removeRelationElementsForWorkPackage(e);const i=_.values(t.value);_.values(i).forEach(e=>{if("precedes"!==e.type&&"follows"!==e.type)return;const t=new Oe(e.ids.from,e);this.renderElement(this.workPackageTimelineTableController.viewParameters,t)})})}update(){this.removeAllVisibleElements(),this.renderElements()}removeRelationElementsForWorkPackage(e){const t=Ie(e);this.container.find("."+t).remove()}removeAllVisibleElements(){this.container.find(".relation-line").remove()}renderElements(){const e=_.keys(this.workPackagesWithRelations);this.renderWorkPackagesRelations(e)}renderElement(e,t){const i=t.relation.ids,n=this.workPackageTimelineTableController.workPackageCells(i.to),s=this.workPackageTimelineTableController.workPackageCells(i.from);0!==n.length&&0!==s.length&&n.forEach(i=>{const n=this.workPackageTimelineTableController.workPackageIndex(i.classIdentifier);s.forEach(s=>{const a=this.workPackageTimelineTableController.workPackageIndex(s.classIdentifier);this.renderRelation(e,t,n,a,i,s)})})}renderRelation(e,t,i,n,s,a){const r=this.workPackageIdOrder[i],c=this.workPackageIdOrder[n];if(!r||!c||r.hidden||c.hidden)return;if(!s.canConnectRelations()||!a.canConnectRelations())return;const o=s.getMarginLeftOfRightSide()-s.getPaddingRightForOutgoingRelationLines(),l=a.getMarginLeftOfLeftSide()+a.getPaddingLeftForIncomingRelationLines(),d=i<n?"toDown":"toUp",u=l>o?"toRight":l<o?"toLeft":"beneath";if(!s)return;const h=s.getPaddingRightForOutgoingRelationLines(),p=a.getPaddingLeftForIncomingRelationLines()+(h>0?h:0);this.container.append(Re(0,t.classNames,i,19,o,p,1));let g=o+p;const m=Math.abs(n-i);"toDown"===d?"toRight"===u||"beneath"===u?this.container.append(Re(0,t.classNames,i,19,g,1,40*m)):"toLeft"===u&&this.container.append(Re(0,t.classNames,i,19,g,1,40*m-10)):"toUp"===d&&this.container.append(Re(0,t.classNames,n,30,g,1,40*m-10)),"toRight"===u?"toDown"===d?this.container.append(Re(0,t.classNames,n,19,g,l-g,1)):"toUp"===d&&(this.container.append(Re(0,t.classNames,n,20,g,1,10)),this.container.append(Re(0,t.classNames,n,20,g,l-g,1))):"toLeft"===u&&("toDown"===d?(this.container.append(Re(0,t.classNames,n,0,g,1,8)),this.container.append(Re(0,t.classNames,n,8,l,g-l,1)),this.container.append(Re(0,t.classNames,n,8,l,1,11))):"toUp"===d&&(this.container.append(Re(0,t.classNames,n,30,l+1,g-l,1)),this.container.append(Re(0,t.classNames,n,19,l+1,1,11))))}}Be.\u0275fac=function(e){return new(e||Be)(r.gc(r.A),r.gc(r.q),r.gc(D.a),r.gc(le),r.gc(J.a),r.gc(ne.a))},Be.\u0275cmp=r.ac({type:Be,selectors:[["wp-timeline-relations"]],features:[r.Qb],decls:1,vars:0,consts:[[1,"wp-table-timeline--relations"]],template:function(e,t){1&e&&r.hc(0,"div",0)},encapsulation:2}),Object(A.c)([Object(W.a)(),Object(A.e)("design:type",O.a)],Be.prototype,"querySpace",void 0);class Ee extends class{constructor(){}render(e){const t=document.createElement("div");return t.id=this.identifier,t.classList.add(...this.classNames),this.finishElement(t,e)}get classNames(){return["wp-timeline--static-element"]}}{finishElement(e,t){const i=t.now.diff(t.dateDisplayStart,"days"),n=R().hour()/24;return e.style.left=Object(M.c)(t,i+n),e}get identifier(){return"wp-timeline-static-element-today-line"}}class Me{constructor(e,t,i){this.states=t,this.workPackageTimelineTableController=i,this.$element=jQuery(e.nativeElement),this.elements=[new Ee]}ngOnInit(){this.container=this.$element.find(".wp-table-timeline--static-elements"),this.workPackageTimelineTableController.onRefreshRequested("static elements",e=>this.update(e))}update(e){this.removeAllVisibleElements(),this.renderElements(e)}removeAllVisibleElements(){jQuery(".wp-timeline--static-element").remove()}renderElements(e){for(const t of this.elements)this.container[0].appendChild(t.render(e))}}function Fe(e,t){const i=e.day();0!==i&&6!==i||t.classList.add("grid-weekend")}Me.\u0275fac=function(e){return new(e||Me)(r.gc(r.q),r.gc(D.a),r.gc(le))},Me.\u0275cmp=r.ac({type:Me,selectors:[["wp-timeline-static-elements"]],decls:1,vars:0,consts:[[1,"wp-table-timeline--static-elements"]],template:function(e,t){1&e&&r.hc(0,"div",0)},encapsulation:2});class Ae{constructor(e,t){this.elementRef=e,this.wpTimeline=t}ngAfterViewInit(){const e=jQuery(this.elementRef.nativeElement);this.gridContainer=e.find(".wp-table-timeline--grid"),this.wpTimeline.onRefreshRequested("grid",e=>this.refreshView(e))}refreshView(e){this.renderLabels(e)}renderLabels(e){if(this.activeZoomLevel!==e.settings.zoomLevel){switch(this.gridContainer.empty(),e.settings.zoomLevel){case"days":return this.renderLabelsDays(e);case"weeks":return this.renderLabelsWeeks(e);case"months":return this.renderLabelsMonths(e);case"quarters":return this.renderLabelsQuarters(e);case"years":return this.renderLabelsYears(e)}this.activeZoomLevel=e.settings.zoomLevel}}renderLabelsDays(e){this.renderTimeSlices(e,"day",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.style.paddingTop="1px",Fe(e,t)}),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight"),t.style.zIndex="2"})}renderLabelsWeeks(e){this.renderTimeSlices(e,"day",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{Fe(e,t)}),this.renderTimeSlices(e,"week",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight")}),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight"),t.style.zIndex="2"})}renderLabelsMonths(e){this.renderTimeSlices(e,"week",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{}),this.renderTimeSlices(e,"month",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight")}),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight"),t.style.zIndex="2"})}renderLabelsQuarters(e){this.renderTimeSlices(e,"month",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{}),this.renderTimeSlices(e,"quarter",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight")}),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight"),t.style.zIndex="2"})}renderLabelsYears(e){this.renderTimeSlices(e,"month",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{}),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight")})}renderTimeSlices(e,t,i,n,s){const{inViewportAndBoundaries:a,rest:r}=Object(M.f)(e,t,i,n);for(let[c,o]of a){const t=document.createElement("div");t.classList.add(M.i,M.j),t.style.left=Object(M.c)(e,c.diff(i,"days")),t.style.width=Object(M.c)(e,o.diff(c,"days")+1),this.gridContainer[0].appendChild(t),s(c,t)}setTimeout(()=>{for(let[t,n]of r){const a=document.createElement("div");a.classList.add(M.i,M.j),a.style.left=Object(M.c)(e,t.diff(i,"days")),a.style.width=Object(M.c)(e,n.diff(t,"days")+1),this.gridContainer[0].appendChild(a),s(t,a)}},0)}}Ae.\u0275fac=function(e){return new(e||Ae)(r.gc(r.q),r.gc(le))},Ae.\u0275cmp=r.ac({type:Ae,selectors:[["wp-timeline-grid"]],decls:1,vars:0,consts:[[1,"wp-table-timeline--grid"]],template:function(e,t){1&e&&r.hc(0,"div",0)},encapsulation:2});var De=i("ul8C"),qe=i("gvAf"),Le=i("K8b8"),$e=i("4Obc"),Ne=i("+pCT"),Qe=i("vd15"),Ve=i("9oW/"),He=i("Tcty"),ze=i("Wo/B"),Ye=i("oLh2"),We=i("0XIV"),Ue=i("ODu2"),Ge=i("xRac"),Xe=i("kY/U"),Ke=i("lJGx"),Ze=i("S2zE"),Je=i("9pt+"),et=i("2orT"),tt=i("m3nR"),it=i("8+xT"),nt=i("ZAVI"),st=i("qs3h"),at=i("m0WY"),rt=i("BV52"),ct=i("s/U8"),ot=i("60np"),lt=i("4fzr"),dt=i("2TbE"),ut=i("Eofd"),ht=i("p5fp"),pt=i("eaMR"),gt=i("70hh"),mt=i("Ndcw"),ft=i("TAxG"),bt=i("72I8"),wt=i("DiYd"),vt=i("67Ga"),yt=i("SgrZ"),kt=i("ahm3"),Ct=i("q/QC"),jt=i("OhNT"),xt=i("BjK6"),Tt=i("r76g"),St=i("Uprc"),_t=i("byj5"),Pt=i("YO9K"),It=i("hj8t"),Ot=i("yUKD"),Rt=i("AcWF"),Bt=i("ylTo"),Et=(i("y2Tr"),i("th4C")),Mt=i("u8Ab"),Ft=i("/Rze"),At=i("N5AO");const Dt=function(e){return{deleting:e}};class qt{constructor(e,t){this.I18n=e,this.panelCtrl=t,this.deleting=!1}ngOnInit(){this.text={remove:this.I18n.t("js.label_remove_watcher",{name:this.watcher.name})}}remove(){this.deleting=!0,this.panelCtrl.removeWatcher(this.watcher)}}qt.\u0275fac=function(e){return new(e||qt)(r.gc(s.a),r.gc(Bt.a))},qt.\u0275cmp=r.ac({type:qt,selectors:[["wp-watcher-entry"]],inputs:{watcher:"watcher"},decls:8,vars:10,consts:[["focus-within","accessible-by-keyboard",1,"form--selected-value--container"],[1,"form--selected-value"],[3,"ngClass"],["data-class-list","avatar-mini"],[1,"work-package--watcher-name",3,"textContent"],["linkClass","form--selected-value--remover",3,"linkAriaLabel","linkTitle","execute"],["icon-classes","icon-remove",3,"icon-title"]],template:function(e,t){1&e&&(r.mc(0,"div",0),r.mc(1,"span",1),r.mc(2,"span",2),r.mc(3,"a"),r.hc(4,"user-avatar",3),r.hc(5,"span",4),r.lc(),r.lc(),r.lc(),r.mc(6,"accessible-by-keyboard",5),r.uc("execute",(function(){return t.remove()})),r.hc(7,"op-icon",6),r.lc(),r.lc()),2&e&&(r.Tb(2),r.Bc("ngClass",r.Gc(8,Dt,t.deleting)),r.Tb(1),r.Ub("href",t.watcher.showUser.href,r.Tc),r.Tb(1),r.Ub("data-user-name",t.watcher.name)("data-user-id",t.watcher.id),r.Tb(1),r.Bc("textContent",t.watcher.name),r.Tb(1),r.Bc("linkAriaLabel",t.text.remove)("linkTitle",t.text.remove),r.Tb(1),r.Bc("icon-title",t.text.remove))},directives:[Et.a,c.n,Mt.a,Ft.a,At.a],encapsulation:2});var Lt=i("VYxi"),$t=i("4fM7"),Nt=i("XZlt"),Qt=i("ZGxV"),Vt=i("kZPr"),Ht=i("F3Jm"),zt=i("u/Nd"),Yt=i("VPzE"),Wt=i("UUNb"),Ut=i("k1Xe"),Gt=i("saRB"),Xt=i("TrTv"),Kt=i("Xmgp"),Zt=i("J30J"),Jt=i("EnRq");class ei{constructor(e,t,i,n,s,a,r,c){this.injector=e,this.elementRef=t,this.querySpace=i,this.states=n,this.displayFieldService=s,this.wpTableColumns=a,this.wpTableSums=r,this.I18n=c,this.text={sum:c.t("js.label_sum")}}ngAfterViewInit(){this.$element=jQuery(this.elementRef.nativeElement),Object(ce.a)([this.wpTableColumns.live$(),this.wpTableSums.live$(),this.querySpace.results.values$()]).pipe(Object(B.a)(this.querySpace.stopAllSubscriptions)).subscribe(([e,t,i])=>{t&&i.sumsSchema?i.sumsSchema.$load().then(t=>{this.refresh(e,i,t)}):this.clear()})}clear(){this.$element.empty()}refresh(e,t,i){this.clear(),this.render(e,t,i)}render(e,t,i){e.forEach((e,n)=>{const s=document.createElement("td");s.classList.add("wp-table--sum-container");const a=this.renderContent(t.totalSums,e.id,i[e.id]);0===n&&(this.appendFirstLabel(a),s.setAttribute("colspan","2")),s.appendChild(a),this.$element.append(s)}),this.$element.append('<td><div class="generic-table--footer-outer"></div></td>')}renderContent(e,t,i){const n=document.createElement("div");if(!i)return n;const s=this.displayFieldService.getField(e,t,i,{injector:this.injector,container:"table",options:{}});return s.isEmpty()||s.render(n,s.valueString),n}appendFirstLabel(e){const t=document.createElement("span");t.textContent=`${this.text.sum}`,jQuery(e).prepend(t)}}ei.\u0275fac=function(e){return new(e||ei)(r.gc(r.A),r.gc(r.q),r.gc(O.a),r.gc(D.a),r.gc(Zt.a),r.gc(me.a),r.gc(Jt.a),r.gc(s.a))},ei.\u0275dir=r.bc({type:ei,selectors:[["","wpTableSumsRow",""]]});var ti=i("WgCp"),ii=i("oJ+N"),ni=i("Ioun"),si=i("CK39"),ai=i("kTg4"),ri=i("l4W+"),ci=i("dMmB"),oi=i("VFHb"),li=i("mMv8"),di=i("PkGb"),ui=i("OGNV"),hi=i("t+3x"),pi=i("i95X"),gi=i("Jui0"),mi=i("pL6k"),fi=i("sl7t"),bi=i("FDFi"),wi=i("Rky/"),vi=i("Yblc");i("B4Ei");function yi(e,t){if(1&e&&(r.mc(0,"div",4),r.mc(1,"div",5),r.hc(2,"h3",6),r.lc(),r.lc()),2&e){const e=r.wc(2);r.Tb(2),r.Bc("textContent",e.group.name)}}const ki=function(e){return{actionsColumnEnabled:!0,hierarchyToggleEnabled:!1,inlineCreateEnabled:!0,compactTableStyle:!0,columnMenuEnabled:!1,contextMenuEnabled:!1,projectIdentifier:e,projectContext:!1}};function Ci(e,t){if(1&e){const e=r.nc();r.kc(0),r.Yc(1,yi,3,1,"div",1),r.mc(2,"wp-embedded-table",2,3),r.uc("onQueryLoaded",(function(t){return r.Qc(e),r.wc().handleQueryLoaded(t)})),r.lc(),r.jc()}if(2&e){const e=r.wc();r.Tb(1),r.Bc("ngIf",e.group),r.Tb(1),r.Bc("initialLoadingIndicator",!1)("queryProps",e.queryProps)("tableActions",e.tableActions)("configuration",r.Gc(5,ki,e.workPackage.project.idFromLink))}}class ji extends wi.a{constructor(e,t,i,n,s,a,r){super(s),this.PathHelper=e,this.wpInlineCreate=t,this.wpRelations=i,this.halEvents=n,this.queryUrlParamsHelper=s,this.notificationService=a,this.I18n=r,this.tableActions=[fi.a.factoryFor("remove-relation-action",this.I18n.t("js.relation_buttons.remove"),e=>{this.embeddedTable.loadingIndicator=this.wpRelations.require(e.id).then(()=>this.wpInlineCreate.remove(this.workPackage,e)).then(()=>this.refreshTable()).catch(e=>this.notificationService.handleRawError(e,this.workPackage))},e=>!!e.changeParent)]}ngOnInit(){let e=this.getRelationTypeFromQuery();this.wpInlineCreate.referenceTarget=this.workPackage,this.wpInlineCreate.relationType=e,this.queryProps=this.buildQueryProps(),this.wpInlineCreate.newInlineWorkPackageCreated.pipe(this.untilDestroyed()).subscribe(e=>this.addRelation(e)),this.wpRelations.observe(this.workPackage.id).pipe(Object(E.a)(e=>!_.isEmpty(e)),this.untilDestroyed()).subscribe(()=>this.refreshTable())}addRelation(e){this.wpInlineCreate.add(this.workPackage,e).then(()=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:e,relationType:this.getRelationTypeFromQuery()})}).catch(e=>this.notificationService.handleRawError(e,this.workPackage))}getRelationTypeFromQuery(){return this.group.relationType}}ji.\u0275fac=function(e){return new(e||ji)(r.gc(gi.a),r.gc(bi.a),r.gc(ne.a),r.gc(z.a),r.gc(mi.a),r.gc(Y.a),r.gc(s.a))},ji.\u0275cmp=r.ac({type:ji,selectors:[["wp-relation-query"]],inputs:{workPackage:"workPackage",query:"query",group:"group"},features:[r.Sb([{provide:bi.a,useClass:vi.a}]),r.Qb],decls:1,vars:1,consts:[[4,"ngIf"],["class","attributes-group--header",4,"ngIf"],[3,"initialLoadingIndicator","queryProps","tableActions","configuration","onQueryLoaded"],["embeddedTable",""],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"]],template:function(e,t){1&e&&r.Yc(0,Ci,4,7,"ng-container",0),2&e&&r.Bc("ngIf",!t.hidden)},directives:[c.q,j.a],encapsulation:2});var xi=i("YefF"),Ti=i("PwL/"),Si=i("rJ6b"),_i=i("2yvi"),Pi=i("5mBr"),Ii=i("Q2ix"),Oi=i("1SJX"),Ri=i("hvpr"),Bi=i("HEQ6"),Ei=i("5JuZ"),Mi=i("w6CH"),Fi=i("MIK2"),Ai=i("wOIT");class Di{constructor(e,t,i,n){this.I18n=e,this.injector=t,this.opModalService=i,this.opContextMenu=n}ngOnInit(){this.text={configureTable:I18n.t("js.toolbar.settings.configure_view")}}openTableConfigurationModal(){this.opContextMenu.close(),this.opModalService.show(we.a,this.injector)}}Di.\u0275fac=function(e){return new(e||Di)(r.gc(s.a),r.gc(r.A),r.gc(ge.b),r.gc(pe.a))},Di.\u0275cmp=r.ac({type:Di,selectors:[["wp-table-config-menu"]],decls:2,vars:2,consts:[["linkClass","wp-table--columns-selection",3,"linkTitle","linkAriaLabel","execute"],["icon-classes","icon-button icon-small icon-settings"]],template:function(e,t){1&e&&(r.mc(0,"accessible-by-keyboard",0),r.uc("execute",(function(){return t.openTableConfigurationModal()})),r.hc(1,"op-icon",1),r.lc()),2&e&&r.Bc("linkTitle",t.text.configureTable)("linkAriaLabel",t.text.configureTable)},directives:[Ft.a,At.a],encapsulation:2});var qi=i("ZTEj"),Li=i("XlgE"),$i=i("eJFM"),Ni=i("+B5R"),Qi=i("GZlY"),Vi=i("2bW2"),Hi=i("+NA0"),zi=i("SIjI"),Yi=i("GntA");class Wi extends Yi.a{setValue(e,t){super.setValue(e,t),"workPackage"===e&&this.updateForm()}buildPayloadFromChanges(){let e=super.buildPayloadFromChanges();return delete e._links.project,e}}var Ui=i("fdeW"),Gi=i("ahVz"),Xi=i("hxzR"),Ki=i("EzE4"),Zi=i("DLfB"),Ji=i("yOxh"),en=i("0loS"),tn=i("3Pt+"),nn=i("+rOU"),sn=i("5+WD"),an=i("kor4"),rn=i("1EAr"),cn=i("ZOsW"),on=i("ximh"),ln=i("ecJW"),dn=i("QihR"),un=i("RN/J"),hn=i("YIAj"),pn=i("oUDv"),gn=i("2hMx"),mn=i("+1L4"),fn=i("cJ7v"),bn=i("lmKF"),wn=i("HN1l"),vn=i("v9+U"),yn=i("mRSd"),kn=i("X4Sm"),Cn=i("qvi4"),jn=i("lfQJ"),xn=i("AdL0"),Tn=i("8h6p"),Sn=i("IYP9"),_n=i("upbp"),Pn=i("CV67"),In=i("xFOf"),On=i("CS/5"),Rn=i("gh2L"),Bn=i("jQQo"),En=i("32V0"),Mn=i("7MH/"),Fn=i("feia"),An=i("k8lp"),Dn=i("jEcX"),qn=i("xiBa"),Ln=i("zTuL");class $n{constructor(e){$n.bootstrapAttributeGroups(e)}static bootstrapAttributeGroups(e){if(this.bootstrapAttributeGroupsCalled)return;this.bootstrapAttributeGroupsCalled=!0;const t=e.get(C.a);t.register("attributeGroupComponent",(e,t)=>"WorkPackageFormAttributeGroup"===e.type?v:t.isNew||"WorkPackageFormChildrenQueryGroup"!==e.type?t.isNew||"WorkPackageFormRelationQueryGroup"!==e.type?null:ji:hi.a),t.register("workPackageAttachmentUploadComponent",e=>_i.a),t.register("workPackageAttachmentListComponent",e=>Pi.a),t.register("halResourceChangesetClass",e=>{switch(e._type){case"WorkPackage":return Hi.a;case"TimeEntry":return Wi;default:return null}})}}$n.bootstrapAttributeGroupsCalled=!1,$n.\u0275mod=r.ec({type:$n}),$n.\u0275inj=r.dc({factory:function(e){return new(e||$n)(r.qc(r.A))},providers:[Y.a,ii.a,si.a,q.a,ci.a,Oi.a,ai.a,ri.a,ne.a,q.a,ci.a,di.a,Ei.a,li.a,ne.a,oi.a,ui.a,z.a],imports:[[n.a,y.a,Kt.a,Ge.a,Mi.a,Qi.a]]}),r.Uc(T.a,[en.UISref,en.AnchorUISref,en.UIView,en.UISrefActive,en.UISrefStatus,c.n,c.o,c.p,c.q,c.x,c.t,c.u,c.v,c.w,c.r,c.s,tn.C,tn.r,tn.B,tn.c,tn.s,tn.v,tn.a,tn.y,tn.z,tn.u,tn.m,tn.n,tn.x,tn.k,tn.j,tn.t,tn.b,tn.d,tn.p,tn.q,tn.o,nn.a,nn.b,nn.h,nn.e,sn.e,sn.f,sn.a,sn.b,sn.d,sn.c,an.a,rn.a,Ft.a,cn.a,cn.n,cn.d,cn.c,cn.e,cn.f,cn.g,cn.h,cn.i,cn.j,cn.k,cn.l,cn.m,on.a,ln.a,dn.a,At.a,un.a,l.a,hn.a,Et.a,pn.a,gn.a,mn.a,fn.a,bn.a,wn.a,vn.a,yn.a,kn.a,Cn.a,jn.a,xn.a,Tn.a,Sn.a,_n.a,Pn.a,Mt.a,In.a,On.c,On.d,On.a,On.b,On.e,Rn.a,Bn.a,En.a,Mn.a,a.a,d.a,Fn.a,An.a,_i.a,Pi.a,Dn.a,qn.a,Ln.a,xi.a,Gi.a,Xi.a,Ui.a,Ki.a,Bi.a,qi.a,Vt.a,Qt.a,Nt.a,Vi.a,Lt.a,$t.a,j.a,x.a,ti.a,ni.a,de.a,pi.a,$i.a,T.a,Di,S.a,P.a,ei,gt.a,mt.a,ft.a,bt.a,wt.a,vt.a,yt.a,kt.a,Ct.a,jt.a,pt.a,ht.a,ue.a,ke,Ce.a,je.a,xe.a,Te.a,Se.a,Ni.a,De.a,_e,Be,Me,Ae,le,dt.a,Ii.a,qe.a,k.a,Le.a,o.a,Ne.a,hi.a,ji,v,Zi.a,$e.a,Qe.a,Ve.a,He.a,ze.a,Ye.a,We.a,Ue.a,Bt.a,qt,st.a,at.a,rt.a,ct.a,ot.a,lt.a,Fi.a,ut.a,xt.a,Ti.a,Ze.a,Je.a,et.a,tt.a,it.a,nt.a,Si.a,we.a,Tt.a,St.a,_t.a,Pt.a,It.a,Ot.a,Rt.a,Ht.a,Ut.a,zt.a,Yt.a,Wt.a,Ji.a,Xe.a,Ke.a,Ai.a,Gt.a,Xt.a,Ri.a,zi.a,Li.a],[c.a,c.C,c.m,c.j,c.A,c.f,c.z,c.B,c.c,c.e,c.h,c.i,c.k]),r.Uc(le,[en.UISref,en.AnchorUISref,en.UIView,en.UISrefActive,en.UISrefStatus,c.n,c.o,c.p,c.q,c.x,c.t,c.u,c.v,c.w,c.r,c.s,tn.C,tn.r,tn.B,tn.c,tn.s,tn.v,tn.a,tn.y,tn.z,tn.u,tn.m,tn.n,tn.x,tn.k,tn.j,tn.t,tn.b,tn.d,tn.p,tn.q,tn.o,nn.a,nn.b,nn.h,nn.e,sn.e,sn.f,sn.a,sn.b,sn.d,sn.c,an.a,rn.a,Ft.a,cn.a,cn.n,cn.d,cn.c,cn.e,cn.f,cn.g,cn.h,cn.i,cn.j,cn.k,cn.l,cn.m,on.a,ln.a,dn.a,At.a,un.a,l.a,hn.a,Et.a,pn.a,gn.a,mn.a,fn.a,bn.a,wn.a,vn.a,yn.a,kn.a,Cn.a,jn.a,xn.a,Tn.a,Sn.a,_n.a,Pn.a,Mt.a,In.a,On.c,On.d,On.a,On.b,On.e,Rn.a,Bn.a,En.a,Mn.a,a.a,d.a,Fn.a,An.a,_i.a,Pi.a,Dn.a,qn.a,Ln.a,xi.a,Gi.a,Xi.a,Ui.a,Ki.a,Bi.a,qi.a,Vt.a,Qt.a,Nt.a,Vi.a,Lt.a,$t.a,j.a,x.a,ti.a,ni.a,de.a,pi.a,$i.a,T.a,Di,S.a,P.a,ei,gt.a,mt.a,ft.a,bt.a,wt.a,vt.a,yt.a,kt.a,Ct.a,jt.a,pt.a,ht.a,ue.a,ke,Ce.a,je.a,xe.a,Te.a,Se.a,Ni.a,De.a,_e,Be,Me,Ae,le,dt.a,Ii.a,qe.a,k.a,Le.a,o.a,Ne.a,hi.a,ji,v,Zi.a,$e.a,Qe.a,Ve.a,He.a,ze.a,Ye.a,We.a,Ue.a,Bt.a,qt,st.a,at.a,rt.a,ct.a,ot.a,lt.a,Fi.a,ut.a,xt.a,Ti.a,Ze.a,Je.a,et.a,tt.a,it.a,nt.a,Si.a,we.a,Tt.a,St.a,_t.a,Pt.a,It.a,Ot.a,Rt.a,Ht.a,Ut.a,zt.a,Yt.a,Wt.a,Ji.a,Xe.a,Ke.a,Ai.a,Gt.a,Xt.a,Ri.a,zi.a,Li.a],[c.a,c.C,c.m,c.j,c.A,c.f,c.z,c.B,c.c,c.e,c.h,c.i,c.k]),r.Uc(Bt.a,[en.UISref,en.AnchorUISref,en.UIView,en.UISrefActive,en.UISrefStatus,c.n,c.o,c.p,c.q,c.x,c.t,c.u,c.v,c.w,c.r,c.s,tn.C,tn.r,tn.B,tn.c,tn.s,tn.v,tn.a,tn.y,tn.z,tn.u,tn.m,tn.n,tn.x,tn.k,tn.j,tn.t,tn.b,tn.d,tn.p,tn.q,tn.o,nn.a,nn.b,nn.h,nn.e,sn.e,sn.f,sn.a,sn.b,sn.d,sn.c,an.a,rn.a,Ft.a,cn.a,cn.n,cn.d,cn.c,cn.e,cn.f,cn.g,cn.h,cn.i,cn.j,cn.k,cn.l,cn.m,on.a,ln.a,dn.a,At.a,un.a,l.a,hn.a,Et.a,pn.a,gn.a,mn.a,fn.a,bn.a,wn.a,vn.a,yn.a,kn.a,Cn.a,jn.a,xn.a,Tn.a,Sn.a,_n.a,Pn.a,Mt.a,In.a,On.c,On.d,On.a,On.b,On.e,Rn.a,Bn.a,En.a,Mn.a,a.a,d.a,Fn.a,An.a,_i.a,Pi.a,Dn.a,qn.a,Ln.a,xi.a,Gi.a,Xi.a,Ui.a,Ki.a,Bi.a,qi.a,Vt.a,Qt.a,Nt.a,Vi.a,Lt.a,$t.a,j.a,x.a,ti.a,ni.a,de.a,pi.a,$i.a,T.a,Di,S.a,P.a,ei,gt.a,mt.a,ft.a,bt.a,wt.a,vt.a,yt.a,kt.a,Ct.a,jt.a,pt.a,ht.a,ue.a,ke,Ce.a,je.a,xe.a,Te.a,Se.a,Ni.a,De.a,_e,Be,Me,Ae,le,dt.a,Ii.a,qe.a,k.a,Le.a,o.a,Ne.a,hi.a,ji,v,Zi.a,$e.a,Qe.a,Ve.a,He.a,ze.a,Ye.a,We.a,Ue.a,Bt.a,qt,st.a,at.a,rt.a,ct.a,ot.a,lt.a,Fi.a,ut.a,xt.a,Ti.a,Ze.a,Je.a,et.a,tt.a,it.a,nt.a,Si.a,we.a,Tt.a,St.a,_t.a,Pt.a,It.a,Ot.a,Rt.a,Ht.a,Ut.a,zt.a,Yt.a,Wt.a,Ji.a,Xe.a,Ke.a,Ai.a,Gt.a,Xt.a,Ri.a,zi.a,Li.a],[c.a,c.C,c.m,c.j,c.A,c.f,c.z,c.B,c.c,c.e,c.h,c.i,c.k]),r.Uc(Ri.a,[en.UISref,en.AnchorUISref,en.UIView,en.UISrefActive,en.UISrefStatus,c.n,c.o,c.p,c.q,c.x,c.t,c.u,c.v,c.w,c.r,c.s,tn.C,tn.r,tn.B,tn.c,tn.s,tn.v,tn.a,tn.y,tn.z,tn.u,tn.m,tn.n,tn.x,tn.k,tn.j,tn.t,tn.b,tn.d,tn.p,tn.q,tn.o,nn.a,nn.b,nn.h,nn.e,sn.e,sn.f,sn.a,sn.b,sn.d,sn.c,an.a,rn.a,Ft.a,cn.a,cn.n,cn.d,cn.c,cn.e,cn.f,cn.g,cn.h,cn.i,cn.j,cn.k,cn.l,cn.m,on.a,ln.a,dn.a,At.a,un.a,l.a,hn.a,Et.a,pn.a,gn.a,mn.a,fn.a,bn.a,wn.a,vn.a,yn.a,kn.a,Cn.a,jn.a,xn.a,Tn.a,Sn.a,_n.a,Pn.a,Mt.a,In.a,On.c,On.d,On.a,On.b,On.e,Rn.a,Bn.a,En.a,Mn.a,a.a,d.a,Fn.a,An.a,_i.a,Pi.a,Dn.a,qn.a,Ln.a,xi.a,Gi.a,Xi.a,Ui.a,Ki.a,Bi.a,qi.a,Vt.a,Qt.a,Nt.a,Vi.a,Lt.a,$t.a,j.a,x.a,ti.a,ni.a,de.a,pi.a,$i.a,T.a,Di,S.a,P.a,ei,gt.a,mt.a,ft.a,bt.a,wt.a,vt.a,yt.a,kt.a,Ct.a,jt.a,pt.a,ht.a,ue.a,ke,Ce.a,je.a,xe.a,Te.a,Se.a,Ni.a,De.a,_e,Be,Me,Ae,le,dt.a,Ii.a,qe.a,k.a,Le.a,o.a,Ne.a,hi.a,ji,v,Zi.a,$e.a,Qe.a,Ve.a,He.a,ze.a,Ye.a,We.a,Ue.a,Bt.a,qt,st.a,at.a,rt.a,ct.a,ot.a,lt.a,Fi.a,ut.a,xt.a,Ti.a,Ze.a,Je.a,et.a,tt.a,it.a,nt.a,Si.a,we.a,Tt.a,St.a,_t.a,Pt.a,It.a,Ot.a,Rt.a,Ht.a,Ut.a,zt.a,Yt.a,Wt.a,Ji.a,Xe.a,Ke.a,Ai.a,Gt.a,Xt.a,Ri.a,zi.a,Li.a],[c.a,c.C,c.m,c.j,c.A,c.f,c.z,c.B,c.c,c.e,c.h,c.i,c.k])},W6hW:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("iB+3"),s=i("pL6k"),a=i("fXoL");class r{constructor(e,t){this.UrlParamsHelper=e,this.$state=t}updateIfDifferent(e,t){let i=this.getNewChecksum(e,t),n=Promise.resolve();return this.isUninitialized()||(this.isIdDifferent(e.id)?(n=this.maintainUrlQueryState(e.id,null),this.clear()):this.isChecksumDifferent(i)&&(n=this.maintainUrlQueryState(e.id,i))),this.set(e.id,i),n}update(e,t){let i=this.getNewChecksum(e,t);this.set(e.id,i),this.maintainUrlQueryState(e.id,i)}setToQuery(e,t){let i=this.getNewChecksum(e,t);return this.set(e.id,i),this.maintainUrlQueryState(e.id,null)}isQueryOutdated(e,t){let i=this.getNewChecksum(e,t);return this.isOutdated(e.id,i)}executeIfOutdated(e,t,i){(this.isUninitialized()||this.isOutdated(e,t))&&(this.set(e,t),i())}set(e,t){this.id=e,this.checksum=t}clear(){this.id=null,this.checksum=null,this.visibleChecksum=null}isUninitialized(){return!this.id&&!this.checksum}isIdDifferent(e){return this.id!==e}isChecksumDifferent(e){return this.checksum&&e!==this.checksum}isOutdated(e,t){const i=!!this.id,n=!!this.checksum,s=this.id!==e,a=t!==this.checksum,r=this.checksum&&!t&&this.visibleChecksum;return(i||n)&&(s||!s&&a&&(t||this.visibleChecksum)||!i&&r)}getNewChecksum(e,t){return this.UrlParamsHelper.encodeQueryJsonParams(e,_.pick(t,["page","perPage"]))}maintainUrlQueryState(e,t){return this.visibleChecksum=t,this.$state.go(".",{query_props:t,query_id:e},{custom:{notify:!1}})}}r.\u0275fac=function(e){return new(e||r)(a.qc(s.a),a.qc(n.G))},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac})},WUI6:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));const n=new(i("fXoL").z)("CardEventHandler");class s{constructor(e){this.injector=e}attachTo(e){this.eventHandlers.map(t=>{let i=t(e);return i.eventScope(e).on(i.EVENT,i.SELECTOR,t=>{i.handleEvent(e,t)}),i})}}},"WW/2":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("E2tj"),s=i("fXoL");class a{constructor(e){this.querySpace=e}classIdentifier(e){return`wp-row-${e.id}`}get renderedCards(){return this.querySpace.tableRendered.getValueOr([])}findRenderedCard(e){return _.findIndex(this.renderedCards,t=>t.classIdentifier===e)}updateRenderedCardsValues(e){this.querySpace.tableRendered.putValue(e.map(e=>({classIdentifier:this.classIdentifier(e),workPackageId:e.id,hidden:!1})))}}a.\u0275fac=function(e){return new(e||a)(s.qc(n.a))},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac})},Wcm6:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("6DMU"),s=i("SJoB"),a=i("yIst"),r=i("WUI6");class c extends r.a{constructor(){super(...arguments),this.eventHandlers=[e=>new n.a(this.injector,e),e=>new s.a(this.injector,e),e=>new a.a(this.injector,e)]}}},WgCp:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("72oW"),s=i("tN7n"),a=i("0zio"),r=i("ho3E"),c=i("fXoL"),o=i("HEQ6");const l=["embeddedTableForConfiguration"],d=function(){return{}},u=function(){return{tableVisible:!1}};class h{constructor(e,t){this.locals=e,this.cdRef=t}ngAfterViewInit(){setTimeout(()=>{this.embeddedTable.openConfigurationModal(()=>{this.service.detach(),this.locals.callback(this.embeddedTable.buildQueryProps())}),this.cdRef.detectChanges()})}get service(){return this.locals.service}}h.\u0275fac=function(e){return new(e||h)(c.gc(r.a),c.gc(c.i))},h.\u0275cmp=c.ac({type:h,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&c.Wc(l,!0),2&e)&&(c.Nc(i=c.vc())&&(t.embeddedTable=i.first))},features:[c.Sb([[{provide:s.a,useClass:a.a}]])],decls:3,vars:4,consts:[["wp-isolated-query-space",""],[3,"queryProps","configuration"],["embeddedTableForConfiguration",""]],template:function(e,t){1&e&&(c.kc(0,0),c.hc(1,"wp-embedded-table",1,2),c.jc()),2&e&&(c.Tb(1),c.Bc("queryProps",t.locals.currentQuery||c.Fc(2,d))("configuration",c.Fc(3,u)))},directives:[o.a,n.a],encapsulation:2})},Wi9d:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("UD+K"),s=i("FnNU"),a=i("CZZR"),r=i("fXoL");class c extends n.a{constructor(e){super(),this.boardDm=e,this._state=Object(s.g)()}load(e){return this.boardDm.one(parseInt(e)).toPromise().then(t=>(this.updateValue(e,t),t))}loadAll(e=[]){return Promise.all(e.map(e=>this.load(e))).then(()=>{})}get multiState(){return this._state}update(e){this.updateValue(e.id,e)}}c.\u0275fac=function(e){return new(e||c)(r.qc(a.a))},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac,providedIn:"root"})},"Wo/B":function(e,t,i){"use strict";i.d(t,"a",(function(){return B}));var n=i("mrSG"),s=i("ug4p"),a=i("Jui0"),r=i("8zkO"),c=(i("ii2/"),i("mMv8")),o=i("nckM"),l=i("RuUM"),d=i("wZYP"),u=i("2Uhg"),h=(i("Mo6U"),i("fXoL")),p=i("jhN1"),g=i("ofXK"),m=i("+pCT"),f=i("QihR"),b=i("0XIV"),w=i("u8Ab"),v=i("/Rze"),y=i("N5AO"),k=i("7MH/");function C(e,t){if(1&e&&h.hc(0,"user-avatar",17),2&e){const e=h.wc(2);h.Ub("data-user-name",e.userName)("data-user-id",e.userId)}}function j(e,t){if(1&e){const e=h.nc();h.mc(0,"accessible-by-keyboard",18),h.uc("execute",(function(){return h.Qc(e),h.wc(2).quoteComment()})),h.hc(1,"op-icon",19),h.lc()}if(2&e){const e=h.wc(2);h.Bc("linkTitle",e.text.quote_comment),h.Tb(1),h.Bc("icon-title",e.text.quote_comment)}}function x(e,t){if(1&e){const e=h.nc();h.mc(0,"accessible-by-keyboard",18),h.uc("execute",(function(){return h.Qc(e),h.wc(2).activate()})),h.hc(1,"op-icon",20),h.lc()}if(2&e){const e=h.wc(2);h.Vb("edit-activity--",e.activityNo,""),h.Bc("linkTitle",e.text.edit_comment),h.Tb(1),h.Bc("icon-title",e.text.edit_comment)}}function T(e,t){if(1&e&&h.hc(0,"img",21),2&e){const e=h.wc(2);h.Bc("src",e.bcfSnapshotUrl,h.Tc)}}function S(e,t){if(1&e&&(h.mc(0,"div",22),h.mc(1,"div",23),h.hc(2,"edit-form-portal",24),h.lc(),h.lc()),2&e){const e=h.wc(2);h.Tb(2),h.Bc("changeInput",e.change)("schemaInput",e.schema)("editFieldHandler",e.handler)}}function P(e,t){if(1&e&&h.hc(0,"div",25),2&e){const e=h.wc(2);h.Bc("innerHtml",e.postedComment,h.Rc)}}function I(e,t){if(1&e&&(h.mc(0,"li"),h.hc(1,"span",28),h.lc()),2&e){const e=t.$implicit;h.Tb(1),h.Bc("innerHtml",e,h.Rc)}}function O(e,t){if(1&e&&(h.mc(0,"ul",26),h.Yc(1,I,2,1,"li",27),h.lc()),2&e){const e=h.wc(2);h.Tb(1),h.Bc("ngForOf",e.details)}}function R(e,t){if(1&e){const e=h.nc();h.mc(0,"div",1),h.uc("mouseenter",(function(){return h.Qc(e),h.wc().focus()}))("mouseleave",(function(){return h.Qc(e),h.wc().blur()})),h.Yc(1,C,1,2,"user-avatar",2),h.mc(2,"span",3),h.hc(3,"user-link",4),h.lc(),h.mc(4,"span",5),h.ad(5),h.hc(6,"op-date-time",6),h.lc(),h.mc(7,"div",7),h.hc(8,"activity-link",8),h.mc(9,"div",9),h.Yc(10,j,2,2,"accessible-by-keyboard",10),h.Yc(11,x,2,5,"accessible-by-keyboard",11),h.lc(),h.lc(),h.Yc(12,T,1,1,"img",12),h.mc(13,"div",13),h.Yc(14,S,3,3,"div",14),h.Yc(15,P,1,1,"div",15),h.Yc(16,O,2,1,"ul",16),h.lc(),h.lc()}if(2&e){const e=h.wc();h.Tb(1),h.Bc("ngIf",e.userName),h.Tb(2),h.Bc("user",e.user),h.Tb(2),h.cd(" ",e.isInitial?e.text.label_created_on:e.text.label_updated_on," "),h.Tb(1),h.Bc("dateTimeValue",e.activity.createdAt),h.Tb(2),h.Bc("workPackage",e.workPackage)("activityNo",e.activityNo),h.Tb(1),h.Bc("hidden",e.shouldHideIcons()),h.Tb(1),h.Bc("ngIf",e.userCanQuote),h.Tb(1),h.Bc("ngIf",e.userCanEdit),h.Tb(1),h.Bc("ngIf",e.bcfSnapshotUrl),h.Tb(2),h.Bc("ngIf",e.active),h.Tb(1),h.Bc("ngIf",!e.active&&(e.isComment||e.isBcfComment)),h.Tb(1),h.Bc("ngIf",!e.isInitial)}}class B extends u.a{constructor(e,t,i,n,s,a,r,c,o,l,d){super(e,t),this.elementRef=e,this.injector=t,this.sanitization=i,this.PathHelper=n,this.wpLinkedActivities=s,this.commentService=a,this.wpCacheService=r,this.ConfigurationService=c,this.userCacheService=o,this.cdRef=l,this.I18n=d,this.userCanEdit=!1,this.userCanQuote=!1,this.details=[],this.focused=!1,this.text={label_created_on:this.I18n.t("js.label_created_on"),label_updated_on:this.I18n.t("js.label_updated_on"),quote_comment:this.I18n.t("js.label_quote_comment"),edit_comment:this.I18n.t("js.label_edit_comment")}}ngOnInit(){super.ngOnInit(),this.updateCommentText(),this.isComment="Activity::Comment"===this.activity._type,this.isBcfComment="Activity::BcfComment"===this.activity._type,this.$element=jQuery(this.elementRef.nativeElement),this.reset(),this.userCanEdit=!!this.activity.update,this.userCanQuote=!!this.workPackage.addComment,this.$element.bind("focusin",this.focus.bind(this)),this.$element.bind("focusout",this.blur.bind(this)),_.each(this.activity.details,e=>{this.details.push(e.html)}),this.userCacheService.require(this.activity.user.idFromLink).then(e=>{this.user=e,this.userId=e.id,this.userName=e.name,this.userAvatar=e.avatar,this.cdRef.detectChanges()})}shouldHideIcons(){return!((this.isComment||this.isBcfComment)&&this.focussing())}ngAfterViewInit(){window.location.hash==="activity-"+this.activityNo&&this.elementRef.nativeElement.scrollIntoView(!0)}activate(){super.activate(this.activity.comment.raw),this.cdRef.detectChanges()}handleUserSubmit(){return this.inFlight||!this.rawComment?Promise.resolve():this.updateComment()}quoteComment(){this.commentService.quoteEvents.next(this.quotedText(this.activity.comment.raw))}get bcfSnapshotUrl(){return _.get(this.activity,"bcfViewpoints[0]")?`${_.get(this.activity,"bcfViewpoints[0]").href}/snapshot`:null}updateComment(){return Object(n.b)(this,void 0,void 0,(function*(){return this.inFlight=!0,yield this.onSubmit(),this.commentService.updateComment(this.activity,this.rawComment||"").then(e=>{this.activity=e,this.updateCommentText(),this.wpLinkedActivities.require(this.workPackage,!0),this.wpCacheService.updateWorkPackage(this.workPackage)}).finally(()=>{this.deactivate(!0),this.inFlight=!1})}))}focusEditIcon(){jQuery(".edit-activity--"+this.activityNo+" a").focus()}focus(){this.focused=!0,this.cdRef.detectChanges()}blur(){this.focused=!1,this.cdRef.detectChanges()}focussing(){return this.focused}setErrors(e){}quotedText(e){let t=e.split("\n").map((function(e){return"\n> "+e})).join("");return this.userName+" wrote:\n"+t}get htmlId(){return`user_activity_edit_field_${this.activityNo}`}deactivate(e){super.deactivate(e),e&&this.focusEditIcon()}updateCommentText(){this.postedComment=this.sanitization.bypassSecurityTrustHtml(this.activity.comment.html)}}B.\u0275fac=function(e){return new(e||B)(h.gc(h.q),h.gc(h.A),h.gc(p.b),h.gc(a.a),h.gc(c.a),h.gc(l.a),h.gc(s.a),h.gc(r.a),h.gc(o.a),h.gc(h.i),h.gc(d.a))},B.\u0275cmp=h.ac({type:B,selectors:[["user-activity"]],inputs:{workPackage:"workPackage",activity:"activity",activityNo:"activityNo",isInitial:"isInitial"},features:[h.Qb],decls:1,vars:1,consts:[["class","work-package-details-activities-activity-contents",3,"mouseenter","mouseleave",4,"ngIf"],[1,"work-package-details-activities-activity-contents",3,"mouseenter","mouseleave"],["data-class-list","avatar",4,"ngIf"],[1,"user"],[3,"user"],[1,"date"],[3,"dateTimeValue"],[1,"comments-number"],[3,"workPackage","activityNo"],[1,"comments-icons",3,"hidden"],[3,"linkTitle","execute",4,"ngIf"],[3,"linkTitle","class","execute",4,"ngIf"],["class","activity-thumbnail",3,"src",4,"ngIf"],[1,"user-comment"],["class","inplace-edit",4,"ngIf"],["class","message wiki",3,"innerHtml",4,"ngIf"],["class","work-package-details-activities-messages",4,"ngIf"],["data-class-list","avatar"],[3,"linkTitle","execute"],["icon-classes","action-icon icon-quote",3,"icon-title"],["icon-classes","action-icon icon-edit",3,"icon-title"],[1,"activity-thumbnail",3,"src"],[1,"inplace-edit"],[1,"user-comment--form","inplace-edit--write-value"],[3,"changeInput","schemaInput","editFieldHandler"],[1,"message","wiki",3,"innerHtml"],[1,"work-package-details-activities-messages"],[4,"ngFor","ngForOf"],[1,"message",3,"innerHtml"]],template:function(e,t){1&e&&h.Yc(0,R,17,13,"div",0),2&e&&h.Bc("ngIf",t.workPackage)},directives:[g.q,m.a,f.a,b.a,w.a,v.a,y.a,k.a,g.p],encapsulation:2,changeDetection:0})},X4Sm:function(e,t,i){"use strict";i.d(t,"a",(function(){return _}));var n=i("wZYP"),s=(i("5HGI"),i("qg8y")),a=i("wyKs"),r=i("6yP5"),c=i("AeZM"),o=i("FB4C"),l=i("itXk"),d=i("AEvm"),u=i("fXoL"),h=i("ofXK"),p=i("N5AO");function g(e,t){if(1&e){const e=u.nc();u.mc(0,"span",9),u.uc("click",(function(t){return u.Qc(e),u.wc(2).toggleHierarchy(t)})),u.hc(1,"op-icon",10),u.lc()}if(2&e){const e=u.wc(2);u.Ub("title",e.text.toggleHierarchy),u.Tb(1),u.Dc("icon-classes","icon ",e.hierarchyIcon,"")}}const m=function(e,t){return[e,t]};function f(e,t){if(1&e&&(u.mc(0,"a",11),u.ad(1),u.lc()),2&e){const e=u.wc(2);u.Cc("lang",e.locale),u.Cc("id",e.headerColumn.id),u.Bc("ngClass",u.Hc(4,m,e.directionClass&&"sort",e.directionClass)),u.Tb(1),u.bd(e.headerColumn.name)}}function b(e,t){if(1&e&&(u.mc(0,"a"),u.ad(1),u.lc()),2&e){const e=u.wc(2);u.Tb(1),u.bd(e.headerColumn.name)}}function w(e,t){if(1&e&&u.hc(0,"op-icon",12),2&e){const e=u.wc(2);u.Cc("icon-title",e.text.openMenu)}}function v(e,t){if(1&e&&(u.mc(0,"span",4),u.Yc(1,g,2,2,"span",5),u.Yc(2,f,2,7,"a",6),u.Yc(3,b,2,1,"a",7),u.Yc(4,w,1,1,"op-icon",8),u.lc()),2&e){const e=u.wc();u.Tb(1),u.Bc("ngIf",e.displayHierarchyIcon),u.Tb(1),u.Bc("ngIf",e.sortable),u.Tb(1),u.Bc("ngIf",!e.sortable),u.Tb(1),u.Bc("ngIf",e.displayDropdownIcon)}}function y(e,t){if(1&e&&u.hc(0,"op-icon",12),2&e){const e=u.wc(2);u.Cc("icon-title",e.text.openMenu)}}function k(e,t){if(1&e&&(u.mc(0,"span",4),u.mc(1,"a"),u.hc(2,"op-icon",13),u.ad(3),u.lc(),u.Yc(4,y,1,1,"op-icon",8),u.lc()),2&e){const e=u.wc();u.Tb(1),u.Ub("title",e.headerColumn.name),u.Tb(2),u.cd(" ",e.columnName," "),u.Tb(1),u.Bc("ngIf",e.displayDropdownIcon)}}function C(e,t){if(1&e&&u.hc(0,"span",14),2&e){const e=u.wc();u.Ub("title",e.text.sortColumn)}}function j(e,t){if(1&e&&(u.mc(0,"a",11),u.ad(1),u.lc()),2&e){const e=u.wc(2);u.Cc("lang",e.locale),u.Cc("id",e.headerColumn.id),u.Bc("ngClass",u.Hc(4,m,e.directionClass&&"sort",e.directionClass)),u.Tb(1),u.bd(e.headerColumn.name)}}function x(e,t){if(1&e&&(u.mc(0,"a"),u.ad(1),u.lc()),2&e){const e=u.wc(2);u.Tb(1),u.bd(e.headerColumn.name)}}function T(e,t){if(1&e&&u.hc(0,"op-icon",12),2&e){const e=u.wc(2);u.Cc("icon-title",e.text.openMenu)}}function S(e,t){if(1&e&&(u.mc(0,"span",4),u.Yc(1,j,2,7,"a",6),u.Yc(2,x,2,1,"a",7),u.Yc(3,T,1,1,"op-icon",8),u.lc()),2&e){const e=u.wc();u.Tb(1),u.Bc("ngIf",e.sortable),u.Tb(1),u.Bc("ngIf",!e.sortable),u.Tb(1),u.Bc("ngIf",e.displayDropdownIcon)}}class _ extends d.a{constructor(e,t,i,n,s,a,r){super(),this.wpTableHierarchies=e,this.wpTableSortBy=t,this.wpTableGroupBy=i,this.wpTableRelationColumns=n,this.elementRef=s,this.cdRef=a,this.I18n=r,this.text={toggleHierarchy:this.I18n.t("js.work_packages.hierarchy.show"),openMenu:this.I18n.t("js.label_open_menu"),sortColumn:"Sorting column"}}ngAfterViewInit(){setTimeout(()=>this.initialize())}initialize(){this.element=jQuery(this.elementRef.nativeElement),Object(l.a)([this.wpTableSortBy.onReadyWithAvailable(),this.wpTableSortBy.live$()]).pipe(this.untilDestroyed()).subscribe(()=>{let e=this.wpTableSortBy.current[0];e&&this.headerColumn.$href===e.column.$href?this.currentSortDirection=e.direction:this.currentSortDirection=null,this.setActiveColumnClass(),this.sortable=this.wpTableSortBy.isSortable(this.headerColumn),this.directionClass=this.getDirectionClass(),this.cdRef.detectChanges()}),this.isHierarchyColumn="subject"===this.headerColumn.id,"sortHandle"===this.headerColumn.id&&(this.columnType="sort"),this.isHierarchyColumn?this.columnType="hierarchy":"toType"===this.wpTableRelationColumns.relationColumnType(this.headerColumn)?(this.columnType="relation",this.columnName=this.headerColumn.type.name):"ofType"===this.wpTableRelationColumns.relationColumnType(this.headerColumn)&&(this.columnType="relation",this.columnName=I18n.t("js.relation_labels."+this.headerColumn.relationType)),this.isHierarchyColumn&&(this.hierarchyIcon="icon-hierarchy",this.isHierarchyDisabled=this.wpTableGroupBy.isEnabled,this.wpTableGroupBy.live$().pipe(this.untilDestroyed()).subscribe(()=>{this.isHierarchyDisabled=this.wpTableGroupBy.isEnabled,this.cdRef.detectChanges()}),this.wpTableHierarchies.live$().pipe(this.untilDestroyed()).subscribe(()=>{this.setHierarchyIcon(),this.cdRef.detectChanges()}),this.setHierarchyIcon()),this.cdRef.detectChanges()}get displayDropdownIcon(){return this.table&&this.table.configuration.columnMenuEnabled}get displayHierarchyIcon(){return this.table&&this.table.configuration.hierarchyToggleEnabled}toggleHierarchy(e){return this.wpTableHierarchies.toggleState()&&this.wpTableGroupBy.disable(),this.setHierarchyIcon(),e.stopPropagation(),!1}setHierarchyIcon(){this.wpTableHierarchies.isEnabled?(this.text.toggleHierarchy=I18n.t("js.work_packages.hierarchy.hide"),this.hierarchyIcon="icon-hierarchy"):(this.text.toggleHierarchy=I18n.t("js.work_packages.hierarchy.show"),this.hierarchyIcon="icon-no-hierarchy")}getDirectionClass(){if(!this.currentSortDirection)return"";switch(this.currentSortDirection.$href){case s.a:return"asc";case s.b:return"desc";default:return""}}setActiveColumnClass(){this.element.toggleClass("active-column",!!this.currentSortDirection)}}_.\u0275fac=function(e){return new(e||_)(u.gc(a.a),u.gc(r.a),u.gc(c.a),u.gc(o.a),u.gc(u.q),u.gc(u.i),u.gc(n.a))},_.\u0275cmp=u.ac({type:_,selectors:[["sortHeader"]],inputs:{headerColumn:"headerColumn",locale:"locale",table:"table"},features:[u.Qb],decls:5,vars:4,consts:[[1,"generic-table--sort-header-outer",3,"ngSwitch"],["class","generic-table--sort-header",4,"ngSwitchCase"],["class","draggable-table--sort-header",4,"ngSwitchCase"],["class","generic-table--sort-header",4,"ngSwitchDefault"],[1,"generic-table--sort-header"],["class","hierarchy-header--icon","tabindex","-1","aria-hidden","true",3,"click",4,"ngIf"],["href","#","lang-attribute","",3,"ngClass","lang","id",4,"ngIf"],[4,"ngIf"],["icon-classes","dropdown-indicator icon-small icon-pulldown",3,"icon-title",4,"ngIf"],["tabindex","-1","aria-hidden","true",1,"hierarchy-header--icon",3,"click"],[3,"icon-classes"],["href","#","lang-attribute","",3,"ngClass","lang","id"],["icon-classes","dropdown-indicator icon-small icon-pulldown",3,"icon-title"],["icon-classes","icon-context icon-relations relations-header--icon"],[1,"draggable-table--sort-header"]],template:function(e,t){1&e&&(u.mc(0,"div",0),u.Yc(1,v,5,4,"span",1),u.Yc(2,k,5,3,"span",1),u.Yc(3,C,1,1,"span",2),u.Yc(4,S,4,3,"span",3),u.lc()),2&e&&(u.Bc("ngSwitch",t.columnType),u.Tb(1),u.Bc("ngSwitchCase","hierarchy"),u.Tb(1),u.Bc("ngSwitchCase","relation"),u.Tb(1),u.Bc("ngSwitchCase","sort"))},directives:[h.u,h.v,h.w,h.q,p.a,h.n],encapsulation:2})},XV4z:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("mrSG"),s=i("sBdf"),a=i("kTsZ"),r=i("Jui0"),c=i("sjKJ"),o=i("CZZR"),l=i("Wi9d"),d=i("wZYP"),u=i("AAic"),h=i("2Vo4"),p=i("fXoL");class g{constructor(e,t,i,n,s,a,r,c){this.boardDm=e,this.PathHelper=t,this.CurrentProject=i,this.halResourceService=n,this.boardCache=s,this.boardActions=a,this.I18n=r,this.boardsList=c,this.currentBoard$=new h.a(null),this.text={unnamed_board:this.I18n.t("js.boards.label_unnamed_board"),action_board:e=>this.I18n.t("js.boards.board_type.action_by_attribute",{attribute:this.I18n.t("js.boards.board_type.action_type."+e)}),unnamed_list:this.I18n.t("js.boards.label_unnamed_list")}}loadAllBoards(e=this.CurrentProject.identifier,t=!1){return t||void 0===this.loadAllPromise?this.loadAllPromise=this.boardDm.allInScope().toPromise().then(e=>(e.forEach(e=>this.buildOrderAndUpdate(e)),e)):this.loadAllPromise}canManage(e){return!!e.grid.$links.delete}save(e){return this.reorderWidgets(e),this.boardDm.save(e).then(e=>(e.sortWidgets(),this.boardCache.update(e),e))}create(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=yield this.boardDm.create(e.type,this.boardName(e),e.attribute);return"free"===e.type?yield this.boardsList.addFreeQuery(t,{name:this.text.unnamed_list}):yield this.boardActions.get(e.attribute).addActionQueries(t),yield this.save(t),t}))}delete(e){return this.boardDm.delete(e).then(()=>this.boardCache.clearSome(e.id))}boardName(e){return e.boardName?e.boardName:"action"===e.type?this.text.action_board(e.attribute):this.text.unnamed_board}reorderWidgets(e){e.grid.columnCount=Math.max(e.grid.widgets.length,1),e.grid.widgets.map((e,t)=>(e.startColumn=t+1,e.endColumn=t+2,e))}buildOrderAndUpdate(e){e.sortWidgets(),this.boardCache.update(e)}}g.\u0275fac=function(e){return new(e||g)(p.qc(o.a),p.qc(r.a),p.qc(c.a),p.qc(a.a),p.qc(l.a),p.qc(u.a),p.qc(d.a),p.qc(s.a))},g.\u0275prov=p.cc({token:g,factory:g.\u0275fac,providedIn:"root"})},XZlt:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));i("ii2/");var n=i("fXoL"),s=i("ofXK"),a=i("80WE");const r=function(){return{colorize:!1}};function c(e,t){if(1&e&&(n.mc(0,"div",1),n.mc(1,"div",2),n.hc(2,"editable-attribute-field",3),n.lc(),n.mc(3,"div",4),n.hc(4,"editable-attribute-field",5),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(2),n.Bc("resource",e.workPackage)("displayFieldOptions",n.Fc(7,r))("wrapperClasses","wp-new-top-row--status -no-label")("fieldName","status"),n.Tb(2),n.Bc("resource",e.workPackage)("wrapperClasses","wp-new-top-row--type -no-label")("fieldName","type")}}class o{}o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=n.ac({type:o,selectors:[["wp-type-status"]],inputs:{workPackage:"workPackage"},decls:1,vars:1,consts:[["class","wp-new-top-row",4,"ngIf"],[1,"wp-new-top-row"],[1,"work-packages--status-selector","wp-new-top-row--element"],[3,"resource","displayFieldOptions","wrapperClasses","fieldName"],[1,"work-packages--type-selector","wp-new-top-row--element"],[3,"resource","wrapperClasses","fieldName"]],template:function(e,t){1&e&&n.Yc(0,c,5,8,"div",0),2&e&&n.Bc("ngIf",t.workPackage)},directives:[s.q,a.a],encapsulation:2})},XZsv:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return a}));var n=i("Mo6U");const s="urn:openproject-org:api:v3:errors:MultipleErrors";class a extends n.a{constructor(){super(...arguments),this.isValidationError=!1}toString(){return`[ErrorResource ${this.message}]`}get errorMessages(){return this.isMultiErrorMessage()?this.errors.map(e=>e.message):[this.message]}isMultiErrorMessage(){return this.errorIdentifier===s}getInvolvedAttributes(){var e=[];return this.details?e=[{details:this.details}]:this.errors&&(e=this.errors),_.flatten(e.map(e=>e.errorIdentifier===s?this.extractMultiError(e)[0]:e.details.attribute))}getMessagesPerAttribute(){let e={};return this.details?e[this.details.attribute]=[this.message]:_.forEach(this.errors,t=>{if(t.errorIdentifier===s){const[i,n]=this.extractMultiError(t);let s=e[i]||[];e[i]=s.concat(n)}else e[t.details.attribute]?e[t.details.attribute].push(t.message):e[t.details.attribute]=[t.message]}),e}extractMultiError(e){return[e.errors[0].details.attribute,e.errors.map(e=>e.message)]}}},XaHm:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("kTsZ"),s=i("Jui0"),a=i("UXun"),r=i("fXoL");class c{constructor(e,t){this.halResourceService=e,this.pathHelper=t}load(){return this.$configuration?this.$configuration:this.$configuration=this.halResourceService.get(this.pathHelper.api.v3.configuration.toString()).pipe(Object(a.a)())}}c.\u0275fac=function(e){return new(e||c)(r.qc(n.a),r.qc(s.a))},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac})},XlgE:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("wZYP"),s=i("Va5K"),a=i("PtkW"),r=i("itXk"),c=i("AEvm"),o=i("fXoL"),l=i("+B5R"),d=i("N5AO");class u extends c.a{constructor(e,t,i,n){super(),this.I18n=e,this.cdRef=t,this.wpDisplayRepresentationService=i,this.wpTableTimeline=n,this.text={card:this.I18n.t("js.views.card"),list:this.I18n.t("js.views.list"),timeline:this.I18n.t("js.views.timeline")}}ngOnInit(){Object(r.a)([this.wpDisplayRepresentationService.live$(),this.wpTableTimeline.live$()]).pipe(this.untilDestroyed()).subscribe(([e,t])=>{this.detectView(e,t.visible),this.cdRef.detectChanges()})}detectView(e,t){e!==s.b?this.view=t?"timeline":s.c:this.view=s.b}}u.\u0275fac=function(e){return new(e||u)(o.gc(n.a),o.gc(o.i),o.gc(s.a),o.gc(a.a))},u.\u0275cmp=o.ac({type:u,selectors:[["wp-view-toggle-button"]],features:[o.Qb],decls:4,vars:2,consts:[["id","wp-view-toggle-button","wpViewDropdown","",1,"button"],[3,"icon-classes"],["aria-hidden","true",1,"button--text",3,"textContent"],["icon-classes","button--icon icon-small icon-pulldown"]],template:function(e,t){1&e&&(o.mc(0,"button",0),o.hc(1,"op-icon",1),o.hc(2,"span",2),o.hc(3,"op-icon",3),o.lc()),2&e&&(o.Tb(1),o.Dc("icon-classes","button--icon icon-view-",t.view,""),o.Tb(1),o.Bc("textContent",t.text[t.view]))},directives:[l.a,d.a],encapsulation:2,changeDetection:0})},Xmgp:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("xRac"),s=i("3Pt+"),a=i("Tac9"),r=i("5Mgc"),c=i("GLdX"),o=i("ofXK"),l=i("fXoL");class d{}d.\u0275mod=l.ec({type:d}),d.\u0275inj=l.dc({factory:function(e){return new(e||d)},providers:[a.a,r.a,c.a],imports:[[s.i,o.b,n.a]]})},"Y/CA":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("E2tj"),s=i("lJxs"),a=i("/uUt"),r=i("eyhC"),c=i("zqrF"),o=i("fXoL");class l extends c.b{constructor(e,t){super(e),this.querySpace=e,this.wpTableSelection=t}isFocused(e){return this.focusedWorkPackage===e}ifShouldFocus(e){const t=this.current;t&&t.focusAfterRender&&(e(t.workPackageId),t.focusAfterRender=!1,this.update(t))}get focusedWorkPackage(){const e=this.current;if(e)return e.workPackageId;const t=this.querySpace.results.value;return t&&t.elements.length>0?t.elements[0].id.toString():null}whenChanged(){return this.live$().pipe(Object(s.a)(e=>e.workPackageId),Object(a.a)())}updateFocus(e,t=!1){this.wpTableSelection.isEmpty&&this.wpTableSelection.setRowState(e,!0),this.update({workPackageId:e,focusAfterRender:t})}valueFromQuery(e,t){}}l.\u0275fac=function(e){return new(e||l)(o.qc(n.a),o.qc(r.a))},l.\u0275prov=o.cc({token:l,factory:l.\u0275fac})},Y0Nk:function(e,t,i){"use strict";i.d(t,"c",(function(){return a})),i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return o}));var n=i("vkgz"),s=i("fXoL");function a(e,t){return i=>(e.start(),i.pipe(Object(n.a)(()=>e.delayedStop(t),()=>e.stop(),()=>e.stop())))}function r(e){return t=>(setTimeout(()=>e().start()),t.pipe(Object(n.a)(()=>{},()=>e().stop(),()=>e().stop())))}class c{constructor(e){this.indicator=e,this.indicatorTemplate='<div class="loading-indicator--background">\n      <div class="loading-indicator">\n        <div class="block-1"></div>\n        <div class="block-2"></div>\n        <div class="block-3"></div>\n        <div class="block-4"></div>\n        <div class="block-5"></div>\n      </div>\n    </div>\n   '}set promise(e){this.start();const t=()=>this.delayedStop();e.then(t).catch(t)}start(){this.stop(),this.indicator.prepend(this.indicatorTemplate)}delayedStop(e=25){setTimeout(()=>this.stop(),e)}stop(){this.indicator.find(".loading-indicator--background").remove()}}class o{get table(){return this.indicator("table")}get wpDetails(){return this.indicator("wpDetails")}get modal(){return this.indicator("modal")}getter(e){return this.indicator.bind(this,e)}indicator(e){return"string"==typeof e&&(e=this.getIndicatorAt(e)),new c(e)}getIndicatorAt(e){return jQuery(".loading-indicator--location").filter(`[data-indicator-name="${e}"]`)}}o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=s.cc({token:o,factory:o.\u0275fac,providedIn:"root"})},Y41n:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("fXoL"),s=i("XNiG"),a=i("Kj3r"),r=i("1G5W");class c{constructor(e,t=250){this.emitter=new n.s,this.debouncer=new s.a,this.debouncer.pipe(Object(a.a)(t),Object(r.a)(e)).subscribe(e=>this.emitter.emit(e))}emit(e){this.debouncer.next(e)}subscribe(e,t,i){return this.emitter.subscribe(e,t,i)}}},YIAj:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("SqdZ"),s=i("wZYP"),a=i("IaZ+"),r=i("fXoL"),c=i("kor4"),o=i("ofXK"),l=i("N5AO");function d(e,t){if(1&e&&(r.mc(0,"a",10),r.hc(1,"op-icon",11),r.hc(2,"span",12),r.lc()),2&e){const e=r.wc();r.Ub("href",e.helpTextLink,r.Tc)("title",e.text.edit),r.Tb(2),r.Bc("textContent",e.text.edit)}}class u extends n.a{constructor(e,t,i,n){super(e,i,n),this.locals=e,this.I18n=t,this.cdRef=i,this.elementRef=n,this.closeOnEscape=!0,this.closeOnOutsideClick=!1,this.text={edit:this.I18n.t("js.button_edit"),close:this.I18n.t("js.button_close")},this.helpText=this.locals.helpText}get helpTextLink(){return this.helpText.editText?this.helpText.editText.$link.href:""}}u.\u0275fac=function(e){return new(e||u)(r.gc(a.a),r.gc(s.a),r.gc(r.i),r.gc(r.q))},u.\u0275cmp=r.ac({type:u,selectors:[["ng-component"]],features:[r.Qb],decls:11,vars:4,consts:[["data-indicator-name","modal",1,"op-modal--portal","loading-indicator--location"],["tabindex","0",1,"op-modal--modal-container","attribute-help-text--modal"],[1,"op-modal--modal-header"],[1,"icon-context","icon-help1"],[1,"ellipsis",3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"accessibleClick"],["tabindex","0",1,"op-modal--modal-body","-formattable",3,"innerHtml"],[1,"modal--form-actions"],["class","help-text--edit-button button",4,"ngIf"],[1,"help-text--edit-button","button"],["icon-classes","button--icon icon-edit"],[1,"button--text",3,"textContent"]],template:function(e,t){1&e&&(r.mc(0,"div",0),r.mc(1,"div",1),r.mc(2,"div",2),r.mc(3,"h3"),r.hc(4,"span",3),r.hc(5,"span",4),r.lc(),r.mc(6,"a",5),r.mc(7,"i",6),r.uc("accessibleClick",(function(e){return t.closeMe(e)})),r.lc(),r.lc(),r.lc(),r.hc(8,"div",7),r.mc(9,"div",8),r.Yc(10,d,3,3,"a",9),r.lc(),r.lc(),r.lc()),2&e&&(r.Tb(5),r.Bc("textContent",t.helpText.attributeCaption),r.Tb(2),r.Ub("title",t.text.close),r.Tb(1),r.Bc("innerHtml",t.helpText.helpText.html,r.Rc),r.Tb(2),r.Bc("ngIf",t.helpText.editText))},directives:[c.a,o.q,l.a],encapsulation:2})},YO9K:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("wZYP"),s=i("qg8y"),a=i("6yP5"),r=i("fXoL"),c=i("3Pt+"),o=i("ofXK");function l(e,t){if(1&e&&r.hc(0,"option",18),2&e){const e=r.wc().$implicit;r.Bc("textContent",e.column.name)("value",e.column.href)}}function d(e,t){if(1&e&&r.hc(0,"option",19),2&e){const e=t.$implicit;r.Bc("textContent",e.name)("value",e.href)}}function u(e,t){if(1&e){const e=r.nc();r.mc(0,"label",5),r.mc(1,"input",20),r.uc("ngModelChange",(function(t){return r.Qc(e),r.wc().$implicit.direction=t})),r.lc(),r.ad(2),r.lc()}if(2&e){const e=t.$implicit,i=r.wc(),n=i.index,s=i.$implicit;r.Tb(1),r.Dc("name","modal-sorting-attribute-",n,"--sort-direction"),r.Bc("ngModel",s.direction)("value",e.$href)("textContent",e.name),r.Tb(1),r.cd(" ",e.name," ")}}function h(e,t){if(1&e){const e=r.nc();r.mc(0,"div"),r.mc(1,"div",3),r.hc(2,"label",11),r.mc(3,"div",4),r.mc(4,"div",12),r.mc(5,"select",13),r.uc("change",(function(i){r.Qc(e);const n=t.$implicit;return r.wc(2).updateSelection(n,i.target.value)})),r.Yc(6,l,1,2,"option",14),r.hc(7,"option",15),r.Yc(8,d,1,2,"option",16),r.lc(),r.lc(),r.lc(),r.lc(),r.mc(9,"div",3),r.mc(10,"div",4),r.Yc(11,u,3,5,"label",17),r.lc(),r.lc(),r.lc()}if(2&e){const e=t.$implicit,i=t.index,n=r.wc(2);r.Vb("form--row modal-sorting-row-",i,""),r.Tb(2),r.Dc("for","modal-sorting-attribute-",i,""),r.Bc("textContent",n.text["sort_criteria_"+i]),r.Tb(3),r.Dc("id","modal-sorting-attribute-",i,""),r.Dc("name","modal-sorting-attribute-",i,""),r.Tb(1),r.Bc("ngIf",!!e.column.href),r.Tb(1),r.Bc("textContent",n.emptyColumn.name)("value",n.emptyColumn.href)("selected",!e.column.href),r.Tb(1),r.Bc("ngForOf",n.availableColumns),r.Tb(3),r.Bc("ngForOf",n.availableDirections)}}function p(e,t){if(1&e&&(r.kc(0),r.Yc(1,h,12,13,"div",10),r.jc()),2&e){const e=r.wc();r.Tb(1),r.Bc("ngForOf",e.sortationObjects)}}class g{constructor(e,t){this.column=e,this.direction=t}}class m{constructor(e,t,i){this.injector=e,this.I18n=t,this.wpTableSortBy=i,this.text={title:this.I18n.t("js.label_sort_by"),placeholder:this.I18n.t("js.placeholders.default"),sort_criteria_1:this.I18n.t("js.filter.sorting.criteria.one"),sort_criteria_2:this.I18n.t("js.filter.sorting.criteria.two"),sort_criteria_3:this.I18n.t("js.filter.sorting.criteria.three"),sorting_mode:{description:this.I18n.t("js.work_packages.table_configuration.sorting_mode.description"),automatic:this.I18n.t("js.work_packages.table_configuration.sorting_mode.automatic"),manually:this.I18n.t("js.work_packages.table_configuration.sorting_mode.manually"),warning:this.I18n.t("js.work_packages.table_configuration.sorting_mode.warning")}},this.availableDirections=[{$href:s.a,name:this.I18n.t("js.label_ascending")},{$href:s.b,name:this.I18n.t("js.label_descending")}],this.availableColumns=[],this.allColumns=[],this.sortationObjects=[],this.emptyColumn={name:this.text.placeholder,href:null},this.sortingMode="automatic"}onSave(){let e;e="automatic"===this.sortingMode?this.sortationObjects.filter(e=>null!==e.column):[new g(this.manualSortColumn,s.a)],e=e.map(e=>this.getMatchingSort(e.column.href,e.direction)),this.wpTableSortBy.update(_.compact(e))}ngOnInit(){this.wpTableSortBy.onReadyWithAvailable().subscribe(()=>{let e=this.wpTableSortBy.available.filter(e=>!e.column.$href.endsWith("/parent")).map(e=>({name:e.column.name,href:e.column.$href}));this.allColumns=_.uniqBy(e,"href"),this.getManualSortingOption(),_.each(this.wpTableSortBy.current,e=>{e.column.$href.endsWith("/parent")||(this.sortationObjects.push(new g({name:e.column.name,href:e.column.$href},e.direction.$href)),e.column.href===this.manualSortColumn.href&&this.updateSortingMode("manual"))}),this.updateUsedColumns(),this.fillUpSortElements()})}updateSelection(e,t){e.column=_.find(this.allColumns,e=>e.href===t)||this.emptyColumn,this.updateUsedColumns()}updateUsedColumns(){let e=this.sortationObjects.filter(e=>null!==e.column).map(e=>e.column);this.availableColumns=_.sortBy(_.differenceBy(this.allColumns,e,"href"),"name")}updateSortingMode(e){this.sortingMode=e}getMatchingSort(e,t){return _.find(this.wpTableSortBy.available,i=>i.column.$href===e&&i.direction.$href===t)}fillUpSortElements(){for(;this.sortationObjects.length<3;)this.sortationObjects.push(new g(this.emptyColumn,s.a))}getManualSortingOption(){this.manualSortColumn=this.allColumns.find(e=>e.href.endsWith("/manualSorting")),this.allColumns.splice(this.allColumns.indexOf(this.manualSortColumn),1)}}m.\u0275fac=function(e){return new(e||m)(r.gc(r.A),r.gc(n.a),r.gc(a.a))},m.\u0275cmp=r.ac({type:m,selectors:[["ng-component"]],decls:16,vars:7,consts:[["name","modalSortingForm"],["id","modal-sorting","data-indicator-name","sorting-modal",1,"modal-content-container","loading-indicator--location"],[3,"textContent"],[1,"form--field","-full-width"],[1,"form--field-container"],[1,"option-label"],["type","radio","name","sorting_mode_switch","value","manual",3,"ngModel","ngModelChange","change"],["type","radio","name","sorting_mode_switch","value","automatic",3,"ngModel","ngModelChange","change"],[1,"form--field-instructions"],[4,"ngIf"],[3,"class",4,"ngFor","ngForOf"],[1,"form--label","hidden-for-sighted",3,"for","textContent"],[1,"form--select-container"],[1,"form--select",3,"id","name","change"],["selected","",3,"textContent","value",4,"ngIf"],[3,"textContent","value","selected"],[3,"textContent","value",4,"ngFor","ngForOf"],["class","option-label",4,"ngFor","ngForOf"],["selected","",3,"textContent","value"],[3,"textContent","value"],["type","radio",3,"ngModel","value","textContent","name","ngModelChange"]],template:function(e,t){1&e&&(r.mc(0,"form",0),r.mc(1,"div",1),r.hc(2,"p",2),r.mc(3,"div",3),r.mc(4,"div",4),r.mc(5,"label",5),r.mc(6,"input",6),r.uc("ngModelChange",(function(e){return t.sortingMode=e}))("change",(function(e){return t.updateSortingMode(e.target.value)})),r.lc(),r.ad(7),r.lc(),r.lc(),r.lc(),r.mc(8,"div",3),r.mc(9,"div",4),r.mc(10,"label",5),r.mc(11,"input",7),r.uc("ngModelChange",(function(e){return t.sortingMode=e}))("change",(function(e){return t.updateSortingMode(e.target.value)})),r.lc(),r.ad(12),r.lc(),r.lc(),r.mc(13,"div",8),r.ad(14),r.lc(),r.lc(),r.Yc(15,p,2,1,"ng-container",9),r.lc(),r.lc()),2&e&&(r.Tb(2),r.Bc("textContent",t.text.sorting_mode.description),r.Tb(4),r.Bc("ngModel",t.sortingMode),r.Tb(1),r.cd(" ",t.text.sorting_mode.manually," "),r.Tb(4),r.Bc("ngModel",t.sortingMode),r.Tb(1),r.cd(" ",t.text.sorting_mode.automatic," "),r.Tb(2),r.cd(" ",t.text.sorting_mode.warning," "),r.Tb(1),r.Bc("ngIf","automatic"===t.sortingMode))},directives:[c.C,c.n,c.o,c.u,c.c,c.m,c.p,o.q,o.p,c.r,c.B],encapsulation:2})},YW04:function(e,t){},Yblc:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("mrSG"),s=i("FDFi"),a=i("i95X"),r=i("uSJ+"),c=i("r0MM"),o=i("fXoL");class l extends s.a{constructor(e){super(e),this.injector=e,this.referenceComponentClass=a.a,this.relationType="",this.referenceTarget=null,this.buttonTexts={reference:this.I18n.t("js.relation_buttons.add_existing"),create:this.I18n.t("js.relation_buttons.create_new")}}add(e,t){return this.wpRelations.addCommonRelation(t,this.relationType,e.id)}remove(e,t){const i=this.wpRelations.find(t,e,this.relationType);return void 0!==i?this.wpRelations.removeRelation(i):Promise.reject()}get canAdd(){return!!(this.referenceTarget&&this.canCreateWorkPackages&&this.referenceTarget.addRelation)}get canReference(){return!!this.canAdd}}l.\u0275fac=function(e){return new(e||l)(o.qc(o.A))},l.\u0275prov=o.cc({token:l,factory:l.\u0275fac}),Object(n.c)([Object(c.a)(),Object(n.e)("design:type",r.a)],l.prototype,"wpRelations",void 0)},YefF:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("A0F/"),s=i("fXoL");class a extends n.a{blockedTransition(e){const t=e.to(),i=e.from(),n=e.params("from"),s=e.params("to");return i.name&&i.name.match(/\.(new|copy)$/)?!(t.data&&t.data.allowMovingInEditMode):void 0===s.workPackageId||s.workPackageId!==n.workPackageId}}a.\u0275fac=function(e){return r(e||a)},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac});const r=s.oc(a);var c=i("HEQ6"),o=i("0loS");class l{}l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=s.ac({type:l,selectors:[["work-packages-base"]],features:[s.Sb([{provide:n.a,useClass:a}])],decls:2,vars:0,consts:[["wp-isolated-query-space","",1,"work-packages-page--ui-view"]],template:function(e,t){1&e&&(s.mc(0,"div",0),s.hc(1,"ui-view"),s.lc())},directives:[c.a,o.UIView],encapsulation:2})},"Yg+W":function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return a}));var n=i("E5Dd");function s(e,t){return"click"!==e.type&&("keydown"!==e.type||e.which!==n.a.ENTER)||(t(),!1)}class a{handleEvent(e,t){s(t,()=>this.processEvent(e,t))}}},Ywds:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("ciXH"),s=i("fXoL");class a extends n.a{schema(){return this.halResourceService.get(this.projectsPath.schema).toPromise()}listUrl(){return this.projectsPath.toString()}oneUrl(e){return this.projectsPath.id(e).toString()}get projectsPath(){return this.pathHelper.api.v3.projects}}a.\u0275fac=function(e){return r(e||a)},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac});const r=s.oc(a)},ZAVI:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("iB+3"),s=(i("ii2/"),i("ug4p")),a=i("R9pB"),r=i("AEvm"),c=i("fXoL"),o=i("ofXK"),l=i("80WE");function d(e,t){if(1&e&&(c.mc(0,"div",1),c.mc(1,"div",2),c.hc(2,"editable-attribute-field",3),c.lc(),c.mc(3,"div",4),c.hc(4,"editable-attribute-field",3),c.lc(),c.lc()),2&e){const e=c.wc();c.Bc("ngClass","__overflowing_"+e.uniqueElementIdentifier),c.Ub("data-overflowing-identifier",".__overflowing_"+e.uniqueElementIdentifier),c.Tb(2),c.Bc("resource",e.workPackage)("wrapperClasses","work-packages--type-selector work-packages--subject-element -no-label")("fieldName","type"),c.Tb(2),c.Bc("resource",e.workPackage)("wrapperClasses","work-packages--details--subject work-packages--subject-element -no-label")("fieldName","subject")}}class u extends r.a{constructor(e,t){super(),this.uiRouterGlobals=e,this.wpCacheService=t,this.uniqueElementIdentifier=`work-packages--subject-type-row-${Object(a.a)(16)}`}ngOnInit(){this.workPackage||this.wpCacheService.loadWorkPackage(this.uiRouterGlobals.params.workPackageId).values$().pipe(this.untilDestroyed()).subscribe(e=>{this.workPackage=e})}}u.\u0275fac=function(e){return new(e||u)(c.gc(n.Q),c.gc(s.a))},u.\u0275cmp=c.ac({type:u,selectors:[["wp-subject"]],inputs:{workPackage:"workPackage"},features:[c.Qb],decls:1,vars:1,consts:[["class","work-packages--subject-type-row __overflowing_element_container",3,"ngClass",4,"ngIf"],[1,"work-packages--subject-type-row","__overflowing_element_container",3,"ngClass"],[1,"work-packages--type-selector","work-packages--subject-element"],[3,"resource","wrapperClasses","fieldName"],[1,"work-packages--details--subject","work-packages--subject-element"]],template:function(e,t){1&e&&c.Yc(0,d,5,8,"div",0),2&e&&c.Bc("ngIf",t.workPackage)},directives:[o.q,o.n,l.a],encapsulation:2})},ZGxV:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("zOhy"),s=i("fXoL"),a=i("ofXK"),r=i("711n"),c=i("XZlt"),o=i("aveh"),l=i("2bW2"),d=i("f24R");const u=function(){return["status","type"]};function h(e,t){if(1&e){const e=s.nc();s.mc(0,"div",1),s.mc(1,"edit-form",2),s.uc("onSaved",(function(t){return s.Qc(e),s.wc().onSaved(t)})),s.mc(2,"div",3),s.mc(3,"div",4),s.hc(4,"wp-type-status",5),s.mc(5,"div",6),s.mc(6,"a",7),s.uc("click",(function(){return s.Qc(e),s.wc().switchToFullscreen()})),s.hc(7,"span",8),s.lc(),s.lc(),s.lc(),s.hc(8,"wp-single-view",9),s.lc(),s.mc(9,"div",10),s.mc(10,"wp-edit-actions-bar",11),s.uc("onCancel",(function(){return s.Qc(e),s.wc().cancelAndBackToList()})),s.lc(),s.lc(),s.mc(11,"div",12),s.hc(12,"wp-resizer",13),s.lc(),s.lc(),s.lc()}if(2&e){const e=s.wc();s.Tb(1),s.Bc("resource",e.newWorkPackage)("skippedFields",s.Fc(8,u))("inEditMode",!0),s.Tb(3),s.Bc("workPackage",e.newWorkPackage),s.Tb(4),s.Bc("workPackage",e.newWorkPackage)("showProject",e.copying),s.Tb(4),s.Bc("elementClass","work-packages-partitioned-page--content-right")("localStorageKey","openProject-splitViewFlexBasis")}}class p extends n.a{}p.\u0275fac=function(e){return g(e||p)},p.\u0275cmp=s.ac({type:p,selectors:[["wp-new-split-view"]],features:[s.Qb],decls:1,vars:1,consts:[["class","work-packages--details work-packages--new",4,"ngIf"],[1,"work-packages--details","work-packages--new"],[3,"resource","skippedFields","inEditMode","onSaved"],[1,"work-packages--details-content","-create-mode"],[1,"work-packages--new-details-header"],[3,"workPackage"],[1,"wp--details--switch-fullscreen-wrapper"],[1,"work-packages-show-view-button","wp--details--switch-fullscreen",3,"click"],[1,"icon-context","icon-to-fullscreen"],[3,"workPackage","showProject"],[1,"work-packages--details-toolbar-container"],[3,"onCancel"],[1,"work-packages--details--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"]],template:function(e,t){1&e&&s.Yc(0,h,13,9,"div",0),2&e&&s.Bc("ngIf",t.newWorkPackage)},directives:[a.q,r.a,c.a,o.a,l.a,d.a],encapsulation:2,changeDetection:0});const g=s.oc(p)},ZTEj:function(e,t,i){"use strict";i.d(t,"a",(function(){return q}));var n=i("E2tj"),s=i("ooSb"),a=i("FB4C"),r=i("Zq3F"),c=i("AeZM"),o=i("wyKs"),l=i("6yP5"),d=i("JY8V"),u=i("F5Dh"),h=i("PtkW"),p=i("eyhC"),g=i("EnRq"),m=i("ONn1"),f=i("2Qcm"),b=i("4n9w"),w=i("+oAL"),v=i("Y/CA"),y=i("SKFm"),k=i("DhiE"),C=i("ABwi"),j=i("VgZ9"),x=i("l08T"),T=i("Q6HB"),S=i("FDFi"),_=i("f9kS"),P=i("Yblc"),I=i("W6hW"),O=i("pSHE"),R=i("FnNU"),B=i("fXoL");class E extends n.a{constructor(){super(...arguments),this.chartType=Object(R.f)()}}E.\u0275fac=function(e){return M(e||E)},E.\u0275prov=B.cc({token:E,factory:E.\u0275fac});const M=B.oc(E);var F=i("HEQ6"),A=i("7xci");const D=[{provide:n.a,useClass:E},s.a,I.a,k.a,a.a,r.a,c.a,o.a,l.a,d.a,u.a,h.a,p.a,g.a,m.a,v.a,f.a,C.a,A.a,j.a,x.a,T.a,S.a,_.a,P.a,y.a,b.a,w.a,O.a];class q extends F.a{}q.\u0275fac=function(e){return L(e||q)},q.\u0275dir=B.bc({type:q,selectors:[["","wp-isolated-graph-query-space",""]],features:[B.Sb(D),B.Qb]});const L=B.oc(q)},Zb8V:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("SKFm"),s=(i("qvol"),i("wZYP")),a=i("fXoL"),r=i("711n"),c=i("AEvm"),o=i("ofXK"),l=i("80WE");const d=["editForm"],u=function(e){return{"-required":e}};function h(e,t){if(1&e&&a.hc(0,"div",3),2&e){const e=a.wc();a.Bc("ngClass",a.Gc(2,u,e.isRequired("workPackage")))("textContent",e.text.attributes.workPackage)}}function p(e,t){if(1&e&&(a.mc(0,"div",4),a.hc(1,"editable-attribute-field",10),a.lc()),2&e){const e=a.wc();a.Tb(1),a.Bc("resource",e.entry)("fieldName","workPackage")}}function g(e,t){if(1&e&&a.hc(0,"editable-attribute-field",10),2&e){const e=a.wc();a.Bc("resource",e.entry)("fieldName","activity")}}function m(e,t){if(1&e&&a.hc(0,"i",12),2&e){const e=a.wc();a.Bc("textContent",e.text.wpRequired)}}function f(e,t){if(1&e&&(a.kc(0),a.hc(1,"div",3),a.mc(2,"div",4),a.hc(3,"editable-attribute-field",10),a.lc(),a.jc()),2&e){const e=t.$implicit,i=a.wc();a.Tb(1),a.Bc("ngClass",a.Gc(4,u,i.isRequired(e.key)))("textContent",e.label),a.Tb(2),a.Bc("resource",i.entry)("fieldName",e.key)}}class b extends c.a{constructor(e,t,i){super(),this.halEditing=e,this.cdRef=t,this.i18n=i,this.showWorkPackageField=!0,this.modifiedEntry=new a.s,this.text={attributes:{comment:this.i18n.t("js.time_entry.comment"),hours:this.i18n.t("js.time_entry.hours"),activity:this.i18n.t("js.time_entry.activity"),workPackage:this.i18n.t("js.time_entry.work_package"),spentOn:this.i18n.t("js.time_entry.spent_on")},wpRequired:this.i18n.t("js.time_entry.work_package_required")},this.workPackageSelected=!1,this.customFields=[]}ngOnInit(){this.halEditing.temporaryEditResource(this.entry).values$().pipe(this.untilDestroyed()).subscribe(e=>{e&&e.workPackage&&(this.workPackageSelected=!0,this.cdRef.markForCheck())}),this.setCustomFields(this.entry.schema),this.cdRef.detectChanges()}signalModifiedEntry(e){this.modifiedEntry.emit(e)}save(){return this.editForm.submit()}get inEditMode(){return!0}isRequired(e){return"workPackage"===e||this.entry.schema[e].required}setCustomFields(e){Object.entries(e).forEach(([e,t])=>{e.match(/customField\d+/)&&this.customFields.push({key:e,label:t.name})})}}b.\u0275fac=function(e){return new(e||b)(a.gc(n.a),a.gc(a.i),a.gc(s.a))},b.\u0275cmp=a.ac({type:b,selectors:[["te-form"]],viewQuery:function(e,t){var i;(1&e&&a.Wc(d,!0),2&e)&&(a.Nc(i=a.vc())&&(t.editForm=i.first))},inputs:{entry:"entry",showWorkPackageField:"showWorkPackageField"},outputs:{modifiedEntry:"modifiedEntry"},features:[a.Qb],decls:19,vars:31,consts:[[3,"resource","inEditMode","onSaved"],["editForm",""],[1,"attributes-map"],[1,"attributes-map--key",3,"ngClass","textContent"],[1,"attributes-map--value"],[3,"resource","wrapperClasses","fieldName"],["class","attributes-map--key",3,"ngClass","textContent",4,"ngIf"],["class","attributes-map--value",4,"ngIf"],[3,"resource","fieldName",4,"ngIf"],[3,"textContent",4,"ngIf"],[3,"resource","fieldName"],[4,"ngFor","ngForOf"],[3,"textContent"]],template:function(e,t){1&e&&(a.mc(0,"edit-form",0,1),a.uc("onSaved",(function(e){return t.signalModifiedEntry(e)})),a.mc(2,"div",2),a.hc(3,"div",3),a.mc(4,"div",4),a.hc(5,"editable-attribute-field",5),a.lc(),a.hc(6,"div",3),a.mc(7,"div",4),a.hc(8,"editable-attribute-field",5),a.lc(),a.Yc(9,h,1,4,"div",6),a.Yc(10,p,2,2,"div",7),a.hc(11,"div",3),a.mc(12,"div",4),a.Yc(13,g,1,2,"editable-attribute-field",8),a.Yc(14,m,1,1,"i",9),a.lc(),a.hc(15,"div",3),a.mc(16,"div",4),a.hc(17,"editable-attribute-field",10),a.lc(),a.Yc(18,f,4,6,"ng-container",11),a.lc(),a.lc()),2&e&&(a.Bc("resource",t.entry)("inEditMode",t.inEditMode),a.Tb(3),a.Bc("ngClass",a.Gc(23,u,t.isRequired("spentOn")))("textContent",t.text.attributes.spentOn),a.Tb(2),a.Bc("resource",t.entry)("wrapperClasses","-tiny")("fieldName","spentOn"),a.Tb(1),a.Bc("ngClass",a.Gc(25,u,t.isRequired("hours")))("textContent",t.text.attributes.hours),a.Tb(2),a.Bc("resource",t.entry)("wrapperClasses","-tiny")("fieldName","hours"),a.Tb(1),a.Bc("ngIf",t.showWorkPackageField),a.Tb(1),a.Bc("ngIf",t.showWorkPackageField),a.Tb(1),a.Bc("ngClass",a.Gc(27,u,t.isRequired("activity")))("textContent",t.text.attributes.activity),a.Tb(2),a.Bc("ngIf",t.workPackageSelected),a.Tb(1),a.Bc("ngIf",!t.workPackageSelected),a.Tb(1),a.Bc("ngClass",a.Gc(29,u,t.isRequired("comment")))("textContent",t.text.attributes.comment),a.Tb(2),a.Bc("resource",t.entry)("fieldName","comment"),a.Tb(1),a.Bc("ngForOf",t.customFields))},directives:[r.a,o.n,l.a,o.q,o.p],encapsulation:2,changeDetection:0})},Zq3F:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("E2tj"),s=i("kt6C"),a=i("U/vl");class r{constructor(e){this.current=new a.a(e.offset,e.total,e.pageSize)}get page(){return this.current.page}set page(e){this.current.page=e}get perPage(){return this.current.perPage}set perPage(e){this.current.perPage=e}get total(){return this.current.total}set total(e){this.current.total=e}}var c=i("zqrF"),o=i("fXoL");class l extends c.b{constructor(e,t){super(e),this.paginationService=t}get paginationObject(){return this.current?{pageSize:this.current.perPage,offset:this.current.page}:{pageSize:this.paginationService.getCachedPerPage([]),offset:1}}valueFromQuery(e,t){return new r(t)}updateFromObject(e){let t=this.current;e.page&&(t.page=e.page),e.perPage&&(t.perPage=e.perPage),e.total&&(t.total=e.total),this.updatesState.putValue(t)}updateFromResults(e){let t={page:e.offset,perPage:e.pageSize,total:e.total,count:e.count};this.updateFromObject(t)}get current(){return this.lastUpdatedState.value}}l.\u0275fac=function(e){return new(e||l)(o.qc(n.a),o.qc(s.a))},l.\u0275prov=o.cc({token:l,factory:l.\u0275fac})},"ZsX/":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("tk/3"),s=i("w1tV"),a=i("pLZG"),r=i("lJxs"),c=i("kTsZ"),o=i("fXoL");class l{constructor(e,t){this.http=e,this.halResource=t}uploadAndMapResponse(e,t,i="post"){const{uploads:n,finished:s}=this.upload(e,t);return{uploads:n,finished:s.then(e=>e.map(e=>({response:e,uploadUrl:e.staticDownloadLocation.href})))}}upload(e,t,i="post"){t=_.filter(t,e=>"directory"!==e.type);const n=_.map(t,t=>this.uploadSingle(e,t,i));return{uploads:n,finished:this.whenFinished(n)}}uploadSingle(e,t,i="post",n="json"){const a=new FormData,r={description:t.description,fileName:t.customName||t.name};return a.append("metadata",JSON.stringify(r)),a.append("file",t,r.fileName),[t,this.http.request(i,e,{body:a,observe:"events",withCredentials:!0,responseType:n,reportProgress:!0}).pipe(Object(s.a)())]}whenFinished(e){const t=e.map(([e,t])=>t.pipe(Object(a.a)(e=>e.type===n.e.Response),Object(r.a)(e=>this.halResource.createHalResource(e.body))).toPromise());return Promise.all(t)}}l.\u0275fac=function(e){return new(e||l)(o.qc(n.b),o.qc(c.a))},l.\u0275prov=o.cc({token:l,factory:l.\u0275fac})},ahVz:function(e,t,i){"use strict";i.d(t,"a",(function(){return j}));var n=i("mrSG"),s=i("dfy/"),a=i("Dp3K"),r=i("IzEk"),c=i("POAS"),o=i("qc15"),l=i("E05v"),d=i("r0MM"),u=i("wZYP"),h=i("eaMR"),p=i("fXoL"),g=i("ofXK"),m=i("CV67"),f=i("CS/5"),b=i("0loS"),w=i("DLfB");function v(e,t){if(1&e&&p.hc(0,"back-button",11),2&e){const e=p.wc();p.Bc("customBackMethod",e.backButtonCallback)}}function y(e,t){if(1&e&&(p.mc(0,"li",15),p.hc(1,"ndc-dynamic",16),p.lc()),2&e){const e=p.wc().$implicit,t=p.wc(2);p.Bc("ngClass",e.containerClasses),p.Tb(1),p.Bc("ndcDynamicComponent",e.component)("ndcDynamicInputs",e.inputs)("ndcDynamicInjector",t.injector)("ndcDynamicOutputs",e.outputs)}}function k(e,t){if(1&e&&(p.kc(0),p.Yc(1,y,2,5,"li",14),p.jc()),2&e){const e=t.$implicit;p.Tb(1),p.Bc("ngIf",!e.show||e.show())}}function C(e,t){if(1&e&&(p.mc(0,"ul",12),p.Yc(1,k,2,1,"ng-container",13),p.lc()),2&e){const e=p.wc();p.Tb(1),p.Bc("ngForOf",e.toolbarButtonComponents)}}class j extends a.a{constructor(){super(...arguments),this.text={jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.pagination"),text_jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.label_pagination")},this.showToolbar=!1,this.toolbarButtonComponents=[],this.filterAllowed=!0,this.currentPartition="-split",this.filterContainerDefinition={component:h.a}}ngOnInit(){super.ngOnInit(),this.showToolbarSaveButton=!!this.$state.params.query_props,this.setPartition(this.$state.current),this.removeTransitionSubscription=this.$transitions.onSuccess({},e=>{const t=e.params("to"),i=e.to();this.showToolbarSaveButton=!!t.query_props,this.setPartition(i),this.cdRef.detectChanges()});const e=!this.querySpace.initialized.hasValue();this.refresh(e,e),this.setupInformationLoadedListener(),this.queryParamListener.observe$.pipe(this.untilDestroyed()).subscribe(()=>{this.currentQuery=void 0,this.refresh(!0,!0)}),this.unRegisterTitleListener=this.$transitions.onSuccess({},()=>{this.updateTitle(this.querySpace.query.value)}),this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.onQueryUpdated(e)})}setPartition(e){this.currentPartition=e.data&&e.data.partition?e.data.partition:"-split"}setupInformationLoadedListener(){this.querySpace.initialized.values$().pipe(Object(r.a)(1)).subscribe(()=>{this.showToolbar=!0,this.cdRef.detectChanges()})}onQueryUpdated(e){this.updateTitle(e),this.currentQuery=e,this.cdRef.detectChanges()}ngOnDestroy(){super.ngOnDestroy(),this.unRegisterTitleListener(),this.removeTransitionSubscription(),this.queryParamListener.removeQueryChangeListener()}changeChangesFromTitle(e){this.currentQuery&&this.currentQuery.persisted?this.updateTitleName(e):this.wpListService.create(this.currentQuery,e).then(()=>this.toolbarDisabled=!1).catch(()=>this.toolbarDisabled=!1)}updateTitleName(e){this.toolbarDisabled=!0,this.currentQuery.name=e,this.wpListService.save(this.currentQuery).then(()=>this.toolbarDisabled=!1).catch(()=>this.toolbarDisabled=!1)}updateTitle(e){e&&(e.persisted?this.selectedTitle=e.name:this.selectedTitle=this.wpStaticQueries.getStaticName(e),this.titleEditingEnabled=this.authorisationService.can("query","updateImmediately"),this.shouldUpdateHtmlTitle()&&this.titleService.setFirstPart(this.selectedTitle))}refresh(e=!1,t=!1){let i;return i=t?this.loadFirstPage():this.wpListService.reloadCurrentResultsList(),e&&(this.loadingIndicator=i.then(()=>this.additionalLoadingTime())),i}loadFirstPage(){return this.currentQuery?this.wpListService.reloadQuery(this.currentQuery,this.projectIdentifier).toPromise():this.wpListService.loadCurrentQueryFromParams(this.projectIdentifier)}additionalLoadingTime(){return Promise.resolve()}set loadingIndicator(e){this.loadingIndicatorService.table.promise=e}shouldUpdateHtmlTitle(){return!0}}j.\u0275fac=function(e){return x(e||j)},j.\u0275cmp=p.ac({type:j,selectors:[["partitioned-query-space-page"]],features:[p.Sb([{provide:c.a,useClass:o.a},l.a]),p.Qb],decls:11,vars:11,consts:[[1,"work-packages-partitioned-query-space--container",3,"ngClass"],[1,"toolbar-container","-editable"],[1,"toolbar"],["linkClass","back-button",3,"customBackMethod",4,"ngIf"],[3,"title","inFlight","showSaveCondition","editable","onSave","onEmptySubmit"],["class","toolbar-items hide-when-print",4,"ngIf"],[1,"work-packages-partitioned-query-space--filter-area"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector"],[1,"work-packages-partitioned-page--content-container"],["data-indicator-name","table","ui-view","content-left",1,"work-packages-partitioned-page--content-left","loading-indicator--location"],["ui-view","content-right",1,"work-packages-partitioned-page--content-right"],["linkClass","back-button",3,"customBackMethod"],[1,"toolbar-items","hide-when-print"],[4,"ngFor","ngForOf"],["class","toolbar-item",3,"ngClass",4,"ngIf"],[1,"toolbar-item",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicInjector","ndcDynamicOutputs"]],template:function(e,t){1&e&&(p.mc(0,"div",0),p.mc(1,"div",1),p.mc(2,"div",2),p.Yc(3,v,1,1,"back-button",3),p.mc(4,"editable-toolbar-title",4),p.uc("onSave",(function(e){return t.changeChangesFromTitle(e)}))("onEmptySubmit",(function(){return t.updateTitleName("")})),p.lc(),p.Yc(5,C,2,1,"ul",5),p.lc(),p.lc(),p.mc(6,"div",6),p.hc(7,"ndc-dynamic",7),p.lc(),p.mc(8,"div",8),p.hc(9,"div",9),p.hc(10,"div",10),p.lc(),p.lc()),2&e&&(p.Bc("ngClass",t.currentPartition),p.Tb(3),p.Bc("ngIf",t.backButtonCallback),p.Tb(1),p.Bc("title",t.selectedTitle)("inFlight",t.toolbarDisabled)("showSaveCondition",t.showToolbarSaveButton)("editable",t.titleEditingEnabled),p.Tb(1),p.Bc("ngIf",t.showToolbar),p.Tb(2),p.Bc("ndcDynamicComponent",t.filterContainerDefinition.component)("ndcDynamicInputs",t.filterContainerDefinition.inputs)("ndcDynamicOutputs",t.filterContainerDefinition.outputs)("ndcDynamicInjector",t.injector))},directives:[g.n,g.q,m.a,f.c,f.d,b.UIView,w.a,g.p],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]{height:100%;overflow:hidden;display:grid;grid-template-columns:1fr;grid-template-rows:auto auto minmax(200px,1fr)}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]{display:flex;overflow:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover{scrollbar-color:#ddd transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{position:relative}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{flex:1}@media only screen and (max-width:679px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{min-width:0;max-width:100vw;max-height:100%}}"],changeDetection:0}),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",u.a)],j.prototype,"I18n",void 0),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",s.a)],j.prototype,"titleService",void 0),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",l.a)],j.prototype,"queryParamListener",void 0);const x=p.oc(j)},ahm3:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));i("AA01");var n=i("wZYP"),s=i("Y41n"),a=i("AEvm"),r=i("Hg4z"),c=i("fXoL"),o=i("3Pt+"),l=i("oUDv");class d extends a.a{constructor(e){super(),this.I18n=e,this.shouldFocus=!1,this.filterChanged=new s.a(Object(r.b)(this))}get value(){return parseInt(this.filter.values[0])}set value(e){this.filter.values="number"==typeof e?[e.toString()]:[],this.filterChanged.emit(this.filter)}get unit(){switch(this.filter.schema.filter.allowedValues[0].id){case"startDate":case"dueDate":case"updatedAt":case"createdAt":return this.I18n.t("js.work_packages.time_relative.days");default:return""}}}d.\u0275fac=function(e){return new(e||d)(c.gc(n.a))},d.\u0275cmp=c.ac({type:d,selectors:[["filter-integer-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[c.Qb],decls:3,vars:7,consts:[[1,"inline-label",3,"id"],["required","","min","0","type","number",1,"advanced-filters--number-field",3,"ngModel","focus","id","name","ngModelChange"],[1,"advanced-filters--affix",3,"for","textContent"]],template:function(e,t){1&e&&(c.mc(0,"div",0),c.mc(1,"input",1),c.uc("ngModelChange",(function(e){return t.value=e})),c.lc(),c.hc(2,"label",2),c.lc()),2&e&&(c.Dc("id","div-values-",t.filter.id,""),c.Tb(1),c.Dc("id","values-",t.filter.id,""),c.Dc("name","v[",t.filter.id,"]"),c.Bc("ngModel",t.value)("focus",t.shouldFocus),c.Tb(1),c.Dc("for","values-",t.filter.id,""),c.Bc("textContent",t.unit))},directives:[o.s,o.c,o.x,o.m,o.p,l.a],encapsulation:2})},aveh:function(e,t,i){"use strict";i.d(t,"a",(function(){return Z}));var n=i("wZYP"),s=i("Jui0"),a=i("/uUt"),r=i("lJxs"),c=i("qHU1"),o=i("sjKJ"),l=i("iMRi"),d=(i("ii2/"),i("SKFm")),u=i("ug4p"),h=i("J30J"),p=i("B4Ei"),g=i("g1AQ"),m=i("XNiG"),f=i("R9pB"),b=i("buwf"),w=i("kTsZ"),v=i("AEvm"),y=i("fXoL"),k=i("ofXK"),C=i("CS/5"),j=i("lJGx"),x=i("80WE"),T=i("K8b8"),S=i("CX+C"),P=i("+pCT"),I=i("QihR"),O=i("+ytV"),R=i("HEQ6");function B(e,t){if(1&e&&(y.mc(0,"div",22),y.hc(1,"editable-attribute-field",23),y.lc()),2&e){const e=y.wc(2);y.Tb(1),y.Bc("resource",e.workPackage)("wrapperClasses","-no-label")("fieldName","subject")}}function E(e,t){if(1&e&&y.hc(0,"wp-status-button",24),2&e){const e=y.wc(2);y.Bc("workPackage",e.workPackage)}}function M(e,t){1&e&&y.hc(0,"attribute-help-text",25),2&e&&y.Bc("attribute","status")("attributeScope","WorkPackage")}function F(e,t){if(1&e&&(y.mc(0,"div",26),y.hc(1,"span",27),y.ad(2,": "),y.hc(3,"span",27),y.mc(4,"span"),y.ad(5,"\xa0"),y.lc(),y.hc(6,"user-link",28),y.ad(7,". "),y.hc(8,"span",27),y.mc(9,"span"),y.ad(10,"\xa0"),y.lc(),y.hc(11,"op-date-time",29),y.ad(12,". "),y.lc()),2&e){const e=y.wc(2);y.Tb(1),y.Bc("textContent",e.idLabel),y.Tb(2),y.Bc("textContent",e.text.infoRow.createdBy),y.Tb(3),y.Bc("user",e.workPackage.author),y.Tb(2),y.Bc("textContent",e.text.infoRow.lastUpdatedOn),y.Tb(3),y.Bc("dateTimeValue",e.workPackage.updatedAt)}}function A(e,t){1&e&&(y.mc(0,"span",39),y.ad(1,"*"),y.lc())}const D=function(e){return{"-span-all-columns":e}};function q(e,t){if(1&e&&(y.mc(0,"div",33),y.mc(1,"div",34),y.mc(2,"wp-replacement-label",35),y.ad(3),y.Yc(4,A,2,0,"span",36),y.lc(),y.hc(5,"attribute-help-text",25),y.lc(),y.mc(6,"div",37),y.hc(7,"editable-attribute-field",38),y.lc(),y.lc()),2&e){const e=t.$implicit,i=y.wc(3);y.Bc("ngClass",y.Gc(8,D,e.spanAll)),y.Tb(2),y.Bc("fieldName",e.name),y.Tb(1),y.cd(" ",e.label," "),y.Tb(1),y.Bc("ngIf",e.field.required&&e.field.writable),y.Tb(1),y.Bc("attribute",e.name)("attributeScope","WorkPackage"),y.Tb(2),y.Bc("resource",i.workPackage)("fieldName",e.name)}}function L(e,t){if(1&e&&(y.mc(0,"div",30),y.mc(1,"div"),y.hc(2,"p",31),y.Yc(3,q,8,10,"div",32),y.lc(),y.lc()),2&e){const e=y.wc(2);y.Tb(2),y.Bc("textContent",e.text.project.required),y.Tb(1),y.Bc("ngForOf",e.projectContext.field)("ngForTrackBy",e.trackByName)}}function $(e,t){if(1&e&&(y.mc(0,"div",40),y.mc(1,"div"),y.mc(2,"p"),y.hc(3,"span",41),y.hc(4,"br"),y.hc(5,"a",42),y.lc(),y.lc(),y.lc()),2&e){const e=y.wc(2);y.Tb(3),y.Bc("innerHTML",e.projectContextText,y.Rc),y.Tb(2),y.Bc("textContent",e.text.project.switchTo),y.Ub("href",e.projectContext.href,y.Tc)}}const N=function(e){return{workPackage:e}};function Q(e,t){if(1&e&&(y.kc(0),y.hc(1,"ndc-dynamic",6),y.jc()),2&e){const e=t.$implicit,i=y.wc(2);y.Tb(1),y.Bc("ndcDynamicComponent",e)("ndcDynamicInputs",y.Gc(2,N,i.workPackage))}}const V=function(e,t,i){return{workPackage:e,group:t,query:i}};function H(e,t){if(1&e&&(y.kc(0,46),y.hc(1,"ndc-dynamic",6),y.jc()),2&e){const e=y.wc().$implicit,t=y.wc(2);y.Tb(1),y.Bc("ndcDynamicComponent",t.attributeGroupComponent(e))("ndcDynamicInputs",y.Ic(2,V,t.workPackage,e,e.query))}}const z=function(e,t){return{workPackage:e,group:t}};function Y(e,t){if(1&e&&(y.kc(0),y.mc(1,"div",3),y.mc(2,"div",4),y.hc(3,"h3",5),y.lc(),y.lc(),y.hc(4,"ndc-dynamic",47),y.jc()),2&e){const e=y.wc().$implicit,t=y.wc(2);y.Tb(3),y.Bc("textContent",e.name),y.Tb(1),y.Bc("ndcDynamicComponent",t.attributeGroupComponent(e))("ndcDynamicInjector",t.injector)("ndcDynamicInputs",y.Hc(4,z,t.workPackage,e))}}function W(e,t){if(1&e&&(y.mc(0,"div",43),y.Yc(1,H,2,6,"ng-container",44),y.Yc(2,Y,5,7,"ng-container",45),y.lc()),2&e){const e=t.$implicit,i=y.wc(2);y.Bc("hidden",i.shouldHideGroup(e))("ngClass","__overflowing_"+e.id),y.Ub("data-group-name",e.name)("data-overflowing-identifier",".__overflowing_"+e.id),y.Tb(1),y.Bc("ngIf",e.isolated),y.Tb(1),y.Bc("ngIf",!e.isolated)}}const U=function(e){return{"-can-have-columns":e}};function G(e,t){if(1&e&&(y.mc(0,"div",8),y.Yc(1,B,2,3,"div",9),y.mc(2,"div",10),y.Yc(3,E,1,1,"wp-status-button",11),y.Yc(4,M,1,2,"attribute-help-text",12),y.Yc(5,F,13,5,"div",13),y.hc(6,"wp-custom-actions",14),y.lc(),y.Yc(7,L,4,3,"div",15),y.Yc(8,$,6,3,"div",16),y.Yc(9,Q,2,4,"ng-container",17),y.mc(10,"div",18),y.mc(11,"div",3),y.mc(12,"div",4),y.hc(13,"h3",5),y.lc(),y.lc(),y.mc(14,"div",19),y.hc(15,"editable-attribute-field",20),y.lc(),y.lc(),y.Yc(16,W,3,6,"div",21),y.lc()),2&e){const e=y.wc();y.Bc("ngClass",y.Gc(16,U,e.enableTwoColumnLayout)),y.Tb(1),y.Bc("ngIf",e.workPackage.isNew),y.Tb(2),y.Bc("ngIf",!e.workPackage.isNew),y.Tb(1),y.Bc("ngIf",!e.workPackage.isNew),y.Tb(1),y.Bc("ngIf",!e.workPackage.isNew),y.Tb(1),y.Bc("workPackage",e.workPackage),y.Tb(1),y.Bc("ngIf",e.projectContext&&e.projectContext.field),y.Tb(1),y.Bc("ngIf",!e.workPackage.isNew&&e.projectContext&&!e.projectContext.matches),y.Tb(1),y.Bc("ngForOf",e.prependedAttributeGroupComponents()),y.Tb(4),y.Bc("textContent",e.text.fields.description),y.Tb(2),y.Bc("fieldName","description")("resource",e.workPackage)("isDropTarget",!0)("wrapperClasses","-no-label"),y.Tb(1),y.Bc("ngForOf",e.groupedFields)("ngForTrackBy",e.trackByName)}}const X=function(e){return{resource:e}};function K(e,t){if(1&e&&y.hc(0,"ndc-dynamic",6),2&e){const e=y.wc();y.Bc("ndcDynamicComponent",e.attachmentUploadComponent())("ndcDynamicInputs",y.Gc(2,X,e.workPackage))}}class Z extends v.a{constructor(e,t,i,n,s,a,r,c,o,l,d,u,h){super(),this.I18n=e,this.currentProject=t,this.PathHelper=i,this.states=n,this.halEditing=s,this.halResourceService=a,this.displayFieldService=r,this.wpCacheService=c,this.hook=o,this.injector=l,this.cdRef=d,this.elementRef=u,this.browserDetector=h,this.showProject=!1,this.groupedFields=[],this.resourceContextChange=new m.a,this.text={attachments:{label:this.I18n.t("js.label_attachments")},project:{required:this.I18n.t("js.project.required_outside_context"),context:this.I18n.t("js.project.context"),switchTo:this.I18n.t("js.project.click_to_switch_context")},fields:{description:this.I18n.t("js.work_packages.properties.description")},infoRow:{createdBy:this.I18n.t("js.label_created_by"),lastUpdatedOn:this.I18n.t("js.label_last_updated_on")}},this.firstTimeFocused=!1}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement);const e=this.halEditing.changeFor(this.workPackage);this.resourceContextChange.next(this.contextFrom(e.projectedResource)),this.refresh(e),this.resourceContextChange.pipe(this.untilDestroyed(),Object(a.a)((e,t)=>_.isEqual(e,t)),Object(r.a)(()=>this.halEditing.changeFor(this.workPackage))).subscribe(e=>this.refresh(e)),this.halEditing.temporaryEditResource(this.workPackage).values$().pipe(this.untilDestroyed()).subscribe(e=>{this.resourceContextChange.next(this.contextFrom(e))})}refresh(e){const t=this.workPackage.isNew,i=e.projectedResource;i.project?this.projectContext={href:this.PathHelper.projectWorkPackagePath(i.project.idFromLink,this.workPackage.id),matches:i.project.href===this.currentProject.apiv3Path}:this.projectContext={matches:!1,href:null},t&&!this.currentProject.inProjectContext&&(this.projectContext.field=this.getFields(i,["project"]));const n=i.schema._attributeGroups;this.groupedFields=this.rebuildGroupedFields(i,n),this.cdRef.detectChanges()}shouldHideGroup(e){const t=0===e.members.length,i=this.workPackage.isNew&&!!e.query;return t||i}trackByName(e,t){return t.name}prependedAttributeGroupComponents(){return this.hook.call("prependedAttributeGroups",this.workPackage)}attributeGroupComponent(e){return this.hook.call("attributeGroupComponent",e,this.workPackage).pop()||null}attachmentListComponent(){return this.hook.call("workPackageAttachmentListComponent",this.workPackage).pop()||null}attachmentUploadComponent(){return this.hook.call("workPackageAttachmentUploadComponent",this.workPackage).pop()||null}get idLabel(){return`#${this.workPackage.id}`}get projectContextText(){let e=this.workPackage.project.idFromLink,t=`<a href="${this.PathHelper.projectPath(e)}">${this.workPackage.project.name}<a>`;return this.I18n.t("js.project.work_package_belongs_to",{projectname:t})}get enableTwoColumnLayout(){return this.workPackage.isNew&&!this.browserDetector.isEdge}rebuildGroupedFields(e,t){return t?t.map(t=>{let i=this.getAttributesGroupId(t);return"WorkPackageFormAttributeGroup"===t._type?{name:t.name,id:i||Object(f.a)(16),members:this.getFields(e,t.attributes),type:t._type,isolated:!1}:{name:t.name,id:i||Object(f.a)(16),query:this.halResourceService.createHalResourceOfClass(p.a,t._embedded.query),relationType:t.relationType,members:[t._embedded.query],type:t._type,isolated:!0}}):[]}getFields(e,t){const i=[];return t.forEach(t=>{if("date"===t)return void i.push(this.getDateField(e));if(!e.schema[t])return void Object(c.a)("Unknown field for current schema",t);const n=this.displayField(e,t);i.push({name:t,label:n.label,multiple:!1,spanAll:n.isFormattable,field:n})}),i}getDateField(e){let t={label:this.I18n.t("js.work_packages.properties.date"),multiple:!1};return e.schema.hasOwnProperty("date")?(t.field=this.displayField(e,"date"),t.name="date"):(t.field=this.displayField(e,"startDate"),t.name="startDate"),t}contextFrom(e){let t=e.schema,i=null,n=e.project&&e.project.href;return i=t.baseSchema?t.baseSchema.href:t.href,{isNew:e.isNew,schema:i,project:n}}displayField(e,t){return this.displayFieldService.getField(e,t,e.schema[t],{container:"single-view",injector:this.injector,options:{}})}getAttributesGroupId(e){let t=this.$element.find("[data-group-name='"+e.name+"']").data("overflowingIdentifier");return t?t.replace(".__overflowing_",""):""}}Z.\u0275fac=function(e){return new(e||Z)(y.gc(n.a),y.gc(o.a),y.gc(s.a),y.gc(l.a),y.gc(d.a),y.gc(w.a),y.gc(h.a),y.gc(u.a),y.gc(g.a),y.gc(y.A),y.gc(y.i),y.gc(y.q),y.gc(b.a))},Z.\u0275cmp=y.ac({type:Z,selectors:[["wp-single-view"]],inputs:{workPackage:"workPackage",showProject:"showProject"},features:[y.Qb],decls:8,vars:7,consts:[["class","work-package--single-view",3,"ngClass",4,"ngIf"],[1,"work-packages--attachments","attributes-group"],[1,"work-packages--attachments-container"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],[3,"ndcDynamicComponent","ndcDynamicInputs"],[3,"ndcDynamicComponent","ndcDynamicInputs",4,"ngIf"],[1,"work-package--single-view",3,"ngClass"],["class","wp-new--subject-wrapper",4,"ngIf"],[1,"wp-info-wrapper"],[3,"workPackage",4,"ngIf"],[3,"attribute","attributeScope",4,"ngIf"],["class","work-packages--info-row",4,"ngIf"],[1,"custom-actions",3,"workPackage"],["class","attributes-group -project-context __overflowing_element_container __overflowing_project_context","data-overflowing-identifier",".__overflowing_project_context",4,"ngIf"],["class","attributes-group -project-context hide-when-print",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"attributes-group","description-group"],[1,"single-attribute","work-packages--details--description"],[3,"fieldName","resource","isDropTarget","wrapperClasses"],["class","attributes-group __overflowing_element_container",3,"hidden","ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"wp-new--subject-wrapper"],[3,"resource","wrapperClasses","fieldName"],[3,"workPackage"],[3,"attribute","attributeScope"],[1,"work-packages--info-row"],[3,"textContent"],[1,"user-link",3,"user"],[3,"dateTimeValue"],["data-overflowing-identifier",".__overflowing_project_context",1,"attributes-group","-project-context","__overflowing_element_container","__overflowing_project_context"],[1,"wp-project-context--warning",3,"textContent"],["class","attributes-key-value",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"attributes-key-value",3,"ngClass"],[1,"attributes-key-value--key"],[3,"fieldName"],["class","required",4,"ngIf"],[1,"attributes-key-value--value-container"],[3,"resource","fieldName"],[1,"required"],[1,"attributes-group","-project-context","hide-when-print"],[3,"innerHTML"],[1,"project-context--switch-link",3,"textContent"],[1,"attributes-group","__overflowing_element_container",3,"hidden","ngClass"],["wp-isolated-query-space","",4,"ngIf"],[4,"ngIf"],["wp-isolated-query-space",""],[3,"ndcDynamicComponent","ndcDynamicInjector","ndcDynamicInputs"]],template:function(e,t){1&e&&(y.Yc(0,G,17,18,"div",0),y.mc(1,"div",1),y.mc(2,"div",2),y.mc(3,"div",3),y.mc(4,"div",4),y.hc(5,"h3",5),y.lc(),y.lc(),y.hc(6,"ndc-dynamic",6),y.Yc(7,K,1,4,"ndc-dynamic",7),y.lc(),y.lc()),2&e&&(y.Bc("ngIf",t.workPackage),y.Tb(5),y.Bc("textContent",t.text.attachments.label),y.Tb(1),y.Bc("ndcDynamicComponent",t.attachmentListComponent())("ndcDynamicInputs",y.Gc(5,X,t.workPackage)),y.Tb(1),y.Bc("ngIf",t.workPackage.canAddAttachments))},directives:[k.q,C.c,C.d,k.n,j.a,k.p,x.a,T.a,S.a,P.a,I.a,O.a,R.a],encapsulation:2,changeDetection:0})},ayqa:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("mrSG"),s=i("juWA"),a=i("RGDJ"),r=i("5qbd"),c=i("r0MM");class o extends r.a{render(e,t){if(super.render(e,t),this.showSchedulingMode()){const t=document.createElement("span");t.classList.add("icon-context"),t.classList.add(this.resource.scheduleManually?"icon-pin":"icon-arrow-left-right"),e.prepend(t)}if(this.shouldHighlight&&this.canOverdue){const t=this.timezoneService.daysFromToday(this.value);e.classList.add(a.a.overdueDate(t))}}get canOverdue(){return-1!==["dueDate","date"].indexOf(this.name)}get valueString(){return this.value?this.timezoneService.formattedDate(this.value):""}showSchedulingMode(){return"startDate"===this.name||"date"===this.name}}Object(n.c)([Object(c.a)(),Object(n.e)("design:type",s.a)],o.prototype,"timezoneService",void 0)},buKu:function(e,t,i){"use strict";i.r(t);i("yLV6");i("tG68"),i("E+lO"),i("vPHx"),i("vqYl"),i("SU55")},buwf:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("ofXK"),s=i("fXoL");class a{constructor(e){this.documentElement=e}get isMobile(){return this.hasBodyClass("-browser-mobile")}get isEdge(){return this.hasBodyClass("-browser-edge")}hasBodyClass(e){return this.documentElement.body.classList.contains(e)}}a.\u0275fac=function(e){return new(e||a)(s.qc(n.d))},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac,providedIn:"root"})},byj5:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("wZYP"),s=i("l08T"),a=i("F5Dh"),r=i("fbLK"),c=i("fXoL"),o=i("ofXK"),l=i("70hh");function d(e,t){if(1&e){const e=c.nc();c.mc(0,"query-filters",1),c.uc("filtersChanged",(function(t){return c.Qc(e),c.wc().filters=t})),c.lc()}if(2&e){const e=c.wc();c.Bc("filters",e.filters)}}class u{constructor(e,t,i,n,s){this.injector=e,this.I18n=t,this.wpTableFilters=i,this.wpFiltersService=n,this.bannerService=s,this.filters=[],this.eeShowBanners=!1,this.text={columnsLabel:this.I18n.t("js.label_columns"),selectedColumns:this.I18n.t("js.description_selected_columns"),multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect"),upsaleRelationColumns:this.I18n.t("js.modals.upsale_relation_columns"),upsaleRelationColumnsLink:this.I18n.t("js.modals.upsale_relation_columns_link")}}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners,this.wpTableFilters.onReady().then(()=>this.filters=this.wpTableFilters.current)}onSave(){this.filters&&this.wpTableFilters.replaceIfComplete(this.filters)}}u.\u0275fac=function(e){return new(e||u)(c.gc(c.A),c.gc(n.a),c.gc(a.a),c.gc(s.a),c.gc(r.a))},u.\u0275cmp=c.ac({type:u,selectors:[["wp-table-config-filters-tab"]],decls:1,vars:1,consts:[[3,"filters","filtersChanged",4,"ngIf"],[3,"filters","filtersChanged"]],template:function(e,t){1&e&&c.Yc(0,d,1,1,"query-filters",0),2&e&&c.Bc("ngIf",!!t.filters)},directives:[o.q,l.a],encapsulation:2})},cJ7v:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("wZYP"),s=i("d/TE"),a=i("fXoL"),r=i("ofXK"),c=i("N5AO"),o=i("lmKF"),l=i("/Rze");function d(e,t){if(1&e){const e=a.nc();a.mc(0,"a",7),a.uc("click",(function(t){return a.Qc(e),a.wc().executeTarget(t)})),a.lc()}if(2&e){const e=a.wc();a.Bc("textContent",e.notification.link.text)}}function u(e,t){if(1&e){const e=a.nc();a.mc(0,"div"),a.mc(1,"a",11),a.uc("click",(function(){return a.Qc(e),a.wc(2).show=!0})),a.hc(2,"op-icon",12),a.lc(),a.mc(3,"a",11),a.uc("click",(function(){return a.Qc(e),a.wc(2).show=!1})),a.hc(4,"op-icon",13),a.lc(),a.hc(5,"span",2),a.lc()}if(2&e){const e=a.wc(2);a.Tb(1),a.Bc("hidden",e.show),a.Tb(2),a.Bc("hidden",!e.show),a.Tb(2),a.Bc("textContent",e.uploadText)}}function h(e,t){if(1&e){const e=a.nc();a.mc(0,"notifications-upload-progress",16),a.uc("onSuccess",(function(){return a.Qc(e),a.wc(3).onUploadSuccess()}))("onError",(function(t){return a.Qc(e),a.wc(3).onUploadError(t)})),a.lc()}if(2&e){const e=t.$implicit;a.Bc("upload",e)}}function p(e,t){if(1&e&&(a.mc(0,"ul",14),a.Yc(1,h,1,1,"notifications-upload-progress",15),a.lc()),2&e){const e=a.wc(2);a.Tb(1),a.Bc("ngForOf",e.data)}}const g=function(e){return{"-hidden":e}};function m(e,t){if(1&e&&(a.mc(0,"div"),a.Yc(1,u,6,3,"div",8),a.mc(2,"div",9),a.Yc(3,p,2,1,"ul",10),a.lc(),a.lc()),2&e){const e=a.wc();a.Tb(1),a.Bc("ngIf",e.canBeHidden()),a.Tb(1),a.Bc("ngClass",a.Gc(3,g,!e.show&&e.canBeHidden())),a.Tb(1),a.Bc("ngIf",e.data&&e.data.length>0)}}function f(e,t){1&e&&a.hc(0,"div")}function b(e,t){if(1&e&&a.hc(0,"li",2),2&e){const e=t.$implicit;a.Bc("textContent",e)}}function w(e,t){if(1&e&&(a.mc(0,"div"),a.mc(1,"ul",17),a.Yc(2,b,1,1,"li",18),a.lc(),a.lc()),2&e){const e=a.wc();a.Tb(2),a.Bc("ngForOf",e.data)}}function v(e,t){if(1&e){const e=a.nc();a.mc(0,"accessible-by-keyboard",19),a.uc("execute",(function(){return a.Qc(e),a.wc().remove()})),a.lc()}if(2&e){const e=a.wc();a.Bc("linkTitle",e.text.close_popup)}}class y{constructor(e,t){this.I18n=e,this.notificationsService=t,this.text={close_popup:this.I18n.t("js.close_popup_title")},this.uploadCount=0,this.show=!1}ngOnInit(){this.type=this.notification.type}get data(){return this.notification.data}canBeHidden(){return this.data&&this.data.length>5}removable(){return"upload"!==this.notification.type}remove(){this.notificationsService.remove(this.notification)}executeTarget(){this.notification.link&&(this.notification.link.target(),this.remove())}onUploadError(e){this.remove()}onUploadSuccess(){this.uploadCount+=1}get uploadText(){return this.I18n.t("js.label_upload_counter",{done:this.uploadCount,count:this.data.length})}}y.\u0275fac=function(e){return new(e||y)(a.gc(n.a),a.gc(s.a))},y.\u0275cmp=a.ac({type:y,selectors:[["notification"]],inputs:{notification:"notification"},decls:11,vars:11,consts:[["tabindex","0"],["role","alert","aria-atomic","true",1,"notification-box--content"],[3,"textContent"],["class","notification-box--target-link",3,"textContent","click",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["linkClass","notification-box--close icon-context icon-close",3,"linkTitle","execute",4,"ngIf"],[1,"notification-box--target-link",3,"textContent","click"],[4,"ngIf"],[3,"ngClass"],["class","notification-box--uploads",4,"ngIf"],[3,"hidden","click"],["icon-classes","icon-arrow-right2"],["icon-classes","icon-arrow-down1"],[1,"notification-box--uploads"],[3,"upload","onSuccess","onError",4,"ngFor","ngForOf"],[3,"upload","onSuccess","onError"],[1,"notification-box--errors"],[3,"textContent",4,"ngFor","ngForOf"],["linkClass","notification-box--close icon-context icon-close",3,"linkTitle","execute"]],template:function(e,t){1&e&&(a.mc(0,"div",0),a.mc(1,"div",1),a.mc(2,"p"),a.hc(3,"span",2),a.hc(4,"span",2),a.Yc(5,d,1,1,"a",3),a.lc(),a.mc(6,"div",4),a.Yc(7,m,4,5,"div",5),a.Yc(8,f,1,0,"div",5),a.Yc(9,w,3,1,"div",5),a.lc(),a.lc(),a.Yc(10,v,1,1,"accessible-by-keyboard",6),a.lc()),2&e&&(a.Vb("notification-box -",t.type,""),a.Tb(3),a.Bc("textContent",t.notification.message),a.Tb(1),a.Bc("textContent"," "),a.Tb(1),a.Bc("ngIf",t.notification.link),a.Tb(1),a.Bc("ngSwitch",t.type),a.Tb(1),a.Bc("ngSwitchCase","upload"),a.Tb(1),a.Bc("ngSwitchCase","success"),a.Tb(1),a.Bc("ngSwitchCase","error"),a.Tb(1),a.Bc("ngIf",t.removable()))},directives:[r.q,r.u,r.v,r.n,c.a,r.p,o.a,l.a],encapsulation:2,changeDetection:0})},cK71:function(e,t,i){e.exports=global.I18n=i("eFC/")},"cd/7":function(e,t,i){"use strict";i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return a}));const n="__ui-state-link",s="-checked";class a{constructor(e,t){this.$state=e,this.keepTab=t}linkToDetails(e,t,i){return this.build(e,"currentDetailsState",t,i)}linkToShow(e,t,i){return this.build(e,"currentShowState",t,i)}build(e,t,i,s){let a=document.createElement("a");return a.href=this.$state.href(this.keepTab[t],{workPackageId:e}),a.classList.add(n),a.dataset.workPackageId=e,a.dataset.wpState=t,a.setAttribute("title",i),a.textContent=s,a}}},ciXH:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));i("YW04");var n=i("kTsZ"),s=i("Jui0"),a=i("RhL0"),r=i("fXoL");class c{constructor(e,t){this.halResourceService=e,this.pathHelper=t}list(e){return this.listRequest(this.listUrl(),e)}one(e){return this.halResourceService.get(this.oneUrl(e).toString()).toPromise()}listRequest(e,t){return this.halResourceService.get(e+this.listParamsString(t)).toPromise()}listParamsString(e){let t=[];if(e&&e.sortBy&&t.push(`sortBy=${JSON.stringify(e.sortBy)}`),e&&void 0!==e.pageSize&&t.push(`pageSize=${e.pageSize}`),e&&e.filters){let i=new a.a;e.filters.forEach(e=>{i.add(...e)}),t.push(i.toParams())}let i="";return t.length&&(i=`?${t.join("&")}`),i}}c.\u0275fac=function(e){return new(e||c)(r.qc(n.a),r.qc(s.a))},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac})},crnd:function(e,t){function i(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}i.keys=function(){return[]},i.resolve=i,e.exports=i,i.id="crnd"},"d/TE":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("8zkO"),s=i("FnNU"),a=i("fXoL");class r{constructor(e){this.configurationService=e,this.stack=Object(s.f)([]),jQuery(window).on("op:notifications:add",(e,t)=>{this.add(t)})}get current(){return this.stack}add(e,t=5e3){return jQuery(".flash.notice").remove(),this.stack.doModify(t=>{let i=[e].concat(t);return _.remove(i,(e,t)=>t>0&&("success"===e.type||"error"===e.type)),i}),"success"===e.type&&this.configurationService.autoHidePopups()&&setTimeout(()=>this.remove(e),t),e}addError(e,t=[]){Array.isArray(t)||(t=[t]);let i=this.createNotification(e,"error");return i.data=t,this.add(i)}addWarning(e){return this.add(this.createNotification(e,"warning"))}addSuccess(e){return this.add(this.createNotification(e,"success"))}addNotice(e){return this.add(this.createNotification(e,"info"))}addAttachmentUpload(e,t){return this.add(this.createAttachmentUploadNotification(e,t))}remove(e){this.stack.doModify(t=>(_.remove(t,t=>t===e),t))}clear(){this.stack.putValue([])}createNotification(e,t){return"string"==typeof e?{message:e,type:t}:(e.type=t,e)}createAttachmentUploadNotification(e,t){if(!t.length)throw new Error("Cannot create an upload notification without uploads!");let i=this.createNotification(e,"upload");return i.data=t,i}}r.\u0275fac=function(e){return new(e||r)(a.qc(n.a))},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac,providedIn:"root"})},d4d5:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{get id(){return this.$source.id||this.idFromLink}set id(e){this.$source.id=e}}},dMmB:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("iMRi"),s=i("kTsZ"),a=i("fXoL");class r{constructor(e,t){this.states=e,this.halResourceService=t}ensureLoaded(e){const t=this.state(e);return t.hasValue()?Promise.resolve(t.value):this.load(e).valuesPromise()}state(e){const t=e.$links.schema;if(!t)throw`Resource ${e} has no schema!`;return this.states.schemas.get(t.href)}load(e,t=!1){const i=this.state(e);return t&&i.clear(),i.putFromPromiseIfPristine(()=>this.halResourceService.createLinkedResource(e,"schema",e.$links.schema.$link).$load()),i}}r.\u0275fac=function(e){return new(e||r)(a.qc(n.a),a.qc(s.a))},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac})},"dfy/":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("fXoL"),s=i("jhN1");class a{constructor(e){this.titleService=e}get current(){return this.titleService.getTitle()}get titleParts(){return this.current.split(" | ")}setFirstPart(e){let t=this.titleParts;t[0]=e,this.titleService.setTitle(t.join(" | "))}}a.\u0275fac=function(e){return new(e||a)(n.qc(s.e))},a.\u0275prov=n.cc({token:a,factory:a.\u0275fac,providedIn:"root"})},e6KS:function(e,t,i){"use strict";i.d(t,"c",(function(){return d})),i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return h}));var n=i("mrSG"),s=i("XZsv"),a=i("iMRi"),r=i("SKFm"),c=i("/C7M"),o=i("POAS"),l=i("r0MM");const d="inline-edit--active-field",u="inline-edit--field";class h{constructor(e){this.injector=e,this.activeFields={},this.errorsPerAttribute={},this.editMode=!1}onSaved(e){}hasActiveFields(){return!_.isEmpty(this.activeFields)}get change(){return this.halEditing.changeFor(this.resource)}activate(e,t=!1){return this.loadFieldSchema(e,t).then(i=>i.writable||t?this.renderField(e,i):(this.halNotification.showEditingBlockedError(i.name||e),Promise.reject()))}activateWhenNeeded(e){return this.activeFields[e]?Promise.resolve():this.requireVisible(e).then(()=>this.activate(e,!0))}activateMissingFields(){this.change.getForm().then(e=>{_.each(e.validationErrors,(e,t)=>{"id"!==t&&this.activateWhenNeeded(t)})})}submit(){return Object(n.b)(this,void 0,void 0,(function*(){if(this.change.isEmpty()&&!this.resource.isNew)return this.closeEditFields(),Promise.resolve(this.resource);this.change.inFlight=!0,this.errorsPerAttribute={};const e=_.keys(this.activeFields);return yield Promise.all(_.map(this.activeFields,e=>e.onSubmit())),new Promise((t,i)=>{this.halEditing.save(this.change).then(i=>{this.closeEditFields(e),t(i.resource),this.halNotification.showSave(i.resource,i.wasNew),this.editMode=!1,this.onSaved(i),this.change.inFlight=!1}).catch(e=>{this.halNotification.handleRawError(e,this.resource),e instanceof s.a&&(this.handleSubmissionErrors(e),i()),this.change.inFlight=!1})})}))}closeEditFields(e="all",t=!0){"all"===e&&(e=_.keys(this.activeFields)),e.forEach(e=>{const i=this.activeFields[e];i&&i.deactivate(!1),t&&this.change.reset(e)})}handleSubmissionErrors(e){this.handleErroneousAttributes(e)}handleErroneousAttributes(e){const t=e.getInvolvedAttributes();if(this.errorsPerAttribute=e.getMessagesPerAttribute(),0!==t.length)return this.setErrorsForFields(t)}setErrorsForFields(e){let t=e.map(e=>this.requireVisible(e).then(()=>(this.activeFields[e]&&this.activeFields[e].setErrors(this.errorsPerAttribute[e]||[]),this.activateWhenNeeded(e))));Promise.all(t).then(()=>{setTimeout(()=>this.focusOnFirstError())}).catch(()=>{console.error("Failed to activate all erroneous fields.")})}loadFieldSchema(e,t=!1){const i=this.change.getSchemaName(e);return new Promise((e,n)=>{this.loadFormAndCheck(i,t);const s=this.change.schema[i];if(!s)throw new Error;e(s)})}loadFormAndCheck(e,t=!1){const i=this.change.getSchemaName(e);this.change.getForm().then(n=>{const s=n.schema[i];s.writable||t||(this.halNotification.showEditingBlockedError(s.name||e),this.closeEditFields([e]))}).catch(t=>{console.error("Failed to build edit field: %o",t),this.halNotification.handleRawError(t,this.resource),this.closeEditFields([e])})}renderField(e,t){return this.activateField(this,t,e,this.errorsPerAttribute[e]||[]).then(t=>(this.activeFields[e]=t,t)).catch(e=>{console.error("Failed to render edit field:"+e),this.halNotification.handleRawError(e)})}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",a.a)],h.prototype,"states",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",r.a)],h.prototype,"halEditing",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",o.a)],h.prototype,"halNotification",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",c.a)],h.prototype,"halEvents",void 0)},"eFC/":function(e,t,i){var n,s;s=this,void 0===(n=(function(){return function(e){"use strict";var t=e&&e.I18n||{},i=Array.prototype.slice,n=function(e){return("0"+e.toString()).substr(-2)},s=function(e){var t=typeof e;return"function"===t||"object"===t},a=function(e){return"function"==typeof e},r=function(e){return null!=e},c=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},o=function(e){return"string"==typeof value||"[object String]"===Object.prototype.toString.call(e)},l=function(e){return!0===e||!1===e},d=function(e,t,i){return void 0===i||0==+i?Math[e](t):(t=+t,i=+i,isNaN(t)||"number"!=typeof i||i%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-i:-i)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+i:i))))},u=function(e,t){return a(e)?e(t):e},h=function(e,t){var i,n,s;for(i in t)t.hasOwnProperty(i)&&(n=t[i],o(n)||"number"==typeof(s=n)||"[object Number]"===Object.prototype.toString.call(s)||l(n)||c(n)?e[i]=n:(null==e[i]&&(e[i]={}),h(e[i],n)));return e},p={day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:[null,"January","February","March","April","May","June","July","August","September","October","November","December"],abbr_month_names:[null,"Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridian:["AM","PM"]},g={precision:3,separator:".",delimiter:",",strip_insignificant_zeros:!1},m={unit:"$",precision:2,format:"%u%n",sign_first:!0,delimiter:",",separator:"."},f={unit:"%",precision:3,format:"%n%u",separator:".",delimiter:""},b=[null,"kb","mb","gb","tb"],w={defaultLocale:"en",locale:"en",defaultSeparator:".",placeholder:/(?:\{\{|%\{)(.*?)(?:\}\}?)/gm,fallbacks:!1,translations:{},missingBehaviour:"message",missingTranslationPrefix:""};return t.reset=function(){var e;for(e in w)this[e]=w[e]},t.initializeOptions=function(){var e;for(e in w)r(this[e])||(this[e]=w[e])},t.initializeOptions(),t.locales={},t.locales.get=function(e){var i=this[e]||this[t.locale]||this.default;return a(i)&&(i=i(e)),!1===c(i)&&(i=[i]),i},t.locales.default=function(e){var i=[],n=[];return e&&i.push(e),!e&&t.locale&&i.push(t.locale),t.fallbacks&&t.defaultLocale&&i.push(t.defaultLocale),i.forEach((function(e){var i=e.split("-"),s=null,a=null;3===i.length?(s=[i[0],i[1]].join("-"),a=i[0]):2===i.length&&(s=i[0]),-1===n.indexOf(e)&&n.push(e),t.fallbacks&&[s,a].forEach((function(t){null!=t&&t!==e&&-1===n.indexOf(t)&&n.push(t)}))})),i.length||i.push("en"),n},t.pluralization={},t.pluralization.get=function(e){return this[e]||this[t.locale]||this.default},t.pluralization.default=function(e){switch(e){case 0:return["zero","other"];case 1:return["one"];default:return["other"]}},t.currentLocale=function(){return this.locale||this.defaultLocale},t.isSet=r,t.lookup=function(e,t){t=t||{};var i,n,s,a,c=this.locales.get(t.locale).slice();for(c[0],s=this.getFullScope(e,t);c.length;)if(i=c.shift(),n=s.split(this.defaultSeparator),a=this.translations[i]){for(;n.length&&null!=(a=a[n.shift()]););if(null!=a)return a}if(r(t.defaultValue))return u(t.defaultValue,e)},t.pluralizationLookupWithoutFallback=function(e,t,i){var n,a,c=this.pluralization.get(t)(e);if(s(i))for(;c.length;)if(n=c.shift(),r(i[n])){a=i[n];break}return a},t.pluralizationLookup=function(e,t,i){i=i||{};var n,a,c,o,l=this.locales.get(i.locale).slice();for(l[0],t=this.getFullScope(t,i);l.length;)if(n=l.shift(),a=t.split(this.defaultSeparator),c=this.translations[n]){for(;a.length&&(c=c[a.shift()],s(c));)0==a.length&&(o=this.pluralizationLookupWithoutFallback(e,n,c));if(null!=o&&null!=o)break}return null!=o&&null!=o||r(i.defaultValue)&&(o=s(i.defaultValue)?this.pluralizationLookupWithoutFallback(e,i.locale,i.defaultValue):i.defaultValue,c=i.defaultValue),{message:o,translations:c}},t.meridian=function(){var e=this.lookup("time"),t=this.lookup("date");return e&&e.am&&e.pm?[e.am,e.pm]:t&&t.meridian?t.meridian:p.meridian},t.prepareOptions=function(){for(var e,t=i.call(arguments),n={};t.length;)if("object"==typeof(e=t.shift()))for(var s in e)e.hasOwnProperty(s)&&(r(n[s])||(n[s]=e[s]));return n},t.createTranslationOptions=function(e,t){var i=[{scope:e}];return r(t.defaults)&&(i=i.concat(t.defaults)),r(t.defaultValue)&&i.push({message:t.defaultValue}),i},t.translate=function(e,t){t=t||{};var i,n=this.createTranslationOptions(e,t),a=this.prepareOptions(t);return delete a.defaultValue,n.some((function(t){if(r(t.scope)?i=this.lookup(t.scope,a):r(t.message)&&(i=u(t.message,e)),null!=i)return!0}),this)?("string"==typeof i?i=this.interpolate(i,t):s(i)&&r(t.count)&&(i=this.pluralize(t.count,e,t)),i):this.missingTranslation(e,t)},t.interpolate=function(e,t){t=t||{};var i,n,s,a,c=e.match(this.placeholder);if(!c)return e;for(;c.length;)n=(i=c.shift()).replace(this.placeholder,"$1"),a=r(t[n])?t[n].toString().replace(/\$/gm,"_#$#_"):n in t?this.nullPlaceholder(i,e,t):this.missingPlaceholder(i,e,t),s=new RegExp(i.replace(/\{/gm,"\\{").replace(/\}/gm,"\\}")),e=e.replace(s,a);return e.replace(/_#\$#_/g,"$")},t.pluralize=function(e,t,i){var n,s;return i=this.prepareOptions({count:String(e)},i),null==(s=this.pluralizationLookup(e,t,i)).translations||null==s.translations?this.missingTranslation(t,i):null!=s.message&&null!=s.message?this.interpolate(s.message,i):(n=this.pluralization.get(i.locale),this.missingTranslation(t+"."+n(e)[0],i))},t.missingTranslation=function(e,t){if("guess"==this.missingBehaviour){var i=e.split(".").slice(-1)[0];return(this.missingTranslationPrefix.length>0?this.missingTranslationPrefix:"")+i.replace("_"," ").replace(/([a-z])([A-Z])/g,(function(e,t,i){return t+" "+i.toLowerCase()}))}return'[missing "'+[null!=t&&null!=t.locale?t.locale:this.currentLocale(),this.getFullScope(e,t)].join(this.defaultSeparator)+'" translation]'},t.missingPlaceholder=function(e,t,i){return"[missing "+e+" value]"},t.nullPlaceholder=function(){return t.missingPlaceholder.apply(t,arguments)},t.toNumber=function(e,t){t=this.prepareOptions(t,this.lookup("number.format"),g);var i,n,s=e<0,a=function(e,t){return d("round",e,-t).toFixed(t)}(Math.abs(e),t.precision).toString().split("."),r=[],c=t.format||"%n",o=s?"-":"";for(e=a[0],i=a[1];e.length>0;)r.unshift(e.substr(Math.max(0,e.length-3),3)),e=e.substr(0,e.length-3);return n=r.join(t.delimiter),t.strip_insignificant_zeros&&i&&(i=i.replace(/0+$/,"")),t.precision>0&&i&&(n+=t.separator+i),n=(c=t.sign_first?"%s"+c:c.replace("%n","%s%n")).replace("%u",t.unit).replace("%n",n).replace("%s",o)},t.toCurrency=function(e,t){return t=this.prepareOptions(t,this.lookup("number.currency.format"),this.lookup("number.format"),m),this.toNumber(e,t)},t.localize=function(e,t,i){switch(i||(i={}),e){case"currency":return this.toCurrency(t);case"number":return e=this.lookup("number.format"),this.toNumber(t,e);case"percentage":return this.toPercentage(t);default:var n;return n=e.match(/^(date|time)/)?this.toTime(e,t):t.toString(),this.interpolate(n,i)}},t.parseDate=function(e){var t,i,n;if("object"==typeof e)return e;if(t=e.toString().match(/(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2}):(\d{2})([\.,]\d{1,3})?)?(Z|\+00:?00)?/)){for(var s=1;s<=6;s++)t[s]=parseInt(t[s],10)||0;t[2]-=1,n=t[7]?1e3*("0"+t[7]):null,i=t[8]?new Date(Date.UTC(t[1],t[2],t[3],t[4],t[5],t[6],n)):new Date(t[1],t[2],t[3],t[4],t[5],t[6],n)}else"number"==typeof e?(i=new Date).setTime(e):e.match(/([A-Z][a-z]{2}) ([A-Z][a-z]{2}) (\d+) (\d+:\d+:\d+) ([+-]\d+) (\d+)/)?(i=new Date).setTime(Date.parse([RegExp.$1,RegExp.$2,RegExp.$3,RegExp.$6,RegExp.$4,RegExp.$5].join(" "))):(e.match(/\d+ \d+:\d+:\d+ [+-]\d+ \d+/),(i=new Date).setTime(Date.parse(e)));return i},t.strftime=function(e,i){var s=this.lookup("date"),a=t.meridian();if(s||(s={}),s=this.prepareOptions(s,p),isNaN(e.getTime()))throw new Error("I18n.strftime() requires a valid date object, but received an invalid date.");var r=e.getDay(),c=e.getDate(),o=e.getFullYear(),l=e.getMonth()+1,d=e.getHours(),u=d,h=d>11?1:0,g=e.getSeconds(),m=e.getMinutes(),f=e.getTimezoneOffset(),b=Math.floor(Math.abs(f/60)),w=Math.abs(f)-60*b,v=(f>0?"-":"+")+(b.toString().length<2?"0"+b:b)+(w.toString().length<2?"0"+w:w);return u>12?u-=12:0===u&&(u=12),i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=i.replace("%a",s.abbr_day_names[r])).replace("%A",s.day_names[r])).replace("%b",s.abbr_month_names[l])).replace("%B",s.month_names[l])).replace("%d",n(c))).replace("%e",c)).replace("%-d",c)).replace("%H",n(d))).replace("%-H",d)).replace("%I",n(u))).replace("%-I",u)).replace("%m",n(l))).replace("%-m",l)).replace("%M",n(m))).replace("%-M",m)).replace("%p",a[h])).replace("%S",n(g))).replace("%-S",g)).replace("%w",r)).replace("%y",n(o))).replace("%-y",n(o).replace(/^0+/,""))).replace("%Y",o)).replace("%z",v)},t.toTime=function(e,t){var i=this.parseDate(t),n=this.lookup(e);return i.toString().match(/invalid/i)?i.toString():n?this.strftime(i,n):i.toString()},t.toPercentage=function(e,t){return t=this.prepareOptions(t,this.lookup("number.percentage.format"),this.lookup("number.format"),f),this.toNumber(e,t)},t.toHumanSize=function(e,t){for(var i,n,s=e,a=0;s>=1024&&a<4;)s/=1024,a+=1;return 0===a?(i=this.t("number.human.storage_units.units.byte",{count:s}),n=0):(i=this.t("number.human.storage_units.units."+b[a]),n=s-Math.floor(s)==0?0:1),t=this.prepareOptions(t,{unit:i,precision:n,format:"%n%u",delimiter:""}),this.toNumber(s,t)},t.getFullScope=function(e,t){return t=t||{},c(e)&&(e=e.join(this.defaultSeparator)),t.scope&&(e=[t.scope,e].join(this.defaultSeparator)),e},t.extend=function(e,t){return void 0===e&&void 0===t?{}:h(e,t)},t.t=t.translate,t.l=t.localize,t.p=t.pluralize,t}(s)}).call(t,i,t,e))||(e.exports=n)},eJFM:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("2Qcm"),s=i("6yP5"),a=i("1G5W"),r=i("/uUt"),c=i("E2tj"),o=i("tmNb"),l=i("87fy"),d=i("DhiE"),u=(i("U1xf"),i("fXoL")),h=i("hvpr"),p=i("ofXK"),g=i("f24R");function m(e,t){if(1&e&&(u.mc(0,"div",2),u.hc(1,"wp-resizer",3),u.lc()),2&e){const e=u.wc();u.Tb(1),u.Bc("elementClass",e.resizerClass)("localStorageKey",e.resizerStorageKey)}}class f{constructor(e,t,i,n,s){this.wpTableHighlight=e,this.wpTableSortBy=t,this.wpList=i,this.querySpace=n,this.cdRef=s,this.showResizer=!1,this.resizerClass="",this.resizerStorageKey="",this.gridOrientation="horizontal",this.highlightingMode="none"}ngOnInit(){this.dragInto=this.configuration.dragAndDropEnabled,this.canDragOutOf=()=>this.configuration.dragAndDropEnabled,this.wpTableHighlight.updates$().pipe(Object(a.a)(this.querySpace.stopAllSubscriptions),Object(r.a)()).subscribe(()=>{this.highlightingMode=this.wpTableHighlight.current.mode,this.cdRef.detectChanges()})}switchToManualSorting(){let e=this.querySpace.query.value;e&&this.wpTableSortBy.switchToManualSorting(e)&&this.wpList.save(e)}}f.\u0275fac=function(e){return new(e||f)(u.gc(n.a),u.gc(s.a),u.gc(d.a),u.gc(c.a),u.gc(u.i))},f.\u0275cmp=u.ac({type:f,selectors:[["wp-grid"]],inputs:{configuration:"configuration",showResizer:"showResizer",resizerClass:"resizerClass",resizerStorageKey:"resizerStorageKey"},features:[u.Sb([o.a,l.a])],decls:2,vars:10,consts:[[3,"dragOutOfHandler","dragInto","cardsRemovable","highlightingMode","showStatusButton","orientation","showEmptyResultsBox","showInfoButton","shrinkOnMobile","onMoved"],["class","hidden-for-mobile hide-when-print",4,"ngIf"],[1,"hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"]],template:function(e,t){1&e&&(u.mc(0,"wp-card-view",0),u.uc("onMoved",(function(){return t.switchToManualSorting()})),u.lc(),u.Yc(1,m,2,2,"div",1)),2&e&&(u.Bc("dragOutOfHandler",t.canDragOutOf)("dragInto",t.dragInto)("cardsRemovable",!1)("highlightingMode",t.highlightingMode)("showStatusButton",!0)("orientation",t.gridOrientation)("showEmptyResultsBox",!0)("showInfoButton",!0)("shrinkOnMobile",!0),u.Tb(1),u.Bc("ngIf",t.showResizer))},directives:[h.a,p.q,g.a],encapsulation:2,changeDetection:0})},eaMR:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("F5Dh"),s=i("l08T"),a=i("Y41n"),r=i("AEvm"),c=i("Hg4z"),o=i("fXoL"),l=i("ofXK"),d=i("70hh");function u(e,t){if(1&e){const e=o.nc();o.mc(0,"button",3),o.uc("click",(function(){return o.Qc(e),o.wc().wpFiltersService.toggleVisibility()})),o.xc(1,"async"),o.hc(2,"i",4),o.hc(3,"span",5),o.lc()}if(2&e){const e=o.wc();o.Xb("-active",o.yc(1,3,e.visible$)),o.Tb(3),o.Bc("textContent",e.filterButtonText)}}function h(e,t){if(1&e){const e=o.nc();o.mc(0,"query-filters",8),o.uc("filtersChanged",(function(t){return o.Qc(e),o.wc(2).replaceIfComplete(t)})),o.lc()}if(2&e){const e=o.wc(2);o.Bc("filters",e.filters)("showCloseFilter",!0)}}function p(e,t){if(1&e&&(o.mc(0,"div",6),o.Yc(1,h,1,2,"query-filters",7),o.lc()),2&e){const e=o.wc();o.Tb(1),o.Bc("ngIf",!!e.filters)}}const g=function(e){return{"-loaded":e}};class m extends r.a{constructor(e,t,i){super(),this.wpTableFilters=e,this.cdRef=t,this.wpFiltersService=i,this.showFilterButton=!1,this.filterButtonText=I18n.t("js.button_filter"),this.filtersChanged=new a.a(Object(c.b)(this)),this.filters=this.wpTableFilters.current,this.loaded=!1,this.visible$=this.wpFiltersService.observeUntil(Object(c.b)(this))}ngOnInit(){this.wpTableFilters.pristine$().pipe(this.untilDestroyed()).subscribe(()=>{this.filters=this.wpTableFilters.current,this.loaded=!0,this.cdRef.detectChanges()})}replaceIfComplete(e){this.wpTableFilters.replaceIfComplete(e),this.filtersChanged.emit(this.filters)}}m.\u0275fac=function(e){return new(e||m)(o.gc(n.a),o.gc(o.i),o.gc(s.a))},m.\u0275cmp=o.ac({type:m,selectors:[["filter-container"]],inputs:{showFilterButton:"showFilterButton",filterButtonText:"filterButtonText"},outputs:{filtersChanged:"filtersChanged"},features:[o.Qb],decls:4,vars:7,consts:[["class","button -small advanced-filters--toggle",3,"-active","click",4,"ngIf"],[1,"work-packages--filters-optional-container",3,"ngClass"],["id","query_form_content","class","hide-when-print",4,"ngIf"],[1,"button","-small","advanced-filters--toggle",3,"click"],[1,"button--icon","icon-filter"],[1,"button--text",3,"textContent"],["id","query_form_content",1,"hide-when-print"],[3,"filters","showCloseFilter","filtersChanged",4,"ngIf"],[3,"filters","showCloseFilter","filtersChanged"]],template:function(e,t){1&e&&(o.Yc(0,u,4,5,"button",0),o.mc(1,"div",1),o.Yc(2,p,2,1,"div",2),o.xc(3,"async"),o.lc()),2&e&&(o.Bc("ngIf",t.showFilterButton),o.Tb(1),o.Bc("ngClass",o.Gc(5,g,t.loaded)),o.Tb(1),o.Bc("ngIf",o.yc(3,3,t.visible$)))},directives:[l.q,l.n,d.a],pipes:[l.a],encapsulation:2,changeDetection:0})},ecJW:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("fXoL"),s=i("8zkO"),a=i("juWA"),r=i("PBJw"),c=i("Y41n"),o=i("AEvm"),l=i("Hg4z"),d=i("E5Dd"),u=i("ofXK"),h=i("oUDv");const p=["dateInput"];class g extends o.a{constructor(e,t,i){super(),this.elementRef=e,this.ConfigurationService=t,this.timezoneService=i,this.onChange=new c.a(Object(l.b)(this)),this.onCancel=new n.s,this.initialDate="",this.appendTo=document.body,this.classes="",this.id="",this.name="",this.required=!1,this.size=20,this.focus=!1,this.disabled=!1,this.id||(this.id="datepicker-input-"+Math.floor(1e3*Math.random()).toString(3))}ngAfterViewInit(){this.initializeDatepicker()}ngOnDestroy(){this.datePickerInstance&&this.datePickerInstance.destroy()}openOnClick(){this.disabled||this.datePickerInstance.show()}onInputChange(e){this.isEmpty()?this.datePickerInstance.clear():this.inputIsValidDate()&&this.onChange.emit(this.currentValue)}closeOnOutsideClick(e){e.relatedTarget&&this.datePickerInstance.datepickerInstance.calendarContainer.contains(e.relatedTarget)||this.datePickerInstance.hide()}isEmpty(){return""===this.currentValue.trim()}get currentValue(){var e;return(null===(e=this.inputElement)||void 0===e?void 0:e.value)||""}get inputElement(){return this.dateInput.nativeElement}inputIsValidDate(){return null!==this.currentValue.match(/\d{4}-\d{2}-\d{2}/)}initializeDatepicker(){let e,t={allowInput:!0,appendTo:this.appendTo,onChange:(e,t)=>{let i=t;this.isEmpty()||(this.inputElement.value=i,this.onChange.emit(i))},onKeyDown:(e,t,i,n)=>{n.which==d.a.ESCAPE&&this.onCancel.emit()}};e=this.isEmpty&&this.initialDate?this.timezoneService.parseISODate(this.initialDate).toDate():this.currentValue,this.datePickerInstance=new r.a("#"+this.id,e,t)}}g.\u0275fac=function(e){return new(e||g)(n.gc(n.q),n.gc(s.a),n.gc(a.a))},g.\u0275cmp=n.ac({type:g,selectors:[["op-date-picker"]],viewQuery:function(e,t){var i;(1&e&&n.fd(p,!0),2&e)&&(n.Nc(i=n.vc())&&(t.dateInput=i.first))},inputs:{initialDate:"initialDate",appendTo:"appendTo",classes:"classes",id:"id",name:"name",required:"required",size:"size",focus:"focus",disabled:"disabled"},outputs:{onChange:"onChange",onCancel:"onCancel"},features:[n.Qb],decls:2,vars:8,consts:[["type","text",3,"id","name","value","ngClass","size","required","focus","disabled","click","blur","input"],["dateInput",""]],template:function(e,t){1&e&&(n.mc(0,"input",0,1),n.uc("click",(function(){return t.openOnClick()}))("blur",(function(e){return t.closeOnOutsideClick(e)}))("input",(function(e){return t.onInputChange(e)})),n.lc()),2&e&&n.Bc("id",t.id)("name",t.name)("value",t.initialDate)("ngClass",t.classes)("size",t.size)("required",t.required)("focus",t.focus)("disabled",t.disabled)},directives:[u.n,h.a],encapsulation:2})},eyhC:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("E2tj"),s=i("ug4p"),a=i("iMRi"),r=i("4lR/"),c=i("zqrF"),o=i("fXoL");class l extends c.b{constructor(e,t,i,n){super(e),this.querySpace=e,this.states=t,this.wpCacheService=i,this.opContextMenu=n,this.reset()}ngOnDestroy(){Mousetrap.unbind(["command+d","ctrl+d"]),Mousetrap.unbind(["command+a","ctrl+a"])}initializeSelection(e){let t={selected:{},activeRowIndex:null};e.forEach(e=>t.selected[e]=!0),this.updatesState.clear(),this.pristineState.putValue(t)}isSelected(e){var t;return!!(null===(t=this.current)||void 0===t?void 0:t.selected[e])}selectAll(e){const t=this._emptyState;e.forEach(e=>{e.workPackageId&&(t.selected[e.workPackageId]=!0)}),this.update(t)}getSelectedWorkPackages(){let e=this.states.workPackages;return this.getSelectedWorkPackageIds().map(t=>e.get(t).value)}getSelectedWorkPackageIds(){var e;let t=[];return _.each(null===(e=this.current)||void 0===e?void 0:e.selected,(e,i)=>{e&&t.push(i)}),t}reset(){this.update(this._emptyState)}get isEmpty(){return 0===this.selectionCount}get selectionCount(){var e;return _.size(null===(e=this.current)||void 0===e?void 0:e.selected)}toggleRow(e){var t;let i=null===(t=this.current)||void 0===t?void 0:t.selected[e];this.setRowState(e,!i)}setRowState(e,t){let i=this.current||this._emptyState;i.selected[e]=t,this.update(i)}setSelection(e,t){const i=this._emptyState;i.selected[e]=!0,i.activeRowIndex=t,this.update(i)}setMultiSelectionFrom(e,t,i){let n=this.current||this._emptyState;if(0===this.selectionCount||null===n.activeRowIndex)n.selected[t]=!0,n.activeRowIndex=i;else{let t=Math.min(i,n.activeRowIndex),s=Math.max(i,n.activeRowIndex);e.forEach((e,i)=>{e.workPackageId&&(n.selected[e.workPackageId]=i>=t&&i<=s)})}this.update(n)}registerSelectAllListener(e){Mousetrap.bind(["command+a","ctrl+a"],t=>(this.selectAll(e()),t.preventDefault(),this.opContextMenu.close(),!1))}registerDeselectAllListener(){Mousetrap.bind(["command+d","ctrl+d"],e=>(this.reset(),e.preventDefault(),this.opContextMenu.close(),!1))}get _emptyState(){return{selected:{},activeRowIndex:null}}valueFromQuery(e,t){}}l.\u0275fac=function(e){return new(e||l)(o.qc(n.a),o.qc(a.a),o.qc(s.a),o.qc(r.a))},l.\u0275prov=o.cc({token:l,factory:l.\u0275fac})},f24R:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("/uUt"),s=i("Kj3r"),a=i("iB+3"),r=i("Sulb"),c=i("buwf"),o=i("AEvm"),l=i("xgIS"),d=i("fXoL"),u=i("v9+U");class h extends o.a{constructor(e,t,i,n){super(),this.toggleService=e,this.elementRef=t,this.$transitions=i,this.browserDetector=n,this.resizeStyle="flexBasis",this.elementMinWidth=530,this.moving=!1,this.resizerClass="work-packages--resizer icon-resizer-vertical-lines"}ngOnInit(){this.resizingElement=document.getElementsByClassName(this.elementClass)[0];let e=this.parseLocalStorageValue();this.elementWidth=e||(this.resizingElement.offsetWidth<this.elementMinWidth?this.elementMinWidth:this.resizingElement.offsetWidth),0===this.elementWidth&&this.resizingElement.parentElement&&(this.elementWidth=this.resizingElement.parentElement.offsetWidth/2),this.resizingElement.style[this.resizeStyle]=this.elementWidth+"px",this.element=this.elementRef.nativeElement,this.toggleService.changeData$.pipe(Object(n.a)(),this.untilDestroyed()).subscribe(e=>{this.toggleFullscreenColumns()}),Object(l.a)(window,"resize",{passive:!0}).pipe(this.untilDestroyed(),Object(s.a)(250)).subscribe(()=>this.toggleFullscreenColumns())}ngAfterViewInit(){this.resizer=this.elementRef.nativeElement.getElementsByClassName(this.resizerClass)[0],this.applyColumnLayout(this.resizingElement,this.elementWidth)}ngOnDestroy(){super.ngOnDestroy(),this.resizingElement.style[this.resizeStyle]=""}resizeStart(){let e=this.parseLocalStorageValue(),t=this.resizingElement.offsetWidth;e&&e>t&&(this.elementWidth=t)}resizeEnd(){let e=this.parseLocalStorageValue();e&&(this.elementWidth=e);const t=new Event(this.resizeEvent);window.dispatchEvent(t),this.manageErrorClass(!1)}resizeMove(e){let t;this.elementWidth=this.elementWidth-e.relative.x,this.elementWidth<this.elementMinWidth?(t=this.elementMinWidth,this.manageErrorClass(!0)):(t=this.elementWidth,this.manageErrorClass(!1)),window.OpenProject.guardedLocalStorage(this.localStorageKey,`${t}`),this.applyColumnLayout(this.resizingElement,t),this.resizingElement.style[this.resizeStyle]=t+"px"}parseLocalStorageValue(){let e=window.OpenProject.guardedLocalStorage(this.localStorageKey),t=parseInt(e||"",10);if("number"==typeof t&&NaN!==t)return t}applyColumnLayout(e,t){e===jQuery(".work-packages-full-view--split-right")[0]?this.toggleFullscreenColumns():this.toggleColumns(e,700)}toggleColumns(e,t=750){e&&!this.browserDetector.isEdge&&jQuery(e).toggleClass("-can-have-columns",e.offsetWidth>t)}toggleFullscreenColumns(){let e=jQuery(".work-packages-full-view--split-left")[0];this.toggleColumns(e)}manageErrorClass(e){e&&!this.resizer.classList.contains("-error-font")&&this.resizer.classList.add("-error-font"),!e&&this.resizer.classList.contains("-error-font")&&this.resizer.classList.remove("-error-font")}}h.\u0275fac=function(e){return new(e||h)(d.gc(r.a),d.gc(d.q),d.gc(a.O),d.gc(c.a))},h.\u0275cmp=d.ac({type:h,selectors:[["wp-resizer"]],inputs:{elementClass:"elementClass",resizeEvent:"resizeEvent",localStorageKey:"localStorageKey",resizeStyle:"resizeStyle"},features:[d.Qb],decls:1,vars:2,consts:[["cursorClass","col-resize",3,"customHandler","resizerClass","end","start","move"]],template:function(e,t){1&e&&(d.mc(0,"resizer",0),d.uc("end",(function(){return t.resizeEnd()}))("start",(function(){return t.resizeStart()}))("move",(function(e){return t.resizeMove(e)})),d.lc()),2&e&&d.Bc("customHandler",!1)("resizerClass",t.resizerClass)},directives:[u.a],encapsulation:2,changeDetection:0})},f9kS:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("VgZ9"),s=i("FDFi"),a=i("i95X"),r=i("fXoL");class c extends s.a{constructor(e,t){super(e),this.injector=e,this.wpRelationsHierarchyService=t,this.referenceComponentClass=a.a,this.relationType="children",this.referenceTarget=null,this.buttonTexts={reference:this.I18n.t("js.relation_buttons.add_existing_child"),create:this.I18n.t("js.relation_buttons.add_new_child")}}add(e,t){return this.wpRelationsHierarchyService.addExistingChildWp(e,t)}remove(e,t){return this.wpRelationsHierarchyService.removeChild(t)}get canAdd(){return!!(this.referenceTarget&&this.canCreateWorkPackages&&this.canAddChild)}get canReference(){return!(!this.referenceTarget||!this.canAddChild)}get canAddChild(){const e=this.referenceTarget;return e&&!e.isMilestone&&e.changeParent}}c.\u0275fac=function(e){return new(e||c)(r.qc(r.A),r.qc(n.a))},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac})},fMMW:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("mrSG"),s=i("Mo6U"),a=i("vK8y"),r=i("kTsZ"),c=i("4EDS"),o=i("r0MM"),l=c.a.compareByHrefOrString;class d{constructor(e,t,i,n=[]){this.injector=e,this.change=t,this.filters=i,this.excluded=n}applyDefaultsFromFilters(){_.each(this.filters,e=>{if("="!==e.operator.id)return;if(-1!==this.excluded.indexOf(e.id))return;if(this.filterAlreadyApplied(e))return;let t=e.values[0];t&&this.setValueFor(e.id,t)})}setValueFor(e,t){let i=this.findSpecialValue(t,e)||t;i&&(this.change.projectedResource[e]=i)}findSpecialValue(e,t){return"parent"===t?e:e instanceof s.a&&"/api/v3/users/me"===e.$href&&this.currentUser.isLoggedIn?this.halResourceService.fromSelfLink(`/api/v3/users/${this.currentUser.userId}`):void 0}filterAlreadyApplied(e){if(e.values.length<=1)return!1;const t=this.change.projectedResource[e.id];for(let i=0;i<e.values.length;i++)if(l(t,e.values[i]))return!0;return!1}}Object(n.c)([Object(o.a)(),Object(n.e)("design:type",a.a)],d.prototype,"currentUser",void 0),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",r.a)],d.prototype,"halResourceService",void 0)},fbLK:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("ofXK"),s=i("fXoL");class a{constructor(e){this.documentElement=e,this._banners=!0,this._banners=e.body.classList.contains("ee-banners-visible")}get eeShowBanners(){return this._banners}conditional(e,t){this._banners?this.callMaybe(e):this.callMaybe(t)}callMaybe(e){e&&e()}}a.\u0275fac=function(e){return new(e||a)(s.qc(n.d))},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac,providedIn:"root"})},fdeW:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var n=i("IzEk"),s=i("x5It"),a=i("tmNb"),r=i("Va5K"),c=i("POAS"),o=i("qc15"),l=i("wZYP"),d=i("E2tj"),u=i("K247"),h=i("sjKJ"),p=i("F5Dh"),g=i("AEvm"),m=i("fXoL"),f=i("ofXK"),b=i("9hh2"),w=i("eJFM"),v=i("lmDM");function y(e,t){1&e&&m.hc(0,"div",4)}function k(e,t){if(1&e&&m.hc(0,"wp-table",5),2&e){const e=m.wc();m.Bc("projectIdentifier",e.CurrentProject.identifier)("configuration",e.wpTableConfiguration)}}const C=function(e){return{"-with-resizer":e}};function j(e,t){if(1&e&&(m.mc(0,"div",6),m.hc(1,"wp-grid",7),m.lc()),2&e){const e=m.wc();m.Bc("ngClass",m.Gc(3,C,e.showResizerInCardView())),m.Tb(1),m.Bc("configuration",e.wpTableConfiguration)("showResizer",e.showResizerInCardView())}}function x(e,t){1&e&&(m.mc(0,"div",8),m.hc(1,"wp-table-pagination"),m.lc())}class T extends g.a{constructor(e,t,i,n,s,a,r,c){super(),this.I18n=e,this.injector=t,this.querySpace=i,this.wpViewFilters=n,this.deviceService=s,this.CurrentProject=a,this.wpDisplayRepresentation=r,this.cdRef=c,this.text={jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.pagination"),text_jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.label_pagination"),button_settings:this.I18n.t("js.button_settings")},this.showListView=!0,this.tableInformationLoaded=!1,this.noResults=!1,this.showResultOverlay$=this.wpViewFilters.incomplete$,this.wpTableConfiguration={dragAndDropEnabled:!0}}ngOnInit(){this.setupInformationLoadedListener(),this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.updateViewRepresentation(e),this.noResults=0===e.results.total,this.cdRef.detectChanges()})}setupInformationLoadedListener(){this.querySpace.initialized.values$().pipe(Object(n.a)(1)).subscribe(()=>{this.tableInformationLoaded=!0,this.cdRef.detectChanges()})}showResizerInCardView(){return!1}updateViewRepresentation(e){this.showListView=!(this.deviceService.isMobile||this.wpDisplayRepresentation.valueFromQuery(e)===r.b)}}T.\u0275fac=function(e){return new(e||T)(m.gc(l.a),m.gc(m.A),m.gc(d.a),m.gc(p.a),m.gc(u.a),m.gc(h.a),m.gc(r.a),m.gc(m.i))},T.\u0275cmp=m.ac({type:T,selectors:[["wp-list-view"]],hostAttrs:[1,"work-packages-split-view--tabletimeline-side"],features:[m.Sb([{provide:c.a,useClass:o.a},a.a,s.a]),m.Qb],decls:5,vars:6,consts:[["class","result-overlay",4,"ngIf"],["class","work-packages-split-view--tabletimeline-content",3,"projectIdentifier","configuration",4,"ngIf"],["class","work-packages--card-view-container",3,"ngClass",4,"ngIf"],["class","work-packages-split-view--tabletimeline-footer hide-when-print",4,"ngIf"],[1,"result-overlay"],[1,"work-packages-split-view--tabletimeline-content",3,"projectIdentifier","configuration"],[1,"work-packages--card-view-container",3,"ngClass"],["resizerClass","work-packages-partitioned-page--content-right","resizerStorageKey","openProject-splitViewFlexBasis",3,"configuration","showResizer"],[1,"work-packages-split-view--tabletimeline-footer","hide-when-print"]],template:function(e,t){1&e&&(m.Yc(0,y,1,0,"div",0),m.xc(1,"async"),m.Yc(2,k,1,2,"wp-table",1),m.Yc(3,j,2,5,"div",2),m.Yc(4,x,2,0,"div",3)),2&e&&(m.Bc("ngIf",m.yc(1,4,t.showResultOverlay$)&&t.showListView),m.Tb(2),m.Bc("ngIf",t.tableInformationLoaded&&t.showListView),m.Tb(1),m.Bc("ngIf",!t.showListView),m.Tb(1),m.Bc("ngIf",t.tableInformationLoaded))},directives:[f.q,b.a,f.n,w.a,v.a],pipes:[f.a],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.result-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;z-index:900;background-color:#fff;opacity:.5}.work-packages--card-view-container[_ngcontent-%COMP%]{width:100%;overflow:auto;padding-bottom:5px;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages--card-view-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages--card-view-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages--card-view-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.work-packages--card-view-container[_ngcontent-%COMP%]:hover{scrollbar-color:#ddd transparent}.work-packages--card-view-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}@media screen and (min-width:679px){.work-packages--card-view-container.-with-resizer[_ngcontent-%COMP%]{padding-left:10px}}@media screen and (max-width:679px){.work-packages--card-view-container[_ngcontent-%COMP%]{min-width:calc(100vw + 10px)}}"],changeDetection:0})},feia:function(e,t,i){"use strict";i.d(t,"b",(function(){return w})),i.d(t,"a",(function(){return v}));var n=i("8zkO"),s=i("Jui0"),a=i("kTsZ"),r=i("iMRi"),c=i("1G5W"),o=i("pLZG"),l=i("d/TE"),d=i("wZYP"),u=i("k8lp"),h=i("Hg4z"),p=i("AEvm"),g=i("fXoL"),m=i("ofXK"),f=i("jEcX");function b(e,t){if(1&e&&(g.kc(0),g.hc(1,"attachments",3),g.jc()),2&e){const e=g.wc();g.Tb(1),g.Bc("resource",e.resource)}}const w="ckeditor-augmented-textarea";class v extends p.a{constructor(e,t,i,n,s,a,r){super(),this.elementRef=e,this.pathHelper=t,this.halResourceService=i,this.Notifications=n,this.I18n=s,this.states=a,this.ConfigurationService=r,this.changed=!1,this.inFlight=!1,this.isEditing=!1}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.textareaSelector=this.$element.attr("textarea-selector"),this.previewContext=this.$element.attr("preview-context"),this.macros="false"!==this.$element.attr("macros"),this.editorType=this.$element.attr("editor-type")||"full";const e=this.$element.data("resource");this.resource=e?this.halResourceService.createHalResource(e,!0):void 0,this.formElement=this.$element.closest("form"),this.wrappedTextArea=this.formElement.find(this.textareaSelector),this.wrappedTextArea.removeAttr("required").hide(),this.initialContent=this.wrappedTextArea.val(),this.$attachmentsElement=this.formElement.find("#attachments_fields"),this.context={resource:this.resource,previewContext:this.previewContext},this.macros||(this.context.macros="none")}ngOnDestroy(){super.ngOnDestroy(),this.formElement.off("submit.ckeditor")}markEdited(){window.OpenProject.pageWasEdited=!0}setup(e){return this.$element.data("editor",e),this.resource&&this.resource.attachments&&(this.setupAttachmentAddedCallback(e),this.setupAttachmentRemovalSignal(e)),this.formElement.on("submit.ckeditor change.ckeditor",()=>{try{this.wrappedTextArea.val(this.ckEditorInstance.getRawData())}catch(e){return console.error(`Failed to save CKEditor body to textarea: ${e}.`),this.Notifications.addError(e||this.I18n.t("js.error.internal")),!1}return this.addUploadedAttachmentsToForm(),!0}),this.setLabel(),e}setupAttachmentAddedCallback(e){e.model.on("op:attachment-added",()=>{this.states.forResource(this.resource).putValue(this.resource)})}setupAttachmentRemovalSignal(e){this.attachments=_.clone(this.resource.attachments.elements),this.states.forResource(this.resource).changes$().pipe(Object(c.a)(Object(h.b)(this)),Object(o.a)(e=>!!e)).subscribe(t=>{let i=_.differenceBy(this.attachments,t.attachments.elements,e=>e.id).map(e=>e.downloadLocation.$href);i.length&&e.model.fire("op:attachment-removed",i),this.attachments=_.clone(t.attachments.elements)})}setLabel(){let e=this.textareaSelector.substring(1),t=jQuery(`label[for=${e}]`),i=this.$element.find(".ck-content");i.attr("aria-label",null),i.attr("aria-labelledby",e),t.click(()=>{i.focus()})}addUploadedAttachmentsToForm(){if(!this.resource||!this.resource.attachments||this.resource.id)return;const e=this.$attachmentsElement.find("input[type='file']").map((e,t)=>{let i=(t.getAttribute("name")||"").match(/attachments\[(\d+)\]\[(?:file|id)\]/);return i?parseInt(i[1]):0}).toArray().sort().pop()||0;let t=this.resource.attachments.elements||[];jQuery.each(t,(t,i)=>{this.$attachmentsElement.append(`<input type="hidden" name="attachments[${e+t+1}][id]" value="${i.id}">`)})}}v.\u0275fac=function(e){return new(e||v)(g.gc(g.q),g.gc(s.a),g.gc(a.a),g.gc(l.a),g.gc(d.a),g.gc(r.a),g.gc(n.a))},v.\u0275cmp=g.ac({type:v,selectors:[["ckeditor-augmented-textarea"]],viewQuery:function(e,t){var i;(1&e&&g.Wc(u.a,!0),2&e)&&(g.Nc(i=g.vc())&&(t.ckEditorInstance=i.first))},features:[g.Qb],decls:4,vars:4,consts:[[1,"op-ckeditor--wrapper"],[3,"context","content","ckEditorType","onInitialized","onContentChange"],[4,"ngIf"],["data-allow-uploading","true","data-destroy-immediately","false",3,"resource"]],template:function(e,t){1&e&&(g.kc(0),g.mc(1,"div",0),g.mc(2,"op-ckeditor",1),g.uc("onInitialized",(function(e){return t.setup(e)}))("onContentChange",(function(){return t.markEdited()})),g.lc(),g.lc(),g.Yc(3,b,2,1,"ng-container",2),g.jc()),2&e&&(g.Tb(2),g.Bc("context",t.context)("content",t.initialContent)("ckEditorType",t.editorType),g.Tb(1),g.Bc("ngIf",t.resource&&t.resource.attachments))},directives:[u.a,m.q,f.a],encapsulation:2})},g1AQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this.hooks={}}register(e,t){t&&(this.hooks[e]||(this.hooks[e]=[]),this.hooks[e].push(t))}call(e,...t){let i=[];if(this.hooks[e])for(let n=0;n<this.hooks[e].length;n++){let s=this.hooks[e][n](...t);s&&i.push(s)}return i}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.cc({token:s,factory:s.\u0275fac})},gh2L:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("t8SH"),s=i("fXoL"),a=i("ZOsW"),r=i("3Pt+"),c=i("ofXK"),o=i("ximh");function l(e,t){if(1&e&&(s.hc(0,"b",4),s.ad(1)),2&e){const e=t.searchTerm,i=s.wc();s.Bc("textContent",i.text.add_new_action),s.Tb(1),s.cd(": ",e," ")}}function d(e,t){if(1&e&&(s.mc(0,"div",5),s.ad(1),s.lc()),2&e){const e=t.item,i=t.searchTerm;s.Bc("ngOptionHighlight",i),s.Tb(1),s.bd(e.name)}}class u extends n.a{}u.\u0275fac=function(e){return h(e||u)},u.\u0275cmp=s.ac({type:u,selectors:[["wp-autocompleter"]],features:[s.Qb],decls:4,vars:13,consts:[["bindLabel","name",3,"ngModel","items","ngClass","addTag","virtualScroll","required","clearable","disabled","typeahead","clearOnBackspace","appendTo","hideSelected","id","ngModelChange","change","open","close","keydown"],["ngSelectComponent",""],["ng-tag-tmp",""],["ng-option-tmp",""],[3,"textContent"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight"]],template:function(e,t){1&e&&(s.mc(0,"ng-select",0,1),s.uc("ngModelChange",(function(e){return t.model=e}))("change",(function(e){return t.changeModel(e)}))("open",(function(){return t.opened()}))("close",(function(){return t.closed()}))("keydown",(function(e){return t.keyPressed(e)})),s.Yc(2,l,2,2,"ng-template",2),s.Yc(3,d,2,2,"ng-template",3),s.lc()),2&e&&s.Bc("ngModel",t.model)("items",t.availableValues)("ngClass",t.classes)("addTag",t.createAllowed)("virtualScroll",!0)("required",t.required)("clearable",!t.required)("disabled",t.disabled)("typeahead",t.typeahead)("clearOnBackspace",!1)("appendTo",t.appendTo)("hideSelected",t.hideSelected)("id",t.id)},directives:[a.a,r.m,r.p,c.n,r.x,a.l,a.c,o.a],encapsulation:2});const h=s.oc(u)},gvAf:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("iB+3"),s=i("ug4p"),a=i("wZYP"),r=i("AEvm"),c=i("fXoL"),o=i("ofXK"),l=i("aveh"),d=i("4Obc");function u(e,t){if(1&e&&c.hc(0,"wp-single-view",2),2&e){const e=c.wc();c.Bc("workPackage",e.workPackage)}}function h(e,t){if(1&e&&(c.mc(0,"div",3),c.mc(1,"div",4),c.mc(2,"div",5),c.hc(3,"h3",6),c.lc(),c.lc(),c.hc(4,"newest-activity-on-overview",2),c.lc()),2&e){const e=c.wc();c.Tb(3),c.Bc("textContent",e.tabName),c.Tb(1),c.Bc("workPackage",e.workPackage)}}class p extends r.a{constructor(e,t,i){super(),this.I18n=e,this.$state=t,this.wpCacheService=i,this.tabName=this.I18n.t("js.label_latest_activity"),this.workPackageId=this.$state.params.workPackageId,i.loadWorkPackage(this.workPackageId).values$().pipe(this.untilDestroyed()).subscribe(e=>this.workPackage=e)}}p.\u0275fac=function(e){return new(e||p)(c.gc(a.a),c.gc(n.G),c.gc(s.a))},p.\u0275cmp=c.ac({type:p,selectors:[["wp-overview-tab"]],features:[c.Qb],decls:2,vars:2,consts:[[3,"workPackage",4,"ngIf"],["class","attributes-group",4,"ngIf"],[3,"workPackage"],[1,"attributes-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"]],template:function(e,t){1&e&&(c.Yc(0,u,1,1,"wp-single-view",0),c.Yc(1,h,5,2,"div",1)),2&e&&(c.Bc("ngIf",t.workPackage),c.Tb(1),c.Bc("ngIf",t.workPackage))},directives:[o.q,l.a,d.a],encapsulation:2})},hgso:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("FnNU"),s=i("IzEk");class a{constructor(){this.cacheDurationInSeconds=120,this.cache={id:null,state:Object(n.f)()}}require(e,t=!1){const i=e.id,n=this.cache.state;return(t||this.cache.id!==i)&&n.clear(),this.isCached(i)?Promise.resolve(n.value):(this.cache.id=i,this.cache.state.putFromPromiseIfPristine(()=>this.load(e)),this.cache.state.values$().pipe(Object(s.a)(1)).toPromise())}clear(e){this.cache.id===e&&this.cache.state.clear()}isCached(e){const t=this.cache.state;return this.cache.id===e&&t.hasValue()&&!t.isValueOlderThan(1e3*this.cacheDurationInSeconds)}}},hj8t:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("wZYP"),s=i("PtkW"),a=i("JY8V"),r=i("4jc8"),c=i("fXoL"),o=i("3Pt+"),l=i("ofXK");function d(e,t){if(1&e&&c.hc(0,"option",15),2&e){const e=t.$implicit,i=c.wc(2);c.Bc("textContent",i.text.zoom[e])("value",e)("selected",i.zoomLevel===e)}}function u(e,t){if(1&e&&c.hc(0,"option",15),2&e){const e=t.$implicit,i=c.wc().$implicit,n=c.wc(2);c.Bc("textContent",e.name)("value",e.id)("selected",n.labels[i]===e.id)}}function h(e,t){if(1&e){const e=c.nc();c.mc(0,"div",16),c.mc(1,"div",1),c.mc(2,"label",17),c.ad(3),c.lc(),c.mc(4,"div",3),c.mc(5,"div",18),c.mc(6,"select",19),c.uc("change",(function(i){c.Qc(e);const n=t.$implicit;return c.wc(2).updateLabels(n,i.target.value)})),c.Yc(7,u,1,3,"option",13),c.lc(),c.lc(),c.lc(),c.lc(),c.lc()}if(2&e){const e=t.$implicit,i=c.wc(2);c.Tb(2),c.Dc("for","modal-timelines-label-",e,""),c.Tb(1),c.cd(" ",i.text.labels[e]," "),c.Tb(3),c.Dc("id","modal-timelines-label-",e,""),c.Tb(1),c.Bc("ngForOf",i.availableAttributes)}}function p(e,t){if(1&e){const e=c.nc();c.kc(0),c.mc(1,"fieldset",8),c.hc(2,"legend",9),c.hc(3,"p",10),c.mc(4,"div",1),c.mc(5,"div",3),c.mc(6,"div",11),c.mc(7,"select",12),c.uc("change",(function(t){return c.Qc(e),c.wc().zoomLevel=t.target.value})),c.Yc(8,d,1,3,"option",13),c.lc(),c.lc(),c.lc(),c.lc(),c.lc(),c.mc(9,"fieldset",8),c.hc(10,"legend",9),c.hc(11,"p",10),c.Yc(12,h,8,4,"div",14),c.lc(),c.jc()}if(2&e){const e=c.wc();c.Tb(2),c.Bc("textContent",e.text.zoom.level),c.Tb(1),c.Bc("textContent",e.text.zoom.description),c.Tb(4),c.Ub("disabled",!0===e.autoZoom?"disabled":void 0),c.Tb(1),c.Bc("ngForOf",e.availableZoomLevels),c.Tb(2),c.Bc("textContent",e.text.labels.title),c.Tb(1),c.Bc("textContent",e.text.labels.description),c.Tb(1),c.Bc("ngForOf",e.availableLabels)}}class g{constructor(e,t,i,n){this.injector=e,this.I18n=t,this.wpTableTimeline=i,this.wpTableColumns=n,this.timelineVisible=!1,this.availableZoomLevels=["auto",...r.n],this.text={title:this.I18n.t("js.timelines.gantt_chart"),display_timelines:this.I18n.t("js.timelines.button_activate"),display_timelines_hint:this.I18n.t("js.work_packages.table_configuration.show_timeline_hint"),zoom:{level:this.I18n.t("js.tl_toolbar.zooms"),description:this.I18n.t("js.timelines.zoom.description"),days:this.I18n.t("js.timelines.zoom.days"),weeks:this.I18n.t("js.timelines.zoom.weeks"),months:this.I18n.t("js.timelines.zoom.months"),quarters:this.I18n.t("js.timelines.zoom.quarters"),years:this.I18n.t("js.timelines.zoom.years"),auto:this.I18n.t("js.timelines.zoom.auto")},labels:{title:this.I18n.t("js.timelines.labels.title"),description:this.I18n.t("js.timelines.labels.description"),bar:this.I18n.t("js.timelines.labels.bar"),none:this.I18n.t("js.timelines.filter.noneSelection"),left:this.I18n.t("js.timelines.labels.left"),right:this.I18n.t("js.timelines.labels.right"),farRight:this.I18n.t("js.timelines.labels.farRight")}}}onSave(){this.wpTableTimeline.update(Object.assign(Object.assign({},this.wpTableTimeline.current),{visible:this.timelineVisible,labels:this.labels,zoomLevel:this.zoomLevel}))}updateLabels(e,t){""===t&&(t=null),this.labels[e]=t}ngOnInit(){this.timelineVisible=this.wpTableTimeline.isVisible,this.zoomLevel=this.wpTableTimeline.zoomLevel;const e=this.wpTableTimeline.labels;this.labels=_.clone(e),this.availableLabels=Object.keys(this.labels);const t=this.wpTableColumns.allPropertyColumns.sort((e,t)=>e.name.localeCompare(t.name));this.availableAttributes=[{id:"",name:this.text.labels.none}].concat(t)}}g.\u0275fac=function(e){return new(e||g)(c.gc(c.A),c.gc(n.a),c.gc(s.a),c.gc(a.a))},g.\u0275cmp=c.ac({type:g,selectors:[["ng-component"]],decls:9,vars:4,consts:[[1,"form"],[1,"form--field"],["for","display_timelines_switch",1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--check-box-container"],["type","checkbox","id","display_timelines_switch","name","display_timelines_switch",3,"checked","change"],[1,"form--field-instructions",3,"textContent"],[4,"ngIf"],[1,"form--fieldset"],[1,"form--fieldset-legend",3,"textContent"],[3,"textContent"],[1,"form--text-select-container","-slim"],["id","modal-timelines-zoomlevel",1,"form--select",3,"change"],[3,"textContent","value","selected",4,"ngFor","ngForOf"],["class","form--row",4,"ngFor","ngForOf"],[3,"textContent","value","selected"],[1,"form--row"],[1,"form--label",3,"for"],[1,"form--select-container"],[1,"form--select",3,"id","change"]],template:function(e,t){1&e&&(c.mc(0,"div"),c.mc(1,"form",0),c.mc(2,"div",1),c.hc(3,"label",2),c.mc(4,"div",3),c.mc(5,"div",4),c.mc(6,"input",5),c.uc("change",(function(){return t.timelineVisible=!t.timelineVisible})),c.lc(),c.lc(),c.lc(),c.hc(7,"p",6),c.lc(),c.Yc(8,p,13,7,"ng-container",7),c.lc(),c.lc()),2&e&&(c.Tb(3),c.Bc("textContent",t.text.display_timelines),c.Tb(3),c.Bc("checked",t.timelineVisible),c.Tb(1),c.Bc("textContent",t.text.display_timelines_hint),c.Tb(1),c.Bc("ngIf",t.timelineVisible))},directives:[o.C,o.n,o.o,l.q,l.p,o.r,o.B],encapsulation:2})},ho3E:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return s}));const n=new(i("fXoL").z)("OpQueryConfigurationLocalsToken"),s="op:queryconfiguration:trigger"},hvpr:function(e,t,i){"use strict";i.d(t,"a",(function(){return M}));var n=i("mrSG"),s=i("fXoL"),a=i("E2tj"),r=i("wZYP"),c=i("FDFi"),o=i("4n9w"),l=i("4EDS"),d=i("Kg8T"),u=i("iB+3"),h=i("iMRi"),p=i("Uyc6"),g=i("Jui0"),m=i("lJxs"),f=i("pLZG"),b=i("zp1y"),w=i("x5It"),v=i("eyhC"),y=i("Wcm6"),k=i("WW/2"),C=i("87fy"),j=i("qc15"),x=i("K247"),T=i("WUI6"),S=i("AEvm"),_=i("Hg4z"),P=i("/C7M");const I=["container"];function O(e,t){if(1&e&&(s.mc(0,"div",5),s.hc(1,"ndc-dynamic",6),s.lc()),2&e){const e=s.wc();s.Tb(1),s.Bc("ndcDynamicComponent",e.referenceClass)("ndcDynamicInjector",e.injector)("ndcDynamicOutputs",e.referenceOutputs)}}function R(e,t){1&e&&s.hc(0,"hr",9)}function B(e,t){if(1&e){const e=s.nc();s.kc(0),s.mc(1,"wp-single-card",7),s.uc("onRemove",(function(){s.Qc(e);const i=t.$implicit;return s.wc().removeCard(i)})),s.lc(),s.Yc(2,R,1,0,"hr",8),s.jc()}if(2&e){const e=t.$implicit,i=s.wc();s.Tb(1),s.Bc("workPackage",e)("showInfoButton",i.showInfoButton)("showStatusButton",i.showStatusButton)("showRemoveButton",i.cardsRemovable)("highlightingMode",i.highlightingMode)("draggable",i.canDragOutOf(e))("orientation",i.orientation)("shrinkOnMobile",i.shrinkOnMobile),s.Ub("data-is-new",e.isNew||void 0)("data-work-package-id",e.id)("data-class-identifier",i.cardView.classIdentifier(e)),s.Tb(1),s.Bc("ngIf",i.shrinkOnMobile)}}function E(e,t){if(1&e&&(s.mc(0,"div"),s.hc(1,"no-results",10),s.lc()),2&e){const e=s.wc();s.Tb(1),s.Bc("title",e.text.noResults.title)("description",e.text.noResults.description)}}class M extends S.a{constructor(e,t,i,n,a,r,c,o,d,u,h,p,g,m,f,b,w,v){super(),this.querySpace=e,this.states=t,this.injector=i,this.$state=n,this.I18n=a,this.wpCreate=r,this.wpInlineCreate=c,this.notificationService=o,this.halEvents=d,this.authorisationService=u,this.causedUpdates=h,this.cdRef=p,this.pathHelper=g,this.wpTableSelection=m,this.wpViewOrder=f,this.cardView=b,this.cardDragDrop=w,this.deviceService=v,this.showStatusButton=!0,this.showInfoButton=!1,this.orientation="vertical",this.cardsRemovable=!1,this.showEmptyResultsBox=!1,this.shrinkOnMobile=!1,this.onMoved=new s.s,this.trackByHref=l.a.trackByHrefAndProperty("lockVersion"),this.isResultEmpty=!1,this.text={removeCard:this.I18n.t("js.card.remove_from_list"),addNewCard:this.I18n.t("js.card.add_new"),noResults:{title:this.I18n.t("js.work_packages.no_results.title"),description:this.I18n.t("js.work_packages.no_results.description")}},this.canAdd=!1,this.canReference=!1,this.inReference=!1,this.referenceClass=this.wpInlineCreate.referenceComponentClass,this.referenceOutputs={onCancel:()=>this.setReferenceMode(!1),onReferenced:e=>this.cardDragDrop.addWorkPackageToQuery(e,0)}}ngOnInit(){this.registerCreationCallback(),this.authorisationService.observeUntil(Object(_.b)(this)).subscribe(()=>{this.canAdd=this.wpInlineCreate.canAdd,this.canReference=this.wpInlineCreate.canReference,this.cdRef.detectChanges()}),this.halEvents.aggregated$("WorkPackage").pipe(Object(m.a)(e=>e.filter(e=>"updated"===e.eventType)),Object(f.a)(e=>{const t=this.workPackages.map(e=>e.id.toString());return!!e.find(e=>-1!==t.indexOf(e.id))})).subscribe(()=>{this.workPackages=this.wpViewOrder.orderedWorkPackages(),this.cdRef.detectChanges()}),this.querySpace.results.values$().pipe(Object(b.a)(this.querySpace.query.values$()),this.untilDestroyed()).subscribe(([e,t])=>{this.query=t,this.workPackages=this.wpViewOrder.orderedWorkPackages(),this.cardView.updateRenderedCardsValues(this.workPackages),this.isResultEmpty=0===this.workPackages.length,this.cdRef.detectChanges()})}ngAfterViewInit(){this.cardDragDrop.init(this),this.deviceService.isMobile||this.cardDragDrop.registerDragAndDrop();let e=this.injector.get(T.b,y.a);e instanceof y.a?e.attachTo(this):new e(this.injector).attachTo(this),this.wpTableSelection.registerSelectAllListener(()=>this.cardView.renderedCards),this.wpTableSelection.registerDeselectAllListener()}ngOnDestroy(){super.ngOnDestroy(),this.cardDragDrop.destroy()}get workPackages(){return this.cardDragDrop.workPackages}set workPackages(e){this.cardDragDrop.workPackages=e}setReferenceMode(e){this.inReference=e,this.cdRef.detectChanges()}addNewCard(){this.cardDragDrop.addNewCard()}removeCard(e){this.cardDragDrop.removeCard(e)}onCardSaved(e){return Object(n.b)(this,void 0,void 0,(function*(){yield this.cardDragDrop.onCardSaved(e)}))}classes(){let e="wp-cards-container ";return e+="-"+this.orientation,e+=this.shrinkOnMobile?" -shrink":"",e}registerCreationCallback(){this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed()).subscribe(e=>Object(n.b)(this,void 0,void 0,(function*(){this.onCardSaved(e)})))}}M.\u0275fac=function(e){return new(e||M)(s.gc(a.a),s.gc(h.a),s.gc(s.A),s.gc(u.G),s.gc(r.a),s.gc(o.a),s.gc(c.a),s.gc(j.a),s.gc(P.a),s.gc(d.a),s.gc(w.a),s.gc(s.i),s.gc(g.a),s.gc(v.a),s.gc(p.a),s.gc(k.a),s.gc(C.a),s.gc(x.a))},M.\u0275cmp=s.ac({type:M,selectors:[["wp-card-view"]],viewQuery:function(e,t){var i;(1&e&&s.Wc(I,!0),2&e)&&(s.Nc(i=s.vc())&&(t.container=i.first))},inputs:{canDragOutOf:["dragOutOfHandler","canDragOutOf"],dragInto:"dragInto",highlightingMode:"highlightingMode",workPackageAddedHandler:"workPackageAddedHandler",showStatusButton:"showStatusButton",showInfoButton:"showInfoButton",orientation:"orientation",cardsRemovable:"cardsRemovable",showEmptyResultsBox:"showEmptyResultsBox",shrinkOnMobile:"shrinkOnMobile"},outputs:{onMoved:"onMoved"},features:[s.Qb],decls:5,vars:5,consts:[[3,"ngClass"],["container",""],["class","wp-inline-create--reference-container",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"wp-inline-create--reference-container"],[3,"ndcDynamicComponent","ndcDynamicInjector","ndcDynamicOutputs"],[3,"workPackage","showInfoButton","showStatusButton","showRemoveButton","highlightingMode","draggable","orientation","shrinkOnMobile","onRemove"],["class","form--separator hidden-for-desktop",4,"ngIf"],[1,"form--separator","hidden-for-desktop"],[3,"title","description"]],template:function(e,t){1&e&&(s.mc(0,"div",0,1),s.Yc(2,O,2,3,"div",2),s.Yc(3,B,3,12,"ng-container",3),s.lc(),s.Yc(4,E,2,2,"div",4)),2&e&&(s.Bc("ngClass",t.classes()),s.Tb(2),s.Bc("ngIf",t.inReference),s.Tb(1),s.Bc("ngForOf",t.workPackages)("ngForTrackBy",t.trackByHref),s.Tb(1),s.Bc("ngIf",t.showEmptyResultsBox&&t.isResultEmpty))},styles:[".wp-inline-create-button[_ngcontent-%COMP%]{font-size:.9rem;padding-top:1rem;text-align:center}.wp-inline-create--reference-container[_ngcontent-%COMP%]{margin-bottom:3rem;margin-top:10px}",".wp-cards-container.-horizontal[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));grid-column-gap:10px;grid-row-gap:10px;margin-right:5px}@media only screen and (max-width:679px){.wp-cards-container.-horizontal.-shrink[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-row-gap:0;margin-right:0}.wp-cards-container.-horizontal.-shrink[_ngcontent-%COMP%]   .form--separator[_ngcontent-%COMP%]{margin-bottom:0}}",".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.wp-cards-container.-vertical[_ngcontent-%COMP%]{height:100%;padding:0 15px;border-radius:2px;overflow-y:scroll;scrollbar-color:transparent transparent;scrollbar-width:thin}.wp-cards-container.-vertical[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.wp-cards-container.-vertical[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.wp-cards-container.-vertical[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.wp-cards-container.-vertical[_ngcontent-%COMP%]:hover{scrollbar-color:#ddd transparent}.wp-cards-container.-vertical[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}"],changeDetection:0})},hxxE:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{updateElements(){return this.$href?this.$load().then(e=>this.elements=e.elements):Promise.resolve()}}},hxzR:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var n=i("IzEk"),s=i("POAS"),a=i("qc15"),r=i("E05v"),c=i("ahVz"),o=i("2TbE"),l=i("p5fp"),d=i("XlgE"),u=i("BjK6"),h=i("ul8C"),p=i("qvi4"),g=i("EzE4"),m=i("LRne"),f=i("fXoL"),b=i("ofXK"),w=i("CV67"),v=i("CS/5"),y=i("0loS"),k=i("DLfB");function C(e,t){if(1&e&&f.hc(0,"back-button",11),2&e){const e=f.wc();f.Bc("customBackMethod",e.backButtonCallback)}}function j(e,t){if(1&e&&(f.mc(0,"li",15),f.hc(1,"ndc-dynamic",16),f.lc()),2&e){const e=f.wc().$implicit,t=f.wc(2);f.Bc("ngClass",e.containerClasses),f.Tb(1),f.Bc("ndcDynamicComponent",e.component)("ndcDynamicInputs",e.inputs)("ndcDynamicInjector",t.injector)("ndcDynamicOutputs",e.outputs)}}function x(e,t){if(1&e&&(f.kc(0),f.Yc(1,j,2,5,"li",14),f.jc()),2&e){const e=t.$implicit;f.Tb(1),f.Bc("ngIf",!e.show||e.show())}}function T(e,t){if(1&e&&(f.mc(0,"ul",12),f.Yc(1,x,2,1,"ng-container",13),f.lc()),2&e){const e=f.wc();f.Tb(1),f.Bc("ngForOf",e.toolbarButtonComponents)}}class S extends c.a{constructor(){super(...arguments),this.toolbarButtonComponents=[{component:o.a,inputs:{stateName$:Object(m.a)("work-packages.partitioned.list.new"),allowed:["work_packages.createWorkPackage"]}},{component:l.a},{component:d.a,containerClasses:"hidden-for-mobile"},{component:u.a,containerClasses:"hidden-for-mobile"},{component:h.a,containerClasses:"hidden-for-mobile -no-spacing"},{component:p.a,containerClasses:"hidden-for-mobile"},{component:g.a}]}ngOnInit(){super.ngOnInit(),this.text.button_settings=this.I18n.t("js.button_settings")}additionalLoadingTime(){return this.wpTableTimeline.isVisible?this.querySpace.timelineRendered.pipe(Object(n.a)(1)).toPromise():this.querySpace.tableRendered.valuesPromise()}shouldUpdateHtmlTitle(){return"work-packages.partitioned.list"===this.$state.current.name}}S.\u0275fac=function(e){return _(e||S)},S.\u0275cmp=f.ac({type:S,selectors:[["wp-view-page"]],features:[f.Sb([{provide:s.a,useClass:a.a},r.a]),f.Qb],decls:11,vars:11,consts:[[1,"work-packages-partitioned-query-space--container",3,"ngClass"],[1,"toolbar-container","-editable"],[1,"toolbar"],["linkClass","back-button",3,"customBackMethod",4,"ngIf"],[3,"title","inFlight","showSaveCondition","editable","onSave","onEmptySubmit"],["class","toolbar-items hide-when-print",4,"ngIf"],[1,"work-packages-partitioned-query-space--filter-area"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector"],[1,"work-packages-partitioned-page--content-container"],["data-indicator-name","table","ui-view","content-left",1,"work-packages-partitioned-page--content-left","loading-indicator--location"],["ui-view","content-right",1,"work-packages-partitioned-page--content-right"],["linkClass","back-button",3,"customBackMethod"],[1,"toolbar-items","hide-when-print"],[4,"ngFor","ngForOf"],["class","toolbar-item",3,"ngClass",4,"ngIf"],[1,"toolbar-item",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicInjector","ndcDynamicOutputs"]],template:function(e,t){1&e&&(f.mc(0,"div",0),f.mc(1,"div",1),f.mc(2,"div",2),f.Yc(3,C,1,1,"back-button",3),f.mc(4,"editable-toolbar-title",4),f.uc("onSave",(function(e){return t.changeChangesFromTitle(e)}))("onEmptySubmit",(function(){return t.updateTitleName("")})),f.lc(),f.Yc(5,T,2,1,"ul",5),f.lc(),f.lc(),f.mc(6,"div",6),f.hc(7,"ndc-dynamic",7),f.lc(),f.mc(8,"div",8),f.hc(9,"div",9),f.hc(10,"div",10),f.lc(),f.lc()),2&e&&(f.Bc("ngClass",t.currentPartition),f.Tb(3),f.Bc("ngIf",t.backButtonCallback),f.Tb(1),f.Bc("title",t.selectedTitle)("inFlight",t.toolbarDisabled)("showSaveCondition",t.showToolbarSaveButton)("editable",t.titleEditingEnabled),f.Tb(1),f.Bc("ngIf",t.showToolbar),f.Tb(2),f.Bc("ndcDynamicComponent",t.filterContainerDefinition.component)("ndcDynamicInputs",t.filterContainerDefinition.inputs)("ndcDynamicOutputs",t.filterContainerDefinition.outputs)("ndcDynamicInjector",t.injector))},directives:[b.n,b.q,w.a,v.c,v.d,y.UIView,k.a,b.p],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]{height:100%;overflow:hidden;display:grid;grid-template-columns:1fr;grid-template-rows:auto auto minmax(200px,1fr)}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]{display:flex;overflow:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover{scrollbar-color:#ddd transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{position:relative}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{flex:1}@media only screen and (max-width:679px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{min-width:0;max-width:100vw;max-height:100%}}"],changeDetection:0});const _=f.oc(S)},i95X:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("wZYP"),s=i("FDFi"),a=i("6p3c"),r=i("uSJ+"),c=i("ug4p"),o=i("E2tj"),l=i("pL6k"),d=i("NawS"),u=i("/C7M"),h=i("qc15"),p=i("fXoL"),g=i("MIK2"),m=i("/Rze"),f=i("N5AO");class b{constructor(e,t,i,n,s,a,r,c,o){this.parent=e,this.wpInlineCreate=t,this.wpCacheService=i,this.wpRelations=n,this.notificationService=s,this.halEvents=a,this.urlParamsHelper=r,this.querySpace=c,this.I18n=o,this.isDisabled=!1,this.queryFilters=this.buildQueryFilters(),this.text={abort:this.I18n.t("js.relation_buttons.abort")}}addExisting(){if(_.isNil(this.selectedWpId))return;const e=this.selectedWpId;this.isDisabled=!0,this.wpInlineCreate.add(this.workPackage,e).then(()=>{this.wpCacheService.loadWorkPackage(this.workPackage.id,!0),this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:e,relationType:this.relationType}),this.isDisabled=!1,this.wpInlineCreate.newInlineWorkPackageReferenced.next(e),this.cancel()}).catch(e=>{this.notificationService.handleRawError(e,this.workPackage),this.isDisabled=!1,this.cancel()})}onSelected(e){e&&(this.selectedWpId=e.id,this.addExisting())}get relationType(){return this.wpInlineCreate.relationType}get workPackage(){return this.wpInlineCreate.referenceTarget}cancel(){this.parent.resetRow()}buildQueryFilters(){const e=this.querySpace.query.value;if(!e)return[];const t=d.a.RELATION_TYPES(!0);let i=e.filters.filter(e=>{let i=this.urlParamsHelper.buildV3GetFilterIdFromFilter(e);return-1===t.indexOf(i)});return this.urlParamsHelper.buildV3GetFilters(i)}}b.\u0275fac=function(e){return new(e||b)(p.gc(a.a),p.gc(s.a),p.gc(c.a),p.gc(r.a),p.gc(h.a),p.gc(u.a),p.gc(l.a),p.gc(o.a),p.gc(n.a))},b.\u0275cmp=p.ac({type:b,selectors:[["ng-component"]],decls:7,vars:4,consts:[["data-indicator-name","relationAddChild",1,"loading-indicator--location"],[1,"wp-relations-create--form","wp-relations--add-form"],[1,"wp-relations-input-section"],["hiddenOverflowContainer",".work-packages-full-view--split-left",3,"workPackage","additionalFilters","filterCandidatesFor","onSelected"],[1,"wp-relations-controls-section","relation-row"],["linkClass","wp-create-relation--cancel","aria-hidden","false",3,"execute"],["icon-classes","icon-remove",3,"icon-title"]],template:function(e,t){1&e&&(p.mc(0,"div",0),p.mc(1,"div",1),p.mc(2,"div",2),p.mc(3,"wp-relations-autocomplete",3),p.uc("onSelected",(function(e){return t.onSelected(e)})),p.lc(),p.lc(),p.mc(4,"div",4),p.mc(5,"accessible-by-keyboard",5),p.uc("execute",(function(){return t.cancel()})),p.hc(6,"op-icon",6),p.lc(),p.lc(),p.lc(),p.lc()),2&e&&(p.Tb(3),p.Bc("workPackage",t.workPackage)("additionalFilters",t.queryFilters)("filterCandidatesFor",t.relationType),p.Tb(3),p.Bc("icon-title",t.text.abort))},directives:[g.a,m.a,f.a],encapsulation:2})},iHm1:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this.config={user:"name",project:"name"}}sort(e,t){if(0===e.length)return e;const i=t||e[0]._type;if(!i)return e;const n=this.sortingProperty(i);return n?_.sortBy(e,e=>e[n].toLowerCase()):e}sortingProperty(e){return e=e.toLowerCase().replace(/^\[\]/,""),this.config[e]}hasSortingProperty(e){return void 0!==this.sortingProperty(e)}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.cc({token:s,factory:s.\u0275fac,providedIn:"root"})},iMRi:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("FnNU"),s=i("XNiG");class a extends n.a{constructor(){super(...arguments),this.name="MainStore",this.projects=Object(n.g)(),this.workPackages=Object(n.g)(),this.posts=Object(n.g)(),this.schemas=Object(n.g)(),this.types=Object(n.g)(),this.statuses=Object(n.g)(),this.timeEntries=Object(n.g)(),this.versions=Object(n.g)(),this.users=Object(n.g)(),this.queries=new c,this.changes=new r,this.additional={}}forResource(e){const t=_.camelCase(e._type)+"s";let i=this[t]||this.additional[t];return i||(i=this.additional[t]=Object(n.g)()),i&&i.get(e.id)}add(e,t){this.additional[e]=t}}class r{constructor(){this.queries=new s.a}}class c{constructor(){this.columns=Object(n.f)(),this.sortBy=Object(n.f)(),this.groupBy=Object(n.f)(),this.filters=Object(n.f)(),this.displayRepresentation=Object(n.f)()}}},"ii2/":function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("mrSG"),s=i("Mo6U"),a=i("wZYP"),r=i("/8SZ"),c=i("ZsX/"),o=i("iMRi"),l=i("ug4p"),d=i("dMmB"),u=i("Jui0"),h=i("d/TE"),p=i("LrpJ"),g=i("5JuZ"),m=i("mMv8"),f=i("qc15"),b=i("r0MM");class w extends s.a{constructor(){super(...arguments),this.overriddenSchema=void 0,this.attachmentsBackend=!0}get ancestorIds(){return this.ancestors.map(e=>e.id)}get isReadonly(){return this.status&&this.status.isReadonly}subjectWithType(e=40){return`${this.type?`${this.type.name}: `:""}${this.subjectWithId(e)}`}subjectWithId(e=40){const t=this.isNew?"":` (#${this.id})`;return`${_.truncate(this.subject,{length:e})}${t}`}get isMilestone(){return this.schema.hasOwnProperty("date")}get isLeaf(){var e=this.$links.children;return!(e&&e.length>0)}get isEditable(){return this.isNew||!!this.$links.update}previewPath(){return this.isNew?super.previewPath():this.pathHelper.api.v3.work_packages.id(this.id).path}getEditorTypeFor(e){return"description"===e?"full":"constrained"}isAttributeEditable(e){const t=this.schema[e];return this.isEditable&&t&&t.writable&&(!this.isReadonly||"status"===e)}performUpload(e){let t="";return t=this.isNew?this.pathHelper.api.v3.attachments.path:this.attachments.$href,this.opFileUpload.uploadAndMapResponse(t,e)}getSchemaName(e){return!this.isMilestone||"startDate"!==e&&"dueDate"!==e?e:"date"}isParentOf(e){var t;return(null===(t=e.parent)||void 0===t?void 0:t.$links.self.$link.href)===this.$links.self.$link.href}updateLinkedResources(...e){const t={};e.forEach(e=>{const i=this[e];t[e]=i?i.$update():Promise.reject(void 0)});const i=Promise.all(_.values(t));return i.then(()=>{this.wpCacheService.touch(this.id)}),i}initializeNewResource(e){this.overriddenSchema=e.schema,this.$source.id="new",this._type="WorkPackage",this.__initialized_at=Date.now(),this.update=this.$links.update=e.$links.self,this.updateImmediately=this.$links.updateImmediately=e=>this.workPackageDmService.createWorkPackage(e)}$initialize(e){super.$initialize(e);let t=this.attachments||{$source:{},elements:[]};this.attachments=new r.a(this.injector,_.get(t,"$source",t),!1,this.halInitializer,"HalResource")}$linkableKeys(){return _.without(super.$linkableKeys(),"schema")}get schema(){if(this.hasOverriddenSchema)return this.overriddenSchema;const e=this.schemaCacheService.state(this);if(!e.hasValue())throw`Accessing schema of ${this.id} without it being loaded.`;return e.value}get state(){return this.states.workPackages.get(this.id)}push(e){return this.wpActivity.clear(e.id),e.parent&&this.wpCacheService.require(e.parent.id,!0),this.wpCacheService.updateWorkPackage(e)}get hasOverriddenSchema(){return null!=this.overriddenSchema}}Object(n.c)([Object(b.a)(),Object(n.e)("design:type",a.a)],w.prototype,"I18n",void 0),Object(n.c)([Object(b.a)(),Object(n.e)("design:type",o.a)],w.prototype,"tates",void 0),Object(n.c)([Object(b.a)(),Object(n.e)("design:type",m.a)],w.prototype,"wpActivity",void 0),Object(n.c)([Object(b.a)(),Object(n.e)("design:type",g.a)],w.prototype,"workPackageDmService",void 0),Object(n.c)([Object(b.a)(),Object(n.e)("design:type",l.a)],w.prototype,"wpCacheService",void 0),Object(n.c)([Object(b.a)(),Object(n.e)("design:type",d.a)],w.prototype,"schemaCacheService",void 0),Object(n.c)([Object(b.a)(),Object(n.e)("design:type",h.a)],w.prototype,"NotificationsService",void 0),Object(n.c)([Object(b.a)(),Object(n.e)("design:type",f.a)],w.prototype,"workPackageNotificationService",void 0),Object(n.c)([Object(b.a)(),Object(n.e)("design:type",u.a)],w.prototype,"pathHelper",void 0),Object(n.c)([Object(b.a)(),Object(n.e)("design:type",c.a)],w.prototype,"opFileUpload",void 0);const v=Object(p.a)(w)},iuLl:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("fXoL"),s=i("gh2L"),a=i("wZYP"),r=i("sjKJ"),c=i("Jui0"),o=i("ZOsW"),l=i("3Pt+"),d=i("ofXK"),u=i("ximh");const h=function(e){return{selected:e}};function p(e,t){if(1&e){const e=n.nc();n.mc(0,"div",5),n.mc(1,"ul",6),n.mc(2,"li",7),n.uc("click",(function(){return n.Qc(e),n.wc().setMode("all")})),n.hc(3,"a",8),n.lc(),n.mc(4,"li",7),n.uc("click",(function(){return n.Qc(e),n.wc().setMode("recent")})),n.hc(5,"a",8),n.lc(),n.lc(),n.lc()}if(2&e){const e=n.wc();n.Tb(2),n.Bc("ngClass",n.Gc(4,h,"all"===e.mode)),n.Tb(1),n.Bc("textContent",e.text.all),n.Tb(1),n.Bc("ngClass",n.Gc(6,h,"recent"===e.mode)),n.Tb(1),n.Bc("textContent",e.text.recent)}}function g(e,t){if(1&e&&(n.hc(0,"b",9),n.ad(1)),2&e){const e=t.searchTerm,i=n.wc();n.Bc("textContent",i.text.add_new_action),n.Tb(1),n.cd(": ",e," ")}}function m(e,t){if(1&e&&(n.mc(0,"div",10),n.ad(1),n.lc()),2&e){const e=t.item,i=t.searchTerm;n.Bc("ngOptionHighlight",i),n.Tb(1),n.bd(e.name)}}class f extends s.a{constructor(e,t,i,s){super(e,t,i,s),this.I18n=e,this.cdRef=t,this.currentProject=i,this.pathHelper=s,this.modeSwitch=new n.s,this.loading=!1,this.mode="all",this.text.all=this.I18n.t("js.label_all"),this.text.recent=this.I18n.t("js.label_recent")}setMode(e){e!==this.mode&&this.modeSwitch.emit(e),this.mode=e}}f.\u0275fac=function(e){return new(e||f)(n.gc(a.a),n.gc(n.i),n.gc(r.a),n.gc(c.a))},f.\u0275cmp=n.ac({type:f,selectors:[["te-work-package-autocompleter"]],outputs:{modeSwitch:"modeSwitch"},features:[n.Qb],decls:6,vars:16,consts:[["bindLabel","name",3,"ngModel","items","ngClass","addTag","virtualScroll","required","clearable","disabled","typeahead","clearOnBackspace","appendTo","hideSelected","loading","id","ngModelChange","change","open","close","keydown"],["ngSelectComponent",""],["ng-header-tmp",""],["ng-tag-tmp",""],["ng-option-tmp",""],[1,"scrollable-tabs","-narrow"],[1,"tabrow"],[3,"ngClass","click"],["href","#",3,"textContent"],[3,"textContent"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight"]],template:function(e,t){1&e&&(n.mc(0,"ng-select",0,1),n.uc("ngModelChange",(function(e){return t.model=e}))("change",(function(e){return t.changeModel(e)}))("open",(function(){return t.opened()}))("close",(function(){return t.closed()}))("keydown",(function(e){return t.keyPressed(e)})),n.xc(2,"async"),n.Yc(3,p,6,8,"ng-template",2),n.Yc(4,g,2,2,"ng-template",3),n.Yc(5,m,2,2,"ng-template",4),n.lc()),2&e&&n.Bc("ngModel",t.model)("items",t.availableValues)("ngClass",t.classes)("addTag",t.createAllowed)("virtualScroll",!0)("required",t.required)("clearable",!t.required)("disabled",t.disabled)("typeahead",t.typeahead)("clearOnBackspace",!1)("appendTo",t.appendTo)("hideSelected",t.hideSelected)("loading",n.yc(2,14,t.finishedLoading))("id",t.id)},directives:[o.a,l.m,l.p,d.n,l.x,o.g,o.l,o.c,u.a],pipes:[d.a],styles:[".ng-dropdown-panel .ng-dropdown-header{padding-bottom:0}"],encapsulation:2})},iuWW:function(e,t,i){"use strict";i.d(t,"b",(function(){return h})),i.d(t,"a",(function(){return p}));var n=i("XNiG"),s=i("GyhO"),a=i("LRne"),r=i("/uUt"),c=i("Kj3r"),o=i("vkgz"),l=i("eIep"),d=i("JIr8"),u=i("1G5W");function h(e){return t=>e.handleRawError(t)}class p{constructor(e,t,i=250){this.requestHandler=e,this.errorHandler=t,this.debounceMs=i,this.input$=new n.a,this.loading$=new n.a,this.lastResult=[],this.output$=Object(s.a)(Object(a.a)([]),this.input$.pipe(Object(r.a)(),Object(c.a)(i),Object(o.a)(e=>{this.lastRequestedValue=e,this.lastResult=[],this.loading$.next(!0)}),Object(l.a)(e=>this.requestHandler(e).pipe(Object(d.a)(e=>(this.errorHandler(e),Object(a.a)([]))),Object(o.a)(e=>{this.loading$.next(!1),this.lastResult=e})))))}request(e){this.input$.next(e)}get hasResults(){return this.lastResult.length>0}observe(e){return this.output$.pipe(Object(u.a)(e))}}},"j/Ak":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("ciXH"),s=i("Mo6U"),a=i("kTsZ"),r=i("Jui0"),c=i("6x6j"),o=i("fXoL");class l extends n.a{constructor(e,t,i){super(e,t),this.halResourceService=e,this.pathHelper=t,this.payloadDm=i}listUrl(){return this.pathHelper.api.v3.time_entries.toString()}oneUrl(e){return this.pathHelper.api.v3.time_entries.id(e).toString()}update(e,t=null){let i=this.extractPayload(e,t);return this.halResourceService.patch(e.updateImmediately.$link.href,i).toPromise()}updateForm(e,t=null){let i=this.extractPayload(e,t);return this.halResourceService.post(this.pathHelper.api.v3.time_entries.id(e.idFromLink).form.toString(),i).toPromise()}createForm(e){return this.halResourceService.post(this.pathHelper.api.v3.time_entries.form.toString(),e).toPromise()}create(e){return this.halResourceService.post(this.pathHelper.api.v3.time_entries.path,e).toPromise()}delete(e){return this.halResourceService.delete(this.pathHelper.api.v3.time_entries.id(e.idFromLink).toString()).toPromise()}extractPayload(e=null,t=null){return e&&t?this.payloadDm.extract(e,t):e instanceof s.a?{}:e}}l.\u0275fac=function(e){return new(e||l)(o.qc(a.a),o.qc(r.a),o.qc(c.a))},l.\u0275prov=o.cc({token:l,factory:l.\u0275fac})},jEcX:function(e,t,i){"use strict";i.d(t,"b",(function(){return m})),i.d(t,"a",(function(){return f}));i("Mo6U");var n=i("kTsZ"),s=i("wZYP"),a=i("iMRi"),r=i("pLZG"),c=i("AEvm"),o=i("fXoL"),l=i("ofXK"),d=i("5mBr"),u=i("2yvi");function h(e,t){if(1&e&&o.hc(0,"attachment-list",6),2&e){const e=o.wc(2);o.Bc("resource",e.resource)("destroyImmediately",e.destroyImmediately)}}function p(e,t){if(1&e&&o.hc(0,"attachments-upload",7),2&e){const e=o.wc(2);o.Bc("resource",e.resource)}}function g(e,t){if(1&e&&(o.mc(0,"fieldset",1),o.mc(1,"legend",2),o.ad(2),o.lc(),o.mc(3,"div",3),o.Yc(4,h,1,2,"attachment-list",4),o.Yc(5,p,1,1,"attachments-upload",5),o.lc(),o.lc()),2&e){const e=o.wc();o.Tb(2),o.cd(" ",e.text.attachments," "),o.Tb(2),o.Bc("ngIf",e.resource.attachments),o.Tb(1),o.Bc("ngIf",e.allowUploading)}}const m="attachments";class f extends c.a{constructor(e,t,i,n){super(),this.elementRef=e,this.I18n=t,this.states=i,this.halResourceService=n,this.text={attachments:this.I18n.t("js.label_attachments")}}ngOnInit(){if(this.$element=jQuery(this.elementRef.nativeElement),!this.resource){const e=this.$element.data("resource");this.resource=this.halResourceService.createHalResource(e,!0)}this.allowUploading=this.$element.data("allow-uploading"),void 0!==this.$element.data("destroy-immediately")?this.destroyImmediately=this.$element.data("destroy-immediately"):this.destroyImmediately=!0,this.setupResourceUpdateListener()}setupResourceUpdateListener(){this.states.forResource(this.resource).changes$().pipe(this.untilDestroyed(),Object(r.a)(e=>!!e)).subscribe(e=>{this.resource=e||this.resource})}showAttachments(){return this.allowUploading||_.get(this.resource,"attachments.count",0)>0}}f.\u0275fac=function(e){return new(e||f)(o.gc(o.q),o.gc(s.a),o.gc(a.a),o.gc(n.a))},f.\u0275cmp=o.ac({type:f,selectors:[["attachments"]],inputs:{resource:"resource"},features:[o.Qb],decls:1,vars:1,consts:[["class","form--fieldset",4,"ngIf"],[1,"form--fieldset"],[1,"form--fieldset-legend"],["id","attachments_fields"],[3,"resource","destroyImmediately",4,"ngIf"],["class","hide-when-print",3,"resource",4,"ngIf"],[3,"resource","destroyImmediately"],[1,"hide-when-print",3,"resource"]],template:function(e,t){1&e&&o.Yc(0,g,6,3,"fieldset",0),2&e&&o.Bc("ngIf",t.showAttachments())},directives:[l.q,d.a,u.a],encapsulation:2})},jQQo:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("fXoL"),s=i("wZYP"),a=i("OW6k"),r=i("AEvm"),c=i("VRyK"),o=i("8OyR"),l=i("9Ejp"),d=i("ofXK"),u=i("ZOsW");const h=["ngSelectComponent"];function p(e,t){if(1&e){const e=n.nc();n.mc(0,"div",5),n.hc(1,"span",6),n.mc(2,"a",7),n.uc("click",(function(){n.Qc(e);const i=t.$implicit;return n.wc().remove(i)})),n.lc(),n.lc()}if(2&e){const e=t.$implicit;n.Tb(1),n.Bc("textContent",e.name)}}class g extends r.a{constructor(e,t){super(),this.I18n=e,this.dragula=t,this.autofocus=!0,this._selected=[],this.onChange=new n.s,this.availableOptions=[],this.text={placeholder:this.I18n.t("js.label_add_columns")}}ngOnInit(){this.updateAvailableOptions(),this.columnsGroup=this.dragula.createGroup("columns",{}),this.dragula.drag("columns").pipe(this.untilDestroyed()).subscribe(()=>o.a.setBodyCursor("move","important")),Object(c.a)(this.dragula.drop("columns"),this.dragula.cancel("columns")).pipe(this.untilDestroyed()).subscribe(()=>o.a.setBodyCursor("auto"));const e=this;this.autoscroll=new a.a([document.getElementById("content-wrapper")],{margin:25,maxSpeed:10,scrollWhenOutside:!0,autoScroll:function(){return this.down&&e.columnsGroup.drake.dragging}})}ngAfterViewInit(){this.autofocus&&this.ngSelectComponent.focus()}ngOnDestroy(){super.ngOnDestroy(),this.dragula.destroy("columns")}select(e){e&&(this.selected=[...this.selected,e],this.ngSelectComponent.clearModel())}remove(e){this.selected=this.selected.filter(t=>t.id!==e.id)}get selected(){return this._selected}set selected(e){this._selected=e,this.updateAvailableOptions(),this.onChange.emit(this.selected)}opened(){setTimeout(()=>{const e=this.ngSelectComponent;e&&e.dropdownPanel&&e.dropdownPanel._updatePosition()},25)}updateAvailableOptions(){this.availableOptions=this.options.filter(e=>!this.selected.find(t=>t.id===e.id))}}g.\u0275fac=function(e){return new(e||g)(n.gc(s.a),n.gc(l.c))},g.\u0275cmp=n.ac({type:g,selectors:[["draggable-autocompleter"]],viewQuery:function(e,t){var i;(1&e&&n.fd(h,!0),2&e)&&(n.Nc(i=n.vc())&&(t.ngSelectComponent=i.first))},inputs:{options:"options",autofocus:"autofocus",_selected:["selected","_selected"]},outputs:{onChange:"onChange"},features:[n.Qb],decls:5,vars:8,consts:[[1,"draggable-autocomplete--container"],["dragula","columns",1,"draggable-autocomplete--selected",3,"dragulaModel","dragulaModelChange"],["class","draggable-autocomplete--item",4,"ngFor","ngForOf"],["ngClass","draggable-autocomplete--input","bindLabel","name","appendTo","body",3,"items","multiple","virtualScroll","placeholder","clearSearchOnAdd","closeOnSelect","open","change"],["ngSelectComponent",""],[1,"draggable-autocomplete--item"],[1,"draggable-autocomplete--item-text",3,"textContent"],[1,"draggable-autocomplete--remove-item","icon-remove",3,"click"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.uc("dragulaModelChange",(function(e){return t.selected=e})),n.Yc(2,p,3,1,"div",2),n.lc(),n.mc(3,"ng-select",3,4),n.uc("open",(function(){return t.opened()}))("change",(function(e){return t.select(e)})),n.lc(),n.lc()),2&e&&(n.Tb(1),n.Bc("dragulaModel",t.selected),n.Tb(1),n.Bc("ngForOf",t.selected),n.Tb(1),n.Bc("items",t.availableOptions)("multiple",!1)("virtualScroll",!0)("placeholder",t.text.placeholder)("clearSearchOnAdd",!0)("closeOnSelect",!0))},directives:[l.a,d.p,u.a,d.n],styles:[".draggable-autocomplete--selected[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;padding-bottom:1rem}.draggable-autocomplete--item[_ngcontent-%COMP%]{padding:5px;margin-right:5px;margin-bottom:5px;min-width:50px;border:1px solid #ddd;background:#f8f8f8;cursor:move;font-size:14px;display:flex;align-items:center;justify-content:space-between}.draggable-autocomplete--item[_ngcontent-%COMP%]   .draggable-autocomplete--remove-item[_ngcontent-%COMP%]{font-size:8px;color:#999;padding-left:5px}"],changeDetection:0})},jW2i:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("mrSG"),s=i("zcj1");class a{constructor(e={}){this._dataDir=e.dataDir||""}getProjects(e,t){e({projects:window.gon.ifc_models.projects})}getProject(e,t,i){t({id:e[0].id,name:e[0].name,models:window.gon.ifc_models.models,viewerContent:{modelsLoaded:window.gon.ifc_models.shown_models},viewerConfigs:{saoEnabled:!0}})}getMetadata(e,t,i,n){const a=window.gon.ifc_models.metadata_attachment_ids[t];console.log(`Loading model metadata for: ${a}`),s.a.loadJSON(this.attachmentUrl(a),i,n)}getGeometry(e,t,i,n){const a=window.gon.ifc_models.xkt_attachment_ids[t];console.log(`Loading model geometry for: ${a}`),s.a.loadArraybuffer(this.attachmentUrl(a),i,n)}attachmentUrl(e){return"/api/v3/attachments/"+e+"/content"}}var r=i("lfyH"),c=i("XNiG"),o=i("Jui0"),l=i("3VS2"),d=i("r0MM"),u=i("mY05"),h=i("LRne"),p=i("fXoL");class g extends r.a{constructor(e){super(e),this.injector=e,this.$loaded=new c.a}newViewer(e,t){i.e(16).then(i.bind(null,"/vtK")).then(i=>{let n=new a,s=new i.BIMViewer(n,e);s.on("queryPicked",e=>{alert(`IFC Name = "${e.objectName}"\nIFC class = "${e.objectType}"\nIFC GUID = ${e.objectId}`)}),s.on("modelLoaded",()=>this.$loaded.complete()),s.loadProject(t[0].id),this.viewer=s})}destroy(){this.$loaded.complete(),this.viewer&&(this.viewer.destroy(),this.viewer=void 0)}get viewer(){return this._viewer}set viewer(e){this._viewer=e}setKeyboardEnabled(e){this.viewer.setKeyboardEnabled(e)}getViewpoint$(){const e=this.viewer.saveBCFViewpoint({spacesVisible:!0});return delete e.bitmaps,Object(h.a)(e)}showViewpoint(e,t){this.routeWithViewer?this.viewer&&this.viewpointsService.getViewPoint$(e,t).subscribe(e=>this.viewer.loadBCFViewpoint(e,{})):window.location.href=this.pathHelper.bimDetailsPath(e.project.idFromLink,e.id,t)}viewerVisible(){return!!this.viewer}onLoad$(){return this.$loaded}}g.\u0275fac=function(e){return new(e||g)(p.qc(p.A))},g.\u0275prov=p.cc({token:g,factory:g.\u0275fac}),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",o.a)],g.prototype,"pathHelper",void 0),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",l.a)],g.prototype,"bcfApi",void 0),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",u.a)],g.prototype,"viewpointsService",void 0)},juWA:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("8zkO"),s=i("wZYP"),a=i("f0Wu"),r=i("fXoL");class c{constructor(e,t){this.ConfigurationService=e,this.I18n=t,this.setupLocale()}setupLocale(){a.locale(I18n.locale)}parseDatetime(e,t){var i=a.utc(e,t);return this.ConfigurationService.isTimezoneSet()&&(i.local(),i.tz(this.ConfigurationService.timezone())),i}parseDate(e,t){return a(e,t)}parseLocalDateTime(e,t){var i;return t=t||this.getTimeFormat(),(i=this.ConfigurationService.isTimezoneSet()?a.tz(e,t,this.ConfigurationService.timezone()):a(e,t)).utc(),i}parseISODatetime(e){return this.parseDatetime(e,"YYYY-MM-DDTHH:mm:ssZ")}parseISODate(e){return this.parseDate(e,"YYYY-MM-DD")}formattedDate(e){return this.parseDate(e).format(this.getDateFormat())}inThePast(e){return this.daysFromToday(e)<=-1}daysFromToday(e){const t=this.parseDate(e),i=a().startOf("day");return t.diff(i,"days")}formattedTime(e){return this.parseDatetime(e).format(this.getTimeFormat())}formattedDatetime(e){var t=this.formattedDatetimeComponents(e);return t[0]+" "+t[1]}formattedDatetimeComponents(e){var t=this.parseDatetime(e);return[t.format(this.getDateFormat()),t.format(this.getTimeFormat())]}toHours(e){return Number(a.duration(e).asHours().toFixed(2))}formattedDuration(e){return this.I18n.t("js.units.hour",{count:this.toHours(e)})}formattedISODate(e){return this.parseDate(e).format("YYYY-MM-DD")}formattedISODateTime(e){return e.format()}isValidISODate(e){return this.isValid(e,"YYYY-MM-DD")}isValidISODateTime(e){return this.isValid(e,"YYYY-MM-DDTHH:mm:ssZ")}isValid(e,t){var i=t||this.getDateFormat();return a(e,[i],!0).isValid()}getDateFormat(){return this.ConfigurationService.dateFormatPresent()?this.ConfigurationService.dateFormat():"L"}getTimeFormat(){return this.ConfigurationService.timeFormatPresent()?this.ConfigurationService.timeFormat():"LT"}}c.\u0275fac=function(e){return new(e||c)(r.qc(n.a),r.qc(s.a))},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac,providedIn:"root"})},k1Xe:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("iMRi"),s=i("Kg8T"),a=i("fXoL"),r=i("wZYP"),c=i("E2tj"),o=i("3Pt+");class l{constructor(e,t,i,n){this.states=e,this.querySpace=t,this.authorisationService=i,this.I18n=n,this.onChange=new a.s,this.text={showInMenu:this.I18n.t("js.label_star_query"),visibleForOthers:this.I18n.t("js.label_public_query"),showInMenuText:this.I18n.t("js.work_packages.query.star_text"),visibleForOthersText:this.I18n.t("js.work_packages.query.public_text")}}get canStar(){return this.isSave||this.authorisationService.can("query","star")||this.authorisationService.can("query","unstar")}get canPublish(){const e=this.querySpace.queryForm.value;return this.authorisationService.can("query","updateImmediately")&&e.schema.public.writable}updateStarred(e){this.isStarred=e,this.changed()}updatePublic(e){this.isPublic=e,this.changed()}changed(){this.onChange.emit({isStarred:!!this.isStarred,isPublic:!!this.isPublic})}}l.\u0275fac=function(e){return new(e||l)(a.gc(n.a),a.gc(c.a),a.gc(s.a),a.gc(r.a))},l.\u0275cmp=a.ac({type:l,selectors:[["query-sharing-form"]],inputs:{isSave:"isSave",isStarred:"isStarred",isPublic:"isPublic"},outputs:{onChange:"onChange"},decls:14,vars:8,consts:[[1,"form--field"],[1,"form--field-container","-vertical"],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["type","checkbox","name","is_public","id","show-public",1,"form--check-box",3,"ngModel","disabled","ngModelChange"],[1,"form--field-instructions","-no-margin",3,"textContent"],["type","checkbox","name","show_in_menu","id","show-in-menu",1,"form--check-box",3,"ngModel","disabled","ngModelChange"]],template:function(e,t){1&e&&(a.mc(0,"div",0),a.mc(1,"div",1),a.mc(2,"label",2),a.mc(3,"div",3),a.mc(4,"input",4),a.uc("ngModelChange",(function(e){return t.updatePublic(e)})),a.lc(),a.lc(),a.ad(5),a.lc(),a.hc(6,"div",5),a.lc(),a.lc(),a.mc(7,"div",0),a.mc(8,"div",1),a.mc(9,"label",2),a.mc(10,"div",3),a.mc(11,"input",6),a.uc("ngModelChange",(function(e){return t.updateStarred(e)})),a.lc(),a.lc(),a.ad(12),a.lc(),a.hc(13,"div",5),a.lc(),a.lc()),2&e&&(a.Tb(4),a.Bc("ngModel",t.isPublic)("disabled",!t.canPublish),a.Tb(1),a.cd(" ",t.text.visibleForOthers," "),a.Tb(1),a.Bc("textContent",t.text.visibleForOthersText),a.Tb(5),a.Bc("ngModel",t.isStarred)("disabled",!t.canStar),a.Tb(1),a.cd(" ",t.text.showInMenu," "),a.Tb(1),a.Bc("textContent",t.text.showInMenuText))},directives:[o.a,o.m,o.p],encapsulation:2})},k8lp:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("fXoL"),s=i("5Mgc"),a=i("d/TE"),r=i("wZYP"),c=i("8zkO"),o=i("ofXK");const l=["opCkeditorReplacementContainer"],d=["codeMirrorPane"];function u(e,t){if(1&e&&(n.mc(0,"div",6),n.mc(1,"div",7),n.mc(2,"p"),n.hc(3,"strong",8),n.hc(4,"br"),n.hc(5,"span",8),n.lc(),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(3),n.Bc("textContent",e.text.errorTitle),n.Tb(2),n.Bc("textContent",e.error)}}class h{constructor(e,t,i,s,a){this.elementRef=e,this.Notifications=t,this.I18n=i,this.configurationService=s,this.ckEditorSetup=a,this.ckEditorType="full",this.onInitialized=new n.s,this.onContentChange=new n.s,this.onInitializationFailed=new n.s,this.error=null,this.allowManualMode=!1,this.manualMode=!1,this.text={errorTitle:this.I18n.t("js.editor.error_initialization_failed")},this.debouncedEmitter=_.debounce(()=>{this.getTransformedContent(!1).then(e=>{this.onContentChange.emit(e)})},1e3,{leading:!0})}getRawData(){return this.manualMode?this._content=this.codeMirrorInstance.getValue():this._content=this.ckEditorInstance.getData({trim:!1})}getTransformedContent(e=!0){if(!this.initialized)throw"Tried to access CKEditor instance before initialization.";return new Promise((t,i)=>{try{t(this.getRawData())}catch(n){console.error(`Failed to save CKEditor content: ${n}.`);let t=this.I18n.t("js.editor.error_saving_failed",{error:n||this.I18n.t("js.error.internal")});e&&this.Notifications.addError(t),i(t)}})}set content(e){if(!this.initialized)throw"Tried to access CKEditor instance before initialization.";this._content=e,this.ckEditorInstance.setData(e)}get content(){return this._content}get initialized(){return void 0!==this.ckEditorInstance}ngOnInit(){try{this.initializeEditor()}catch(e){console.error(`Failed to setup CKEditor instance: ${e}`),this.error=e,this.onInitializationFailed.emit(e)}}initializeEditor(){this.$element=jQuery(this.elementRef.nativeElement);const e=this.ckEditorSetup.create(this.ckEditorType,this.opCkeditorReplacementContainer.nativeElement,this.context,this.content).catch(e=>{throw e}).then(e=>(this.ckEditorInstance=e,e.model.document.on("change",this.debouncedEmitter),e.on("op:source-code-enabled",()=>this.enableManualMode()),e.on("op:source-code-disabled",()=>this.disableManualMode()),this.onInitialized.emit(e),e));this.$element.data("editor",e)}disableManualMode(){const e=this.getRawData();this.ckEditorInstance.setData(e),this.codeMirrorInstance=null,this.manualMode=!1}enableManualMode(){const e=this.getRawData();Promise.all([i.e(0).then(i.t.bind(null,"VrN/",7)),i("TKcc")("./gfm/gfm.js")]).then(t=>{const i=t[0].default;this.codeMirrorInstance=i(this.$element.find(".ck-editor__source")[0],{lineNumbers:!0,smartIndent:!0,value:e,mode:""}),this.codeMirrorInstance.on("change",this.debouncedEmitter),setTimeout(()=>this.codeMirrorInstance.refresh(),100),this.manualMode=!0})}}h.\u0275fac=function(e){return new(e||h)(n.gc(n.q),n.gc(a.a),n.gc(r.a),n.gc(c.a),n.gc(s.a))},h.\u0275cmp=n.ac({type:h,selectors:[["op-ckeditor"]],viewQuery:function(e,t){var i;(1&e&&(n.Wc(l,!0),n.fd(d,!0)),2&e)&&(n.Nc(i=n.vc())&&(t.opCkeditorReplacementContainer=i.first),n.Nc(i=n.vc())&&(t.codeMirrorPane=i.first))},inputs:{ckEditorType:"ckEditorType",context:"context",_content:["content","_content"]},outputs:{onInitialized:"onInitialized",onContentChange:"onContentChange",onInitializationFailed:"onInitializationFailed"},decls:7,vars:1,consts:[["class","notification-box -error",4,"ngIf"],[1,"op-ckeditor-source-element","document-editor"],["opCkeditorReplacementContainer",""],[1,"document-editor__toolbar"],[1,"document-editor__editable-container"],[1,"document-editor__editable"],[1,"notification-box","-error"],[1,"notification-box--content"],[3,"textContent"]],template:function(e,t){1&e&&(n.kc(0),n.Yc(1,u,6,2,"div",0),n.mc(2,"div",1,2),n.hc(4,"div",3),n.mc(5,"div",4),n.hc(6,"div",5),n.lc(),n.lc(),n.jc()),2&e&&(n.Tb(1),n.Bc("ngIf",t.error))},directives:[o.q],styles:[".op-ckeditor--mode-switch[_ngcontent-%COMP%]{text-align:right}.op-ckeditor--mode-switch[_ngcontent-%COMP%]   button.button[_ngcontent-%COMP%]{margin:0 0 5px}"]})},kTg4:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("wZYP"),s=i("Jui0"),a=i("sjKJ"),r=i("iB+3"),c=i("vK8y"),o=i("fXoL");class l{constructor(e,t,i,n,s){this.I18n=e,this.$state=t,this.CurrentProject=i,this.PathHelper=n,this.CurrentUserService=s,this.text={assignee:this.I18n.t("js.work_packages.properties.assignee"),author:this.I18n.t("js.work_packages.properties.author"),created_at:this.I18n.t("js.work_packages.properties.createdAt"),updated_at:this.I18n.t("js.work_packages.properties.updatedAt"),status:this.I18n.t("js.work_packages.properties.status"),work_packages:this.I18n.t("js.label_work_package_plural"),gantt:this.I18n.t("js.timelines.gantt_chart"),latest_activity:this.I18n.t("js.work_packages.default_queries.latest_activity"),created_by_me:this.I18n.t("js.work_packages.default_queries.created_by_me"),assigned_to_me:this.I18n.t("js.work_packages.default_queries.assigned_to_me"),recently_created:this.I18n.t("js.work_packages.default_queries.recently_created"),all_open:this.I18n.t("js.work_packages.default_queries.all_open"),summary:this.I18n.t("js.work_packages.default_queries.summary")}}get all(){let e=[{identifier:"all_open",label:this.text.all_open,query_props:null},{identifier:"latest_activity",label:this.text.latest_activity,query_props:'{"c":["id","subject","type","status","assignee","updatedAt"],"hi":false,"g":"","t":"updatedAt:desc","f":[{"n":"status","o":"o","v":[]}]}'},{identifier:"gantt",label:this.text.gantt,query_props:'{"c":["id","subject","startDate","dueDate"],"tv":true,"tzl":"years","hi":true,"g":"","t":"id:asc","t":"startDate:asc","f":[{"n":"status","o":"o","v":[]}]}'},{identifier:"recently_created",label:this.text.recently_created,query_props:'{"c":["id","subject","type","status","assignee","createdAt"],"hi":false,"g":"","t":"createdAt:desc","f":[{"n":"status","o":"o","v":[]}]}'}];const t=this.CurrentProject.identifier;return t&&e.push({identifier:"summary",label:this.text.summary,static_link:this.PathHelper.projectWorkPackagesPath(t)+"/report"}),this.CurrentUserService.isLoggedIn&&(e=e.concat([{identifier:"created_by_me",label:this.text.created_by_me,query_props:'{"c":["id","subject","type","status","assignee","updatedAt"],"hi":false,"g":"","t":"updatedAt:desc,id:asc","f":[{"n":"status","o":"o","v":[]},{"n":"author","o":"=","v":["me"]}]}'},{identifier:"assigned_to_me",label:this.text.assigned_to_me,query_props:'{"c":["id","subject","type","status","author","updatedAt"],"hi":false,"g":"","t":"updatedAt:desc,id:asc","f":[{"n":"status","o":"o","v":[]},{"n":"assigneeOrGroup","o":"=","v":["me"]}]}'}])),e}getStaticName(e){if(this.$state.params.query_props){let e=JSON.parse(this.$state.params.query_props);delete e.pp,delete e.pa;const t=_.find(this.all,t=>t.query_props&&t.query_props===JSON.stringify(e));if(t)return t.label}return 1===e.filters.length&&"status"===e.filters[0].id&&"o"===e.filters[0].operator.id?this.text.all_open:this.text.work_packages}}l.\u0275fac=function(e){return new(e||l)(o.qc(n.a),o.qc(r.G),o.qc(a.a),o.qc(s.a),o.qc(c.a))},l.\u0275prov=o.cc({token:l,factory:l.\u0275fac})},kTsZ:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("mrSG"),s=i("tk/3"),a=i("vLqr"),r=i("lJxs"),c=i("JIr8"),o=i("Mo6U"),l=i("BtrP"),d=i("PZVJ"),u=i("Ng29"),h=i("16wW"),p=i("qHU1"),g=i("fXoL");class m{constructor(e,t){this.injector=e,this.http=t,this.config={}}request(e,t,i,n={}){if("get"===e)return this.get(t,i,n);const s={body:i||{},headers:n,withCredentials:!0,responseType:"json"};return this._request(e,t,s)}_request(e,t,i){return this.http.request(e,t,i).pipe(Object(r.a)(e=>this.createHalResource(e)),Object(c.a)(i=>{Object(p.c)(()=>console.error(`Failed to ${e} ${t}: ${i.name}`));const n=this.createHalResource(i.error);return n.httpError=i,Object(a.throwError)(n)}))}get(e,t,i){const n={headers:i,params:new s.f({encoder:new u.a,fromObject:t}),withCredentials:!0,responseType:"json"};return this._request("get",e,n)}getAllPaginated(e,t,i={},s={}){return Object(n.b)(this,void 0,void 0,(function*(){let n=0,a=1;const r=[];for(i.pageSize=t;n<t;){i.offset=a;const t=this.request("get",e,this.toEprops(i),s).toPromise(),c=yield t;if(0===c.count)throw"No more results for this query, but expected more.";r.push(c),n+=c.count,a+=1}return r}))}put(e,t,i){return this.request("put",e,t,i)}post(e,t,i){return this.request("post",e,t,i)}patch(e,t,i){return this.request("patch",e,t,i)}delete(e,t,i){return this.request("delete",e,t,i)}registerResource(e,t){this.config[e]=t}get defaultClass(){return o.a}createHalResource(e,t=!0){_.isNil(e)&&(e=o.a.getEmptyResource());const i=e._type||"HalResource";return this.createHalResourceOfType(i,e,t)}createHalResourceOfType(e,t,i=!1){return new(this.getResourceClassOfType(e))(this.injector,t,i,e=>Object(d.b)(this,e),e)}createHalResourceOfClass(e,t,i=!1){const n=t._type||"HalResource";return new e(this.injector,t,i,e=>Object(d.b)(this,e),n)}fromLink(e){const t=o.a.getEmptyResource(l.a.fromObject(this,e));return this.createHalResource(t,!1)}fromSelfLink(e){const t={_links:{self:{href:e}}};return this.createHalResource(t)}createLinkedResource(e,t,i){const n=o.a.getEmptyResource(),s=e.$halType,a=this.getResourceClassOfAttribute(s,t)||"HalResource";return n._links.self=i,this.createHalResourceOfType(a,n,!1)}getResourceClassOfType(e){const t=this.config[e];return t&&t.cls?t.cls:this.defaultClass}getResourceClassOfAttribute(e,t){const i=this.config[e];return(i&&i.attrTypes||{})[t]}toEprops(e){let t=h.deflate(JSON.stringify(e),{to:"string"});return{eprops:btoa(t)}}}m.\u0275fac=function(e){return new(e||m)(g.qc(g.A),g.qc(s.b))},m.\u0275prov=g.cc({token:m,factory:m.\u0275fac,providedIn:"root"})},"kY/U":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));i("ii2/");var n=i("ug4p"),s=i("kTsZ"),a=(i("RWlv"),i("mMv8")),r=i("SKFm"),c=i("dMmB"),o=i("/C7M"),l=i("qc15"),d=i("fXoL");class u{constructor(e,t,i,n,s,a,r){this.halResourceService=e,this.wpCacheService=t,this.wpSchemaCacheService=i,this.wpActivity=n,this.notificationService=s,this.halEditing=a,this.halEvents=r}fetchAction(){this.halResourceService.get(this.action.href).toPromise().then(e=>{this.action=e})}update(){let e={lockVersion:this.workPackage.lockVersion,_links:{workPackage:{href:this.workPackage.href}}};this.halResourceService.post(this.action.href+"/execute",e).toPromise().then(e=>{this.notificationService.showSave(e,!1),this.workPackage=e,this.wpActivity.clear(this.workPackage.id),this.wpSchemaCacheService.ensureLoaded(e).then(()=>{this.wpCacheService.updateWorkPackage(e,!0),this.halEditing.stopEditing(e),this.halEvents.push(e,{eventType:"updated"})})}).catch(e=>{this.notificationService.handleRawError(e,this.workPackage)})}onMouseEnter(){this.fetchAction()}}u.\u0275fac=function(e){return new(e||u)(d.gc(s.a),d.gc(n.a),d.gc(c.a),d.gc(a.a),d.gc(l.a),d.gc(r.a),d.gc(o.a))},u.\u0275cmp=d.ac({type:u,selectors:[["wp-custom-action"]],hostBindings:function(e,t){1&e&&d.uc("mouseenter",(function(){return t.onMouseEnter()}))},inputs:{workPackage:"workPackage",action:"action"},decls:2,vars:2,consts:[[1,"custom-action--button","button","-narrow","hide-when-print",3,"title","click"]],template:function(e,t){1&e&&(d.mc(0,"button",0),d.uc("click",(function(){return t.update()})),d.ad(1),d.lc()),2&e&&(d.Cc("title",t.action.description?t.action.description:t.action.name),d.Tb(1),d.cd(" ",t.action.name,"\n"))},encapsulation:2})},kZPr:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("zOhy"),s=i("fXoL"),a=i("ofXK"),r=i("711n"),c=i("XZlt"),o=i("qvi4"),l=i("1zMF"),d=i("aveh"),u=i("2bW2");const h=function(){return["status","type"]};function p(e,t){if(1&e){const e=s.nc();s.mc(0,"div",1),s.mc(1,"edit-form",2),s.uc("onSaved",(function(t){return s.Qc(e),s.wc().onSaved(t)})),s.mc(2,"div",3),s.mc(3,"div",4),s.hc(4,"wp-type-status",5),s.lc(),s.mc(5,"ul",6),s.mc(6,"li",7),s.hc(7,"zen-mode-toggle-button"),s.lc(),s.mc(8,"li",7),s.mc(9,"button",8),s.hc(10,"i",9),s.lc(),s.lc(),s.lc(),s.lc(),s.hc(11,"wp-single-view",10),s.mc(12,"wp-edit-actions-bar",11),s.uc("onCancel",(function(){return s.Qc(e),s.wc().cancelAndBackToList()})),s.lc(),s.lc(),s.lc()}if(2&e){const e=s.wc();s.Tb(1),s.Bc("resource",e.newWorkPackage)("skippedFields",s.Fc(7,h))("inEditMode",!0),s.Tb(3),s.Bc("workPackage",e.newWorkPackage),s.Tb(5),s.Ub("title",e.text.button_settings),s.Tb(2),s.Bc("workPackage",e.newWorkPackage)("showProject",e.copying)}}class g extends n.a{constructor(){super(...arguments),this.successState="work-packages.show"}}g.\u0275fac=function(e){return m(e||g)},g.\u0275cmp=s.ac({type:g,selectors:[["wp-new-full-view"]],hostAttrs:[1,"work-packages-page--ui-view"],features:[s.Qb],decls:1,vars:1,consts:[["class","work-package--new-state work-packages--new work-packages--show-view toolbar-container",4,"ngIf"],[1,"work-package--new-state","work-packages--new","work-packages--show-view","toolbar-container"],[3,"resource","skippedFields","inEditMode","onSaved"],[1,"toolbar"],[1,"title-container"],[3,"workPackage"],[1,"toolbar-items","hide-when-print"],[1,"toolbar-item","hidden-for-mobile"],["id","create-wp-menu-button","wpCreateSettingsMenu","",1,"button","last","work-packages-settings-button","toolbar-icon"],[1,"button--icon","icon-show-more"],[3,"workPackage","showProject"],[3,"onCancel"]],template:function(e,t){1&e&&s.Yc(0,p,13,8,"div",0),2&e&&s.Bc("ngIf",t.newWorkPackage)},directives:[a.q,r.a,c.a,o.a,l.a,d.a,u.a],encapsulation:2,changeDetection:0});const m=s.oc(g)},kgyZ:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("XNiG"),s=i("AEvm");class a extends s.a{constructor(){super(...arguments),this.onDestroy=new n.a,this._onSubmitHandlers=[]}onSubmit(){return Promise.all(this._onSubmitHandlers.map(e=>e()))}registerOnSubmit(e){this._onSubmitHandlers.push(e)}previewContext(e){}}},kor4:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("fXoL"),s=i("E5Dd");class a{constructor(){this.stopEventPropagation=!0,this.onClick=new n.s}handleClick(e){"click"!==e.type&&e.which!==s.a.ENTER&&e.which!==s.a.SPACE||(this.stopEventPropagation&&(e.preventDefault(),e.stopPropagation()),this.onClick.emit(e))}}a.\u0275fac=function(e){return new(e||a)},a.\u0275dir=n.bc({type:a,selectors:[["","accessibleClick",""]],hostBindings:function(e,t){1&e&&n.uc("click",(function(e){return t.handleClick(e)}))("keydown",(function(e){return t.handleClick(e)}))},inputs:{stopEventPropagation:["accessibleClickStopEvent","stopEventPropagation"]},outputs:{onClick:"accessibleClick"}})},kt6C:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("8zkO"),s=i("fXoL");const a=6,r=1;class c{constructor(e){this.configuration=e,this.loadPaginationOptions()}getCachedPerPage(e){var t,i;const n=this.localStoragePerPage,s=(null===(t=e)||void 0===t?void 0:t.length)||0;return null!==n&&n>0&&(0===s||-1!==(null===(i=e)||void 0===i?void 0:i.indexOf(n)))?n:s>0?e[0]:20}get localStoragePerPage(){const e=window.OpenProject.guardedLocalStorage("pagination.perPage");return void 0!==e?parseInt(e,10):null}getPaginationOptions(){return this.paginationOptions}get isPerPageKnown(){return!(!this.localStoragePerPage&&!this.paginationOptions)}getPerPage(){return this.localStoragePerPage||this.paginationOptions.perPage}getMaxVisiblePageOptions(){return _.get(this.paginationOptions,"maxVisiblePageOptions",a)}getOptionsTruncationSize(){return _.get(this.paginationOptions,"optionsTruncationSize",r)}setPerPage(e){window.OpenProject.guardedLocalStorage("pagination.perPage",e.toString()),this.paginationOptions.perPage=e}getPerPageOptions(){return this.paginationOptions.perPageOptions}setPerPageOptions(e){this.paginationOptions.perPageOptions=e}loadPaginationOptions(){return this.configuration.initialized.then(()=>(this.paginationOptions={perPage:this.getCachedPerPage(this.configuration.perPageOptions),perPageOptions:this.configuration.perPageOptions,maxVisiblePageOptions:a,optionsTruncationSize:r},this.paginationOptions))}}c.\u0275fac=function(e){return new(e||c)(s.qc(n.a))},c.\u0275prov=s.cc({token:c,factory:c.\u0275fac})},l08T:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("FnNU"),s=i("1G5W"),a=i("fXoL");class r{constructor(){this.state=Object(n.f)(!1)}get visible(){return this.state.getValueOr(!1)}set visible(e){this.state.putValue(e)}observeUntil(e){return this.state.values$().pipe(Object(s.a)(e))}toggleVisibility(){this.state.doModify(e=>!e)}}r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac})},"l4W+":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("kTsZ"),s=i("OGNV"),a=i("fXoL");class r{constructor(e,t){this.halResourceService=e,this.queryFormDm=t}restoreQuery(e,t){let i=this.queryFormDm.buildQueryResource(t);this.restoreFilters(e,i,t.schema),this.restoreColumns(e,i,t.schema),this.restoreSortBy(e,i,t.schema),this.restoreGroupBy(e,i,t.schema),this.restoreOtherProperties(e,i)}restoreFilters(e,t,i){let n=_.map(t.filters,e=>{let t=_.find(i.filtersSchemas.elements,t=>t.filter.allowedValues[0].$href===e.filter.$href);if(!t)return null;let n=t.getFilter(),s=_.find(t.operator.allowedValues,t=>t.$href===e.operator.$href);return s&&(n.operator=s),n.values.length=0,_.each(e.values,e=>n.values.push(e)),n});n=_.compact(n),e.filters.length=0,_.each(n,t=>e.filters.push(t))}restoreColumns(e,t,i){let n=_.map(t.columns,e=>_.find(i.columns.allowedValues,t=>t.$href===e.$href));n=_.compact(n),e.columns.length=0,_.each(n,t=>e.columns.push(t))}restoreSortBy(e,t,i){let n=_.map(t.sortBy,e=>_.find(i.sortBy.allowedValues,t=>t.$href===e.$href));n=_.compact(n),e.sortBy.length=0,_.each(n,t=>e.sortBy.push(t))}restoreGroupBy(e,t,i){let n=_.find(i.groupBy.allowedValues,e=>t.groupBy&&t.groupBy.$href===e.$href);e.groupBy=n}restoreOtherProperties(e,t){_.without(Object.keys(t.$source),"_links","filters").forEach(i=>{e[i]=t[i]}),_.without(Object.keys(t.$source._links),"columns","groupBy","sortBy").forEach(i=>{e[i]=t[i]})}}r.\u0275fac=function(e){return new(e||r)(a.qc(n.a),a.qc(s.a))},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac})},lJGx:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));i("ii2/");var n=i("fXoL"),s=i("ofXK"),a=i("kY/U");function r(e,t){if(1&e&&n.hc(0,"wp-custom-action",1),2&e){const e=t.$implicit,i=n.wc();n.Bc("workPackage",i.workPackage)("action",e)}}class c{get actions(){return this.workPackage.customActions}}c.\u0275fac=function(e){return new(e||c)},c.\u0275cmp=n.ac({type:c,selectors:[["wp-custom-actions"]],inputs:{workPackage:"workPackage"},decls:1,vars:1,consts:[["class","custom-action",3,"workPackage","action",4,"ngFor","ngForOf"],[1,"custom-action",3,"workPackage","action"]],template:function(e,t){1&e&&n.Yc(0,r,1,2,"wp-custom-action",0),2&e&&n.Bc("ngForOf",t.actions)},directives:[s.p,a.a],encapsulation:2})},lJrL:function(e,t,i){"use strict";function n(...e){let t=document.createElement("i");return t.setAttribute("aria-hidden","true"),t.classList.add(...e),t}i.d(t,"a",(function(){return n}))},lfQJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("0lDN"),s=i("fXoL"),a=i("ofXK"),r=i("kor4"),c=i("N5AO");function o(e,t){1&e&&s.hc(0,"li",5)}function l(e,t){if(1&e&&s.hc(0,"op-icon",10),2&e){const e=s.wc(2).$implicit;s.Dc("icon-classes","icon-action-menu ",e.icon,"")}}function d(e,t){if(1&e&&s.hc(0,"op-icon",11),2&e){const e=s.wc(2).$implicit;s.Dc("icon-classes","icon-action-menu-post ",e.postIcon,""),s.Bc("icon-title",e.postIconTitle||"")}}const u=function(e){return{inactive:e}};function h(e,t){if(1&e){const e=s.nc();s.mc(0,"li"),s.mc(1,"a",6),s.uc("accessibleClick",(function(t){s.Qc(e);const i=s.wc().$implicit;return s.wc().handleClick(i,t)})),s.Yc(2,l,1,1,"op-icon",7),s.hc(3,"span",8),s.Yc(4,d,1,2,"op-icon",9),s.lc(),s.lc()}if(2&e){const e=s.wc().$implicit;s.Tb(1),s.Vb("menu-item ",e.class,""),s.Bc("ngClass",s.Gc(11,u,e.disabled))("accessibleClickStopEvent",!1),s.Ub("href",e.href||"",s.Tc)("aria-disabled",e.disabled)("aria-label",e.ariaLabel||e.linkText),s.Tb(1),s.Bc("ngIf",e.icon),s.Tb(1),s.Bc("textContent",e.linkText),s.Tb(1),s.Bc("ngIf",e.postIcon)}}function p(e,t){if(1&e&&(s.kc(0),s.Yc(1,o,1,0,"li",3),s.Yc(2,h,5,13,"li",4),s.jc()),2&e){const e=t.$implicit;s.Tb(1),s.Bc("ngIf",e.divider&&!e.hidden),s.Tb(1),s.Bc("ngIf",!e.divider&&!e.hidden)}}const g=function(e){return{"-empty":e}};class m{constructor(e){this.locals=e,this.items=this.locals.items,this.service=this.locals.service}handleClick(e,t){return!e.disabled&&!e.divider&&(!e.onClick(t)||(this.locals.service.close(),t.preventDefault(),t.stopPropagation(),!1))}}m.\u0275fac=function(e){return new(e||m)(s.gc(n.a))},m.\u0275cmp=s.ac({type:m,selectors:[["ng-component"]],decls:3,vars:5,consts:[["ng-class","{'dropdown-anchor-right': locals.showAnchorRight}",1,"dropdown-relative","dropdown","-overflow-in-view"],["role","menu",1,"dropdown-menu",3,"ngClass"],[4,"ngFor","ngForOf"],["class","dropdown-divider",4,"ngIf"],[4,"ngIf"],[1,"dropdown-divider"],["tabindex","0",3,"ngClass","accessibleClickStopEvent","accessibleClick"],[3,"icon-classes",4,"ngIf"],[3,"textContent"],[3,"icon-title","icon-classes",4,"ngIf"],[3,"icon-classes"],[3,"icon-title","icon-classes"]],template:function(e,t){1&e&&(s.mc(0,"div",0),s.mc(1,"ul",1),s.Yc(2,p,3,2,"ng-container",2),s.lc(),s.lc()),2&e&&(s.Ub("id",t.locals.contextMenuId),s.Tb(1),s.Bc("ngClass",s.Gc(3,g,0===t.items.length)),s.Tb(1),s.Bc("ngForOf",t.items))},directives:[a.n,a.p,a.q,r.a,c.a],encapsulation:2})},lfyH:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("mrSG"),s=i("r0MM"),a=i("iB+3"),r=i("fXoL");class c{constructor(e){this.injector=e}get routeWithViewer(){return this.state.includes("bim.partitioned.split")}}c.\u0275fac=function(e){return new(e||c)(r.qc(r.A))},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac}),Object(n.c)([Object(s.a)(),Object(n.e)("design:type",a.G)],c.prototype,"state",void 0)},lmDM:function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var n=i("mRSd"),s=i("wZYP"),a=i("kt6C"),r=i("Zq3F"),c=i("6yP5"),o=i("E2tj"),l=i("itXk"),d=i("fXoL"),u=i("ofXK"),h=i("kor4"),p=i("N5AO");function g(e,t){if(1&e){const e=d.nc();d.mc(0,"li",15),d.mc(1,"a",16),d.uc("accessibleClick",(function(){d.Qc(e);const i=t.$implicit;return d.wc(3).showPage(i)})),d.lc(),d.lc()}if(2&e){const e=t.$implicit;d.Tb(1),d.Bc("textContent",e)}}function m(e,t){if(1&e&&(d.kc(0),d.Yc(1,g,2,1,"li",13),d.mc(2,"li",14),d.ad(3,"\u2026"),d.lc(),d.jc()),2&e){const e=d.wc(2);d.Tb(1),d.Bc("ngForOf",e.prePageNumbers)}}function f(e,t){if(1&e&&(d.mc(0,"em"),d.ad(1),d.lc()),2&e){const e=d.wc().$implicit;d.Tb(1),d.bd(e)}}function b(e,t){if(1&e){const e=d.nc();d.mc(0,"a",16),d.uc("accessibleClick",(function(){d.Qc(e);const t=d.wc().$implicit;return d.wc(3).showPage(t)})),d.lc()}if(2&e){const e=d.wc().$implicit;d.Bc("textContent",e)}}const w=function(e){return{"-current":e}};function v(e,t){if(1&e&&(d.mc(0,"li",19),d.Yc(1,f,2,1,"em",6),d.Yc(2,b,1,1,"a",20),d.lc()),2&e){const e=t.$implicit,i=d.wc(3);d.Bc("ngClass",d.Gc(3,w,e==i.pagination.page)),d.Tb(1),d.Bc("ngIf",e==i.pagination.page),d.Tb(1),d.Bc("ngIf",e!=i.pagination.page)}}function y(e,t){1&e&&(d.mc(0,"li",14),d.ad(1,"\u2026"),d.lc())}function k(e,t){if(1&e&&(d.kc(0),d.Yc(1,v,3,5,"li",17),d.Yc(2,y,2,0,"li",18),d.jc()),2&e){const e=d.wc(2);d.Tb(1),d.Bc("ngForOf",e.pageNumbers),d.Tb(1),d.Bc("ngIf",e.postPageNumbers.length)}}function C(e,t){if(1&e){const e=d.nc();d.mc(0,"li",22),d.mc(1,"a",16),d.uc("accessibleClick",(function(){d.Qc(e);const i=t.$implicit;return d.wc(3).showPage(i)})),d.lc(),d.lc()}if(2&e){const e=t.$implicit;d.Tb(1),d.Bc("textContent",e)}}function j(e,t){if(1&e&&(d.kc(0),d.Yc(1,C,2,1,"li",21),d.jc()),2&e){const e=d.wc(2);d.Tb(1),d.Bc("ngForOf",e.postPageNumbers)}}function x(e,t){if(1&e&&d.hc(0,"span",23),2&e){const e=d.wc(2);d.Bc("textContent",e.text.no_other_page)}}function T(e,t){if(1&e&&(d.mc(0,"li",24),d.hc(1,"op-icon",25),d.hc(2,"span",9),d.lc()),2&e){const e=d.wc(2);d.Tb(2),d.Bc("textContent",e.infoText)}}function S(e,t){if(1&e){const e=d.nc();d.mc(0,"span"),d.mc(1,"a",30),d.uc("accessibleClick",(function(){d.Qc(e);const t=d.wc().$implicit;return d.wc(3).selectPerPage(t)})),d.lc(),d.lc()}if(2&e){const e=d.wc().$implicit;d.Tb(1),d.Bc("textContent",e)}}function _(e,t){if(1&e&&(d.mc(0,"span"),d.ad(1),d.lc()),2&e){const e=d.wc().$implicit;d.Tb(1),d.bd(e)}}function P(e,t){if(1&e&&(d.mc(0,"li",29),d.Yc(1,S,2,1,"span",6),d.Yc(2,_,2,1,"span",6),d.lc()),2&e){const e=t.$implicit,i=d.wc(3);d.Bc("ngClass",d.Gc(3,w,e==i.pagination.perPage)),d.Tb(1),d.Bc("ngIf",e!=i.pagination.perPage),d.Tb(1),d.Bc("ngIf",e==i.pagination.perPage)}}function I(e,t){if(1&e&&(d.mc(0,"div",26),d.mc(1,"ul",3),d.hc(2,"li",27),d.Yc(3,P,3,5,"li",28),d.lc(),d.lc()),2&e){const e=d.wc(2);d.Tb(2),d.Cc("title",e.text.per_page),d.Bc("textContent",e.text.per_page),d.Tb(1),d.Bc("ngForOf",e.perPageOptions)}}function O(e,t){if(1&e){const e=d.nc();d.mc(0,"div",1),d.mc(1,"nav",2),d.mc(2,"ul",3),d.mc(3,"li",4),d.mc(4,"a",5),d.uc("accessibleClick",(function(){d.Qc(e);const t=d.wc();return t.showPage(t.pagination.page-1)})),d.ad(5,"<"),d.lc(),d.lc(),d.Yc(6,m,4,1,"ng-container",6),d.Yc(7,k,3,2,"ng-container",6),d.Yc(8,j,2,1,"ng-container",6),d.mc(9,"li",4),d.mc(10,"a",7),d.uc("accessibleClick",(function(){d.Qc(e);const t=d.wc();return t.showPage(t.pagination.page+1)})),d.ad(11,">"),d.lc(),d.lc(),d.mc(12,"li",8),d.hc(13,"span",9),d.Yc(14,x,1,1,"span",10),d.lc(),d.Yc(15,T,3,1,"li",11),d.lc(),d.lc(),d.Yc(16,I,4,3,"div",12),d.lc()}if(2&e){const e=d.wc();d.Tb(3),d.Bc("hidden",1==e.pagination.page||!e.showPageSelections),d.Tb(1),d.Ub("aria-label",e.text.label_previous),d.Tb(2),d.Bc("ngIf",e.prePageNumbers.length>0),d.Tb(1),d.Bc("ngIf",e.pageNumbers.length>1),d.Tb(1),d.Bc("ngIf",e.postPageNumbers.length),d.Tb(1),d.Bc("hidden",!(e.pagination.total&&e.pagination.page<e.pageNumbers[e.pageNumbers.length-1])),d.Tb(1),d.Ub("aria-label",e.text.label_next),d.Tb(3),d.Bc("textContent",e.currentRange),d.Tb(1),d.Bc("ngIf",1===e.pageNumbers.length),d.Tb(1),d.Bc("ngIf",e.infoText),d.Tb(1),d.Bc("ngIf",e.showPerPageOptions())}}class R extends n.a{constructor(e,t,i,n,s,a){super(e,t,a),this.paginationService=e,this.cdRef=t,this.wpTablePagination=i,this.querySpace=n,this.wpTableSortBy=s,this.I18n=a}ngOnInit(){this.paginationService.loadPaginationOptions().then(e=>{this.perPageOptions=e.perPageOptions,this.cdRef.detectChanges()}),this.wpTablePagination.live$().pipe(this.untilDestroyed()).subscribe(e=>{this.pagination=e.current,this.update()}),Object(l.a)([this.querySpace.query.values$(),this.wpTableSortBy.live$()]).pipe(this.untilDestroyed()).subscribe(([e,t])=>{this.showPerPage=this.showPageSelections=!this.isManualSortingMode,this.infoText=this.paginationInfoText(e.results),this.update()})}selectPerPage(e){this.paginationService.setPerPage(e),this.wpTablePagination.updateFromObject({page:1,perPage:e})}showPage(e){this.wpTablePagination.updateFromObject({page:e})}get isManualSortingMode(){return this.wpTableSortBy.isManualSortingMode}paginationInfoText(e){return this.isManualSortingMode&&e.count<e.total?I18n.t("js.work_packages.limited_results",{count:e.count}):void 0}}R.\u0275fac=function(e){return new(e||R)(d.gc(a.a),d.gc(d.i),d.gc(r.a),d.gc(o.a),d.gc(c.a),d.gc(s.a))},R.\u0275cmp=d.ac({type:R,selectors:[["wp-table-pagination"]],features:[d.Qb],decls:1,vars:1,consts:[["class","pagination",4,"ngIf"],[1,"pagination"],[1,"pagination--pages"],[1,"pagination--items"],[1,"pagination--item",3,"hidden"],["rel","prev start","id","pagination--prev-link","role","link","href","",3,"accessibleClick"],[4,"ngIf"],["rel","next","id","pagination--next-link","role","link","href","",1,"pagination--next-link",3,"accessibleClick"],[1,"pagination--range"],[3,"textContent"],["id","pagination-empty-text","tabindex","0","class","hidden-for-sighted",3,"textContent",4,"ngIf"],["class","pagination--info",4,"ngIf"],["class","pagination--options",4,"ngIf"],["class","pagination--item",4,"ngFor","ngForOf"],[1,"pagination--space"],[1,"pagination--item"],["rel","next","role","link","href","",3,"textContent","accessibleClick"],["class","pagination--item pagination-number",3,"ngClass",4,"ngFor","ngForOf"],["class","pagination--space",4,"ngIf"],[1,"pagination--item","pagination-number",3,"ngClass"],["rel","next","role","link","href","",3,"textContent","accessibleClick",4,"ngIf"],["class","pagination--item pagination-number",4,"ngFor","ngForOf"],[1,"pagination--item","pagination-number"],["id","pagination-empty-text","tabindex","0",1,"hidden-for-sighted",3,"textContent"],[1,"pagination--info"],["icon-classes","icon-info1 icon-context"],[1,"pagination--options"],[1,"pagination--label",3,"textContent","title"],["class","pagination--item",3,"ngClass",4,"ngFor","ngForOf"],[1,"pagination--item",3,"ngClass"],["role","link","href","",3,"textContent","accessibleClick"]],template:function(e,t){1&e&&d.Yc(0,O,17,11,"div",0),2&e&&d.Bc("ngIf",t.pagination&&t.isVisible&&t.pagination.total)},directives:[u.q,h.a,u.p,u.n,p.a],encapsulation:2,changeDetection:0})},lmKF:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("fXoL"),s=i("tk/3"),a=i("wZYP"),r=i("qHU1"),c=i("AEvm"),o=i("ofXK"),l=i("N5AO");function d(e,t){1&e&&n.hc(0,"op-icon",6)}function u(e,t){1&e&&n.hc(0,"op-icon",7)}function h(e,t){if(1&e&&(n.mc(0,"span",3),n.Yc(1,d,1,0,"op-icon",4),n.Yc(2,u,1,0,"op-icon",5),n.lc()),2&e){const e=n.wc();n.Tb(1),n.Bc("ngIf",e.error),n.Tb(1),n.Bc("ngIf",e.completed)}}class p extends c.a{constructor(e){super(),this.I18n=e,this.onError=new n.s,this.onSuccess=new n.s,this.value=0,this.error=!1,this.completed=!1}ngOnInit(){this.file=this.upload[0],this.upload[1].pipe(this.untilDestroyed()).subscribe(e=>{switch(e.type){case s.e.Sent:return this.value=5,Object(r.a)(`Uploading file "${this.file.name}" of size ${this.file.size}.`);case s.e.UploadProgress:return this.updateProgress(e);case s.e.Response:return Object(r.a)(`File ${this.fileName} was fully uploaded.`),this.value=100,this.completed=!0,this.onSuccess.emit();default:return}},e=>this.handleError(e))}get fileName(){return this.file&&this.file.name}updateProgress(e){e.total?this.value=Math.round(e.loaded/e.total*100):this.value=10}handleError(e){this.error=!0,this.onError.emit(e)}}p.\u0275fac=function(e){return new(e||p)(n.gc(a.a))},p.\u0275cmp=n.ac({type:p,selectors:[["notifications-upload-progress"]],inputs:{upload:"upload"},outputs:{onError:"onError",onSuccess:"onSuccess"},features:[n.Qb],decls:5,vars:5,consts:[[1,"filename",3,"textContent"],["max","100",3,"hidden","value"],["class","upload-completed",4,"ngIf"],[1,"upload-completed"],["icon-classes","icon-close",4,"ngIf"],["icon-classes","icon-checkmark",4,"ngIf"],["icon-classes","icon-close"],["icon-classes","icon-checkmark"]],template:function(e,t){1&e&&(n.mc(0,"li"),n.hc(1,"span",0),n.mc(2,"progress",1),n.ad(3),n.lc(),n.Yc(4,h,3,2,"span",2),n.lc()),2&e&&(n.Tb(1),n.Bc("textContent",t.fileName),n.Tb(1),n.Bc("hidden",t.completed)("value",t.value),n.Tb(1),n.cd("",t.value,"%"),n.Tb(1),n.Bc("ngIf",t.completed||t.error))},directives:[o.q,l.a],encapsulation:2})},m0WY:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("wZYP"),s=(i("ii2/"),i("1uah")),a=i("1G5W"),r=i("IzEk"),c=i("ug4p"),o=i("uSJ+"),l=i("AEvm"),d=i("Hg4z"),u=i("fXoL"),h=i("ofXK"),p=i("4fzr"),g=i("BV52"),m=i("60np");function f(e,t){if(1&e&&(u.mc(0,"div",5),u.mc(1,"div",6),u.mc(2,"div",7),u.hc(3,"h3",8),u.lc(),u.lc(),u.lc()),2&e){const e=u.wc();u.Tb(3),u.Bc("textContent",e.text.relations_header)}}function b(e,t){if(1&e){const e=u.nc();u.mc(0,"div"),u.mc(1,"wp-relations-group",9),u.uc("onToggleGroupBy",(function(){return u.Qc(e),u.wc().toggleGroupBy()})),u.lc(),u.lc()}if(2&e){const e=t.$implicit,i=t.first,n=u.wc();u.Tb(1),u.Bc("header",e)("groupByWorkPackageType",n.groupByWorkPackageType)("firstGroup",i)("relatedWorkPackages",n.relationGroups[e])("workPackage",n.workPackage)}}function w(e,t){if(1&e&&u.hc(0,"wp-relations-create",4),2&e){const e=u.wc();u.Bc("workPackage",e.workPackage)}}class v extends l.a{constructor(e,t,i,n){super(),this.I18n=e,this.wpRelations=t,this.cdRef=i,this.wpCacheService=n,this.relationGroups={},this.relationGroupKeys=[],this.relationsPresent=!1,this.groupByWorkPackageType=!1,this.text={relations_header:this.I18n.t("js.work_packages.tabs.relations")},this.currentRelations=[]}ngOnInit(){this.canAddRelation=!!this.workPackage.addRelation,this.wpRelations.state(this.workPackage.id).values$().pipe(Object(a.a)(Object(d.b)(this))).subscribe(e=>{this.loadedRelations(e)}),this.wpRelations.require(this.workPackage.id),this.wpCacheService.loadWorkPackage(this.workPackage.id).values$().pipe(Object(a.a)(Object(d.b)(this))).subscribe(e=>{this.workPackage=e})}getRelatedWorkPackages(e){let t=e.map(e=>this.wpCacheService.loadWorkPackage(e).values$());return Object(s.a)(...t)}getRelatedWorkPackageId(e){const t=e.ids;return e.to.href===this.workPackage.href?t.from:t.to}toggleGroupBy(){this.groupByWorkPackageType=!this.groupByWorkPackageType,this.buildRelationGroups()}buildRelationGroups(){_.isNil(this.currentRelations)||(this.relationGroups=_.groupBy(this.currentRelations,e=>{if(this.groupByWorkPackageType)return e.type.name;var t=e.relatedBy.normalizedType(this.workPackage);return this.I18n.t("js.relation_labels."+t)}),this.relationGroupKeys=_.keys(this.relationGroups),this.relationsPresent=_.size(this.relationGroups)>0,this.cdRef.detectChanges())}loadedRelations(e){var t=[],i=[];if(0===_.size(e))return this.currentRelations=[],this.buildRelationGroups();_.each(e,e=>{const n=this.getRelatedWorkPackageId(e);t.push(n),i[n]=e}),this.getRelatedWorkPackages(t).pipe(Object(r.a)(1)).subscribe(e=>{this.currentRelations=e.map(e=>(e.relatedBy=i[e.id],e)),this.buildRelationGroups()})}}v.\u0275fac=function(e){return new(e||v)(u.gc(n.a),u.gc(o.a),u.gc(u.i),u.gc(c.a))},v.\u0275cmp=u.ac({type:v,selectors:[["wp-relations"]],inputs:{workPackage:"workPackage"},features:[u.Qb],decls:5,vars:4,consts:[["data-indicator-name","relation-groups",1,"loading-indicator--location"],["class","wp-relations-hierarchy-section",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"workPackage",4,"ngIf"],[3,"workPackage"],[1,"wp-relations-hierarchy-section"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],[3,"header","groupByWorkPackageType","firstGroup","relatedWorkPackages","workPackage","onToggleGroupBy"]],template:function(e,t){1&e&&(u.mc(0,"div",0),u.Yc(1,f,4,1,"div",1),u.Yc(2,b,2,5,"div",2),u.Yc(3,w,1,1,"wp-relations-create",3),u.hc(4,"wp-relations-hierarchy",4),u.lc()),2&e&&(u.Tb(1),u.Bc("ngIf",!t.relationsPresent),u.Tb(1),u.Bc("ngForOf",t.relationGroupKeys),u.Tb(1),u.Bc("ngIf",t.canAddRelation),u.Tb(1),u.Bc("workPackage",t.workPackage))},directives:[h.q,h.p,p.a,g.a,m.a],encapsulation:2,changeDetection:0})},m3nR:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("SKFm"),s=i("wZYP"),a=(i("ii2/"),i("fXoL")),r=i("8+xT"),c=i("P7xQ"),o=i("N5AO");class l{constructor(e,t){this.I18n=e,this.halEditing=t,this.text={button_more:this.I18n.t("js.button_more")}}}l.\u0275fac=function(e){return new(e||l)(a.gc(s.a),a.gc(n.a))},l.\u0275cmp=a.ac({type:l,selectors:[["wp-details-toolbar"]],inputs:{workPackage:"workPackage"},decls:5,vars:5,consts:[[1,"work-packages--details-toolbar"],[3,"workPackage","showText"],["wpSingleContextMenu","",1,"button","dropdown-relative",3,"wpSingleContextMenu-workPackage"],[1,"button--text",3,"textContent"],["icon-classes","button--dropdown-indicator"]],template:function(e,t){1&e&&(a.mc(0,"div",0),a.hc(1,"wp-watcher-button",1),a.mc(2,"button",2),a.hc(3,"span",3),a.hc(4,"op-icon",4),a.lc(),a.lc()),2&e&&(a.Tb(1),a.Bc("workPackage",t.workPackage)("showText",!0),a.Tb(1),a.Bc("wpSingleContextMenu-workPackage",t.workPackage),a.Ub("accesskey",7),a.Tb(1),a.Bc("textContent",t.text.button_more))},directives:[r.a,c.a,o.a],encapsulation:2})},mMv8:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));class n{constructor(e,t,i,n,s){this.timezoneService=e,this.isReversed=t,this.activities=i,this.activity=n,this.index=s}number(e=!1){return this.orderedIndex(this.index,e)}get date(){return this.activityDate(this.activity)}get dateOfPrevious(){if(this.index>0)return this.activityDate(this.activities[this.index-1])}get href(){return this.activity.href}get version(){return this.activity.version}get isNextDate(){return this.date!==this.dateOfPrevious}isInitial(e=!1){var t=this.number(e);if(0!==this.activity._type.indexOf("Activity"))return!1;if(1===t)return!0;for(;--t>0;){var i=this.orderedIndex(t,e)-1,n=this.activities[i];if(!_.isNil(n)&&0===n._type.indexOf("Activity"))return!1}return!0}activityDate(e){return moment(e.createdAt).format("LL")}orderedIndex(e,t=!1){return t||this.isReversed?this.activities.length-e:e+1}}var s=i("8zkO"),a=i("hgso"),r=i("juWA"),c=i("fXoL");class o extends a.a{constructor(e,t){super(),this.ConfigurationService=e,this.timezoneService=t}get order(){return this.isReversed?"desc":"asc"}get isReversed(){return this.ConfigurationService.commentsSortedInDescendingOrder()}load(e){var t=[],i=[],n=function(e){t.push(e.elements)};return i.push(e.activities.$update().then(n)),e.revisions&&i.push(e.revisions.$update().then(n)),Promise.all(i).then(()=>this.sortedActivityList(t))}sortedActivityList(e,t="createdAt"){let i=_.sortBy(_.flatten(e),t);return this.isReversed?i.reverse():i}info(e,t,i){return new n(this.timezoneService,this.isReversed,e,t,i)}}o.\u0275fac=function(e){return new(e||o)(c.qc(s.a),c.qc(r.a))},o.\u0275prov=c.cc({token:o,factory:o.\u0275fac})},mRSd:function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));var n=i("kt6C"),s=i("U/vl"),a=i("fXoL"),r=i("wZYP"),c=i("AEvm"),o=i("ofXK"),l=i("kor4"),d=i("N5AO");function u(e,t){if(1&e){const e=a.nc();a.mc(0,"li",15),a.mc(1,"a",16),a.uc("accessibleClick",(function(){a.Qc(e);const i=t.$implicit;return a.wc(3).showPage(i)})),a.lc(),a.lc()}if(2&e){const e=t.$implicit;a.Tb(1),a.Bc("textContent",e)}}function h(e,t){if(1&e&&(a.kc(0),a.Yc(1,u,2,1,"li",13),a.mc(2,"li",14),a.ad(3,"\u2026"),a.lc(),a.jc()),2&e){const e=a.wc(2);a.Tb(1),a.Bc("ngForOf",e.prePageNumbers)}}function p(e,t){if(1&e&&(a.mc(0,"em"),a.ad(1),a.lc()),2&e){const e=a.wc().$implicit;a.Tb(1),a.bd(e)}}function g(e,t){if(1&e){const e=a.nc();a.mc(0,"a",16),a.uc("accessibleClick",(function(){a.Qc(e);const t=a.wc().$implicit;return a.wc(3).showPage(t)})),a.lc()}if(2&e){const e=a.wc().$implicit;a.Bc("textContent",e)}}const m=function(e){return{"-current":e}};function f(e,t){if(1&e&&(a.mc(0,"li",19),a.Yc(1,p,2,1,"em",6),a.Yc(2,g,1,1,"a",20),a.lc()),2&e){const e=t.$implicit,i=a.wc(3);a.Bc("ngClass",a.Gc(3,m,e==i.pagination.page)),a.Tb(1),a.Bc("ngIf",e==i.pagination.page),a.Tb(1),a.Bc("ngIf",e!=i.pagination.page)}}function b(e,t){1&e&&(a.mc(0,"li",14),a.ad(1,"\u2026"),a.lc())}function w(e,t){if(1&e&&(a.kc(0),a.Yc(1,f,3,5,"li",17),a.Yc(2,b,2,0,"li",18),a.jc()),2&e){const e=a.wc(2);a.Tb(1),a.Bc("ngForOf",e.pageNumbers),a.Tb(1),a.Bc("ngIf",e.postPageNumbers.length)}}function v(e,t){if(1&e){const e=a.nc();a.mc(0,"li",22),a.mc(1,"a",16),a.uc("accessibleClick",(function(){a.Qc(e);const i=t.$implicit;return a.wc(3).showPage(i)})),a.lc(),a.lc()}if(2&e){const e=t.$implicit;a.Tb(1),a.Bc("textContent",e)}}function y(e,t){if(1&e&&(a.kc(0),a.Yc(1,v,2,1,"li",21),a.jc()),2&e){const e=a.wc(2);a.Tb(1),a.Bc("ngForOf",e.postPageNumbers)}}function k(e,t){if(1&e&&a.hc(0,"span",23),2&e){const e=a.wc(2);a.Bc("textContent",e.text.no_other_page)}}function C(e,t){if(1&e&&(a.mc(0,"li",24),a.hc(1,"op-icon",25),a.hc(2,"span",9),a.lc()),2&e){const e=a.wc(2);a.Tb(2),a.Bc("textContent",e.infoText)}}function j(e,t){if(1&e){const e=a.nc();a.mc(0,"span"),a.mc(1,"a",30),a.uc("accessibleClick",(function(){a.Qc(e);const t=a.wc().$implicit;return a.wc(3).selectPerPage(t)})),a.lc(),a.lc()}if(2&e){const e=a.wc().$implicit;a.Tb(1),a.Bc("textContent",e)}}function x(e,t){if(1&e&&(a.mc(0,"span"),a.ad(1),a.lc()),2&e){const e=a.wc().$implicit;a.Tb(1),a.bd(e)}}function T(e,t){if(1&e&&(a.mc(0,"li",29),a.Yc(1,j,2,1,"span",6),a.Yc(2,x,2,1,"span",6),a.lc()),2&e){const e=t.$implicit,i=a.wc(3);a.Bc("ngClass",a.Gc(3,m,e==i.pagination.perPage)),a.Tb(1),a.Bc("ngIf",e!=i.pagination.perPage),a.Tb(1),a.Bc("ngIf",e==i.pagination.perPage)}}function S(e,t){if(1&e&&(a.mc(0,"div",26),a.mc(1,"ul",3),a.hc(2,"li",27),a.Yc(3,T,3,5,"li",28),a.lc(),a.lc()),2&e){const e=a.wc(2);a.Tb(2),a.Cc("title",e.text.per_page),a.Bc("textContent",e.text.per_page),a.Tb(1),a.Bc("ngForOf",e.perPageOptions)}}function _(e,t){if(1&e){const e=a.nc();a.mc(0,"div",1),a.mc(1,"nav",2),a.mc(2,"ul",3),a.mc(3,"li",4),a.mc(4,"a",5),a.uc("accessibleClick",(function(){a.Qc(e);const t=a.wc();return t.showPage(t.pagination.page-1)})),a.ad(5,"<"),a.lc(),a.lc(),a.Yc(6,h,4,1,"ng-container",6),a.Yc(7,w,3,2,"ng-container",6),a.Yc(8,y,2,1,"ng-container",6),a.mc(9,"li",4),a.mc(10,"a",7),a.uc("accessibleClick",(function(){a.Qc(e);const t=a.wc();return t.showPage(t.pagination.page+1)})),a.ad(11,">"),a.lc(),a.lc(),a.mc(12,"li",8),a.hc(13,"span",9),a.Yc(14,k,1,1,"span",10),a.lc(),a.Yc(15,C,3,1,"li",11),a.lc(),a.lc(),a.Yc(16,S,4,3,"div",12),a.lc()}if(2&e){const e=a.wc();a.Tb(3),a.Bc("hidden",1==e.pagination.page||!e.showPageSelections),a.Tb(1),a.Ub("aria-label",e.text.label_previous),a.Tb(2),a.Bc("ngIf",e.prePageNumbers.length>0),a.Tb(1),a.Bc("ngIf",e.pageNumbers.length>1),a.Tb(1),a.Bc("ngIf",e.postPageNumbers.length),a.Tb(1),a.Bc("hidden",!(e.pagination.total&&e.pagination.page<e.pageNumbers[e.pageNumbers.length-1])),a.Tb(1),a.Ub("aria-label",e.text.label_next),a.Tb(3),a.Bc("textContent",e.currentRange),a.Tb(1),a.Bc("ngIf",1===e.pageNumbers.length),a.Tb(1),a.Bc("ngIf",e.infoText),a.Tb(1),a.Bc("ngIf",e.showPerPageOptions())}}class P extends c.a{constructor(e,t,i){super(),this.paginationService=e,this.cdRef=t,this.I18n=i,this.hideForSinglePageResults=!1,this.showPerPage=!0,this.showPageSelections=!0,this.updateResults=new a.s,this.text={label_previous:this.I18n.t("js.pagination.pages.previous"),label_next:this.I18n.t("js.pagination.pages.next"),per_page:this.I18n.t("js.label_per_page"),no_other_page:this.I18n.t("js.pagination.no_other_page")},this.currentRange="",this.pageNumbers=[],this.postPageNumbers=[],this.prePageNumbers=[],this.perPageOptions=[]}ngOnInit(){this.paginationService.loadPaginationOptions().then(e=>{this.perPageOptions=e.perPageOptions,this.pagination=new s.a(1,parseInt(this.totalEntries),e.perPage),this.cdRef.detectChanges()})}update(){this.updateCurrentRangeLabel(),this.updatePageNumbers(),this.cdRef.detectChanges()}selectPerPage(e){this.pagination.perPage=e,this.paginationService.setPerPage(e),this.showPage(1)}showPage(e){this.pagination.page=e,this.updateCurrentRangeLabel(),this.updatePageNumbers(),this.onUpdatedPage(),this.cdRef.detectChanges()}onUpdatedPage(){this.updateResults.emit(this.pagination)}get isVisible(){return!this.hideForSinglePageResults||this.pagination.total>this.pagination.perPage}updateCurrentRangeLabel(){if(this.pagination.total){let e=this.pagination.total,t=this.pagination.getLowerPageBound(),i=this.pagination.getUpperPageBound(this.pagination.total);this.currentRange="("+t+"\xa0-\xa0"+i+"/"+e+")"}else this.currentRange="(0 - 0/0)"}updatePageNumbers(){if(!this.showPageSelections)return this.pageNumbers=[],void(this.postPageNumbers=[]);var e=this.paginationService.getMaxVisiblePageOptions(),t=this.paginationService.getOptionsTruncationSize(),i=[];const n=this.pagination.perPage,s=this.pagination.page;if(n){for(var a=1;a<=Math.ceil(this.pagination.total/n);a++)i.push(a);var r=s-2*t;0<=r&&r<=1?this.postPageNumbers=this.truncatePageNums(i,i.length>=e+2*t,e+t,i.length,0):(this.prePageNumbers=this.truncatePageNums(i,s>=e,0,Math.min(s-Math.ceil(e/2),i.length-e),t),this.postPageNumbers=this.truncatePageNums(i,i.length>=e+2*t,e,i.length,0))}this.pageNumbers=i}showPerPageOptions(){return this.showPerPage&&this.perPageOptions.length>0&&this.pagination.total>this.perPageOptions[0]}truncatePageNums(e,t,i,n,s){if(t){var a=this.paginationService.getOptionsTruncationSize(),r=e.splice(i,n);return r.length>=2*a&&r.splice(s,r.length-a),r}return[]}}P.\u0275fac=function(e){return new(e||P)(a.gc(n.a),a.gc(a.i),a.gc(r.a))},P.\u0275cmp=a.ac({type:P,selectors:[["","tablePagination",""]],inputs:{totalEntries:"totalEntries",hideForSinglePageResults:"hideForSinglePageResults",showPerPage:"showPerPage",showPageSelections:"showPageSelections",infoText:"infoText"},outputs:{updateResults:"updateResults"},features:[a.Qb],attrs:["tablePagination",""],decls:1,vars:1,consts:[["class","pagination",4,"ngIf"],[1,"pagination"],[1,"pagination--pages"],[1,"pagination--items"],[1,"pagination--item",3,"hidden"],["rel","prev start","id","pagination--prev-link","role","link","href","",3,"accessibleClick"],[4,"ngIf"],["rel","next","id","pagination--next-link","role","link","href","",1,"pagination--next-link",3,"accessibleClick"],[1,"pagination--range"],[3,"textContent"],["id","pagination-empty-text","tabindex","0","class","hidden-for-sighted",3,"textContent",4,"ngIf"],["class","pagination--info",4,"ngIf"],["class","pagination--options",4,"ngIf"],["class","pagination--item",4,"ngFor","ngForOf"],[1,"pagination--space"],[1,"pagination--item"],["rel","next","role","link","href","",3,"textContent","accessibleClick"],["class","pagination--item pagination-number",3,"ngClass",4,"ngFor","ngForOf"],["class","pagination--space",4,"ngIf"],[1,"pagination--item","pagination-number",3,"ngClass"],["rel","next","role","link","href","",3,"textContent","accessibleClick",4,"ngIf"],["class","pagination--item pagination-number",4,"ngFor","ngForOf"],[1,"pagination--item","pagination-number"],["id","pagination-empty-text","tabindex","0",1,"hidden-for-sighted",3,"textContent"],[1,"pagination--info"],["icon-classes","icon-info1 icon-context"],[1,"pagination--options"],[1,"pagination--label",3,"textContent","title"],["class","pagination--item",3,"ngClass",4,"ngFor","ngForOf"],[1,"pagination--item",3,"ngClass"],["role","link","href","",3,"textContent","accessibleClick"]],template:function(e,t){1&e&&a.Yc(0,_,17,11,"div",0),2&e&&a.Bc("ngIf",t.pagination&&t.isVisible&&t.pagination.total)},directives:[o.q,l.a,o.p,o.n,d.a],encapsulation:2,changeDetection:0})},mY05:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("mrSG"),s=i("r0MM"),a=i("3VS2"),r=i("lfyH"),c=i("vkgz"),o=i("eIep"),l=i("lJxs"),d=i("LRne"),u=i("cp0P"),h=i("ug4p"),p=i("fXoL");class g{constructor(e){this.injector=e}getViewPointResource(e,t){const i=e.bcfViewpoints[t].href;return this.bcfApi.parse(i)}getViewPoint$(e,t){return this.getViewPointResource(e,t).get()}deleteViewPoint$(e,t){return this.getViewPointResource(e,t).delete().pipe(Object(c.a)(()=>this.wpCache.require(e.id,!0)))}saveViewpoint$(e,t){const i=e.project.idFromLink,n=this.setBcfTopic$(e),s=t?Object(d.a)(t):this.viewerBridge.getViewpoint$();return Object(u.a)({topicUUID:n,viewpoint:s}).pipe(Object(o.a)(e=>this.bcfApi.projects.id(i).topics.id(e.topicUUID).viewpoints.post(e.viewpoint)),Object(c.a)(t=>this.wpCache.require(e.id,!0)))}setBcfTopic$(e){var t;if(this.topicUUID)return Object(d.a)(this.topicUUID);{const i=null===(t=e.bcfTopic)||void 0===t?void 0:t.href;return(i?Object(d.a)(this.bcfApi.parse(i).id):this.createBcfTopic$(e)).pipe(Object(l.a)(e=>this.topicUUID=e))}}createBcfTopic$(e){const t=e.project.idFromLink,i=e.convertBCF.payload;return this.bcfApi.projects.id(t).topics.post(i).pipe(Object(l.a)(e=>(this.topicUUID=e.guid,this.topicUUID)))}}g.\u0275fac=function(e){return new(e||g)(p.qc(p.A))},g.\u0275prov=p.cc({token:g,factory:g.\u0275fac}),Object(n.c)([Object(s.a)(),Object(n.e)("design:type",a.a)],g.prototype,"bcfApi",void 0),Object(n.c)([Object(s.a)(),Object(n.e)("design:type",r.a)],g.prototype,"viewerBridge",void 0),Object(n.c)([Object(s.a)(),Object(n.e)("design:type",h.a)],g.prototype,"wpCache",void 0)},mg4W:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("fXoL"),s=i("VQC/"),a=i("sjKJ"),r=i("Jui0"),c=i("t8SH"),o=i("wZYP"),l=i("POAS"),d=i("ZOsW"),u=i("3Pt+"),h=i("ofXK"),p=i("ximh");function g(e,t){if(1&e&&(n.hc(0,"b",4),n.ad(1)),2&e){const e=t.searchTerm,i=n.wc();n.Bc("textContent",i.text.add_new_action),n.Tb(1),n.cd(": ",e," ")}}function m(e,t){if(1&e&&(n.mc(0,"div",5),n.ad(1),n.lc()),2&e){const e=t.item,i=t.searchTerm;n.Bc("ngOptionHighlight",i),n.Tb(1),n.bd(e.name)}}class f extends c.a{constructor(e,t,i,s,a,r){super(e,i,t,s),this.I18n=e,this.currentProject=t,this.cdRef=i,this.pathHelper=s,this.versionDm=a,this.halNotification=r,this.openDirectly=!1,this.onCreate=new n.s}ngAfterViewInit(){super.ngAfterViewInit(),this.canCreateNewActionElements().then(e=>{e&&(this.createAllowed=e=>this.createNewVersion(e),this.cdRef.detectChanges())})}canCreateNewActionElements(){return this.currentProject.id?this.versionDm.canCreateVersionInProject(this.currentProject.id).catch(()=>!1):Promise.resolve(!1)}createNewVersion(e){this.versionDm.createVersion(this.getVersionPayload(e)).then(e=>{this.onCreate.emit(e)}).catch(e=>{this.closeSelect(),this.halNotification.handleRawError(e)})}getVersionPayload(e){let t={};return t.name=e,t._links={definingProject:{href:this.pathHelper.api.v3.projects.id(this.currentProject.id).path}},t}}f.\u0275fac=function(e){return new(e||f)(n.gc(o.a),n.gc(a.a),n.gc(n.i),n.gc(r.a),n.gc(s.a),n.gc(l.a))},f.\u0275cmp=n.ac({type:f,selectors:[["version-autocompleter"]],inputs:{openDirectly:"openDirectly"},outputs:{onCreate:"onCreate"},features:[n.Qb],decls:4,vars:13,consts:[["bindLabel","name",3,"ngModel","items","ngClass","addTag","virtualScroll","required","clearable","disabled","typeahead","clearOnBackspace","appendTo","hideSelected","id","ngModelChange","change","open","close","keydown"],["ngSelectComponent",""],["ng-tag-tmp",""],["ng-option-tmp",""],[3,"textContent"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight"]],template:function(e,t){1&e&&(n.mc(0,"ng-select",0,1),n.uc("ngModelChange",(function(e){return t.model=e}))("change",(function(e){return t.changeModel(e)}))("open",(function(){return t.opened()}))("close",(function(){return t.closed()}))("keydown",(function(e){return t.keyPressed(e)})),n.Yc(2,g,2,2,"ng-template",2),n.Yc(3,m,2,2,"ng-template",3),n.lc()),2&e&&n.Bc("ngModel",t.model)("items",t.availableValues)("ngClass",t.classes)("addTag",t.createAllowed)("virtualScroll",!0)("required",t.required)("clearable",!t.required)("disabled",t.disabled)("typeahead",t.typeahead)("clearOnBackspace",!1)("appendTo",t.appendTo)("hideSelected",t.hideSelected)("id",t.id)},directives:[d.a,u.m,u.p,h.n,u.x,d.l,d.c,p.a],encapsulation:2})},n9mQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("kTsZ"),s=i("Jui0"),a=i("6x6j"),r=i("Mo6U"),c=i("ciXH"),o=i("fXoL");class l extends c.a{constructor(e,t,i){super(e,t),this.halResourceService=e,this.pathHelper=t,this.payloadDm=i}createForm(e=null,t=null){let i=this.extractPayload(e,t);return this.halResourceService.post(this.pathHelper.api.v3.grids.form().toString(),i).toPromise()}create(e,t=null){let i=this.extractPayload(e,t);return this.halResourceService.post(this.pathHelper.api.v3.grids.path,i).toPromise()}update(e,t=null){let i=this.extractPayload(e,t);return this.halResourceService.patch(this.pathHelper.api.v3.grids.id(e.id).toString(),i).toPromise()}updateForm(e,t=null){let i=this.extractPayload(e,t);return this.halResourceService.post(this.pathHelper.api.v3.grids.id(e.idFromLink).form.toString(),i).toPromise()}extractPayload(e=null,t=null){if(e&&t){let i=this.payloadDm.extract(e,t);return i.widgets&&(i.widgets=e.widgets.map(e=>({id:e.id,startRow:e.startRow,endRow:e.endRow,startColumn:e.startColumn,endColumn:e.endColumn,identifier:e.identifier,options:e.options}))),i}return e instanceof r.a?{}:e}listUrl(){return this.pathHelper.api.v3.grids.toString()}oneUrl(e){return this.pathHelper.api.v3.grids.id(e).toString()}}l.\u0275fac=function(e){return new(e||l)(o.qc(n.a),o.qc(s.a),o.qc(a.a))},l.\u0275prov=o.cc({token:l,factory:l.\u0275fac})},nbRO:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));const n="wp-table--group-header",s="-collapsed"},nckM:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("UD+K"),s=i("TTfU"),a=i("iMRi"),r=i("fXoL");class c extends n.a{constructor(e,t){super(),this.states=e,this.userDmService=t}load(e){return this.userDmService.load(e)}loadAll(e){const t=e.map(e=>this.load(e));return Promise.all(t).then(()=>{})}get multiState(){return this.states.users}}c.\u0275fac=function(e){return new(e||c)(r.qc(a.a),r.qc(s.a))},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac,providedIn:"root"})},nfBx:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("FnNU"),s=i("Ul5t"),a=i("fXoL");class r{constructor(e){this.helpTextDm=e,this.helpTexts=Object(n.f)()}require(e,t){return this.helpTexts.putFromPromiseIfPristine(()=>this.helpTextDm.loadAll().then(e=>e.elements)),new Promise((i,n)=>{this.helpTexts.valuesPromise().then(()=>i(this.find(e,t)))})}find(e,t){const i=this.helpTexts.getValueOr([]);return _.find(i,i=>i.scope===t&&i.attribute===e)}}r.\u0275fac=function(e){return new(e||r)(a.qc(s.a))},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac,providedIn:"root"})},"oJ+N":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("+rOU"),s=i("iB+3"),a=i("7ond"),r=i("WgCp"),c=i("ho3E"),o=i("fXoL");class l{constructor(e,t,i,n,s){this.componentFactoryResolver=e,this.FocusHelper=t,this.appRef=i,this.$transitions=n,this.injector=s}setupListener(){jQuery(window).on(c.b,(e,t,i)=>(this.show(t,i),!1))}get bodyPortalHost(){if(!this._portalHostElement){const e=this._portalHostElement=document.createElement("div");e.classList.add("op-external-query-configuration--container"),document.body.appendChild(e),this._bodyPortalHost=new n.d(e,this.componentFactoryResolver,this.appRef,this.injector)}return this._bodyPortalHost}show(e,t,i={}){this.detach();const s=new n.c(this.externalQueryConfigurationComponent(),null,this.injectorFor({callback:t,currentQuery:e,disabledTabs:i}));this.bodyPortalHost.attach(s),this._portalHostElement.style.display="block"}detach(){this.bodyPortalHost.hasAttached()&&(this.bodyPortalHost.detach(),this._portalHostElement.style.display="none")}injectorFor(e){const t=new WeakMap;return e.service=this,t.set(c.a,e),new n.f(this.injector,t)}externalQueryConfigurationComponent(){return r.a}}l.\u0275fac=function(e){return new(e||l)(o.qc(o.l),o.qc(a.a),o.qc(o.f),o.qc(s.O),o.qc(o.A))},l.\u0275prov=o.cc({token:l,factory:l.\u0275fac})},oLh2:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));i("ii2/");var n=i("nckM"),s=i("juWA"),a=i("wZYP"),r=i("fXoL"),c=i("ofXK"),o=i("0XIV"),l=i("u8Ab");function d(e,t){if(1&e&&r.hc(0,"user-avatar",10),2&e){const e=r.wc(2);r.Ub("data-user-name",e.userName)("data-user-id",e.userId)}}function u(e,t){if(1&e&&r.hc(0,"user-avatar",10),2&e){const e=r.wc(2);r.Ub("data-user-name",e.userName)("data-use-fallback",!0)}}function h(e,t){if(1&e&&(r.mc(0,"span",11),r.hc(1,"a",12),r.lc()),2&e){const e=r.wc(2);r.Tb(1),r.Bc("textContent",e.userName),r.Ub("href",e.userPath,r.Tc)("aria-label",e.userLabel)}}function p(e,t){if(1&e&&r.hc(0,"span",13),2&e){const e=r.wc(2);r.Bc("textContent",e.userName)}}function g(e,t){if(1&e&&(r.mc(0,"div",1),r.mc(1,"div",2),r.hc(2,"activity-link",3),r.lc(),r.Yc(3,d,1,2,"user-avatar",4),r.Yc(4,u,1,2,"user-avatar",4),r.Yc(5,h,2,3,"span",5),r.Yc(6,p,1,1,"span",6),r.hc(7,"span",7),r.mc(8,"span",8),r.hc(9,"span",9),r.lc(),r.lc()),2&e){const e=r.wc();r.Tb(2),r.Bc("workPackage",e.workPackage)("activityNo",e.activityNo),r.Tb(1),r.Bc("ngIf",e.activity.author&&e.userName),r.Tb(1),r.Bc("ngIf",!e.activity.author&&e.userName),r.Tb(1),r.Bc("ngIf",e.userActive),r.Tb(1),r.Bc("ngIf",!e.userActive),r.Tb(1),r.Bc("innerHtml",e.revisionLink,r.Rc),r.Tb(2),r.Bc("innerHtml",e.message,r.Rc)}}class m{constructor(e,t,i,n){this.I18n=e,this.timezoneService=t,this.cdRef=i,this.userCacheService=n}ngOnInit(){this.loadAuthor(),this.project=this.workPackage.project,this.revision=this.activity.identifier,this.message=this.activity.message.html;const e=this.activity.showRevision.$link.href,t=this.activity.formattedIdentifier,i=document.createElement("a");i.href=e,i.title=this.revision,i.textContent=this.I18n.t("js.label_committed_link",{revision_identifier:t}),this.revisionLink=this.I18n.t("js.label_committed_at",{committed_revision_link:i.outerHTML,date:this.timezoneService.formattedDatetime(this.activity.createdAt)})}loadAuthor(){void 0===this.activity.author?this.userName=this.activity.authorName:this.userCacheService.require(this.activity.author.idFromLink).then(e=>{this.userId=e.id,this.userName=e.name,this.userActive=e.isActive,this.userAvatar=e.avatar,this.userPath=e.showUser.href,this.userLabel=this.I18n.t("js.label_author",{user:this.userName}),this.cdRef.detectChanges()})}}m.\u0275fac=function(e){return new(e||m)(r.gc(a.a),r.gc(s.a),r.gc(r.i),r.gc(n.a))},m.\u0275cmp=r.ac({type:m,selectors:[["revision-activity"]],inputs:{workPackage:"workPackage",activity:"activity",activityNo:"activityNo"},decls:1,vars:1,consts:[["class","work-package-details-activities-activity-contents",4,"ngIf"],[1,"work-package-details-activities-activity-contents"],[1,"comments-number"],[3,"workPackage","activityNo"],["data-class-list","avatar",4,"ngIf"],["class","user",4,"ngIf"],["class","user",3,"textContent",4,"ngIf"],[1,"revision-activity--revision-link","date",3,"innerHtml"],[1,"user-comment","wiki"],[1,"message",3,"innerHtml"],["data-class-list","avatar"],[1,"user"],[3,"textContent"],[1,"user",3,"textContent"]],template:function(e,t){1&e&&r.Yc(0,g,10,8,"div",0),2&e&&r.Bc("ngIf",t.workPackage)},directives:[c.q,o.a,l.a],encapsulation:2,changeDetection:0})},oT5z:function(e,t,i){"use strict";i.d(t,"a",(function(){return nt}));var n=i("fXoL"),s=i("5btT"),a=i("J30J"),r=i("V4eP"),c=i("3Pt+"),o=i("oUDv");class l extends r.a{constructor(){super(...arguments),this.shouldFocus="subject"===this.name}}l.\u0275fac=function(e){return d(e||l)},l.\u0275cmp=n.ac({type:l,selectors:[["ng-component"]],features:[n.Qb],decls:1,vars:6,consts:[["type","text",1,"inline-edit--field",3,"focus","disabled","ngModel","id","ngModelChange","keydown","focusout"]],template:function(e,t){1&e&&(n.mc(0,"input",0),n.uc("ngModelChange",(function(e){return t.value=e}))("keydown",(function(e){return t.handler.handleUserKeydown(e)}))("focusout",(function(){return t.handler.onFocusOut()})),n.lc()),2&e&&(n.Bc("focus",t.shouldFocus)("disabled",t.inFlight)("ngModel",t.value)("id",t.handler.htmlId),n.Ub("aria-required",t.required)("required",t.required))},directives:[c.c,o.a,c.x,c.m,c.p],encapsulation:2});const d=n.oc(l);class u extends r.a{constructor(){super(...arguments),this.locale=I18n.locale}}u.\u0275fac=function(e){return h(e||u)},u.\u0275cmp=n.ac({type:u,selectors:[["ng-component"]],features:[n.Qb],decls:1,vars:6,consts:[["type","number",1,"inline-edit--field",3,"disabled","ngModel","id","ngModelChange","keydown","focusout"]],template:function(e,t){1&e&&(n.mc(0,"input",0),n.uc("ngModelChange",(function(e){return t.value=e}))("keydown",(function(e){return t.handler.handleUserKeydown(e)}))("focusout",(function(){return t.handler.onFocusOut()})),n.lc()),2&e&&(n.Bc("disabled",t.inFlight)("ngModel",t.value)("id",t.handler.htmlId),n.Ub("aria-required",t.required)("required",t.required)("lang",t.locale))},directives:[c.s,c.c,c.x,c.m,c.p],encapsulation:2});const h=n.oc(u);var p=i("mrSG"),g=i("juWA"),m=i("wd/R"),f=i("r0MM");class b extends r.a{parser(e){if(!isNaN(e)){let t=parseFloat(e);return m.duration(t,"hours")}return e}formatter(e){return Number(m.duration(e).asHours().toFixed(2))}parseValue(e){if(null===e)return e;let t;return t=e.isValid()?e.toISOString():this.resource[this.name],t}}b.\u0275fac=function(e){return w(e||b)},b.\u0275cmp=n.ac({type:b,selectors:[["ng-component"]],features:[n.Qb],decls:1,vars:5,consts:[["type","number","step","0.01",1,"inline-edit--field",3,"ngModel","disabled","id","ngModelChange","keydown"]],template:function(e,t){1&e&&(n.mc(0,"input",0),n.uc("ngModelChange",(function(e){return t.value=t.parser(e)}))("keydown",(function(e){return t.handler.handleUserKeydown(e)})),n.lc()),2&e&&(n.Bc("ngModel",t.formatter(t.value))("disabled",t.inFlight)("id",t.handler.htmlId),n.Ub("aria-required",t.required)("required",t.required))},directives:[c.s,c.c,c.m,c.p,c.x],encapsulation:2}),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",g.a)],b.prototype,"TimezoneService",void 0);const w=n.oc(b);var v=i("iHm1"),y=i("t8SH");class k{constructor(){this._fields=[]}register(e,t){this._fields.push({attribute:t,component:e})}getAutocompleterOfAttribute(e){let t=_.find(this._fields,t=>t.attribute===e);return t?t.component:void 0}}k.\u0275fac=function(e){return new(e||k)},k.\u0275prov=n.cc({token:k,factory:k.\u0275fac,providedIn:"root"});var C=i("Cfvw"),j=i("vkgz"),x=i("lJxs"),T=i("POAS"),S=i("CS/5");const P=function(e,t,i,n,s,a,r){return{availableValues:e,appendTo:t,model:i,required:n,disabled:s,id:a,finishedLoading:!0,classes:r}};class I extends r.a{constructor(){super(...arguments),this.valuesLoaded=!1,this.appendTo=null,this.hiddenOverflowContainer=".__hidden_overflow_container",this.referenceOutputs={onCreate:e=>this.onCreate(e),onChange:e=>this.onChange(e),onKeydown:e=>this.handler.handleUserKeydown(e,!0),onOpen:()=>this.onOpen(),onClose:()=>this.onClose(),onAfterViewInit:e=>this._autocompleterComponent=e}}initialize(){this.text={requiredPlaceholder:this.I18n.t("js.placeholders.selection"),placeholder:this.I18n.t("js.placeholders.default")},this.valuesLoadingPromise=this.change.getForm().then(()=>this.initialValueLoading())}initialValueLoading(){return this.valuesLoaded=!1,this.loadValues().toPromise()}autocompleterComponent(){let e=this.schema.type;return this.selectAutocompleterRegister.getAutocompleterOfAttribute(e)||y.a}ngOnInit(){super.ngOnInit(),this.appendTo=this.overflowingSelector,this.handler.$onUserActivate.pipe(this.untilDestroyed()).subscribe(()=>{this.valuesLoadingPromise.then(()=>{this._autocompleterComponent.openDirectly=!0})})}get selectedOption(){const e=this.value?this.value.$href:null;return _.find(this.valueOptions,t=>t.$href===e)}set selectedOption(e){let t=_.find(this.availableOptions,t=>t.$href===e.$href);t&&""===t.$href&&(t.$href=null),this.value=t}setValues(e){this.availableOptions=this.sortValues(e),this.addEmptyOption(),this.valueOptions=this.availableOptions.map(e=>this.mapAllowedValue(e))}loadValues(e){let t=this.schema.allowedValues;if(Array.isArray(t))this.setValues(t),this.valuesLoaded=!0;else{if(t&&!this.valuesLoaded)return this.loadValuesFromBackend(e);this.setValues([])}return Object(C.a)(Promise.resolve(this.valueOptions))}loadValuesFromBackend(e){return Object(C.a)(this.loadAllowedValues(e)).pipe(Object(j.a)(t=>{(void 0===t.count||void 0===t.total||!e&&t.total===t.count)&&(this.valuesLoaded=!0)}),Object(x.a)(t=>void 0===t.count||void 0===t.total||!e&&t.total===t.count||!this.value?t.elements:t.elements.concat([this.value])),Object(j.a)(e=>this.setValues(e)),Object(x.a)(()=>this.valueOptions))}loadAllowedValues(e){if(!e){const e=this.schema.allowedValues.$link.href;return this.change.cacheValue(e,this.fetchAllowedValueQuery.bind(this))}return this.fetchAllowedValueQuery(e)}fetchAllowedValueQuery(e){return this.schema.allowedValues.$link.$fetch(this.allowedValuesFilter(e))}addValue(e){this.availableOptions.push(e),this.valueOptions.push({name:e.name,$href:e.$href})}get currentValueInvalid(){return!!(this.value&&!_.some(this.availableOptions,e=>e.$href===this.value.$href)||!this.value&&this.schema.required)}onCreate(e){this.addValue(e),this.selectedOption={name:e.name,$href:e.$href},this.handler.handleUserSubmit()}onOpen(){jQuery(this.hiddenOverflowContainer).one("scroll",()=>{this._autocompleterComponent.closeSelect()})}onClose(){}onChange(e){if(void 0!==e)return this.selectedOption={name:e.name,$href:e.$href},void this.handler.handleUserSubmit();const t=this.getEmptyOption();t&&(this.selectedOption=t,this.handler.handleUserSubmit())}addEmptyOption(){if(this.isRequired())return;void 0===this.getEmptyOption()&&this.availableOptions.unshift({name:this.text.placeholder,$href:""})}isRequired(){return this.schema.required}sortValues(e){return this.halSorting.sort(e)}mapAllowedValue(e){return{name:e.name,$href:e.$href}}allowedValuesFilter(e){return{}}getEmptyOption(){return _.find(this.availableOptions,e=>e.name===this.text.placeholder)}}I.\u0275fac=function(e){return O(e||I)},I.\u0275cmp=n.ac({type:I,selectors:[["ng-component"]],features:[n.Qb],decls:1,vars:11,consts:[[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"]],template:function(e,t){1&e&&n.hc(0,"ndc-dynamic",0),2&e&&n.Bc("ndcDynamicComponent",t.autocompleterComponent())("ndcDynamicInputs",n.Lc(3,P,t.valueOptions,t.appendTo,t.selectedOption?t.selectedOption:"",t.required,t.inFlight,t.handler.htmlId,"inline-edit--field "+t.handler.fieldName))("ndcDynamicOutputs",t.referenceOutputs)},directives:[S.c,S.d],encapsulation:2}),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",k)],I.prototype,"selectAutocompleterRegister",void 0),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",T.a)],I.prototype,"halNotification",void 0),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",v.a)],I.prototype,"halSorting",void 0);const O=n.oc(I);var R=i("wZYP"),B=i("ZOsW"),E=i("ofXK"),M=i("32V0");function F(e,t){if(1&e){const e=n.nc();n.mc(0,"edit-field-controls",3),n.uc("onSave",(function(){return n.Qc(e),n.wc().handler.handleUserSubmit()}))("onCancel",(function(){return n.Qc(e),n.wc().handler.handleUserCancel()})),n.lc()}if(2&e){const e=n.wc();n.Bc("fieldController",e.self)("saveTitle",e.text.save)("cancelTitle",e.text.cancel)}}class A extends r.a{constructor(){super(...arguments),this.availableOptions=[],this.text={requiredPlaceholder:this.I18n.t("js.placeholders.selection"),placeholder:this.I18n.t("js.placeholders.default"),save:this.I18n.t("js.inplace.button_save",{attribute:this.schema.name}),cancel:this.I18n.t("js.inplace.button_cancel",{attribute:this.schema.name})},this.appendTo=null,this.hiddenOverflowContainer=".__hidden_overflow_container",this.currentValueInvalid=!1,this.requestFocus=!1}ngOnInit(){this.nullOption={name:this.text.placeholder,$href:null},this.handler.$onUserActivate.pipe(this.untilDestroyed()).subscribe(()=>{this.requestFocus=0===this.availableOptions.length,this.requestFocus||this.openAutocompleteSelectField()}),super.ngOnInit(),this.appendTo=this.overflowingSelector}get value(){const e=this.resource[this.name];return e?e[0]:e}buildSelectedOption(){const e=this.resource[this.name];return e?e.map(e=>this.findValueOption(e)):[]}get selectedOption(){return this._selectedOption}set selectedOption(e){this._selectedOption=e;let t=e=>{let t=_.find(this.availableOptions,t=>t.$href===e.$href)||this.nullOption;return t&&""===t.$href&&(t.$href=null),t};this.resource[this.name]=_.castArray(e).map(e=>t(e))}onOpen(){jQuery(this.hiddenOverflowContainer).one("scroll",()=>{this.ngSelectComponent.close()})}onClose(){}repositionDropdown(){this.ngSelectComponent&&this.ngSelectComponent.dropdownPanel&&setTimeout(()=>this.ngSelectComponent.dropdownPanel.adjustPosition(),0)}openAutocompleteSelectField(){let e=this;window.setTimeout((function(){e.ngSelectComponent.open()}),0)}findValueOption(e){let t;return e&&(t=_.find(this.valueOptions,t=>t.$href===e.$href)),t||this.nullOption}setValues(e,t=!1){t&&e.sort((function(e,t){let i=e.name.toLowerCase(),n=t.name.toLowerCase();return i<n?-1:i>n?1:0})),this.availableOptions=e||[],this.valueOptions=this.availableOptions.map(e=>({name:e.name,$href:e.$href})),this._selectedOption=this.buildSelectedOption(),this.checkCurrentValueValidity(),this.availableOptions.length>0&&this.requestFocus&&(this.openAutocompleteSelectField(),this.requestFocus=!1)}initialize(){super.initialize(),this.loadValues()}loadValues(){let e=this.schema.allowedValues;if(Array.isArray(e))this.setValues(e);else{if(this.schema.allowedValues)return this.schema.allowedValues.$load().then(e=>{e.count>0&&"Project"===e.elements[0]._type?this.setValues(e.elements,!0):this.setValues(e.elements)});this.setValues([])}return Promise.resolve()}checkCurrentValueValidity(){this.value?this.currentValueInvalid=!_.some(this.value,e=>_.some(this.availableOptions,t=>t.$href===e.$href)):this.currentValueInvalid=!!this.schema.required}}A.\u0275fac=function(e){return D(e||A)},A.\u0275cmp=n.ac({type:A,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(B.a,!0),2&e)&&(n.Nc(i=n.vc())&&(t.ngSelectComponent=i.first))},features:[n.Qb],decls:3,vars:15,consts:[[1,"textarea-wrapper"],["bindLabel","name",3,"ngModel","ngClass","required","clearable","disabled","id","items","virtualScroll","clearSearchOnAdd","multiple","closeOnSelect","appendTo","dropdownPosition","hideSelected","ngModelChange","keydown","open","close","add","remove"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel",4,"ngIf"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"ng-select",1),n.uc("ngModelChange",(function(e){return t.selectedOption=e}))("keydown",(function(e){return t.handler.handleUserKeydown(e,!0)}))("open",(function(){return t.onOpen()}))("close",(function(){return t.onClose()}))("add",(function(){return t.repositionDropdown()}))("remove",(function(){return t.repositionDropdown()})),n.lc(),n.Yc(2,F,1,3,"edit-field-controls",2),n.lc()),2&e&&(n.Tb(1),n.Bc("ngModel",t.selectedOption)("ngClass","inline-edit--field -multi-select")("required",t.required)("clearable",!t.required)("disabled",t.inFlight)("id",t.handler.htmlId)("items",t.valueOptions)("virtualScroll",!0)("clearSearchOnAdd",!0)("multiple",!0)("closeOnSelect",!1)("appendTo",t.appendTo)("dropdownPosition","top")("hideSelected",!0),n.Tb(1),n.Bc("ngIf",!t.handler.inEditMode))},directives:[B.a,c.m,c.p,E.n,c.x,E.q,M.a],encapsulation:2}),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",R.a)],A.prototype,"I18n",void 0);const D=n.oc(A);class q extends r.a{constructor(){super(...arguments),this.locale=I18n.locale}}q.\u0275fac=function(e){return L(e||q)},q.\u0275cmp=n.ac({type:q,selectors:[["ng-component"]],features:[n.Qb],decls:1,vars:6,consts:[["type","number","step","any",1,"inline-edit--field",3,"disabled","ngModel","id","ngModelChange","keydown","focusout"]],template:function(e,t){1&e&&(n.mc(0,"input",0),n.uc("ngModelChange",(function(e){return t.value=e}))("keydown",(function(e){return t.handler.handleUserKeydown(e)}))("focusout",(function(){return t.handler.onFocusOut()})),n.lc()),2&e&&(n.Bc("disabled",t.inFlight)("ngModel",t.value)("id",t.handler.htmlId),n.Ub("aria-required",t.required)("required",t.required)("lang",t.locale))},directives:[c.s,c.c,c.x,c.m,c.p],encapsulation:2});const L=n.oc(q);class $ extends r.a{updateValue(e){this.value=e,this.handler.handleUserSubmit()}}$.\u0275fac=function(e){return N(e||$)},$.\u0275cmp=n.ac({type:$,selectors:[["ng-component"]],features:[n.Qb],decls:1,vars:4,consts:[["type","checkbox",1,"inline-edit--field","inline-edit--boolean-field",3,"checked","disabled","id","change","keydown"]],template:function(e,t){1&e&&(n.mc(0,"input",0),n.uc("change",(function(){return t.updateValue(!t.value)}))("keydown",(function(e){return t.handler.handleUserKeydown(e)})),n.lc()),2&e&&(n.Bc("checked",t.value)("disabled",t.inFlight)("id",t.handler.htmlId),n.Ub("aria-required",t.required))},encapsulation:2});const N=n.oc($);var Q=i("RhL0"),V=i("iuWW"),H=i("IzEk");const z=function(e,t,i,n,s,a,r,c,o){return{availableValues:e,appendTo:t,model:i,required:n,disabled:s,typeahead:a,id:r,finishedLoading:c,hideSelected:!0,classes:o}};class Y extends I{constructor(){super(...arguments),this.requests=new V.a(e=>this.loadValues(e),Object(V.b)(this.halNotification))}initialValueLoading(){return this.valuesLoaded=!1,new Promise(e=>{this.requests.output$.pipe(Object(H.a)(1)).subscribe(t=>{e(t)}),this.requests.input$.next("")})}get typeahead(){return!this.valuesLoaded&&this.requests.input$}allowedValuesFilter(e){let t=super.allowedValuesFilter(e);if(e){let i=new Q.a;i.add("subjectOrId","**",[e]),t={filters:i.toJson()}}return t}mapAllowedValue(e){if(e.id){let t=e.type?`${e.type.name} `:"",i=e.subject||e.name;return{name:`${t}#${e.id} ${i}`,$href:e.$href}}return e}}Y.\u0275fac=function(e){return W(e||Y)},Y.\u0275cmp=n.ac({type:Y,selectors:[["ng-component"]],features:[n.Qb],decls:2,vars:15,consts:[[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"]],template:function(e,t){1&e&&(n.hc(0,"ndc-dynamic",0),n.xc(1,"async")),2&e&&n.Bc("ndcDynamicComponent",t.autocompleterComponent())("ndcDynamicInputs",n.Mc(5,z,[n.yc(1,3,t.requests.output$),t.appendTo,t.selectedOption?t.selectedOption:"",t.required,t.inFlight,t.typeahead,t.handler.htmlId,t.requests.loading$,"inline-edit--field "+t.handler.fieldName]))("ndcDynamicOutputs",t.referenceOutputs)},directives:[S.c,S.d],pipes:[E.a],encapsulation:2});const W=n.oc(Y);var U=i("IaZ+"),G=i("ecJW");class X extends r.a{ngOnInit(){super.ngOnInit()}onValueSelected(e){this.value=this.parser(e),this.handler.handleUserSubmit()}onCancel(){this.handler.handleUserCancel()}parser(e){return m(e,"YYYY-MM-DD",!0).isValid()?e:null}formatter(e){if(m(e,"YYYY-MM-DD",!0).isValid()){var t=this.timezoneService.parseDate(e);return this.timezoneService.formattedISODate(t)}return null}}X.\u0275fac=function(e){return K(e||X)},X.\u0275cmp=n.ac({type:X,selectors:[["ng-component"]],features:[n.Qb],decls:1,vars:4,consts:[["tabindex","-1","classes","inline-edit--field",3,"initialDate","required","disabled","id","onChange","onCancel"]],template:function(e,t){1&e&&(n.mc(0,"op-date-picker",0),n.uc("onChange",(function(e){return t.onValueSelected(e)}))("onCancel",(function(){return t.onCancel()})),n.lc()),2&e&&n.Bc("initialDate",t.formatter(t.value))("required",t.required)("disabled",t.inFlight)("id",t.handler.htmlId)},directives:[G.a],encapsulation:2}),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",g.a)],X.prototype,"timezoneService",void 0),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",U.b)],X.prototype,"opModalService",void 0);const K=n.oc(X);var Z=i("VNOR"),J=i("9oW/"),ee=i("mg4W");function te(e){return"-"+(e=ne(e)).replace(" ","-")}function ie(e,t){return e=ne(e),t.t("js.grid.widgets.project_status."+e.replace(" ","_"))}function ne(e){return e||"not set"}function se(e,t){if(1&e&&(n.hc(0,"span",3),n.mc(1,"span",4),n.ad(2),n.lc()),2&e){const e=t.item;n.Bc("ngClass",e.colorClass),n.Tb(1),n.Bc("ngClass",e.colorClass),n.Tb(1),n.bd(e.name)}}function ae(e,t){if(1&e&&(n.hc(0,"span",3),n.mc(1,"span",4),n.ad(2),n.lc()),2&e){const e=t.item;n.Bc("ngClass",e.colorClass),n.Tb(1),n.Bc("ngClass",e.colorClass),n.Tb(1),n.bd(e.name)}}class re extends r.a{constructor(){super(...arguments),this._availableStatusCodes=["not set","off track","at risk","on track"],this.currentStatusCode="not set",this.availableStatuses=this._availableStatusCodes.map(e=>({code:e,name:ie(e,this.I18n),colorClass:te(e)})),this.hiddenOverflowContainer="#content-wrapper",this.appendToContainer="body"}ngOnInit(){this.currentStatusCode=null===this.resource.status?"not set":this.resource.status;let e=this;window.setTimeout((function(){e.ngSelectComponent.open()}),0)}onChange(){this.resource.status="not set"===this.currentStatusCode?null:this.currentStatusCode,this.handler.handleUserSubmit()}onOpen(){setTimeout(()=>{const e=this.ngSelectComponent;e&&e.dropdownPanel&&e.dropdownPanel._updatePosition(),jQuery(this.hiddenOverflowContainer).one("scroll.autocompleteContainer",()=>{this.ngSelectComponent.close()})},25)}onClose(){jQuery(this.hiddenOverflowContainer).off("scroll.autocompleteContainer")}}re.\u0275fac=function(e){return ce(e||re)},re.\u0275cmp=n.ac({type:re,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(B.a,!0),2&e)&&(n.Nc(i=n.vc())&&(t.ngSelectComponent=i.first))},features:[n.Qb],decls:3,vars:5,consts:[["bindLabel","name","bindValue","code",1,"project-status",3,"items","ngModel","appendTo","hideSelected","disabled","ngModelChange","open","close","change"],["ng-label-tmp",""],["ng-option-tmp",""],[1,"project-status--bulb",3,"ngClass"],[1,"project-status--name",3,"ngClass"]],template:function(e,t){1&e&&(n.mc(0,"ng-select",0),n.uc("ngModelChange",(function(e){return t.currentStatusCode=e}))("open",(function(){return t.onOpen()}))("close",(function(){return t.onClose()}))("change",(function(){return t.onChange()})),n.Yc(1,se,3,3,"ng-template",1),n.Yc(2,ae,3,3,"ng-template",2),n.lc()),2&e&&n.Bc("items",t.availableStatuses)("ngModel",t.currentStatusCode)("appendTo",t.appendToContainer)("hideSelected",!0)("disabled",t.inFlight)},directives:[B.a,c.m,c.p,B.e,B.c,E.n],styles:[""]}),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",R.a)],re.prototype,"I18n",void 0);const ce=n.oc(re);class oe extends r.a{constructor(){super(...arguments),this.shouldFocus=!1}get value(){if(!this.schema)return"";const e=this.resource[this.name];return e&&e.raw||""}set value(e){this.resource[this.name]={raw:e}}}oe.\u0275fac=function(e){return le(e||oe)},oe.\u0275cmp=n.ac({type:oe,selectors:[["ng-component"]],features:[n.Qb],decls:1,vars:6,consts:[["type","text",1,"inline-edit--field",3,"focus","disabled","ngModel","id","ngModelChange","keydown","focusout"]],template:function(e,t){1&e&&(n.mc(0,"input",0),n.uc("ngModelChange",(function(e){return t.value=e}))("keydown",(function(e){return t.handler.handleUserKeydown(e)}))("focusout",(function(){return t.handler.onFocusOut()})),n.lc()),2&e&&(n.Bc("focus",t.shouldFocus)("disabled",t.inFlight)("ngModel",t.value)("id",t.handler.htmlId),n.Ub("aria-required",t.required)("required",t.required))},directives:[c.c,o.a,c.x,c.m,c.p],encapsulation:2});const le=n.oc(oe);var de=i("gh2L"),ue=i("j/Ak"),he=i("iuLl");const pe=function(e,t,i,n,s,a,r,c,o){return{availableValues:e,appendTo:t,model:i,required:n,disabled:s,typeahead:a,id:r,finishedLoading:c,hideSelected:!0,classes:o}};class ge extends Y{initialize(){super.initialize(),this.referenceOutputs&&(this.referenceOutputs.modeSwitch=e=>{this.valuesLoaded=!1;let t=this.requests.lastRequestedValue;this.requests.input$.next('_/&"()____'),this.requests.input$.next(t)})}autocompleterComponent(){return he.a}isRequired(){return!0}loadAllowedValues(e){return this.recentWorkPackageIds?this.fetchAllowedValueQuery(e):this.timeEntryDm.list({filters:[["user_id","=",["me"]]],sortBy:[["updated_on","desc"]],pageSize:30}).then(t=>(this.recentWorkPackageIds=t.elements.map(e=>e.workPackage.idFromLink).filter((e,t,i)=>i.indexOf(e)===t),this.fetchAllowedValueQuery(e)))}allowedValuesFilter(e){let t=new Q.a;return"recent"===this._autocompleterComponent.mode&&t.add("id","=",this.recentWorkPackageIds),e&&t.add("subjectOrId","**",[e]),{filters:t.toJson()}}sortValues(e){return"recent"===this._autocompleterComponent.mode?this.sortValuesByRecentIds(e):super.sortValues(e)}sortValuesByRecentIds(e){return e.sort((e,t)=>this.recentWorkPackageIds.indexOf(e.id)-this.recentWorkPackageIds.indexOf(t.id))}}ge.\u0275fac=function(e){return me(e||ge)},ge.\u0275cmp=n.ac({type:ge,selectors:[["ng-component"]],features:[n.Qb],decls:2,vars:15,consts:[[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"]],template:function(e,t){1&e&&(n.hc(0,"ndc-dynamic",0),n.xc(1,"async")),2&e&&n.Bc("ndcDynamicComponent",t.autocompleterComponent())("ndcDynamicInputs",n.Mc(5,pe,[n.yc(1,3,t.requests.output$),t.appendTo,t.selectedOption?t.selectedOption:"",t.required,t.inFlight,t.typeahead,t.handler.htmlId,t.requests.loading$,"inline-edit--field "+t.handler.fieldName]))("ndcDynamicOutputs",t.referenceOutputs)},directives:[S.c,S.d],pipes:[E.a],encapsulation:2}),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",ue.a)],ge.prototype,"timeEntryDm",void 0);const me=n.oc(ge);var fe=i("yOxh");class be extends X{constructor(){super(...arguments),this.dates=""}ngOnInit(){super.ngOnInit(),this.handler.$onUserActivate.pipe(this.untilDestroyed()).subscribe(()=>{this.showDatePickerModal()})}ngOnDestroy(){var e;super.ngOnDestroy(),null===(e=this.modal)||void 0===e||e.closeMe()}handleClick(){this.showDatePickerModal()}showDatePickerModal(){const e=this.modal=this.opModalService.show(fe.a,this.injector,{changeset:this.change,fieldName:this.name});setTimeout(()=>{const t=jQuery(e.elementRef.nativeElement).find(".datepicker-modal"),i=jQuery(this.elementRef.nativeElement);e.reposition(t,i)}),e.onDataUpdated.subscribe(e=>{this.dates=e,this.cdRef.detectChanges()}),e.closingEvent.pipe(Object(H.a)(1)).subscribe(()=>{this.handler.handleUserSubmit()})}}be.\u0275fac=function(e){return we(e||be)},be.\u0275cmp=n.ac({type:be,selectors:[["ng-component"]],features:[n.Qb],decls:1,vars:1,consts:[["type","text",3,"value","click"]],template:function(e,t){1&e&&(n.mc(0,"input",0),n.uc("click",(function(){return t.handleClick()})),n.lc()),2&e&&n.Bc("value",t.dates)},encapsulation:2}),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",g.a)],be.prototype,"timezoneService",void 0),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",U.b)],be.prototype,"opModalService",void 0);const we=n.oc(be);var ve=i("4rda");class ye extends ve.a{}class ke extends ve.a{get valueString(){return null==this.value?"":this.value.toLocaleString(this.I18n.locale,{useGrouping:!0,maximumFractionDigits:20})}}class Ce extends ve.a{get value(){return parseInt(this.resource[this.name])}isEmpty(){return isNaN(this.value)}}class je extends ve.a{get value(){return this.schema?this.attribute&&this.attribute.name:null}}var xe=i("Q2x2");var Te=i("E+lO");class Se extends ve.a{render(e,t,i={}){let n=document.createElement("div");n.classList.add("read-value--html","wiki","highlight","-multiline"),i.rtl&&n.classList.add("-rtl"),n.innerHTML=t,e.innerHTML="",e.appendChild(n),Te.DynamicBootstrapper.bootstrapOptionalEmbeddable(this.appRef,n)}get isFormattable(){return!0}get value(){if(!this.schema)return null;const e=this.resource[this.name];return e&&e.html?this.unescape(e.html):""}unescape(e){return e?class{static get UNESCAPED_EXPRESSION(){return"{{"}static get ESCAPED_EXPRESSION(){return"{{ \\$root\\.DOUBLE_LEFT_CURLY_BRACE }}"}static escape(e){return e.replace(new RegExp(this.UNESCAPED_EXPRESSION,"g"),this.ESCAPED_EXPRESSION)}static unescape(e){return e.replace(new RegExp(this.ESCAPED_EXPRESSION,"g"),this.UNESCAPED_EXPRESSION)}}.unescape(e):""}}Object(p.c)([Object(f.a)(),Object(p.e)("design:type",n.f)],Se.prototype,"appRef",void 0);class _e extends ve.a{constructor(){super(...arguments),this.derivedText=this.I18n.t("js.label_value_derived_from_children")}get valueString(){return this.timezoneService.formattedDuration(this.value)}get derivedPropertyName(){return"derived"+this.name.charAt(0).toUpperCase()+this.name.slice(1)}get derivedValue(){return this.resource[this.derivedPropertyName]}get derivedValueString(){const e=this.derivedValue;return e?this.timezoneService.formattedDuration(e):this.placeholder}render(e,t){if(this.isEmpty())return void(e.textContent=this.placeholder);e.classList.add("split-time-field");let i=this.value,n=i&&this.timezoneService.toHours(i)||0;0!==n&&this.renderActual(e,t);let s=this.derivedValue;s&&0!==this.timezoneService.toHours(s)&&this.renderDerived(e,this.derivedValueString,0!==n)}renderActual(e,t){const i=document.createElement("span");i.textContent=t,i.title=this.valueString,i.classList.add("-actual-value"),e.appendChild(i)}renderDerived(e,t,i){const n=document.createElement("span");n.setAttribute("title",this.texts.empty),n.textContent="("+(i?"+":"")+t+")",n.title=`${this.derivedValueString} ${this.derivedText}`,n.classList.add("-derived-value"),i&&n.classList.add("-with-actual-value"),e.appendChild(n)}get title(){return null}isEmpty(){const e=this.value,t=this.derivedValue,i=!e||0===this.timezoneService.toHours(e),n=!t||0===this.timezoneService.toHours(t);return i&&n}}Object(p.c)([Object(f.a)(),Object(p.e)("design:type",g.a)],_e.prototype,"timezoneService",void 0);var Pe=i("ayqa");class Ie extends ve.a{get valueString(){return this.value?this.timezoneService.formattedDatetime(this.value):""}}Object(p.c)([Object(f.a)(),Object(p.e)("design:type",g.a)],Ie.prototype,"timezoneService",void 0);class Oe extends ve.a{get valueString(){return this.translatedValue()}get placeholder(){return this.translatedValue()}translatedValue(){return this.value?this.I18n.t("js.general_text_yes"):this.I18n.t("js.general_text_no")}isEmpty(){return!1}}var Re=i("Nvnm");class Be extends ve.a{constructor(){super(...arguments),this.text={none:this.I18n.t("js.filter.noneElement")}}get value(){return this.resource[this.name]}get title(){return this.isEmpty()?this.text.none:this.value.name}get wpId(){return this.isEmpty()?null:this.value.$loaded?this.value.id:this.value.href.match(/(\d+)$/)[0]}get valueString(){return`#${this.wpId} ${this.title}`}isEmpty(){return!this.value}get unknownAttribute(){return!1}}var Ee=i("Jui0"),Me=i("NNMa"),Fe=i("yQm5"),Ae=i("xQCb");class De extends _e{constructor(){super(...arguments),this.text={linkTitle:this.I18n.t("js.work_packages.message_view_spent_time"),logTime:this.I18n.t("js.button_log_time")}}render(e,t){if(!this.value)return;const i=document.createElement("a");if(i.textContent=t,i.setAttribute("title",this.text.linkTitle),i.setAttribute("class","time-logging--value"),this.resource.project){const e=this.resource.id.toString();this.projectCacheService.require(this.resource.project.idFromLink).then(t=>{const n=Fe(this.PathHelper.projectTimeEntriesPath(t.identifier)).search({work_package_id:e}).toString();i.href=n})}e.innerHTML="",e.appendChild(i),this.appendTimelogLink(e)}appendTimelogLink(e){if(this.resource.logTime){const t=document.createElement("a");t.setAttribute("class","icon icon-time"),t.setAttribute("href",""),t.setAttribute("title",this.text.logTime),e.appendChild(t),t.addEventListener("click",this.showTimelogWidget.bind(this,this.resource))}}showTimelogWidget(e){this.timeEntryCreateService.create(moment(new Date),e,!1).catch(()=>{})}}Object(p.c)([Object(f.a)(),Object(p.e)("design:type",Ee.a)],De.prototype,"PathHelper",void 0),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",Me.a)],De.prototype,"projectCacheService",void 0),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",Ae.a)],De.prototype,"timeEntryCreateService",void 0);class qe extends ve.a{constructor(){super(...arguments),this.text={linkTitle:this.I18n.t("js.work_packages.message_successful_show_in_fullscreen")}}get value(){return this.resource.isNew?null:this.resource[this.name]}render(e,t){this.value&&(e.textContent=t)}isEmpty(){return!1}}var Le=i("RGDJ"),$e=i("5qbd"),Ne=i("Mo6U");class Qe extends $e.a{render(e,t){super.render(e,t),this.shouldHighlight&&this.addHighlight(e)}get value(){return this.schema?this.attribute&&this.attribute.name:null}addHighlight(e){if(this.attribute instanceof Ne.a){const t=Le.a.inlineClass(this.name,this.attribute.id);e.classList.add(t)}}}class Ve extends Qe{get shouldHighlight(){return!0}}var He=i("3uR5");class ze extends ve.a{get value(){return this.schema?this.attribute&&this.attribute.name:null}render(e,t){this.placeholder===t?this.renderEmpty(e):this.avatarRenderer.render(e,this.attribute)}}Object(p.c)([Object(f.a)(),Object(p.e)("design:type",He.a)],ze.prototype,"avatarRenderer",void 0);class Ye extends xe.a{render(e,t){const i=this.value;e.innerHTML="",e.setAttribute("title",i.join(", ")),0===i.length?this.renderEmpty(e):this.renderValues(this.attribute,e)}renderValues(e,t){const i=document.createDocumentFragment();if(this.renderAbridgedValues(t,e),e.length>2){const t=document.createElement("span");t.innerHTML="... ",i.appendChild(t);const n=this.optionDiv(e.length.toString(),"badge","-secondary");i.appendChild(n)}t.appendChild(i)}renderAbridgedValues(e,t){const i=_.take(t,2);this.avatarRenderer.renderMultiple(e,i)}}Object(p.c)([Object(f.a)(),Object(p.e)("design:type",He.a)],Ye.prototype,"avatarRenderer",void 0);var We=i("PkGb"),Ue=i("iB+3"),Ge=i("cd/7");class Xe extends qe{constructor(){super(...arguments),this.uiStateBuilder=new Ge.a(this.$state,this.keepTab)}render(e,t){if(!this.value)return;let i=this.uiStateBuilder.linkToShow(this.value,t,this.value);e.appendChild(i)}}Object(p.c)([Object(f.a)(),Object(p.e)("design:type",Ue.G)],Xe.prototype,"$state",void 0),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",We.a)],Xe.prototype,"keepTab",void 0);class Ke extends ve.a{render(e,t){const i=this.value;e.innerHTML=`\n      <span class="project-status--bulb ${te(i)}"></span>\n      <span class="project-status--name ${te(i)}">${ie(i,this.I18n)}</span>\n      <span class="project-status--pulldown-icon icon icon-pulldown"></span>\n    `}}class Ze extends ve.a{get value(){if(!this.schema)return null;const e=this.resource[this.name];return e&&e.raw||""}}class Je extends Be{constructor(){super(...arguments),this.text={linkTitle:this.I18n.t("js.work_packages.message_successful_show_in_fullscreen"),none:this.I18n.t("js.filter.noneElement")},this.uiStateBuilder=new Ge.a(this.$state,this.keepTab)}render(e,t){if(this.isEmpty())return void(e.innerText=this.placeholder);let i=this.uiStateBuilder.linkToShow(this.wpId,this.text.linkTitle,this.valueString);e.innerHTML="",e.appendChild(i)}get writable(){return!1}get valueString(){return"#"+this.wpId}}Object(p.c)([Object(f.a)(),Object(p.e)("design:type",Ue.G)],Je.prototype,"$state",void 0),Object(p.c)([Object(f.a)(),Object(p.e)("design:type",We.a)],Je.prototype,"keepTab",void 0);var et=i("u4T9"),tt=i("8ggW"),it=i("Xmgp");class nt{}nt.\u0275mod=n.ec({type:nt}),nt.\u0275inj=n.dc({factory:function(e){return new(e||nt)},providers:[{provide:n.c,useFactory:function(e,t){return()=>{e.defaultFieldType="text",e.addFieldType(l,"text",["String"]).addFieldType(u,"integer",["Integer"]).addFieldType(b,"duration",["Duration"]).addFieldType(I,"select",["Priority","Status","Type","User","Version","TimeEntriesActivity","Category","CustomOption","Project"]).addFieldType(A,"multi-select",["[]CustomOption","[]User"]).addFieldType(q,"float",["Float"]).addFieldType(Y,"workPackage",["WorkPackage"]).addFieldType($,"boolean",["Boolean"]).addFieldType(X,"date",["Date"]).addFieldType(Z.a,"wiki-textarea",["Formattable"]).addFieldType(re,"project_status",["ProjectStatus"]).addFieldType(J.a,"_comment",["comment"]),e.addSpecificFieldType("WorkPackage",be,"date",["startDate","dueDate","date"]).addSpecificFieldType("TimeEntry",oe,"comment",["comment"]).addSpecificFieldType("TimeEntry",ge,"workPackage",["WorkPackage"]),t.register(ee.a,"Version"),t.register(de.a,"WorkPackage")}},deps:[s.a,k],multi:!0},{provide:n.c,useFactory:function(e){return()=>{e.defaultFieldType="text",e.addFieldType(ye,"text",["String"]).addFieldType(ke,"float",["Float"]).addFieldType(Ce,"integer",["Integer"]).addFieldType(Qe,"highlight",["Status","Priority"]).addFieldType(Ve,"type",["Type"]).addFieldType(je,"resource",["Project","TimeEntriesActivity","Version","Category","CustomOption"]).addFieldType(xe.a,"resources",["[]CustomOption"]).addFieldType(Ye,"users",["[]User"]).addFieldType(Se,"formattable",["Formattable"]).addFieldType(_e,"duration",["Duration"]).addFieldType(Pe.a,"date",["Date"]).addFieldType(Ie,"datetime",["DateTime"]).addFieldType(Oe,"boolean",["Boolean"]).addFieldType(Re.a,"progress",["percentageDone"]).addFieldType(Je,"work_package",["WorkPackage"]).addFieldType(qe,"id",["id"]).addFieldType(Ke,"project_status",["ProjectStatus"]).addFieldType(ze,"user",["User"]),e.addSpecificFieldType("WorkPackage",Xe,"id",["id"]).addSpecificFieldType("WorkPackage",De,"spentTime",["spentTime"]).addSpecificFieldType("TimeEntry",Ze,"comment",["comment"]).addSpecificFieldType("TimeEntry",Be,"work_package",["workPackage"])}},deps:[a.a],multi:!0}],imports:[[et.a,tt.a,it.a]]})},oUDv:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("7ond"),s=i("fXoL");class a{constructor(e,t){this.FocusHelper=e,this.elementRef=t,this.priority=0}ngAfterViewInit(){this.updateFocus()}updateFocus(){if(this.condition){const e=jQuery(this.elementRef.nativeElement);this.FocusHelper.focusElement(e,this.priority)}}}a.\u0275fac=function(e){return new(e||a)(s.gc(n.a),s.gc(s.q))},a.\u0275dir=s.bc({type:a,selectors:[["","focus",""]],inputs:{condition:["focus","condition"],priority:["focusPriority","priority"]}})},ooSb:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("/cHX"),s=i("lJrL"),a=i("PkGb"),r=i("cd/7"),c=i("iB+3");class o extends n.a{constructor(){super(...arguments),this.identifier="open-details-action",this.uiStatebuilder=new r.a(this.injector.get(c.G),this.injector.get(a.a)),this.text={button:this.I18n.t("js.button_open_details")}}buildElement(){let e=this.uiStatebuilder.linkToDetails(this.workPackage.id,this.text.button,"");return e.classList.add("wp-table--details-link",n.b,"hidden-for-mobile"),e.appendChild(Object(s.a)("icon","icon-info2")),e}}class l extends n.a{constructor(){super(...arguments),this.identifier="open-context-menu-action",this.text={linkTitle:this.I18n.t("js.label_open_context_menu")}}buildElement(){let e=document.createElement("a");return e.href="#",e.classList.add(n.c,n.b),e.title=this.text.linkTitle,e.appendChild(Object(s.a)("icon","icon-show-more-horizontal")),e}}var d=i("fXoL");class u{constructor(e){this.injector=e,this.actions=[(e,t)=>new o(e,t),(e,t)=>new l(e,t)]}setActions(...e){this.actions=e}render(e){let t=this.actions.map(t=>t(this.injector,e).buildElement());return _.compact(t)}}u.\u0275fac=function(e){return new(e||u)(d.qc(d.A))},u.\u0275prov=d.cc({token:u,factory:u.\u0275fac})},oqKi:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){}get isEmpty(){return!this.name}setIfFirst(e,t){this.isEmpty&&e&&(this.name=e,this.params=t)}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.cc({token:s,factory:s.\u0275fac})},p5fp:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("xLNn"),s=i("wZYP"),a=i("l08T"),r=i("F5Dh"),c=i("Hg4z"),o=i("fXoL"),l=i("ofXK"),d=i("N5AO");function u(e,t){if(1&e&&o.hc(0,"span",4),2&e){const e=o.wc();o.Bc("textContent",e.filterCount)}}const h=function(e){return{"-active":e}};class p extends n.a{constructor(e,t,i,n){super(e),this.I18n=e,this.cdRef=t,this.wpFiltersService=i,this.wpTableFilters=n,this.initialized=!1,this.buttonId="work-packages-filter-toggle-button",this.iconClass="icon-filter"}ngOnInit(){this.setupObserver()}get labelKey(){return"js.button_filter"}get textKey(){return"js.toolbar.filter"}get label(){return this.prefix+this.text.label}get filterCount(){return this.count}performAction(e){this.toggleVisibility()}toggleVisibility(){this.wpFiltersService.toggleVisibility()}setupObserver(){this.wpTableFilters.live$().pipe(this.untilDestroyed()).subscribe(()=>{this.count=this.wpTableFilters.currentlyVisibleFilters.length,this.initialized=!0,this.cdRef.detectChanges()}),this.wpFiltersService.observeUntil(Object(c.b)(this)).subscribe(()=>{this.isActive=this.wpFiltersService.visible,this.cdRef.detectChanges()})}}p.\u0275fac=function(e){return new(e||p)(o.gc(s.a),o.gc(o.i),o.gc(a.a),o.gc(r.a))},p.\u0275cmp=o.ac({type:p,selectors:[["wp-filter-button"]],features:[o.Qb],decls:5,vars:11,consts:[[1,"button",3,"disabled","ngClass","click"],[3,"icon-classes"],[1,"button--text"],["class","badge -secondary",3,"textContent",4,"ngIf"],[1,"badge","-secondary",3,"textContent"]],template:function(e,t){1&e&&(o.mc(0,"button",0),o.uc("click",(function(e){return t.performAction(e)})),o.hc(1,"op-icon",1),o.mc(2,"span",2),o.ad(3),o.Yc(4,u,1,1,"span",3),o.lc(),o.lc()),2&e&&(o.Bc("disabled",t.disabled)("ngClass",o.Gc(9,h,t.isActive)),o.Ub("id",t.buttonId)("accesskey",t.accessKey)("title",t.label)("aria-label",t.label),o.Tb(1),o.Dc("icon-classes","",t.iconClass," button--icon"),o.Tb(2),o.cd(" ",t.buttonText," "),o.Tb(1),o.Bc("ngIf",t.initialized))},directives:[l.n,d.a,l.q],encapsulation:2,changeDetection:0})},pL6k:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("kt6C"),s=i("fXoL");class a{constructor(e){this.paginationService=e}buildQueryString(e){if(!e)return;let t=[];return _.each(e,(e,i)=>{e&&(Array.isArray(e)||(e=[e]),_.each(e,e=>{null!==e&&"object"==typeof e&&(e=JSON.stringify(e)),t.push(encodeURIComponent(i)+"="+encodeURIComponent(e))}))}),t.join("&")}encodeQueryJsonParams(e,t={}){let i={};return i=this.encodeColumns(i,e),i=this.encodeSums(i,e),i=this.encodeTimelineVisible(i,e),i=this.encodeHighlightingMode(i,e),i=this.encodeHighlightedAttributes(i,e),i.hi=!!e.showHierarchies,i.g=_.get(e.groupBy,"id",""),i=this.encodeSortBy(i,e),i=this.encodeFilters(i,e.filters),i.pa=t.page,i.pp=t.perPage,i.dr=e.displayRepresentation,JSON.stringify(i)}encodeColumns(e,t){return e.c=t.columns.map((function(e){return e.id})),e}encodeSums(e,t){return t.sums&&(e.s=t.sums),e}encodeHighlightingMode(e,t){return t.highlightingMode&&(t.persisted||"inline"!==t.highlightingMode)&&(e.hl=t.highlightingMode),e}encodeHighlightedAttributes(e,t){return"inline"===t.highlightingMode&&Array.isArray(t.highlightedAttributes)&&t.highlightedAttributes.length>0&&(e.hla=t.highlightedAttributes.map(e=>e.id)),e}encodeSortBy(e,t){return t.sortBy&&(e.t=t.sortBy.map((function(e){return e.id.replace("-",":")})).join()),e}encodeFilters(e,t){return t&&t.length>0?e.f=t.map(e=>({n:e.id,o:e.operator.id,v:_.map(e.values,e=>this.queryFilterValueToParam(e))})):e.f=[],e}encodeTimelineVisible(e,t){return t.timelineVisible?(e.tv=t.timelineVisible,_.isEmpty(t.timelineLabels)||(e.tll=JSON.stringify(t.timelineLabels)),e.tzl=t.timelineZoomLevel):e.tv=!1,e}buildV3GetQueryFromJsonParams(e){var t={pageSize:this.paginationService.getPerPage()};if(!e)return t;var i=JSON.parse(e);if(i.c&&(t["columns[]"]=i.c.map(e=>e)),i.s&&(t.showSums=i.s),t.timelineVisible=i.tv,i.tv&&(i.tll&&(t.timelineLabels=i.tll),i.tzl&&(t.timelineZoomLevel=i.tzl)),i.dr&&(t.displayRepresentation=i.dr),i.hl&&(t.highlightingMode=i.hl),i.hla&&(t["highlightedAttributes[]"]=i.hla.map(e=>e)),!1!==i.hi&&!0!==i.hi||(t.showHierarchies=i.hi),t.groupBy=_.get(i,"g",""),i.f){var n=i.f.map((function(e){var t={operator:decodeURIComponent(e.o)};if(e.v){var i=Array.isArray(e.v)?e.v:[e.v];_.extend(t,{values:i})}const n={};return n[e.n]=t,n}));t.filters=JSON.stringify(n)}return i.t&&(t.sortBy=JSON.stringify(i.t.split(",").map(e=>e.split(":")))),i.pa&&(t.offset=i.pa),i.pp&&(t.pageSize=i.pp),t}buildV3GetQueryFromQueryResource(e,t={},i={}){var n={};return n["columns[]"]=this.buildV3GetColumnsFromQueryResource(e),n.showSums=e.sums,n.timelineVisible=!!e.timelineVisible,e.timelineVisible&&(n.timelineZoomLevel=e.timelineZoomLevel,n.timelineLabels=JSON.stringify(e.timelineLabels)),e.highlightingMode&&(n.highlightingMode=e.highlightingMode),e.highlightedAttributes&&"inline"===e.highlightingMode&&(n["highlightedAttributes[]"]=e.highlightedAttributes.map(e=>e.href)),e.displayRepresentation&&(n.displayRepresentation=e.displayRepresentation),n.showHierarchies=!!e.showHierarchies,n.groupBy=_.get(e.groupBy,"id",""),n.filters=this.buildV3GetFiltersAsJson(e.filters,i),n.sortBy=this.buildV3GetSortByFromQuery(e),_.extend(t,n)}queryFilterValueToParam(e){return"boolean"==typeof e?e?"t":"f":e?e.id?e.id.toString():e.$href&&e.$href.match(/^\/api\/v3\/string_objects/i)?e.$href.match(/value=([^&]+)/)[1].toString():e.$href?e.$href.split("/").pop().toString():e.toString():""}buildV3GetColumnsFromQueryResource(e){return e.columns?e.columns.map(e=>e.id||e.idFromLink):e._links.columns?e._links.columns.map(e=>{let t=e.href;return this.idFromHref(t)}):void 0}buildV3GetFilters(e,t={}){return e.map(e=>{let i=this.buildV3GetFilterIdFromFilter(e),n=this.buildV3GetOperatorIdFromFilter(e),s=this.buildV3GetValuesFromFilter(e).map(e=>(_.each(t,(t,i)=>{e=e.replace(`{${i}}`,t)}),e));const a={};return a[i]={operator:n,values:s},a})}buildV3GetFiltersAsJson(e,t={}){return JSON.stringify(this.buildV3GetFilters(e,t))}buildV3GetFilterIdFromFilter(e){let t=e.filter?e.filter.$href:e._links.filter.href;return this.idFromHref(t)}buildV3GetOperatorIdFromFilter(e){if(e.operator)return e.operator.id||e.operator.idFromLink;{let t=e._links.operator.href;return this.idFromHref(t)}}buildV3GetValuesFromFilter(e){return e.values?_.map(e.values,e=>this.queryFilterValueToParam(e)):_.map(e._links.values,e=>this.idFromHref(e.href))}buildV3GetSortByFromQuery(e){let t=(e.sortBy?e.sortBy:e._links.sortBy).map(e=>{if(e.id)return e.id;{let t=e.href;return this.idFromHref(t)}});return JSON.stringify(t.map(e=>e.split("-")))}idFromHref(e){let t=e.substring(e.lastIndexOf("/")+1,e.length);return decodeURIComponent(t)}}a.\u0275fac=function(e){return new(e||a)(s.qc(n.a))},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac,providedIn:"root"})},pQre:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("mrSG"),s=i("iB+3"),a=i("PkGb"),r=i("r0MM"),c=i("fXoL");class o{constructor(e){this.injector=e}goBack(e=!1){const t=this.$state.current.data.baseRoute||"work-packages.partitioned.list";!this.backRoute||this.backRoute.name.includes("new")?this.$state.go(t,this.$state.params):this.keepTab.isDetailsState(this.backRoute.parent)?e?this.$state.go(t,this.$state.params):this.$state.go(this.keepTab.currentDetailsState,this.$state.params):this.$state.go(this.backRoute.name,this.backRoute.params)}goToBaseState(){const e=this.$state.current.data.baseRoute||"work-packages.partitioned.list";this.$state.go(e,this.$state.params)}sync(e){const t=e.from(),i=e.to();if(t.name&&t.data&&i.data&&t.data.parent!==i.data.parent){const i=Object.assign({},e.params("from"));this.backRoute={name:t.name,params:i,parent:t.data.parent}}}set backRoute(e){this._backRoute=e}get backRoute(){return this._backRoute}}o.\u0275fac=function(e){return new(e||o)(c.qc(c.A))},o.\u0275prov=c.cc({token:o,factory:o.\u0275fac,providedIn:"root"}),Object(n.c)([Object(r.a)(),Object(n.e)("design:type",s.G)],o.prototype,"$state",void 0),Object(n.c)([Object(r.a)(),Object(n.e)("design:type",a.a)],o.prototype,"keepTab",void 0)},pSHE:function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));var n=i("E2tj");class s{constructor(e,t){this.querySpace=e,this.injector=t}get applies(){return!0}onNewOrder(e){}canPickup(e){return!0}handleDrop(e,t){return Promise.resolve(void 0)}changeShadowElement(e,t=!1){return t?e.classList.remove("-dragged"):e.classList.add("-dragged"),!0}}var a=i("mrSG"),r=i("wyKs"),c=i("VgZ9"),o=i("CBsm"),l=i("ug4p"),d=i("5+Sy"),u=i("r0MM");class h extends s{get applies(){return this.wpTableHierarchies.isEnabled}canPickup(e){return!!e.changeParent}handleDrop(e,t){return this.determineParent(t).then(t=>this.relationHierarchyService.changeParent(e,t))}determineParent(e){let t=e.previousElementSibling;var i=null;if(null!==t&&!this.isFlatList(t)){if(t.className.indexOf(Object(d.d)())>=0){let e=this.findRelationRowRoot(t);if(null==e)return Promise.resolve(null);t=e}let e=t.dataset.workPackageId;i=this.isHiearchyRoot(t,e)?e:this.loadParentOfWP(e)}return Promise.resolve(i)}findRelationRowRoot(e){let t=e.previousElementSibling;for(;null!==t;){if(t.className.indexOf(Object(d.d)())<0)return t;t=t.previousElementSibling}return null}isFlatList(e){const t=e.className.indexOf(Object(o.c)(""))>=0,i=e.className.indexOf(Object(o.d)(""))>=0;return!(t||i)}isHiearchyRoot(e,t){return e.classList.contains(Object(o.d)(t))}loadParentOfWP(e){return this.wpCacheService.require(e).then(e=>{var t;return Promise.resolve((null===(t=e.parent)||void 0===t?void 0:t.id)||null)})}}Object(a.c)([Object(u.a)(),Object(a.e)("design:type",r.a)],h.prototype,"wpTableHierarchies",void 0),Object(a.c)([Object(u.a)(),Object(a.e)("design:type",c.a)],h.prototype,"relationHierarchyService",void 0),Object(a.c)([Object(u.a)(),Object(a.e)("design:type",l.a)],h.prototype,"wpCacheService",void 0);var p=i("AeZM"),g=i("SKFm"),m=i("nbRO"),f=i("T9ri"),b=i("POAS"),w=i("/C7M");class v extends s{get applies(){return this.wpTableGroupBy.isEnabled}canPickup(e){const t=this.groupedAttribute;return null!==t&&e.isAttributeEditable(t)}handleDrop(e,t){const i=this.halEditing.changeFor(e),n=this.getValueForGroup(t);return i.projectedResource[this.groupedAttribute]=n,this.halEditing.save(i).then(e=>this.halEvents.push(e.resource,{eventType:"updated"})).catch(t=>this.halNotification.handleRawError(t,e))}getValueForGroup(e){const t=Object(d.a)(e,`.${m.b}`),i=this.groups.find(e=>Object(f.b)(e)===t.dataset.groupIdentifier);if(!i)return null;if(i._links&&i._links.valueLink){const e=i._links.valueLink;return 1===e.length?e[0]:e}return i.value}get groupedAttribute(){const e=this.wpTableGroupBy.current;return e?e.id:null}get groups(){return this.querySpace.groups.value||[]}}Object(a.c)([Object(u.a)(),Object(a.e)("design:type",p.a)],v.prototype,"wpTableGroupBy",void 0),Object(a.c)([Object(u.a)(),Object(a.e)("design:type",g.a)],v.prototype,"halEditing",void 0),Object(a.c)([Object(u.a)(),Object(a.e)("design:type",w.a)],v.prototype,"halEvents",void 0),Object(a.c)([Object(u.a)(),Object(a.e)("design:type",b.a)],v.prototype,"halNotification",void 0);var y=i("fXoL");class k{constructor(){this.register=[h,v]}add(e){this.register.push(e)}get(e){const t=e.get(n.a);return this.register.map(i=>new i(t,e)).find(e=>e.applies)||new s(t,e)}}k.\u0275fac=function(e){return new(e||k)},k.\u0275prov=y.cc({token:k,factory:k.\u0275fac})},pXZk:function(e,t,i){"use strict";i.d(t,"c",(function(){return s})),i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return r}));var n=i("Ncnr");const s="wp-table--cell-td",a="wp-table--cell-container";class r{constructor(e){this.injector=e,this.fieldRenderer=new n.a(this.injector,"table")}build(e,t){const i=document.createElement("td"),r=t.id;i.classList.add(s,r),"subject"===r&&i.classList.add("-max");const c=e.schema[r];c&&"User"===c.type&&i.classList.add("-contains-avatar");const o=document.createElement("span");o.classList.add(a,n.c,r);const l=this.fieldRenderer.render(e,r,null);return o.appendChild(l),i.appendChild(o),i}refresh(e,t,i){const n=this.fieldRenderer.render(t,i,null);e.innerHTML="",e.appendChild(n)}}},"q/QC":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("wZYP"),s=(i("AA01"),i("Y41n")),a=i("AEvm"),r=i("Hg4z"),c=i("fXoL"),o=i("3Pt+"),l=i("oUDv");class d extends a.a{constructor(e){super(),this.I18n=e,this.shouldFocus=!1,this.filterChanged=new s.a(Object(r.b)(this)),this.text={enter_text:this.I18n.t("js.work_packages.description_enter_text")}}get value(){return this.filter.values[0]}set value(e){e.length?this.filter.values[0]=e:this.filter.values.length=0,this.filterChanged.emit(this.filter)}}d.\u0275fac=function(e){return new(e||d)(c.gc(n.a))},d.\u0275cmp=c.ac({type:d,selectors:[["filter-string-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[c.Qb],decls:3,vars:7,consts:[[3,"id"],["requried","true","type","text",1,"advanced-filters--text-field",3,"ngModel","focus","id","name","ngModelChange"],[1,"hidden-for-sighted",3,"for","textContent"]],template:function(e,t){1&e&&(c.mc(0,"div",0),c.mc(1,"input",1),c.uc("ngModelChange",(function(e){return t.value=e})),c.lc(),c.hc(2,"label",2),c.lc()),2&e&&(c.Dc("id","div-values-",t.filter.name,""),c.Tb(1),c.Dc("id","values-",t.filter.name,""),c.Dc("name","v[",t.filter.name,"]"),c.Bc("ngModel",t.value)("focus",t.shouldFocus),c.Tb(1),c.Dc("for","values-",t.filter.name,""),c.Bc("textContent",t.text.enter_text))},directives:[o.c,o.m,o.p,l.a],encapsulation:2})},qHU1:function(e,t,i){"use strict";i.d(t,"c",(function(){return s})),i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return r}));var n=i("AytR");function s(e){n.a.production||e()}function a(e,...t){s(()=>console.log(`[DEBUG] ${e}`,...t))}function r(e,t){if(n.a.production)return t();var i=performance.now(),s=t(),a=performance.now();return console.log(`%c${e} completed in ${a-i} milliseconds.`,"color:#00A093;"),s}},qc15:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("POAS"),s=i("ug4p"),a=i("fXoL");class r extends n.a{constructor(e,t){super(e),this.injector=e,this.wpCacheService=t}showSave(e,t=!1){let i={message:this.I18n.t("js.notice_successful_"+(t?"create":"update"))};this.addWorkPackageFullscreenLink(i,e),this.NotificationsService.addSuccess(i)}showCustomError(e,t){return"urn:openproject-org:api:v3:errors:UpdateConflict"===e.errorIdentifier?(this.NotificationsService.addError({message:e.message,type:"error",link:{text:this.I18n.t("js.hal.error.update_conflict_refresh"),target:()=>this.wpCacheService.require(t.id,!0)}}),!0):super.showCustomError(e,t)}addWorkPackageFullscreenLink(e,t){this.$state.includes("work-packages.show")||(e.link={target:()=>this.$state.go("work-packages.show.activity",{workPackageId:t.id}),text:this.I18n.t("js.work_packages.message_successful_show_in_fullscreen")})}}r.\u0275fac=function(e){return new(e||r)(a.qc(a.A),a.qc(s.a))},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac})},qg8y:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return a}));var n=i("Mo6U");const s="urn:openproject-org:api:v3:queries:directions:asc",a="urn:openproject-org:api:v3:queries:directions:desc";n.a;n.a},qs3h:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("iB+3"),s=i("ug4p"),a=i("wZYP"),r=i("AEvm"),c=i("fXoL"),o=i("ofXK"),l=i("m0WY");function d(e,t){if(1&e&&(c.mc(0,"div",1),c.mc(1,"div",2),c.hc(2,"wp-relations",3),c.lc(),c.lc()),2&e){const e=c.wc();c.Tb(2),c.Bc("workPackage",e.workPackage)}}class u extends r.a{constructor(e,t,i){super(),this.I18n=e,this.$transition=t,this.wpCacheService=i}ngOnInit(){const e=this.workPackageId||this.$transition.params("to").workPackageId;this.wpCacheService.loadWorkPackage(e).values$().pipe(this.untilDestroyed()).subscribe(e=>{this.workPackageId=e.id,this.workPackage=e})}}u.\u0275fac=function(e){return new(e||u)(c.gc(a.a),c.gc(n.J),c.gc(s.a))},u.\u0275cmp=c.ac({type:u,selectors:[["wp-relations-tab"]],inputs:{workPackageId:"workPackageId"},features:[c.Qb],decls:1,vars:1,consts:[["class","detail-panel-description detail-panel--relations detail-panel--autocomplete-target",4,"ngIf"],[1,"detail-panel-description","detail-panel--relations","detail-panel--autocomplete-target"],[1,"detail-panel-description-content"],[3,"workPackage"]],template:function(e,t){1&e&&c.Yc(0,d,3,1,"div",0),2&e&&c.Bc("ngIf",t.workPackage)},directives:[o.q,l.a],encapsulation:2})},qtzK:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var n=i("mrSG"),s=i("Q6HB"),a=i("iMRi"),r=i("VgZ9"),c=i("eyhC"),o=i("13ri"),l=i("9+6k"),d=i("4lR/"),u=i("TM9v"),h=i("IaZ+"),p=i("UUNb"),g=i("iB+3"),m=i("r0MM"),f=i("xQCb"),b=i("2G+H");class w extends l.a{constructor(e,t,i,n={},s=!0){super(e.get(d.a)),this.injector=e,this.workPackageId=t,this.$element=i,this.additionalPositionArgs=n,this.allowSplitScreenActions=s,this.workPackage=this.states.workPackages.get(this.workPackageId).value,this.selectedWorkPackages=this.getSelectedWorkPackages(),this.permittedActions=this.WorkPackageContextMenuHelper.getPermittedActions(this.selectedWorkPackages,u.a,this.allowSplitScreenActions),this.baseRoute=this.$state.current.data.baseRoute||this.$state.current.name,this.items=this.buildItems()}get locals(){return{contextMenuId:"work-package-context-menu",items:this.items}}positionArgs(e){let t=super.positionArgs(e);return _.assign(t,this.additionalPositionArgs),t}triggerContextMenuAction(e){const t=e.link;switch(e.key){case"delete":this.deleteSelectedWorkPackages();break;case"edit":this.editSelectedWorkPackages(t);break;case"copy":this.copySelectedWorkPackages(t);break;case"relation-new-child":this.wpRelationsHierarchyService.addNewChildWp(this.baseRoute,this.workPackage);break;case"log_time":this.logTimeForSelectedWorkPackage();break;default:window.location.href=t}}deleteSelectedWorkPackages(){let e=this.getSelectedWorkPackages();this.opModalService.show(p.a,this.injector,{workPackages:e})}editSelectedWorkPackages(e){this.getSelectedWorkPackages().length>1&&(window.location.href=e)}copySelectedWorkPackages(e){let t=this.getSelectedWorkPackages();if(t.length>1)return void(window.location.href=e);let i={copiedFromWorkPackageId:t[0].id};this.$state.go(this.baseRoute+".copy",i)}logTimeForSelectedWorkPackage(){this.timeEntryCreateService.create(moment(new Date),this.workPackage).catch(()=>{})}getSelectedWorkPackages(){let e=this.wpTableSelection.getSelectedWorkPackages();return 0===e.length?[this.workPackage]:(-1===e.indexOf(this.workPackage)&&e.push(this.workPackage),e)}buildItems(){let e=this.permittedActions.map(e=>({class:void 0,disabled:!1,linkText:e.text,href:e.href,icon:null!=e.icon?e.icon:`icon-${e.key}`,onClick:t=>(!e.href||!o.a.isClickedWithModifier(t))&&(this.triggerContextMenuAction(e),!0)}));return this.workPackage.isNew||(e.unshift({disabled:!1,icon:"icon-view-fullscreen",class:"openFullScreenView",href:this.$state.href("work-packages.show",{workPackageId:this.workPackageId}),linkText:I18n.t("js.button_open_fullscreen"),onClick:e=>!o.a.isClickedWithModifier(e)&&(this.$state.go("work-packages.show",{workPackageId:this.workPackageId}),!0)}),this.allowSplitScreenActions&&e.unshift({disabled:!1,icon:"icon-view-split",class:"detailsViewMenuItem",href:this.$state.href(Object(b.a)(this.$state)+".overview",{workPackageId:this.workPackageId}),linkText:I18n.t("js.button_open_details"),onClick:e=>!o.a.isClickedWithModifier(e)&&(this.$state.go(Object(b.a)(this.$state)+".overview",{workPackageId:this.workPackageId}),!0)})),e}}Object(n.c)([Object(m.a)(),Object(n.e)("design:type",a.a)],w.prototype,"states",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",r.a)],w.prototype,"wpRelationsHierarchyService",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",h.b)],w.prototype,"opModalService",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",g.G)],w.prototype,"$state",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",c.a)],w.prototype,"wpTableSelection",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",s.a)],w.prototype,"WorkPackageContextMenuHelper",void 0),Object(n.c)([Object(m.a)(),Object(n.e)("design:type",f.a)],w.prototype,"timeEntryCreateService",void 0)},qvi4:function(e,t,i){"use strict";i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return h}));var n=i("xLNn"),s=i("wZYP"),a=i("fXoL"),r=i("ofXK"),c=i("kor4"),o=i("N5AO");const l=function(e){return{"-active":e}},d=i("k7+O"),u="zen-mode-toggle-button";class h extends n.a{constructor(e,t){super(e),this.I18n=e,this.cdRef=t,this.buttonId="work-packages-zen-mode-toggle-button",this.buttonClass="toolbar-icon",this.iconClass="icon-zen-mode",this.activateLabel=e.t("js.zen_mode.button_activate"),this.deactivateLabel=e.t("js.zen_mode.button_deactivate");let i=this;d.enabled&&d.onchange((function(){d.isFullscreen||i.deactivateZenMode()}))}get label(){return this.isActive?this.deactivateLabel:this.activateLabel}isToggle(){return!0}deactivateZenMode(){this.isActive=h.inZenMode=!1,jQuery("body").removeClass("zen-mode"),this.disabled=!1,d.enabled&&d.isFullscreen&&d.exit(),this.cdRef.detectChanges()}activateZenMode(){this.isActive=h.inZenMode=!0,jQuery("body").addClass("zen-mode"),d.enabled&&d.request(),this.cdRef.detectChanges()}performAction(e){return h.inZenMode?this.deactivateZenMode():this.activateZenMode(),e.preventDefault(),!1}}h.inZenMode=!1,h.\u0275fac=function(e){return new(e||h)(a.gc(s.a),a.gc(a.i))},h.\u0275cmp=a.ac({type:h,selectors:[["zen-mode-toggle-button"]],features:[a.Qb],decls:2,vars:11,consts:[["type","button",3,"ngClass","disabled","accessibleClick"],[3,"icon-classes"]],template:function(e,t){1&e&&(a.mc(0,"button",0),a.uc("accessibleClick",(function(e){return t.performAction(e)})),a.hc(1,"op-icon",1),a.lc()),2&e&&(a.Vb("button ",t.buttonClass,""),a.Bc("ngClass",a.Gc(9,l,t.isActive))("disabled",t.disabled||!t.isToggle()&&t.isActive),a.Ub("id",t.buttonId)("title",t.label)("accesskey",t.accessKey),a.Tb(1),a.Dc("icon-classes","",t.iconClass," button--icon"))},directives:[r.n,c.a,o.a],encapsulation:2,changeDetection:0})},qvol:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("mrSG"),s=i("Mo6U"),a=i("dMmB"),r=i("r0MM");class c extends s.a{constructor(){super(...arguments),this.overriddenSchema=void 0}get schema(){if(this.hasOverriddenSchema)return this.overriddenSchema;const e=this.schemaCacheService.state(this);if(!e.hasValue())throw`Accessing schema of ${this.id} without it being loaded.`;return e.value}get hasOverriddenSchema(){return null!=this.overriddenSchema}get state(){return this.states.timeEntries.get(this.id)}$linkableKeys(){return _.without(super.$linkableKeys(),"schema")}}Object(n.c)([Object(r.a)(),Object(n.e)("design:type",a.a)],c.prototype,"schemaCacheService",void 0)},r0MM:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));i("mNvP");var n=i("qHU1");function s(e,t=null){return(i,s)=>{delete i[s]&&Object.defineProperty(i,s,{get:function(){if(e)return this.injector.get(e,t);{const e=Reflect.getMetadata("design:type",i,s);return this.injector.get(e)}},set:function(e){Object(n.a)("Trying to set InjectField property "+s)}})}}},r76g:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("wZYP"),s=i("8zkO"),a=i("JY8V"),r=i("fbLK"),c=i("fXoL"),o=i("jQQo"),l=i("ofXK"),d=i("xFOf");function u(e,t){if(1&e&&c.hc(0,"enterprise-banner",5),2&e){const e=c.wc();c.Bc("linkMessage",e.text.upsaleCheckOutLink)("textMessage",e.text.upsaleRelationColumns)}}class h{constructor(e,t,i,n,s){this.injector=e,this.I18n=t,this.wpTableColumns=i,this.ConfigurationService=n,this.bannerService=s,this.availableColumnsOptions=this.wpTableColumns.all.map(e=>this.column2Like(e)),this.availableColumns=this.wpTableColumns.all,this.availableColumnsMap=_.keyBy(this.availableColumns,e=>e.id),this.selectedColumns=this.wpTableColumns.getColumns().map(e=>this.column2Like(e)),this.selectedColumnMap={},this.eeShowBanners=!1,this.text={columnsHelp:this.I18n.t("js.work_packages.table_configuration.columns_help_text"),columnsLabel:this.I18n.t("js.label_columns"),selectedColumns:this.I18n.t("js.description_selected_columns"),multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect"),upsaleRelationColumns:this.I18n.t("js.work_packages.table_configuration.upsale.relation_columns"),upsaleCheckOutLink:this.I18n.t("js.work_packages.table_configuration.upsale.check_out_link")}}onSave(){this.wpTableColumns.setColumnsById(this.selectedColumns.map(e=>e.id))}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners,this.selectedColumns.forEach(e=>{this.selectedColumnMap[e.id]=!0})}column2Like(e){return{id:e.id,name:e.name}}updateSelected(e){this.selectedColumns=e}}h.\u0275fac=function(e){return new(e||h)(c.gc(c.A),c.gc(n.a),c.gc(a.a),c.gc(s.a),c.gc(r.a))},h.\u0275cmp=c.ac({type:h,selectors:[["ng-component"]],decls:5,vars:5,consts:[[1,"columns-modal--content"],[1,"hidden-for-sighted",3,"textContent"],[3,"options","selected","onChange"],[1,"form--inline-instructions",3,"textContent"],["class","ee-relation-columns-upsale","opReferrer","wp-list-columns#relations",3,"linkMessage","textMessage",4,"ngIf"],["opReferrer","wp-list-columns#relations",1,"ee-relation-columns-upsale",3,"linkMessage","textMessage"]],template:function(e,t){1&e&&(c.mc(0,"div",0),c.hc(1,"label",1),c.mc(2,"draggable-autocompleter",2),c.uc("onChange",(function(e){return t.updateSelected(e)})),c.lc(),c.hc(3,"p",3),c.lc(),c.Yc(4,u,1,2,"enterprise-banner",4)),2&e&&(c.Tb(1),c.Bc("textContent",t.text.selectedColumns),c.Tb(1),c.Bc("options",t.availableColumnsOptions)("selected",t.selectedColumns),c.Tb(1),c.Bc("textContent",t.text.columnsHelp),c.Tb(1),c.Bc("ngIf",t.eeShowBanners))},directives:[o.a,l.q,d.a],encapsulation:2})},rJ6b:function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var n=i("iB+3"),s=i("eyhC"),a=i("rOco"),r=i("LRne"),c=i("POAS"),o=i("qc15"),l=i("fXoL"),d=i("ofXK"),u=i("711n"),h=i("2orT"),p=i("DLfB"),g=i("ZAVI"),m=i("2TbE"),f=i("qvi4"),b=i("P7xQ"),w=i("N5AO"),v=i("aveh"),y=i("oUDv"),k=i("0loS"),C=i("S2zE"),j=i("f24R"),x=i("8+xT"),T=i("9pt+");function S(e,t){if(1&e&&(l.mc(0,"li",30),l.hc(1,"wp-watcher-button",31),l.lc()),2&e){const e=l.wc(2);l.Tb(1),l.Bc("workPackage",e.workPackage)("showText",!1)}}const _=function(e){return{workPackageId:e}};function P(e,t){if(1&e&&(l.mc(0,"li",32),l.hc(1,"a",23),l.hc(2,"wp-watchers-count",25),l.lc()),2&e){const e=l.wc(2);l.Bc("uiParams",l.Gc(3,_,e.workPackage.id)),l.Tb(1),l.Bc("textContent",e.text.tabs.watchers),l.Tb(1),l.Bc("wpId",e.workPackage.id)}}const I=function(){return["work_package.addChild","work_package.copy"]};function O(e,t){if(1&e&&(l.mc(0,"div",1),l.hc(1,"wp-breadcrumb",2),l.mc(2,"div",3),l.mc(3,"div",4),l.mc(4,"div",5),l.hc(5,"back-button",6),l.mc(6,"div",7),l.hc(7,"wp-subject"),l.lc(),l.lc(),l.mc(8,"ul",8),l.mc(9,"li",9),l.hc(10,"wp-create-button",10),l.lc(),l.Yc(11,S,2,2,"li",11),l.mc(12,"li",9),l.hc(13,"zen-mode-toggle-button"),l.lc(),l.mc(14,"li",12),l.mc(15,"button",13),l.hc(16,"op-icon",14),l.lc(),l.lc(),l.lc(),l.lc(),l.lc(),l.mc(17,"div",15),l.mc(18,"div",16),l.mc(19,"div",17),l.hc(20,"wp-single-view",2),l.lc(),l.lc(),l.mc(21,"div",18),l.mc(22,"div",17),l.hc(23,"span",19),l.mc(24,"div",20),l.mc(25,"ul",21),l.mc(26,"li",22),l.hc(27,"a",23),l.lc(),l.mc(28,"li",24),l.hc(29,"a",23),l.hc(30,"wp-relations-count",25),l.lc(),l.Yc(31,P,3,5,"li",26),l.lc(),l.lc(),l.hc(32,"div",27),l.lc(),l.mc(33,"div",28),l.hc(34,"wp-resizer",29),l.lc(),l.lc(),l.lc(),l.lc()),2&e){const e=l.wc();l.Bc("resource",e.workPackage),l.Tb(1),l.Bc("workPackage",e.workPackage),l.Tb(9),l.Bc("allowed",l.Fc(17,I))("stateName$",e.stateName$),l.Tb(1),l.Bc("ngIf",e.displayWatchButton),l.Tb(4),l.Bc("wpSingleContextMenu-workPackage",e.workPackage),l.Ub("title",e.text.full_view.button_more),l.Tb(5),l.Bc("workPackage",e.workPackage),l.Tb(3),l.Bc("textContent",e.focusAnchorLabel),l.Tb(3),l.Bc("uiParams",l.Gc(18,_,e.workPackage.id)),l.Tb(1),l.Bc("textContent",e.text.tabs.activity),l.Tb(1),l.Bc("uiParams",l.Gc(20,_,e.workPackage.id)),l.Tb(1),l.Bc("textContent",e.text.tabs.relations),l.Tb(1),l.Bc("wpId",e.workPackage.id),l.Tb(1),l.Bc("ngIf",e.canViewWorkPackageWatchers()),l.Tb(3),l.Bc("elementClass","work-packages-full-view--split-right")("localStorageKey","openProject-fullViewFlexBasis")}}class R extends a.a{constructor(e,t,i){super(e,i.params.workPackageId),this.injector=e,this.wpTableSelection=t,this.$state=i,this.stateName$=Object(r.a)("work-packages.new")}ngOnInit(){this.observeWorkPackage()}initializeTexts(){super.initializeTexts(),this.text.full_view={button_more:this.I18n.t("js.button_more")}}init(){super.init(),this.wpTableFocus.updateFocus(this.workPackage.id),this.setWorkPackageScopeProperties(this.workPackage)}setWorkPackageScopeProperties(e){this.isWatched=e.hasOwnProperty("unwatch"),this.displayWatchButton=e.hasOwnProperty("unwatch")||e.hasOwnProperty("watch"),e.watchers&&(this.watchers=e.watchers.elements)}}R.\u0275fac=function(e){return new(e||R)(l.gc(l.A),l.gc(s.a),l.gc(n.G))},R.\u0275cmp=l.ac({type:R,selectors:[["wp-full-view-entry"]],hostAttrs:[1,"work-packages-page--ui-view"],features:[l.Sb([{provide:c.a,useExisting:o.a}]),l.Qb],decls:1,vars:1,consts:[["edit-form","","class","work-packages--show-view",3,"resource",4,"ngIf"],["edit-form","",1,"work-packages--show-view",3,"resource"],[3,"workPackage"],[1,"toolbar-container"],["id","toolbar"],[1,"wp-show--header-container"],["linkClass","work-packages-back-button"],[1,"subject-header"],["id","toolbar-items",1,"toolbar-items","hide-when-print"],[1,"toolbar-item","hidden-for-mobile"],[3,"allowed","stateName$"],["class","toolbar-item",4,"ngIf"],["id","action-show-more-dropdown-menu",1,"toolbar-item","action_menu_main"],["wpSingleContextMenu","",1,"button","dropdown-relative","toolbar-icon",3,"wpSingleContextMenu-workPackage"],["icon-classes","button--icon icon-show-more"],[1,"work-packages-full-view--split-container"],[1,"work-packages-full-view--split-left"],[1,"work-packages--panel-inner"],[1,"work-packages-full-view--split-right","work-packages-tab-view--overflow"],["tabindex","-1","focus","",1,"hidden-for-sighted",3,"textContent"],["id","tabs"],[1,"tabrow"],["uiSref","work-packages.show.activity","uiSrefActive","selected",3,"uiParams"],["href","",3,"textContent"],["uiSref","work-packages.show.relations","uiSrefActive","selected",3,"uiParams"],[3,"wpId"],["uiSref","work-packages.show.watchers","uiSrefActive","selected",3,"uiParams",4,"ngIf"],["ui-view","",1,"tabcontent"],[1,"work-packages-full-view--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"],[1,"toolbar-item"],[3,"workPackage","showText"],["uiSref","work-packages.show.watchers","uiSrefActive","selected",3,"uiParams"]],template:function(e,t){1&e&&l.Yc(0,O,35,22,"div",0),2&e&&l.Bc("ngIf",t.workPackage)},directives:[d.q,u.a,h.a,p.a,g.a,m.a,f.a,b.a,w.a,v.a,y.a,k.UISref,k.UISrefActive,k.UISrefStatus,C.a,k.UIView,j.a,x.a,T.a],encapsulation:2})},rOco:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var n=i("mrSG"),s=i("fXoL"),a=i("wZYP"),r=i("Jui0"),c=i("Y/CA"),o=i("NNMa"),l=i("dfy/"),d=i("Kg8T"),u=i("ug4p"),h=i("iMRi"),p=i("PkGb"),g=i("SKFm"),m=i("qc15"),f=i("r0MM"),b=i("AEvm");class w extends b.a{constructor(e,t){super(),this.injector=e,this.workPackageId=t,this.text={},this.initializeTexts()}observeWorkPackage(){this.wpCacheService.require(this.workPackageId).catch(e=>this.notificationService.handleRawError(e)),this.wpCacheService.state(this.workPackageId).values$().pipe(this.untilDestroyed()).subscribe(e=>{this.workPackage=e,this.init(),this.cdRef.detectChanges()})}initializeTexts(){this.text.tabs={},["overview","activity","relations","watchers"].forEach(e=>{this.text.tabs[e]=this.I18n.t("js.work_packages.tabs."+e)})}init(){this.projectCacheService.require(this.workPackage.project.idFromLink).then(()=>{this.projectIdentifier=this.workPackage.project.identifier}),this.authorisationService.initModelAuth("work_package",this.workPackage.$links),this.titleService.setFirstPart(this.workPackage.subjectWithType(20)),this.showStaticPagePath=this.PathHelper.workPackagePath(this.workPackageId),this.keepTab.observable.pipe(this.untilDestroyed()).subscribe(e=>{this.updateFocusAnchorLabel(e.active)})}updateFocusAnchorLabel(e){const t=this.I18n.t("js.label_work_package_details_you_are_here",{tab:this.I18n.t("js.work_packages.tabs."+e),type:this.workPackage.type.name,subject:this.workPackage.subject});return this.focusAnchorLabel=t}canViewWorkPackageWatchers(){return!(!this.workPackage||!this.workPackage.watchers)}get isEditable(){return this.workPackage.isEditable}}Object(n.c)([Object(f.a)(),Object(n.e)("design:type",u.a)],w.prototype,"wpCacheService",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",h.a)],w.prototype,"states",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",a.a)],w.prototype,"I18n",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",p.a)],w.prototype,"keepTab",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",r.a)],w.prototype,"PathHelper",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",g.a)],w.prototype,"halEditing",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",c.a)],w.prototype,"wpTableFocus",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",m.a)],w.prototype,"notificationService",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",o.a)],w.prototype,"projectCacheService",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",d.a)],w.prototype,"authorisationService",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",s.i)],w.prototype,"cdRef",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",l.a)],w.prototype,"titleService",void 0)},"s/U8":function(e,t,i){"use strict";i.d(t,"a",(function(){return $}));var n=i("ug4p"),s=(i("ii2/"),i("uSJ+")),a=i("Jui0"),r=i("NawS"),c=i("wZYP"),o=i("/C7M"),l=i("qc15"),d=i("AEvm"),u=i("fXoL"),h=i("ofXK"),p=i("th4C"),g=i("/Rze"),m=i("N5AO"),f=i("kor4"),b=i("3Pt+"),w=i("oUDv"),v=i("0loS"),y=i("711n"),k=i("80WE"),C=i("32V0");const j=["relationDescriptionTextarea"];function x(e,t){if(1&e&&u.hc(0,"span",17),2&e){const e=u.wc(3);u.Bc("textContent",e.normalizedRelationType)}}function T(e,t){if(1&e&&u.hc(0,"span",17),2&e){const e=u.wc(3);u.Bc("textContent",e.relatedWorkPackage.type.name)}}function S(e,t){if(1&e){const e=u.nc();u.mc(0,"span",14),u.uc("accessibleClick",(function(){return u.Qc(e),u.wc(2).activateRelationTypeEdit()})),u.Yc(1,x,1,1,"span",15),u.Yc(2,T,1,1,"span",15),u.hc(3,"span",16),u.lc()}if(2&e){const e=u.wc(2);u.Tb(1),u.Bc("ngIf",e.groupByWorkPackageType),u.Tb(1),u.Bc("ngIf",!e.groupByWorkPackageType),u.Tb(1),u.Bc("textContent",e.text.updateRelation)}}function P(e,t){if(1&e&&u.hc(0,"option",21),2&e){const e=t.$implicit;u.Bc("textContent",e.label)("ngValue",e)}}function I(e,t){if(1&e){const e=u.nc();u.mc(0,"div",18),u.mc(1,"select",19),u.uc("ngModelChange",(function(t){return u.Qc(e),u.wc(2).selectedRelationType=t}))("change",(function(){return u.Qc(e),u.wc(2).saveRelationType()}))("keydown.escape",(function(t){return u.Qc(e),u.wc(2).cancelRelationTypeEditOnEscape(t)})),u.Yc(2,P,1,2,"option",20),u.lc(),u.lc()}if(2&e){const e=u.wc(2);u.Tb(1),u.Bc("ngModel",e.selectedRelationType),u.Tb(1),u.Bc("ngForOf",e.availableRelationTypes)}}const O=function(e){return{workPackageId:e}};function R(e,t){if(1&e&&(u.mc(0,"div",22),u.hc(1,"a",23),u.lc()),2&e){const e=u.wc(2);u.Tb(1),u.Bc("uiParams",u.Gc(3,O,e.relatedWorkPackage.id))("textContent",e.relatedWorkPackage.subjectWithId()),u.Ub("aria-label",e.normalizedRelationType+" "+e.relatedWorkPackage.subjectWithId())}}function B(e,t){if(1&e&&(u.mc(0,"edit-form",24),u.hc(1,"editable-attribute-field",25),u.lc()),2&e){const e=u.wc(2);u.Bc("resource",e.relatedWorkPackage),u.Tb(1),u.Bc("resource",e.relatedWorkPackage)}}function E(e,t){if(1&e){const e=u.nc();u.mc(0,"accessible-by-keyboard",26),u.uc("execute",(function(){u.Qc(e);const t=u.wc(2);return t.removeRelation(t.relation)})),u.hc(1,"op-icon",27),u.lc()}if(2&e){const e=u.wc(2);u.Bc("linkAriaLabel",e.text.removeButton)("linkTitle",e.text.removeButton),u.Tb(1),u.Bc("icon-title",e.text.removeButton)}}const M=function(e){return{"-placeholder":e}};function F(e,t){if(1&e){const e=u.nc();u.mc(0,"div",31),u.uc("accessibleClick",(function(){return u.Qc(e),u.wc(3).startDescriptionEdit()})),u.lc()}if(2&e){const e=u.wc(3);u.Bc("ngClass",u.Gc(2,M,!e.relation.description))("textContent",e.relation.description||e.text.placeholder.description)}}function A(e,t){if(1&e){const e=u.nc();u.mc(0,"div",32),u.mc(1,"textarea",33,34),u.uc("keyup",(function(t){return u.Qc(e),u.wc(3).handleDescriptionKey(t)}))("ngModelChange",(function(t){return u.Qc(e),u.wc(3).userInputs.newRelationText=t})),u.lc(),u.mc(3,"edit-field-controls",35),u.uc("onSave",(function(){return u.Qc(e),u.wc(3).saveDescription()}))("onCancel",(function(){return u.Qc(e),u.wc(3).cancelDescriptionEdit()})),u.lc(),u.lc()}if(2&e){const e=u.wc(3);u.Tb(1),u.Bc("ngModel",e.userInputs.newRelationText),u.Tb(2),u.Bc("fieldController",e.fieldController)("saveTitle",e.text.save)("cancelTitle",e.text.cancel)}}function D(e,t){if(1&e&&(u.mc(0,"div",28),u.Yc(1,F,1,4,"div",29),u.Yc(2,A,4,4,"div",30),u.lc()),2&e){const e=u.wc(2);u.Tb(1),u.Bc("ngIf",!e.userInputs.showDescriptionEditForm),u.Tb(1),u.Bc("ngIf",e.userInputs.showDescriptionEditForm)}}const q=function(e){return{"-visible":e}};function L(e,t){if(1&e){const e=u.nc();u.mc(0,"div",1),u.mc(1,"div",2),u.mc(2,"div",3),u.Yc(3,S,4,3,"span",4),u.Yc(4,I,3,2,"div",5),u.lc(),u.Yc(5,R,2,5,"div",6),u.mc(6,"div",7),u.Yc(7,B,2,2,"edit-form",8),u.lc(),u.mc(8,"div",9),u.mc(9,"accessible-by-keyboard",10),u.uc("execute",(function(){u.Qc(e);const t=u.wc();return t.userInputs.showRelationInfo=!t.userInputs.showRelationInfo})),u.hc(10,"op-icon",11),u.lc(),u.Yc(11,E,2,3,"accessible-by-keyboard",12),u.lc(),u.lc(),u.Yc(12,D,3,2,"div",13),u.lc()}if(2&e){const e=u.wc();u.Vb("relation-row relation-row-",e.relatedWorkPackage.id,""),u.Tb(3),u.Bc("ngIf",!e.userInputs.showRelationTypesForm),u.Tb(1),u.Bc("ngIf",e.userInputs.showRelationTypesForm),u.Tb(1),u.Bc("ngIf",e.relatedWorkPackage),u.Tb(2),u.Bc("ngIf",e.relatedWorkPackage),u.Tb(2),u.Bc("linkAriaLabel",e.text.description_label)("linkTitle",e.text.description_label)("ngClass",u.Gc(12,q,e.showDescriptionInfo)),u.Tb(2),u.Bc("ngIf",e.relation.delete),u.Tb(1),u.Bc("ngIf",e.userInputs.showRelationInfo)}}class $ extends d.a{constructor(e,t,i,n,s,a,r){super(),this.wpCacheService=e,this.notificationService=t,this.wpRelations=i,this.halEvents=n,this.I18n=s,this.cdRef=a,this.PathHelper=r,this.showRelationInfo=!1,this.showEditForm=!1,this.userInputs={newRelationText:"",showDescriptionEditForm:!1,showRelationTypesForm:!1,showRelationInfo:!1},this.fieldController={handler:{active:!0},required:!1},this.text={cancel:this.I18n.t("js.button_cancel"),save:this.I18n.t("js.button_save"),removeButton:this.I18n.t("js.relation_buttons.remove"),description_label:this.I18n.t("js.relation_buttons.update_description"),toggleDescription:this.I18n.t("js.relation_buttons.toggle_description"),updateRelation:this.I18n.t("js.relation_buttons.update_relation"),placeholder:{description:this.I18n.t("js.placeholders.relation_description")}}}ngOnInit(){this.relation=this.relatedWorkPackage.relatedBy,this.userInputs.newRelationText=this.relation.description||"",this.availableRelationTypes=r.a.LOCALIZED_RELATION_TYPES(!1),this.selectedRelationType=_.find(this.availableRelationTypes,{name:this.relation.normalizedType(this.workPackage)}),this.wpCacheService.observe(this.relatedWorkPackage.id).pipe(this.untilDestroyed()).subscribe(e=>{this.relatedWorkPackage=e})}get normalizedRelationType(){var e=this.relation.normalizedType(this.workPackage);return this.I18n.t("js.relation_labels."+e)}get relationReady(){return this.relatedWorkPackage&&this.relatedWorkPackage.$loaded}startDescriptionEdit(){this.userInputs.showDescriptionEditForm=!0,setTimeout(()=>{const e=jQuery(this.relationDescriptionTextarea.nativeElement),t=e.val().length;e.focus(),e.prop("selectionStart",t),e.prop("selectionEnd",t)})}handleDescriptionKey(e){27===e.which&&this.cancelDescriptionEdit()}cancelDescriptionEdit(){this.userInputs.showDescriptionEditForm=!1,this.userInputs.newRelationText=this.relation.description||""}saveDescription(){this.wpRelations.updateRelation(this.relation,{description:this.userInputs.newRelationText}).then(e=>{this.relation=e,this.relatedWorkPackage.relatedBy=e,this.userInputs.showDescriptionEditForm=!1,this.notificationService.showSave(this.relatedWorkPackage),this.cdRef.detectChanges()})}get showDescriptionInfo(){return this.userInputs.showRelationInfo||this.relation.description}activateRelationTypeEdit(){this.groupByWorkPackageType&&(this.userInputs.showRelationTypesForm=!0)}cancelRelationTypeEditOnEscape(e){this.userInputs.showRelationTypesForm=!1}saveRelationType(){this.wpRelations.updateRelationType(this.workPackage,this.relatedWorkPackage,this.relation,this.selectedRelationType.name).then(e=>{this.notificationService.showSave(this.relatedWorkPackage),this.relatedWorkPackage.relatedBy=e,this.relation=e,this.userInputs.showRelationTypesForm=!1,this.cdRef.detectChanges()}).catch(e=>this.notificationService.handleRawError(e,this.workPackage))}toggleUserDescriptionForm(){this.userInputs.showDescriptionEditForm=!this.userInputs.showDescriptionEditForm}removeRelation(){this.wpRelations.removeRelation(this.relation).then(()=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:null,relationType:this.relation.normalizedType(this.workPackage)}),this.wpCacheService.updateWorkPackage(this.relatedWorkPackage),this.notificationService.showSave(this.relatedWorkPackage)}).catch(e=>this.notificationService.handleRawError(e,this.relatedWorkPackage))}}$.\u0275fac=function(e){return new(e||$)(u.gc(n.a),u.gc(l.a),u.gc(s.a),u.gc(o.a),u.gc(c.a),u.gc(u.i),u.gc(a.a))},$.\u0275cmp=u.ac({type:$,selectors:[["wp-relation-row"]],viewQuery:function(e,t){var i;(1&e&&u.fd(j,!0),2&e)&&(u.Nc(i=u.vc())&&(t.relationDescriptionTextarea=i.first))},inputs:{workPackage:"workPackage",relatedWorkPackage:"relatedWorkPackage",groupByWorkPackageType:"groupByWorkPackageType"},features:[u.Qb],decls:1,vars:1,consts:[["focus-within","'.wp-relations-controls-section accessible-by-keyboard'",3,"class",4,"ngIf"],["focus-within","'.wp-relations-controls-section accessible-by-keyboard'"],[1,"grid-block","hierarchy-item"],[1,"grid-content","medium-2","collapse"],["class","relation-row--type","tabindex","0",3,"accessibleClick",4,"ngIf"],["class","inline-edit--container inplace-edit",4,"ngIf"],["class","grid-content medium-5 collapse",4,"ngIf"],[1,"grid-content","medium-3","collapse","wp-relations-status-field"],[3,"resource",4,"ngIf"],["ng-class","{'-expanded': userInputs.showRelationInfo }",1,"grid-content","medium-2","collapse","wp-relations-controls-section"],["linkClass","wp-relations--description-btn",3,"linkAriaLabel","linkTitle","ngClass","execute"],["icon-classes","icon-info1 -padded wp-relations--icon wp-relations--description-icon","icon-title","text.toggleDescription"],["aria-hidden","false","linkClass","relation-row--remove-btn",3,"linkAriaLabel","linkTitle","execute",4,"ngIf"],["class","grid-block hierarchy-item description-container",4,"ngIf"],["tabindex","0",1,"relation-row--type",3,"accessibleClick"],[3,"textContent",4,"ngIf"],[1,"hidden-for-sighted",3,"textContent"],[3,"textContent"],[1,"inline-edit--container","inplace-edit"],["role","listbox","focus","",1,"inline-edit--field","form--select",3,"ngModel","ngModelChange","change","keydown.escape"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],[3,"textContent","ngValue"],[1,"grid-content","medium-5","collapse"],["uiSref","work-packages.show.relations",1,"wp-relations--subject-field",3,"uiParams","textContent"],[3,"resource"],["fieldName","status",3,"resource"],["aria-hidden","false","linkClass","relation-row--remove-btn",3,"linkAriaLabel","linkTitle","execute"],["icon-classes","icon-remove -padded wp-relations--icon",3,"icon-title"],[1,"grid-block","hierarchy-item","description-container"],["class","wp-relation--description-read-value",3,"ngClass","textContent","accessibleClick",4,"ngIf"],["class","wp-relation--description-wrapper textarea-wrapper",4,"ngIf"],[1,"wp-relation--description-read-value",3,"ngClass","textContent","accessibleClick"],[1,"wp-relation--description-wrapper","textarea-wrapper"],["autofocus","","name","description",1,"wp-relation--description-textarea",3,"ngModel","keyup","ngModelChange"],["relationDescriptionTextarea",""],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel"]],template:function(e,t){1&e&&u.Yc(0,L,13,14,"div",0),2&e&&u.Bc("ngIf",t.workPackage&&t.relatedWorkPackage)},directives:[h.q,p.a,g.a,h.n,m.a,f.a,b.y,w.a,b.m,b.p,h.p,b.r,b.B,v.AnchorUISref,v.UISref,y.a,k.a,b.c,C.a],encapsulation:2})},sBdf:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("mrSG"),s=i("sjKJ"),a=i("OGNV"),r=i("Jui0"),c=i("0bag"),o=i("PHo6"),l=i("kTsZ"),d=i("wZYP"),u=i("d/TE"),h=i("fXoL");class p{constructor(e,t,i,n,s,a,r){this.CurrentProject=e,this.pathHelper=t,this.QueryDm=i,this.halResourceService=n,this.QueryFormDm=s,this.notifications=a,this.I18n=r,this.v3=this.pathHelper.api.v3}create(e,t){let i=JSON.stringify(t);return this.QueryFormDm.loadWithParams({pageSize:0,filters:i},void 0,this.CurrentProject.identifier,this.buildQueryRequest(e)).then(e=>{if(e.schema.public.writable){const t=this.QueryFormDm.buildQueryResource(e);return this.QueryDm.create(t,e)}throw new Error(this.I18n.t("js.boards.error_permission_missing"))})}addFreeQuery(e,t){const i=this.freeBoardQueryFilter();return this.addQuery(e,t,[i])}addQuery(e,t,i){return Object(n.b)(this,void 0,void 0,(function*(){const n=e.queries.length;try{let s={_type:"GridWidget",identifier:"work_package_query",startRow:1,endRow:2,startColumn:n+1,endColumn:n+2,options:{queryId:(yield this.create(t,i)).id,filters:i}},a=this.halResourceService.createHalResourceOfClass(o.a,s);e.addQuery(a)}catch(s){this.notifications.addError(s),console.error(s)}return e}))}buildQueryRequest(e){return Object.assign({hidden:!0,public:!0,_links:{sortBy:[{href:this.v3.resource("/queries/sort_bys/manualSorting-asc")},{href:this.v3.resource("/queries/sort_bys/id-asc")}]}},e)}freeBoardQueryFilter(){return{manualSort:{operator:"ow",values:[]}}}}p.\u0275fac=function(e){return new(e||p)(h.qc(s.a),h.qc(r.a),h.qc(c.a),h.qc(l.a),h.qc(a.a),h.qc(u.a),h.qc(d.a))},p.\u0275prov=h.cc({token:p,factory:p.\u0275fac,providedIn:"root"})},saRB:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return r}));var n=i("fXoL"),s=i("CVKj");const a="macro.embedded-table";class r{constructor(e){this.elementRef=e,this.configuration={actionsColumnEnabled:!1,columnMenuEnabled:!1,contextMenuEnabled:!1}}ngOnInit(){const e=this.elementRef.nativeElement;this.queryProps=JSON.parse(e.dataset.queryProps)}}r.\u0275fac=function(e){return new(e||r)(n.gc(n.q))},r.\u0275cmp=n.ac({type:r,selectors:[["macro",8,"embedded-table"]],attrs:["class","embedded-table"],decls:1,vars:2,consts:[[3,"queryProps","configuration"]],template:function(e,t){1&e&&n.hc(0,"wp-embedded-table-entry",0),2&e&&n.Bc("queryProps",t.queryProps)("configuration",t.configuration)},directives:[s.a],encapsulation:2})},sjKJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("Jui0"),s=i("fXoL");class a{constructor(e){this.PathHelper=e,this.detect()}get inProjectContext(){return void 0!==this.current}get path(){return this.current?this.PathHelper.projectPath(this.current.identifier):null}get apiv3Path(){return this.current?this.PathHelper.api.v3.projects.id(this.current.id).toString():null}get id(){return this.getCurrent("id")}get name(){return this.getCurrent("name")}get identifier(){return this.getCurrent("identifier")}getCurrent(e){return this.current&&this.current[e]?this.current[e].toString():null}detect(){const e=document.querySelector("meta[name=current_project]");e&&(this.current={id:e.dataset.projectId,name:e.dataset.projectName,identifier:e.dataset.projectIdentifier})}}a.\u0275fac=function(e){return new(e||a)(s.qc(n.a))},a.\u0275prov=s.cc({token:a,factory:a.\u0275fac,providedIn:"root"})},sl7t:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("/cHX"),s=i("lJrL");class a extends n.a{constructor(e,t,i,n,s,a){super(e,t),this.injector=e,this.workPackage=t,this.identifier=i,this.title=n,this.applicable=s,this.onClick=a}static factoryFor(e,t,i,n=(()=>!0)){return(s,r)=>new a(s,r,e,t,n,i)}buildElement(){if(!this.applicable(this.workPackage))return null;let e=document.createElement("a");return e.title=this.title,e.href="#",e.classList.add(n.b,"wp-table-action--unlink"),e.dataset.workPackageId=this.workPackage.id,e.appendChild(Object(s.a)("icon","icon-close")),jQuery(e).click(e=>{e.preventDefault(),this.onClick(this.workPackage)}),e}}},sngl:function(e,t,i){"use strict";i.d(t,"b",(function(){return T})),i.d(t,"a",(function(){return S}));var n=i("fXoL"),s=i("8zkO"),a=i("JY8V"),r=i("SqdZ"),c=i("tN7n"),o=i("H3ou"),l=i("OGNV"),d=i("+oAL"),u=i("E2tj"),h=i("Y0Nk"),p=i("wZYP"),g=i("IaZ+"),m=i("qc15"),f=i("ofXK"),b=i("CS/5");const w=["tabContentOutlet"];function v(e,t){1&e&&n.ic(0)}function y(e,t){if(1&e&&(n.kc(0),n.Yc(1,v,1,0,"ng-container",13),n.jc()),2&e){const e=n.wc();n.Tb(1),n.Bc("ngComponentOutlet",e.prependModalComponent)("ngComponentOutletInjector",e.injector)}}const k=function(e,t){return{selected:e,"-disabled":t}},C=function(e){return{selected:e}};function j(e,t){if(1&e){const e=n.nc();n.mc(0,"li",17),n.mc(1,"a",18),n.uc("click",(function(){n.Qc(e);const i=t.$implicit;return n.wc(2).switchTo(i.name)})),n.lc(),n.lc()}if(2&e){const e=t.$implicit,i=n.wc(2);n.Bc("ngClass",n.Hc(4,k,i.currentTab&&e.name===i.currentTab.name,null!=e.disableBecause)),n.Tb(1),n.Bc("ngClass",n.Gc(7,C,i.currentTab&&e.name===i.currentTab.name))("textContent",e.title),n.Ub("title",e.disableBecause||e.title)}}function x(e,t){if(1&e&&(n.mc(0,"div",14),n.mc(1,"ul",15),n.Yc(2,j,2,9,"li",16),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(2),n.Bc("ngForOf",e.availableTabs)}}const T=new n.z("WpTableConfigurationModalPrependComponent");class S extends r.a{constructor(e,t,i,s,a,r,o,l,d,u,h,p,g,m,f){super(e,g,f),this.locals=e,this.prependModalComponent=t,this.I18n=i,this.injector=s,this.appRef=a,this.componentFactoryResolver=r,this.loadingIndicator=o,this.querySpace=l,this.queryFormDm=d,this.wpStatesInitialization=u,this.notificationService=h,this.wpTableColumns=p,this.cdRef=g,this.ConfigurationService=m,this.elementRef=f,this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.text={title:this.I18n.t("js.work_packages.table_configuration.modal_title"),closePopup:this.I18n.t("js.close_popup_title"),columnsLabel:this.I18n.t("js.label_columns"),selectedColumns:this.I18n.t("js.description_selected_columns"),multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect"),applyButton:this.I18n.t("js.modals.button_apply"),cancelButton:this.I18n.t("js.modals.button_cancel"),upsaleRelationColumns:this.I18n.t("js.modals.upsale_relation_columns"),upsaleRelationColumnsLink:this.I18n.t("js.modals.upsale_relation_columns_link")},this.onDataUpdated=new n.s,this.selectedColumnMap={},this.wpTableConfigurationService=this.injector.get(c.a,new c.a(this.I18n))}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.tabPortalHost=new o.a(this.wpTableConfigurationService.tabs,this.tabContentOutlet.nativeElement,this.componentFactoryResolver,this.appRef,this.injector),this.loadingIndicator.indicator("modal").promise=this.loadForm().then(()=>{const e=this.locals.initialTab||this.availableTabs[0].name;this.switchTo(e)})}ngOnDestroy(){this.onDataUpdated.complete(),this.tabPortalHost.dispose()}get availableTabs(){return this.tabPortalHost.availableTabs}get currentTab(){return this.tabPortalHost.currentTab}switchTo(e){this.tabPortalHost.switchTo(e)}saveChanges(){this.tabPortalHost.activeComponents.forEach(e=>{e.onSave()}),this.onDataUpdated.emit(),this.service.close()}onClose(){return this.afterFocusOn.focus(),!0}get afterFocusOn(){return this.$element}loadForm(){const e=this.querySpace.query.value;return this.queryFormDm.load(e).then(t=>(this.wpStatesInitialization.updateStatesFromForm(e,t),t)).catch(e=>this.notificationService.handleRawError(e))}}S.\u0275fac=function(e){return new(e||S)(n.gc(g.a),n.gc(T,8),n.gc(p.a),n.gc(n.A),n.gc(n.f),n.gc(n.l),n.gc(h.a),n.gc(u.a),n.gc(l.a),n.gc(d.a),n.gc(m.a),n.gc(a.a),n.gc(n.i),n.gc(s.a),n.gc(n.q))},S.\u0275cmp=n.ac({type:S,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(w,!0),2&e)&&(n.Nc(i=n.vc())&&(t.tabContentOutlet=i.first))},features:[n.Qb],decls:13,vars:6,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","-wide","wp-table--configuration-modal","loading-indicator--location"],[1,"op-modal--modal-header"],[3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[4,"ngIf"],["class","content--tabs scrollable-tabs",4,"ngIf"],[1,"tab-content"],["tabContentOutlet",""],[1,"modal--form-actions"],[1,"button","-highlight",3,"textContent","click"],[1,"button",3,"textContent","click"],[4,"ngComponentOutlet","ngComponentOutletInjector"],[1,"content--tabs","scrollable-tabs"],[1,"tabrow"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["role","button","href","",1,"tab-show",3,"ngClass","textContent","click"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.hc(3,"h3",3),n.mc(4,"a",4),n.mc(5,"i",5),n.uc("click",(function(e){return t.closeMe(e)})),n.lc(),n.lc(),n.lc(),n.Yc(6,y,2,2,"ng-container",6),n.Yc(7,x,3,1,"div",7),n.hc(8,"div",8,9),n.mc(10,"div",10),n.mc(11,"button",11),n.uc("click",(function(){return t.saveChanges()})),n.lc(),n.mc(12,"button",12),n.uc("click",(function(e){return t.closeMe(e)})),n.lc(),n.lc(),n.lc(),n.lc()),2&e&&(n.Tb(3),n.Bc("textContent",t.text.title),n.Tb(2),n.Ub("title",t.text.closePopup),n.Tb(1),n.Bc("ngIf",!!t.prependModalComponent),n.Tb(1),n.Bc("ngIf",!!t.tabPortalHost),n.Tb(4),n.Bc("textContent",t.text.applyButton),n.Tb(1),n.Bc("textContent",t.text.cancelButton))},directives:[f.q,f.o,b.a,f.p,f.n],encapsulation:2})},"t+3x":function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("wZYP"),s=i("Jui0"),a=(i("ii2/"),i("pL6k")),r=i("VgZ9"),c=i("sl7t"),o=i("FDFi"),l=i("Rky/"),d=i("f9kS"),u=i("ug4p"),h=i("pLZG"),p=(i("B4Ei"),i("/C7M")),g=i("fXoL"),m=i("ofXK"),f=i("72oW");function b(e,t){if(1&e&&(g.mc(0,"div",4),g.mc(1,"div",5),g.hc(2,"h3",6),g.lc(),g.lc()),2&e){const e=g.wc(2);g.Tb(2),g.Bc("textContent",e.group.name)}}const w=function(e){return{actionsColumnEnabled:!0,hierarchyToggleEnabled:!1,inlineCreateEnabled:!0,compactTableStyle:!0,columnMenuEnabled:!1,contextMenuEnabled:!1,projectIdentifier:e,projectContext:!1}};function v(e,t){if(1&e){const e=g.nc();g.kc(0),g.Yc(1,b,3,1,"div",1),g.mc(2,"wp-embedded-table",2,3),g.uc("onQueryLoaded",(function(t){return g.Qc(e),g.wc().handleQueryLoaded(t)})),g.lc(),g.jc()}if(2&e){const e=g.wc();g.Tb(1),g.Bc("ngIf",e.group),g.Tb(1),g.Bc("initialLoadingIndicator",!1)("queryProps",e.queryProps)("tableActions",e.tableActions)("configuration",g.Gc(5,w,e.workPackage.project.idFromLink))}}class y extends l.a{constructor(e,t,i,n,s,a,r){super(a),this.wpRelationsHierarchyService=e,this.PathHelper=t,this.wpInlineCreate=i,this.halEvents=n,this.wpCacheService=s,this.queryUrlParamsHelper=a,this.I18n=r,this.addExistingChildEnabled=!1,this.tableActions=[c.a.factoryFor("remove-child-action",this.I18n.t("js.relation_buttons.remove_child"),e=>{this.embeddedTable.loadingIndicator=this.wpRelationsHierarchyService.removeChild(e)},e=>!!e.changeParent)]}ngOnInit(){this.wpInlineCreate.referenceTarget=this.workPackage,this.queryProps=this.buildQueryProps(),this.wpInlineCreate.newInlineWorkPackageCreated.pipe(this.untilDestroyed()).subscribe(e=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:e,relationType:"child"})}),this.wpCacheService.observe(this.workPackage.id).pipe(Object(h.a)(()=>this.embeddedTable&&this.embeddedTable.isInitialized),this.untilDestroyed()).subscribe(()=>this.refreshTable())}}y.\u0275fac=function(e){return new(e||y)(g.gc(r.a),g.gc(s.a),g.gc(o.a),g.gc(p.a),g.gc(u.a),g.gc(a.a),g.gc(n.a))},y.\u0275cmp=g.ac({type:y,selectors:[["wp-children-query"]],inputs:{workPackage:"workPackage",query:"query",group:"group",addExistingChildEnabled:"addExistingChildEnabled"},features:[g.Sb([{provide:o.a,useClass:d.a}]),g.Qb],decls:1,vars:1,consts:[[4,"ngIf"],["class","attributes-group--header",4,"ngIf"],[3,"initialLoadingIndicator","queryProps","tableActions","configuration","onQueryLoaded"],["embeddedTable",""],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"]],template:function(e,t){1&e&&g.Yc(0,v,4,7,"ng-container",0),2&e&&g.Bc("ngIf",!t.hidden)},directives:[m.q,f.a],encapsulation:2})},t7qP:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("iB+3"),s=i("4lR/"),a=i("PUHT"),r=i("SKFm"),c=(i("ii2/"),i("RGDJ")),o=i("wZYP"),l=i("d/TE"),d=i("/C7M"),u=i("qc15"),h=i("fXoL");class p extends a.a{constructor(e,t,i,n,s,a,r,c){super(e,t),this.elementRef=e,this.opContextMenu=t,this.$state=i,this.workPackageNotificationService=n,this.halEditing=s,this.notificationService=a,this.I18n=r,this.halEvents=c}open(e){const t=this.halEditing.changeFor(this.workPackage);t.getForm().then(i=>{const n=i.schema.status.allowedValues;this.buildItems(n),t.schema.status.writable?this.opContextMenu.show(this,e):this.notificationService.addError(this.I18n.t("js.work_packages.message_work_package_status_blocked"))})}get locals(){return{items:this.items,contextMenuId:"wp-status-context-menu"}}updateStatus(e){const t=this.halEditing.changeFor(this.workPackage);t.projectedResource.status=e,this.workPackage.isNew||this.halEditing.save(t).then(()=>{this.workPackageNotificationService.showSave(this.workPackage)})}buildItems(e){this.items=e.map(e=>({disabled:!1,linkText:e.name,postIcon:e.isReadonly?"icon-locked":null,postIconTitle:this.I18n.t("js.work_packages.message_work_package_read_only"),class:c.a.inlineClass("status",e.id),onClick:()=>(this.updateStatus(e),!0)}))}}p.\u0275fac=function(e){return new(e||p)(h.gc(h.q),h.gc(s.a),h.gc(n.G),h.gc(u.a),h.gc(r.a),h.gc(l.a),h.gc(o.a),h.gc(d.a))},p.\u0275dir=h.bc({type:p,selectors:[["","wpStatusDropdown",""]],inputs:{workPackage:["wpStatusDropdown-workPackage","workPackage"]},features:[h.Qb]})},t8SH:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("fXoL"),s=i("wZYP"),a=i("sjKJ"),r=i("Jui0"),c=i("ZOsW"),o=i("3Pt+"),l=i("ofXK"),d=i("ximh");const u=["ngSelectComponent"];function h(e,t){if(1&e&&(n.hc(0,"b",4),n.ad(1)),2&e){const e=t.searchTerm,i=n.wc();n.Bc("textContent",i.text.add_new_action),n.Tb(1),n.cd(": ",e," ")}}function p(e,t){if(1&e&&(n.mc(0,"div",5),n.ad(1),n.lc()),2&e){const e=t.item,i=t.searchTerm;n.Bc("ngOptionHighlight",i),n.Tb(1),n.bd(e.name)}}class g{constructor(e,t,i,s){this.I18n=e,this.cdRef=t,this.currentProject=i,this.pathHelper=s,this.required=!1,this.disabled=!1,this.finishedLoading=!1,this.id="",this.classes="",this.hideSelected=!1,this.onChange=new n.s,this.onKeydown=new n.s,this.onOpen=new n.s,this.onClose=new n.s,this.onAfterViewInit=new n.s,this.text={add_new_action:this.I18n.t("js.label_create")},this.createAllowed=!1,this._openDirectly=!1}ngAfterViewInit(){this.onAfterViewInit.emit(this)}openSelect(){this.ngSelectComponent&&(this.ngSelectComponent.open(),this.openDirectly=!1)}closeSelect(){this.ngSelectComponent&&this.ngSelectComponent.close()}changeModel(e){this.onChange.emit(e)}opened(){setTimeout(()=>{const e=this.ngSelectComponent;e&&e.dropdownPanel&&e.dropdownPanel._updatePosition()},25),this.onOpen.emit()}closed(){this.openDirectly=!1,this.onClose.emit()}keyPressed(e){this.onKeydown.emit(e)}get openDirectly(){return this._openDirectly}set openDirectly(e){this._openDirectly=e,e&&this.openSelect()}focusInputField(){this.ngSelectComponent&&this.ngSelectComponent.focus()}}g.\u0275fac=function(e){return new(e||g)(n.gc(s.a),n.gc(n.i),n.gc(a.a),n.gc(r.a))},g.\u0275cmp=n.ac({type:g,selectors:[["create-autocompleter"]],viewQuery:function(e,t){var i;(1&e&&n.fd(u,!0),2&e)&&(n.Nc(i=n.vc())&&(t.ngSelectComponent=i.first))},inputs:{availableValues:"availableValues",appendTo:"appendTo",model:"model",required:"required",disabled:"disabled",finishedLoading:"finishedLoading",id:"id",classes:"classes",typeahead:"typeahead",hideSelected:"hideSelected"},outputs:{onChange:"onChange",onKeydown:"onKeydown",onOpen:"onOpen",onClose:"onClose",onAfterViewInit:"onAfterViewInit"},decls:4,vars:13,consts:[["bindLabel","name",3,"ngModel","items","ngClass","addTag","virtualScroll","required","clearable","disabled","typeahead","clearOnBackspace","appendTo","hideSelected","id","ngModelChange","change","open","close","keydown"],["ngSelectComponent",""],["ng-tag-tmp",""],["ng-option-tmp",""],[3,"textContent"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight"]],template:function(e,t){1&e&&(n.mc(0,"ng-select",0,1),n.uc("ngModelChange",(function(e){return t.model=e}))("change",(function(e){return t.changeModel(e)}))("open",(function(){return t.opened()}))("close",(function(){return t.closed()}))("keydown",(function(e){return t.keyPressed(e)})),n.Yc(2,h,2,2,"ng-template",2),n.Yc(3,p,2,2,"ng-template",3),n.lc()),2&e&&n.Bc("ngModel",t.model)("items",t.availableValues)("ngClass",t.classes)("addTag",t.createAllowed)("virtualScroll",!0)("required",t.required)("clearable",!t.required)("disabled",t.disabled)("typeahead",t.typeahead)("clearOnBackspace",!1)("appendTo",t.appendTo)("hideSelected",t.hideSelected)("id",t.id)},directives:[c.a,o.m,o.p,l.n,o.x,c.l,c.c,d.a],encapsulation:2})},tG68:function(e,t,i){"use strict";i.r(t),i.d(t,"ModalWrapperAugmentService",(function(){return c}));var n=i("ofXK"),s=i("5Lfy"),a=i("IaZ+"),r=i("fXoL");class c{constructor(e,t,i){this.documentElement=e,this.injector=t,this.opModalService=i}setupListener(){const e=this.documentElement.querySelectorAll("section[data-augmented-model-wrapper]");for(let t=0;t<e.length;++t)this.wrapElement(jQuery(e[t]))}wrapElement(e){let t=e.find(".modal-wrapper--activation-link"),i=e.data("activationSelector");i&&(t=jQuery(i)),e.data("modalInitializeNow")?this.show(e):t.click(t=>{this.show(e),t.preventDefault()})}show(e){const t=e.data("modalClassName"),i=e.data("modalIframeUrl");let n=e.find(".modal-wrapper--content").html();i&&(n=this.appendIframe(n,i)),this.opModalService.show(s.a,this.injector,{modalBody:n,modalClassName:t})}appendIframe(e,t){let i=jQuery(e),n=jQuery('<iframe frameborder="0" height="400" allowfullscreen>></iframe>');return n.attr("src",t),i.find(".iframe-target-wrapper").append(n),i.html()}}c.\u0275fac=function(e){return new(e||c)(r.qc(n.d),r.qc(r.A),r.qc(a.b))},c.\u0275prov=r.cc({token:c,factory:c.\u0275fac,providedIn:"root"})},tN7n:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("wZYP"),s=i("Uprc"),a=i("r76g"),r=i("byj5"),c=i("YO9K"),o=i("hj8t"),l=i("yUKD"),d=i("fXoL");class u{constructor(e){this.I18n=e,this._tabs=[{name:"columns",title:this.I18n.t("js.label_columns"),componentClass:a.a},{name:"filters",title:this.I18n.t("js.work_packages.query.filters"),componentClass:r.a},{name:"sort-by",title:this.I18n.t("js.label_sort_by"),componentClass:c.a},{name:"display-settings",title:this.I18n.t("js.work_packages.table_configuration.display_settings"),componentClass:s.a},{name:"highlighting",title:this.I18n.t("js.work_packages.table_configuration.highlighting"),componentClass:l.a},{name:"timelines",title:this.I18n.t("js.timelines.gantt_chart"),componentClass:o.a}]}get tabs(){return this._tabs}}u.\u0275fac=function(e){return new(e||u)(d.qc(n.a))},u.\u0275prov=d.cc({token:u,factory:u.\u0275fac})},th4C:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("2Vo4"),s=i("3UWI"),a=i("AEvm"),r=i("fXoL");class c extends a.a{constructor(e){super(),this.elementRef=e}ngOnInit(){let e=jQuery(this.elementRef.nativeElement),t=new n.a(!1);t.pipe(this.untilDestroyed(),Object(s.a)(50)).subscribe(t=>{e.toggleClass("-focus",t)});e[0].addEventListener("focus",(function(){t.next(!0)}),!0);e[0].addEventListener("blur",(function(){t.next(!1)}),!0),setTimeout(()=>{e.addClass("focus-within--trigger"),e.find(this.selector).addClass("focus-within--depending")},0)}}c.\u0275fac=function(e){return new(e||c)(r.gc(r.q))},c.\u0275dir=r.bc({type:c,selectors:[["","focus-within",""]],inputs:{selector:"selector"},features:[r.Qb]})},tmNb:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("mrSG"),s=i("ofXK"),a=i("OW6k"),r=i("99YG"),c=i("fXoL");class o{constructor(e,t){this.document=e,this.injector=t,this.drake=null,this.members=[],this.escapeListener=e=>{this.drake&&"Escape"===e.key&&this.drake.cancel(!0)},this.document.documentElement.addEventListener("keydown",this.escapeListener)}ngOnDestroy(){this.document.documentElement.removeEventListener("keydown",this.escapeListener),this.autoscroll&&this.autoscroll.destroy(),this.drake&&this.drake.destroy()}remove(e){this.initialized&&(_.remove(this.drake.containers,t=>t===e),_.remove(this.members,t=>t.dragContainer===e))}member(e){return _.find(this.members,t=>t.dragContainer===e)}get initialized(){return null!==this.drake}register(e){this.members.push(e);const t=e.dragContainer;this.autoscroll?this.autoscroll.add(t):this.setupAutoscroll([t]),null===this.drake?this.initializeDrake([t]):this.drake.containers.push(t)}addScrollContainer(e){this.autoscroll?this.autoscroll.add(e):this.setupAutoscroll([e]),this.autoscroll.setOuterScrollContainer(e)}setupAutoscroll(e){this.autoscroll=new a.a(e,{margin:100,maxSpeed:10,scrollWhenOutside:!0,autoScroll:()=>this.drake&&this.drake.dragging})}getMember(e){return this.members.find(t=>t.dragContainer===e)}initializeDrake(e){this.drake=dragula(e,{moves:(e,t,i,n)=>{const s=this.getMember(t);return!!s&&s.moves(e,t,i,n)},accepts:(e,t)=>{const i=this.getMember(t);return!i||!i.accepts||i.accepts(e,t)},invalid:()=>!1,direction:"vertical",copy:!1,revertOnSpill:!0,removeOnSpill:!1,mirrorContainer:document.body,ignoreInputTextSelection:!0}),this.drake.on("drag",(e,t)=>{e.dataset.sourceIndex=r.a.findIndex(e).toString()}),this.drake.on("over",(e,t)=>{const i=t.closest(".drop-zone");i&&i.classList.add("-dragged-over")}),this.drake.on("out",(e,t)=>{const i=t.closest(".drop-zone");i&&i.classList.remove("-dragged-over")}),this.drake.on("cloned",(e,t)=>{const i=this.member(t.parentElement);i&&i.onCloned&&i.onCloned(e,t)}),this.drake.on("drop",(e,t,i,s)=>Object(n.b)(this,void 0,void 0,(function*(){try{yield this.handleDrop(e,t,i,s)}catch(n){console.error("Failed to handle drop of %O, %O",e,n)}}))),this.drake.on("shadow",(e,t)=>{const i=this.member(t);i&&i.onShadowInserted&&i.onShadowInserted(e)}),this.drake.on("cancel",(e,t,i)=>{const n=this.member(t);n&&n.onCancel&&n.onCancel(e)})}handleDrop(e,t,i,s){return Object(n.b)(this,void 0,void 0,(function*(){const n=this.member(t),a=this.member(i);if(n&&a)return n===a?n.onMoved(e,t,i,s):void((yield n.onAdded(e,t,i,s))?a.onRemoved(e,t,i,s):r.a.reinsert(e,e.dataset.sourceIndex||-1,i))}))}}o.\u0275fac=function(e){return new(e||o)(c.qc(s.d),c.qc(c.A))},o.\u0275prov=c.cc({token:o,factory:o.\u0275fac})},"u/Nd":function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("DhiE"),s=i("iMRi"),a=i("POAS"),r=i("d/TE"),c=i("SqdZ"),o=i("IaZ+"),l=i("wZYP"),d=i("E2tj"),u=i("fXoL"),h=i("k1Xe");class p extends c.a{constructor(e,t,i,n,s,a,r,c,o){super(t,a,e),this.elementRef=e,this.locals=t,this.I18n=i,this.states=n,this.querySpace=s,this.cdRef=a,this.wpListService=r,this.halNotification=c,this.notificationsService=o,this.isStarred=!1,this.isPublic=!1,this.isBusy=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text"),save_as:this.I18n.t("js.label_save_as"),label_name:this.I18n.t("js.modals.label_name"),label_visibility_settings:this.I18n.t("js.label_visibility_settings"),button_save:this.I18n.t("js.modals.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")}}ngOnInit(){super.ngOnInit(),this.query=this.querySpace.query.value,this.isStarred=this.query.starred,this.isPublic=this.query.public}setValues(e){this.isStarred=e.isStarred,this.isPublic=e.isPublic}get afterFocusOn(){return jQuery("#work-packages-settings-button")}saveQuery(e){if(this.isBusy)return;this.isBusy=!0;let t=[];this.query.public!==this.isPublic&&(this.query.public=this.isPublic,t.push(this.wpListService.save(this.query))),this.query.starred!==this.isStarred&&t.push(this.wpListService.toggleStarred(this.query)),Promise.all(t).then(()=>{this.closeMe(e),this.isBusy=!1}).catch(()=>{this.notificationsService.addError(this.I18n.t("js.errors.query_saving")),this.isBusy=!1})}}p.\u0275fac=function(e){return new(e||p)(u.gc(u.q),u.gc(o.a),u.gc(l.a),u.gc(s.a),u.gc(d.a),u.gc(u.i),u.gc(n.a),u.gc(a.a),u.gc(r.a))},p.\u0275cmp=u.ac({type:p,selectors:[["ng-component"]],features:[u.Qb],decls:10,vars:8,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","wp-table--configuration-modal","loading-indicator--location"],[1,"op-modal--modal-header"],[3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[3,"isSave","isStarred","isPublic","onChange"],[1,"form--space"],[1,"button","-highlight","-with-icon","icon-checkmark",3,"textContent","click"],[1,"button","-with-icon","icon-cancel",3,"textContent","disabled","click"]],template:function(e,t){1&e&&(u.mc(0,"div",0),u.mc(1,"div",1),u.mc(2,"div",2),u.hc(3,"h3",3),u.mc(4,"a",4),u.mc(5,"i",5),u.uc("click",(function(e){return t.closeMe(e)})),u.lc(),u.lc(),u.lc(),u.mc(6,"query-sharing-form",6),u.uc("onChange",(function(e){return t.setValues(e)})),u.lc(),u.mc(7,"div",7),u.mc(8,"button",8),u.uc("click",(function(e){return t.saveQuery(e)})),u.lc(),u.mc(9,"button",9),u.uc("click",(function(e){return t.closeMe(e)})),u.lc(),u.lc(),u.lc(),u.lc()),2&e&&(u.Tb(3),u.Bc("textContent",t.text.label_visibility_settings),u.Tb(2),u.Ub("title",t.text.close_popup),u.Tb(1),u.Bc("isSave",!1)("isStarred",t.isStarred)("isPublic",t.isPublic),u.Tb(2),u.Bc("textContent",t.text.button_save),u.Tb(1),u.Bc("textContent",t.text.button_cancel)("disabled",t.isBusy))},directives:[h.a],encapsulation:2})},u4T9:function(e,t,i){"use strict";i.d(t,"a",(function(){return j}));var n=i("3Pt+"),s=i("8ggW"),a=i("HN1l"),r=i("g1AQ"),c=i("iB+3"),o=i("0loS"),l=i("+rOU"),d=i("ofXK"),u=i("5+WD"),h=i("CS/5"),p=i("mg4W"),g=i("t8SH"),m=i("ZOsW"),f=i("ximh"),b=i("sjKJ"),w=i("vK8y"),v=i("gh2L"),y=i("iuLl"),k=i("9Ejp"),C=i("fXoL");class j{constructor(e){!function(e){const t=e.get(b.a),i=e.get(w.a),n=e.get(c.G);window.ErrorReporter.addContext(e=>{i.isLoggedIn&&e.setUser({name:i.name,id:i.userId,email:i.mail}),t.inProjectContext&&e.setTag("project",t.identifier),e.setExtra("router state",n.current.name)}),e.get(r.a).register("openProjectAngularBootstrap",()=>[a.b])}(e)}}j.\u0275mod=C.ec({type:j}),j.\u0275inj=C.dc({factory:function(e){return new(e||j)(C.qc(C.A))},imports:[[o.UIRouterModule,d.b,n.i,l.g,u.g,k.b,s.a,m.b,f.b,h.f.withComponents([p.a,v.a,y.a,g.a])],o.UIRouterModule,d.b,n.i,l.g,u.g,s.a,m.b,f.b,h.f]})},u8Ab:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return c}));i("y2Tr");var n=i("Jui0"),s=i("3uR5"),a=i("fXoL");const r="user-avatar";class c{constructor(e,t,i){this.elementRef=e,this.avatarRenderer=t,this.pathHelper=i}ngAfterViewInit(){const e=this.elementRef.nativeElement;let t=this.user||{name:e.dataset.userName,id:e.dataset.userId};this.avatarRenderer.render(e,t,!1,e.dataset.classList)}}c.\u0275fac=function(e){return new(e||c)(a.gc(a.q),a.gc(s.a),a.gc(n.a))},c.\u0275cmp=a.ac({type:c,selectors:[["user-avatar"]],inputs:{user:"user"},decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0})},"uSJ+":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("1MaS"),s=i("Jui0"),a=i("FnNU"),r=i("UD+K"),c=i("kTsZ"),o=i("fXoL");class l extends a.a{constructor(){super(),this.name="WP-Relations",this.relations=Object(a.g)(),this.initializeMembers()}}class d extends r.a{constructor(e,t,i){super(),this.relationsDm=e,this.PathHelper=t,this.halResource=i,this.relationStates=new l}get multiState(){return this.relationStates.relations}load(e){return new Promise((t,i)=>{this.relationsDm.load(e).then(i=>{this.updateRelationsStateTo(e,i),t(this.state(e).value)}).catch(i)})}loadAll(e){return new Promise((t,i)=>{this.relationsDm.loadInvolved(e).then(i=>{this.clearSome(...e),this.accumulateRelationsFromInvolved(e,i),t()}).catch(i)})}find(e,t,i){const n=this.state(e.id).value;if(n)return _.find(n,n=>{const s=n.denormalized(e);return s.target.id===t.id&&s.relationType===i})}removeRelation(e){return e.delete().then(()=>{this.removeFromStates(e)})}updateRelationType(e,t,i,n){const s={_links:{from:{href:e.href},to:{href:t.href}},type:n};return this.updateRelation(i,s)}updateRelation(e,t){return e.updateImmediately(t).then(e=>(this.insertIntoStates(e),e))}addCommonRelation(e,t,i){const n={_links:{from:{href:this.PathHelper.api.v3.work_packages.id(e).toString()},to:{href:this.PathHelper.api.v3.work_packages.id(i).toString()}},type:t},s=this.PathHelper.api.v3.work_packages.id(e).relations.toString();return this.halResource.post(s,n).toPromise().then(e=>(this.insertIntoStates(e),e))}insertIntoStates(e){_.values(e.ids).forEach(t=>{this.multiState.get(t).doModify(t=>(t[e.id]=e,t),()=>{let t={};return t[e.id]=e,t})})}removeFromStates(e){_.values(e.ids).forEach(t=>{this.multiState.get(t).doModify(t=>(delete t[e.id],t),()=>({}))})}updateRelationsStateTo(e,t){const i=this.multiState.get(e),n=_.keyBy(t,e=>e.id);i.putValue(n,"Overriding relations state.")}accumulateRelationsFromInvolved(e,t){e.forEach(e=>{const i=t.filter(t=>t.isInvolved(e));this.updateRelationsStateTo(e,i)})}}d.\u0275fac=function(e){return new(e||d)(o.qc(n.a),o.qc(s.a),o.qc(c.a))},d.\u0275prov=o.cc({token:d,factory:d.\u0275fac})},ug4p:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("iMRi"),s=i("UD+K"),a=i("dMmB"),r=i("qHU1"),c=i("5JuZ"),o=i("fXoL");function l(e){return(e||"new").toString()}class d extends s.a{constructor(e,t,i){super(),this.states=e,this.schemaCacheService=t,this.workPackageDmService=i}updateValue(e,t){this.updateWorkPackageList([t],!1)}updateWorkPackage(e,t=!1){const i=l(e.id);return t||e.isNew?(this.multiState.get(i).putValue(e),Promise.resolve()):this.schemaCacheService.ensureLoaded(e).then(()=>{this.multiState.get(i).putValue(e)})}updateWorkPackageList(e,t=!0){for(var i of e){const e=i,n=l(e.id),s=this.multiState.get(n);e.isNew?s.putValue(e):this.schemaCacheService.ensureLoaded(e).then(()=>{t&&s.hasValue()&&_.isEqual(s.value.$source,e.$source)?Object(r.a)("Skipping identical work package from updating"):this.multiState.get(n).putValue(e)})}}loadWorkPackage(e,t=!1){const i=this.state(e);return"new"===e||this.require(e,t),i}loadAll(e){return new Promise((t,i)=>{this.workPackageDmService.loadWorkPackagesCollectionsFor(_.uniq(e)).then(e=>{_.each(e,e=>{e.schemas&&_.each(e.schemas.elements,e=>{this.states.schemas.get(e.href).putValue(e)}),e.elements&&this.updateWorkPackageList(e.elements),t(void 0)})},i)})}load(e){return new Promise((t,i)=>{const n=e=>{i(e)};this.workPackageDmService.loadWorkPackageById(e,!0).then(i=>{this.schemaCacheService.ensureLoaded(i).then(()=>{this.multiState.get(e).putValue(i),t(i)},n)},n)})}get multiState(){return this.states.workPackages}}d.\u0275fac=function(e){return new(e||d)(o.qc(n.a),o.qc(a.a),o.qc(c.a))},d.\u0275prov=o.cc({token:d,factory:d.\u0275fac})},uhGA:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("mrSG"),s=i("Mo6U"),a=i("PHo6"),r=i("LrpJ");class c extends s.a{constructor(){super(...arguments),this.attachmentsBackend=!0}$initialize(e){super.$initialize(e),this.widgets=this.widgets.map(e=>{let t=new a.a(this.injector,e,!0,this.halInitializer,"GridWidget");return t.grid=this,t})}updateAttachments(){return Object(n.b)(this,void 0,void 0,(function*(){return this.attachments.$update().then(()=>(this.states.forResource(this).putValue(this),this.attachments))}))}}const o=Object(r.a)(c)},ul8C:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("xLNn"),s=i("wZYP"),a=i("PtkW"),r=i("fXoL"),c=i("ofXK"),o=i("N5AO");function l(e,t){if(1&e){const e=r.nc();r.mc(0,"li"),r.mc(1,"button",2),r.uc("click",(function(){return r.Qc(e),r.wc().enableAutoZoom()})),r.hc(2,"op-icon",3),r.lc(),r.lc()}if(2&e){const e=r.wc();r.Tb(1),r.Bc("ngClass",e.getAutoZoomToggleClass()),r.Ub("title",e.text.zoomAuto)}}function d(e,t){if(1&e){const e=r.nc();r.mc(0,"li"),r.mc(1,"button",4),r.uc("click",(function(){return r.Qc(e),r.wc().updateZoomWithDelta(1)})),r.hc(2,"op-icon",5),r.lc(),r.lc()}if(2&e){const e=r.wc();r.Tb(1),r.Bc("disabled",e.isMaxLevel),r.Ub("title",e.text.zoomOut)}}function u(e,t){if(1&e){const e=r.nc();r.mc(0,"li"),r.mc(1,"button",6),r.uc("click",(function(){return r.Qc(e),r.wc().updateZoomWithDelta(-1)})),r.hc(2,"op-icon",7),r.lc(),r.lc()}if(2&e){const e=r.wc();r.Tb(1),r.Bc("disabled",e.isMinLevel),r.Ub("title",e.text.zoomIn)}}class h extends n.a{constructor(e,t,i){super(e),this.I18n=e,this.cdRef=t,this.wpTableTimeline=i,this.buttonId="work-packages-timeline-toggle-button",this.iconClass="icon-view-timeline",this.minZoomLevel="days",this.maxZoomLevel="years",this.isAutoZoom=!1,this.isMaxLevel=!1,this.isMinLevel=!1,this.activateLabel=e.t("js.timelines.button_activate"),this.deactivateLabel=e.t("js.timelines.button_deactivate"),this.text.zoomIn=e.t("js.timelines.zoom.in"),this.text.zoomOut=e.t("js.timelines.zoom.out"),this.text.zoomAuto=e.t("js.timelines.zoom.auto")}ngOnInit(){this.wpTableTimeline.live$().pipe(this.untilDestroyed()).subscribe(()=>{this.isAutoZoom=this.wpTableTimeline.isAutoZoom(),this.isActive=this.wpTableTimeline.isVisible,this.cdRef.detectChanges()}),this.wpTableTimeline.appliedZoomLevel$.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.isMaxLevel=e===this.maxZoomLevel,this.isMinLevel=e===this.minZoomLevel,this.cdRef.detectChanges()})}get label(){return this.isActive?this.deactivateLabel:this.activateLabel}isToggle(){return!0}updateZoomWithDelta(e){this.wpTableTimeline.updateZoomWithDelta(e)}performAction(e){this.toggleTimeline()}toggleTimeline(){this.wpTableTimeline.toggle()}enableAutoZoom(){this.wpTableTimeline.enableAutozoom()}getAutoZoomToggleClass(){return this.isAutoZoom?"-disabled":""}}h.\u0275fac=function(e){return new(e||h)(r.gc(s.a),r.gc(r.i),r.gc(a.a))},h.\u0275cmp=r.ac({type:h,selectors:[["wp-timeline-toggle-button"]],features:[r.Qb],decls:4,vars:3,consts:[["id","work-packages-timeline-mode-selection",1,"toolbar-button-group"],[4,"ngIf"],["id","work-packages-timeline-zoom-auto-button",1,"button","timeline-toolbar--button","toolbar-icon",3,"ngClass","click"],["icon-classes","icon-zoom-auto button--icon"],["id","work-packages-timeline-zoom-out-button",1,"button","timeline-toolbar--button","toolbar-icon",3,"disabled","click"],["icon-classes","icon-zoom-out button--icon"],["id","work-packages-timeline-zoom-in-button",1,"button","timeline-toolbar--button","toolbar-icon",3,"disabled","click"],["icon-classes","icon-zoom-in button--icon"]],template:function(e,t){1&e&&(r.mc(0,"ul",0),r.Yc(1,l,3,2,"li",1),r.Yc(2,d,3,2,"li",1),r.Yc(3,u,3,2,"li",1),r.lc()),2&e&&(r.Tb(1),r.Bc("ngIf",t.isActive),r.Tb(1),r.Bc("ngIf",t.isActive),r.Tb(1),r.Bc("ngIf",t.isActive))},directives:[c.q,c.n,o.a],styles:[".toolbar-button-group[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:last-child{margin-right:10px}"],changeDetection:0})},upbp:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("fXoL"),s=i("ofXK");const a=["scrollContainer"],r=["scrollPane"],c=["scrollRightBtn"],o=["scrollLeftBtn"];function l(e,t){if(1&e){const e=n.nc();n.mc(0,"li"),n.mc(1,"a",11),n.uc("click",(function(){n.Qc(e);const i=t.$implicit;return n.wc().clickTab(i.id)})),n.lc(),n.lc()}if(2&e){const e=t.$implicit,i=n.wc();n.Xb("selected",e.id===i.currentTabId),n.Ub("tab-id",e.id),n.Tb(1),n.Bc("href",e.path,n.Tc)("textContent",e.name)}}class d{constructor(){this.currentTabId="",this.tabs=[],this.classes=["scrollable-tabs"],this.hideLeftButton=!0,this.hideRightButton=!0}ngAfterViewInit(){this.container=this.scrollContainer.nativeElement,this.pane=this.scrollPane.nativeElement,this.determineScrollButtonVisibility(),this.scrollIntoVisibleArea(this.currentTabId)}clickTab(e){this.currentTabId=e}onScroll(e){this.determineScrollButtonVisibility()}determineScrollButtonVisibility(){this.hideLeftButton=this.pane.scrollLeft<=0,this.hideRightButton=this.pane.scrollWidth-this.pane.scrollLeft<=this.container.clientWidth}scrollRight(){this.pane.scrollLeft+=this.container.clientWidth}scrollLeft(){this.pane.scrollLeft-=this.container.clientWidth}scrollIntoVisibleArea(e){const t=jQuery(this.pane).find(`[tab-id=${e}]`),i=t.position().left+Number(t.outerWidth());this.pane.scrollLeft+this.container.clientWidth<i&&(this.pane.scrollLeft=i-this.container.clientWidth+40)}}d.\u0275fac=function(e){return new(e||d)},d.\u0275cmp=n.ac({type:d,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&(n.Wc(a,!0),n.Wc(r,!0),n.Wc(c,!0),n.Wc(o,!0)),2&e)&&(n.Nc(i=n.vc())&&(t.scrollContainer=i.first),n.Nc(i=n.vc())&&(t.scrollPane=i.first),n.Nc(i=n.vc())&&(t.scrollRightBtn=i.first),n.Nc(i=n.vc())&&(t.scrollLeftBtn=i.first))},decls:11,vars:4,consts:[[3,"ngClass"],["scrollContainer",""],[1,"tabrow",3,"scroll"],["scrollPane",""],[3,"selected",4,"ngFor","ngForOf"],[1,"scrollable-tabs--button","-left",3,"hidden","click"],["scrollLeftBtn",""],[1,"icon-arrow-left2"],[1,"scrollable-tabs--button","-right",3,"hidden","click"],["scrollRightBtn",""],[1,"icon-arrow-right2"],[3,"href","textContent","click"]],template:function(e,t){1&e&&(n.mc(0,"div",0,1),n.mc(2,"ul",2,3),n.uc("scroll",(function(e){return t.onScroll(e)})),n.Yc(4,l,2,5,"li",4),n.lc(),n.mc(5,"div",5,6),n.uc("click",(function(){return t.scrollLeft()})),n.hc(7,"span",7),n.lc(),n.mc(8,"div",8,9),n.uc("click",(function(){return t.scrollRight()})),n.hc(10,"span",10),n.lc(),n.lc()),2&e&&(n.Bc("ngClass",t.classes),n.Tb(4),n.Bc("ngForOf",t.tabs),n.Tb(1),n.Bc("hidden",t.hideLeftButton),n.Tb(3),n.Bc("hidden",t.hideRightButton))},directives:[s.n,s.p],encapsulation:2})},"v9+U":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("fXoL"),s=i("8OyR"),a=i("ofXK");function r(e,t){if(1&e&&n.hc(0,"div",1),2&e){const e=n.wc();n.Bc("ngClass",e.resizerClass)}}class c{constructor(){this.resizing=!1,this.end=new n.s,this.start=new n.s,this.move=new n.s,this.customHandler=!1,this.cursorClass="nwse-resize",this.resizerClass="resizer"}ngOnDestroy(){this.removeEventListener()}startResize(e){e.preventDefault(),e.stopPropagation(),1!==e.buttons&&1!==e.which&&0!==e.which||(this.oldX=this.startX=e.clientX||e.pageX||e.touches[0].clientX,this.oldY=this.startY=e.clientY||e.pageY||e.touches[0].clientY,this.newX=e.clientX||e.pageX||e.touches[0].clientX,this.newY=e.clientY||e.pageY||e.touches[0].clientY,this.resizing=!0,this.setResizeCursor(),this.bindEventListener(e),this.start.emit(this.buildDelta(e)))}onMouseUp(e){this.setAutoCursor(),this.removeEventListener(),this.end.emit(this.buildDelta(e))}onMouseMove(e){e.preventDefault(),e.stopPropagation(),this.oldX=this.newX,this.oldY=this.newY,this.newX=e.clientX||e.pageX||e.touches[0].clientX,this.newY=e.clientY||e.pageY||e.touches[0].clientX,this.move.emit(this.buildDelta(e))}bindEventListener(e){this.mouseMoveHandler=this.onMouseMove.bind(this),this.mouseUpHandler=this.onMouseUp.bind(this),window.addEventListener("mousemove",this.mouseMoveHandler),window.addEventListener("touchmove",this.mouseMoveHandler),window.addEventListener("mouseup",this.mouseUpHandler),window.addEventListener("touchend",this.mouseUpHandler)}removeEventListener(){window.removeEventListener("touchmove",this.mouseMoveHandler),window.removeEventListener("mousemove",this.mouseMoveHandler),window.removeEventListener("mouseup",this.mouseUpHandler),window.removeEventListener("touchend",this.mouseUpHandler)}setResizeCursor(){s.a.setBodyCursor(this.cursorClass,"important")}setAutoCursor(){s.a.setBodyCursor("auto")}buildDelta(e){return{origin:e,absolute:{x:this.newX-this.startX,y:this.newY-this.startY},relative:{x:this.newX-this.oldX,y:this.newY-this.oldX}}}}c.\u0275fac=function(e){return new(e||c)},c.\u0275cmp=n.ac({type:c,selectors:[["resizer"]],hostBindings:function(e,t){1&e&&n.uc("mousedown",(function(e){return t.startResize(e)}))("touchstart",(function(e){return t.startResize(e)}))},inputs:{customHandler:"customHandler",cursorClass:"cursorClass",resizerClass:"resizerClass"},outputs:{end:"end",start:"start",move:"move"},ngContentSelectors:["*"],decls:2,vars:1,consts:[[3,"ngClass",4,"ngIf"],[3,"ngClass"]],template:function(e,t){1&e&&(n.Ac(),n.Yc(0,r,1,1,"div",0),n.zc(1)),2&e&&n.Bc("ngIf",!t.customHandler)},directives:[a.q,a.n],encapsulation:2})},vK8y:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{get isLoggedIn(){return this.userMeta.length>0}get userId(){return this.userMeta.data("id")}get name(){return this.userMeta.data("name")}get mail(){return this.userMeta.data("mail")}get language(){return I18n.locale||"en"}get userMeta(){return jQuery("meta[name=current_user]")}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.cc({token:s,factory:s.\u0275fac,providedIn:"root"})},vPHx:function(e,t,i){"use strict";i.r(t);var n=i("PBJw");function s(e){window.OpenProject.getPluginContext().then(t=>{const i=t.services.opModalService,n=t.classes.modals.passwordConfirmation;e(document).on("submit","form[data-request-for-confirmation]",(function(e){const t=jQuery(this);return!!t.find('input[name="_password_confirmation"]').length||function(e,t,i,n){return e.find("_password_confirmation").length>0||(t.preventDefault(),i.show(n,"global").closingEvent.subscribe(t=>{t.confirmed&&(jQuery("<input>").attr({type:"hidden",name:"_password_confirmation",value:t.password_confirmation}).appendTo(e),e.trigger("submit"))}),!1)}(t,e,i,n)}))})}var a,r=i("K247");(a=jQuery)((function(){a(document.documentElement).on("click",e=>{const t=jQuery(e.target);return function(e,t){t.hasClass("-augmented-datepicker")&&(t.attr("autocomplete","off"),new n.a(".-augmented-datepicker",t.val(),{weekNumbers:!0,allowInput:!0},t[0]).show())}(0,t),function(e,t){document.contains(e.target)||e.preventDefault();const i=t.closest("a");if(0===i.length)return;const n=i.attr("href")||"",s=n.indexOf("#");""!==n&&0!==s||(-1!==s&&"#"!==n&&(window.location.hash=n),e.preventDefault())}(e,t),!0});const e=window.location.hash;if(e&&e.startsWith("#"))try{const t=document.querySelector(e);t&&t.scrollIntoView()}catch(t){console.log("Could not scroll to given location hash: "+e+" ( "+t.message+")")}if(a(document).on("submit","form",(function(){window.OpenProject.pageIsSubmitted=!0})),document.querySelector(".warning-bar--item")){let e=document.querySelector("#content");e&&(e.style.marginBottom="100px")}a(window).on("beforeunload",e=>{const t=e.originalEvent;window.OpenProject.pageWasEdited&&!window.OpenProject.pageIsSubmitted&&(t.preventDefault(),t.returnValue="")}),a(document.documentElement).on("dragover drop",e=>(e.preventDefault(),!1)),function(){const e=document.querySelectorAll(".augment--refresh-on-form-changes");for(let t=0;t<e.length;t++){let i=e[t];const n=jQuery(i),s=n.data("refreshUrl"),a=n.data("inputSelector");n.find(a).on("change",()=>{window.location.href=s+"?"+n.serialize()})}}(),s(a),(new r.a).isMobile&&function(){let e=window.scrollY;window.addEventListener("scroll",(function(){let t=window.scrollY<0?0:window.scrollY;!jQuery("#main").hasClass("hidden-navigation")||jQuery("#top-menu").hasClass("-global-search-expanded")||Math.abs(t-e)<=55||(void 0!==e&&void 0!==t&&e>t?jQuery("#wrapper").removeClass("-header-scrolled"):jQuery("#wrapper").addClass("-header-scrolled"),e=t)}))}()}))},vd15:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var n=i("mrSG"),s=(i("ii2/"),i("XZsv")),a=i("ug4p"),r=i("mMv8"),c=i("Y0Nk"),o=i("RuUM"),l=i("fXoL"),d=i("8zkO"),u=i("d/TE"),h=i("wZYP"),p=i("2Uhg"),g=i("qc15"),m=i("ofXK"),f=i("7MH/"),b=i("/Rze"),w=i("N5AO");const v=["commentContainer"];function y(e,t){if(1&e&&l.ic(0,4),2&e){const e=l.wc();l.Bc("ngTemplateOutlet",e.template)}}function k(e,t){if(1&e&&l.hc(0,"edit-form-portal",10),2&e){const e=l.wc(2);l.Bc("schemaInput",e.schema)("changeInput",e.change)("editFieldHandler",e.handler)}}function C(e,t){if(1&e){const e=l.nc();l.mc(0,"div",11),l.uc("dragover",(function(t){return l.Qc(e),l.wc(2).startDragOverActivation(t)})),l.mc(1,"accessible-by-keyboard",12),l.uc("execute",(function(){return l.Qc(e),l.wc(2).activate()})),l.mc(2,"span",13),l.hc(3,"span",14),l.lc(),l.mc(4,"span",15),l.hc(5,"op-icon",16),l.lc(),l.lc(),l.lc()}if(2&e){const e=l.wc(2);l.Tb(1),l.Bc("linkAriaLabel",e.text.editTitle),l.Tb(2),l.Bc("textContent",e.text.placeholder),l.Tb(2),l.Bc("icon-title",e.text.editTitle)}}function j(e,t){if(1&e&&(l.mc(0,"div",5,6),l.mc(2,"div",7),l.Yc(3,k,1,3,"edit-form-portal",8),l.Yc(4,C,6,3,"div",9),l.lc(),l.lc()),2&e){const e=l.wc();l.Tb(3),l.Bc("ngIf",e.active),l.Tb(1),l.Bc("ngIf",!e.active)}}function x(e,t){if(1&e&&l.ic(0,4),2&e){const e=l.wc();l.Bc("ngTemplateOutlet",e.template)}}class T extends p.a{constructor(e,t,i,n,s,a,r,c,o,l,d){super(e,t),this.elementRef=e,this.injector=t,this.commentService=i,this.wpLinkedActivities=n,this.ConfigurationService=s,this.loadingIndicator=a,this.wpCacheService=r,this.workPackageNotificationService=c,this.NotificationsService=o,this.cdRef=l,this.I18n=d,this.text={editTitle:this.I18n.t("js.label_add_comment_title"),addComment:this.I18n.t("js.label_add_comment"),cancelTitle:this.I18n.t("js.label_cancel_comment"),placeholder:this.I18n.t("js.label_add_comment_title")},this.fieldLabel=this.text.editTitle,this.inFlight=!1}ngOnInit(){super.ngOnInit(),this.canAddComment=!!this.workPackage.addComment,this.showAbove=this.ConfigurationService.commentsSortedInDescendingOrder(),this.commentService.quoteEvents.pipe(this.untilDestroyed()).subscribe(e=>{this.activate(e),this.commentContainer.nativeElement.scrollIntoView()})}startDragOverActivation(e){return!!this.active||(this.activate(),e.preventDefault(),!1)}get htmlId(){return"wp-comment-field"}activate(e){super.activate(e),this.showAbove||this.scrollToBottom(),this.cdRef.detectChanges()}deactivate(e){e&&this.focus(),this.active=!1,this.cdRef.detectChanges()}handleUserSubmit(){return Object(n.b)(this,void 0,void 0,(function*(){if(this.inFlight||!this.rawComment)return Promise.resolve();return this.inFlight=!0,yield this.onSubmit(),this.loadingIndicator.wpDetails.promise=this.commentService.createComment(this.workPackage,this.commentValue).then(()=>{this.active=!1,this.NotificationsService.addSuccess(this.I18n.t("js.work_packages.comment_added")),this.wpLinkedActivities.require(this.workPackage,!0),this.wpCacheService.updateWorkPackage(this.workPackage),this.inFlight=!1,this.deactivate(!0)}).catch(e=>{this.inFlight=!1,e instanceof s.a?this.workPackageNotificationService.showError(e,this.workPackage):this.NotificationsService.addError(this.I18n.t("js.work_packages.comment_send_failed"))})}))}scrollToBottom(){const e=jQuery(this.elementRef.nativeElement).scrollParent()[0];e&&setTimeout(()=>{e.scrollTop=e.scrollHeight},400)}setErrors(e){}}T.\u0275fac=function(e){return new(e||T)(l.gc(l.q),l.gc(l.A),l.gc(o.a),l.gc(r.a),l.gc(d.a),l.gc(c.a),l.gc(a.a),l.gc(g.a),l.gc(u.a),l.gc(l.i),l.gc(h.a))},T.\u0275cmp=l.ac({type:T,selectors:[["work-package-comment"]],contentQueries:function(e,t,i){var n;(1&e&&l.Yb(i,l.ab,!0),2&e)&&(l.Nc(n=l.vc())&&(t.template=n.first))},viewQuery:function(e,t){var i;(1&e&&l.fd(v,!0),2&e)&&(l.Nc(i=l.vc())&&(t.commentContainer=i.first))},inputs:{workPackage:"workPackage"},features:[l.Qb],decls:5,vars:3,consts:[["id","work-package-activites-container"],["id","work-package-comment-container"],[3,"ngTemplateOutlet",4,"ngIf"],["class","work-package--details--long-field work-packages--activity--add-comment hide-when-print",4,"ngIf"],[3,"ngTemplateOutlet"],[1,"work-package--details--long-field","work-packages--activity--add-comment","hide-when-print"],["commentContainer",""],[1,"inline-edit--container","inplace-edit"],[3,"schemaInput","changeInput","editFieldHandler",4,"ngIf"],["class","inplace-edit--read",3,"dragover",4,"ngIf"],[3,"schemaInput","changeInput","editFieldHandler"],[1,"inplace-edit--read",3,"dragover"],["spanClass","inplace-editing--container inline-edit--display-field","linkClass","inplace-editing--trigger-link",1,"inplace-editing--trigger-container",3,"linkAriaLabel","execute"],[1,"inplace-editing--trigger-text","inline-edit--formattable-display-text","-default"],[3,"textContent"],[1,"inplace-editing--trigger-icon"],["icon-classes","icon-edit",3,"icon-title"]],template:function(e,t){1&e&&(l.mc(0,"div",0),l.mc(1,"div",1),l.Yc(2,y,1,1,"ng-container",2),l.Yc(3,j,5,2,"div",3),l.Yc(4,x,1,1,"ng-container",2),l.lc(),l.lc()),2&e&&(l.Tb(2),l.Bc("ngIf",!t.showAbove),l.Tb(1),l.Bc("ngIf",t.canAddComment),l.Tb(1),l.Bc("ngIf",t.showAbove))},directives:[m.q,m.x,f.a,b.a,w.a],encapsulation:2,changeDetection:0})},vqYl:function(e,t,i){"use strict";i.r(t),i.d(t,"OpenProject",(function(){return a}));var n=i("FnNU"),s=i("IzEk");class a{constructor(){this.pluginContext=Object(n.f)(),this.pageWasEdited=!1,this.pageIsSubmitted=!1}getPluginContext(){return this.pluginContext.values$().pipe(Object(s.a)(1)).toPromise()}get urlRoot(){return jQuery("meta[name=app_base_path]").attr("content")||""}get environment(){return jQuery("meta[name=openproject_initializer]").data("environment")}get edition(){return jQuery("meta[name=openproject_initializer]").data("edition")}get isStandardEdition(){return"standard"===this.edition}get isBimEdition(){return"bim"===this.edition}guardedLocalStorage(e,t){try{if(void 0===t){const t=window.localStorage.getItem(e);return null===t?void 0:t}window.localStorage.setItem(e,t)}catch(i){console.error("Failed to access your browsers local storage. Is your local database corrupted?")}}}window.OpenProject=new a},w6CH:function(e,t,i){"use strict";i.d(t,"a",(function(){return G}));var n=i("fXoL"),s=i("u4T9"),a=i("XGsO"),r=i("J30J"),c=i("mrSG"),o=i("4rda"),l=i("r0MM"),d=i("07mJ");class u extends o.a{render(e,t){const i=this.resource.bcfViewpoints;if(i&&i.length>0){const t=i[0];e.innerHTML=`\n        <img src="${this.bcfPathHelper.snapshotPath(t)}" class="thumbnail">\n      `}else e.innerHTML=""}}Object(c.c)([Object(l.a)(),Object(c.e)("design:type",d.a)],u.prototype,"bcfPathHelper",void 0);var h=i("tk/3"),p=i("HGdY"),g=i("ofXK");class m{constructor(e){this.documentElement=e}get isBcfActivated(){return this.hasBodyClass("bcf-activated")}hasBodyClass(e){return this.documentElement.body.classList.contains(e)}}m.\u0275fac=function(e){return new(e||m)(n.qc(g.d))},m.\u0275prov=n.cc({token:m,factory:m.\u0275fac});var f=i("mY05"),b=i("XNiG"),w=i("/uUt"),v=i("pLZG"),y=i("SxV6"),k=i("CqXF"),C=i("lfyH"),j=i("FnNU"),x=i("lJxs");class T extends C.a{constructor(e){super(e),this.injector=e,this.revitMessageReceivedSource=new b.a,this._trackingIdNumber=0,this._ready$=Object(j.f)(!1),this.revitMessageReceived$=this.revitMessageReceivedSource.asObservable(),window.RevitBridge?(console.log("window.RevitBridge is already there, so let's hook up the Revit Listener"),this.hookUpRevitListener()):(console.log("Waiting for Revit Plugin to become ready."),window.addEventListener("revit.plugin.ready",()=>{console.log('CAPTURED EVENT "revit.plugin.ready"'),this.hookUpRevitListener()}))}viewerVisible(){return this._ready$.getValueOr(!1)}getViewpoint$(){const e=this.newTrackingId();return this.sendMessageToRevit("ViewpointGenerationRequest",e,""),this.revitMessageReceived$.pipe(Object(w.a)(),Object(v.a)(t=>"ViewpointData"===t.messageType&&t.trackingId===e),Object(y.a)()).pipe(Object(x.a)(e=>{let t=JSON.parse(e.messagePayload);return t.snapshot={snapshot_type:"png",snapshot_data:t.snapshot},t}))}showViewpoint(e,t){this.viewpointsService.getViewPoint$(e,t).subscribe(e=>this.sendMessageToRevit("ShowViewpoint",this.newTrackingId(),JSON.stringify(e)))}sendMessageToRevit(e,t,i){if(!this.viewerVisible())return void console.log("The Revit bridge is not ready yet.");const n=null!=i?JSON.stringify(i):null;window.RevitBridge.sendMessageToRevit(e,t,n)}hookUpRevitListener(){window.RevitBridge.sendMessageToOpenProject=e=>{const t=JSON.parse(e),i=t.messageType,n=t.trackingId,s=JSON.parse(t.messagePayload);this.revitMessageReceivedSource.next({messageType:i,trackingId:n,messagePayload:s})},this._ready$.putValue(!0)}newTrackingId(){return this._trackingIdNumber=this._trackingIdNumber+1,String(this._trackingIdNumber)}onLoad$(){return this._ready$.values$().pipe(Object(k.a)(void 0))}}T.\u0275fac=function(e){return new(e||T)(n.qc(n.A))},T.\u0275prov=n.cc({token:T,factory:T.\u0275fac}),Object(c.c)([Object(l.a)(),Object(c.e)("design:type",f.a)],T.prototype,"viewpointsService",void 0);var S=i("jW2i"),_=i("g1AQ"),P=i("iB+3"),I=(i("ii2/"),i("wZYP")),O=i("ug4p"),R=i("AEvm"),B=i("d/TE"),E=i("4n9w"),M=i("3VS2"),F=i("IzEk");class A{constructor(e){this.bcfApi=e,this.authorizationMap=Object(j.g)()}authorized$(e,t,i){const n=this.authorizationMap.get(e);return n.putFromPromiseIfPristine(()=>this.bcfApi.projects.id(e).extensions.get().toPromise()),n.values$().pipe(Object(x.a)(e=>e[t]&&e[t].includes(i)))}isAllowedTo(e,t,i){return this.authorized$(e,t,i).pipe(Object(F.a)(1)).toPromise().catch(()=>!1)}}A.\u0275fac=function(e){return new(e||A)(n.qc(M.a))},A.\u0275prov=n.cc({token:A,factory:A.\u0275fac,providedIn:"root"});var D=i("N5AO");function q(e,t){if(1&e){const e=n.nc();n.mc(0,"div",7),n.mc(1,"ngx-gallery",8),n.uc("change",(function(t){return n.Qc(e),n.wc(2).onGalleryChanged(t)}))("imagesReady",(function(){return n.Qc(e),n.wc(2).selectViewpointInGallery()}))("previewOpen",(function(){return n.Qc(e),n.wc(2).galleryPreviewOpen()}))("previewClose",(function(){return n.Qc(e),n.wc(2).galleryPreviewClose()})),n.lc(),n.lc()}if(2&e){const e=n.wc(2);n.Tb(1),n.Bc("options",e.galleryOptions)("images",e.galleryImages)}}function L(e,t){if(1&e){const e=n.nc();n.mc(0,"a",9),n.uc("click",(function(){n.Qc(e);const t=n.wc(2);return t.saveViewpoint(t.workPackage)})),n.hc(1,"op-icon",10),n.mc(2,"span",11),n.ad(3),n.lc(),n.lc()}if(2&e){const e=n.wc(2);n.Bc("title",e.text.add_viewpoint),n.Tb(3),n.cd(" ",e.text.viewpoint," ")}}function $(e,t){if(1&e&&(n.kc(0),n.mc(1,"div",1),n.mc(2,"div",2),n.mc(3,"div",3),n.hc(4,"h3",4),n.lc(),n.lc(),n.Yc(5,q,2,2,"div",5),n.Yc(6,L,4,2,"a",6),n.lc(),n.jc()),2&e){const e=n.wc();n.Tb(4),n.Bc("textContent",e.text.bcf),n.Tb(1),n.Bc("ngIf",e.galleryImages.length>0),n.Tb(1),n.Bc("ngIf",e.viewerVisible&&e.createAllowed)}}class N extends R.a{constructor(e,t,i,n,s,a,r,c,o){super(),this.state=e,this.bcfAuthorization=t,this.viewerBridge=i,this.wpCache=n,this.wpCreate=s,this.notifications=a,this.cdRef=r,this.I18n=c,this.viewpointsService=o,this.text={bcf:this.I18n.t("js.bcf.label_bcf"),viewpoint:this.I18n.t("js.bcf.viewpoint"),add_viewpoint:this.I18n.t("js.bcf.add_viewpoint"),show_viewpoint:this.I18n.t("js.bcf.show_viewpoint"),delete_viewpoint:this.I18n.t("js.bcf.delete_viewpoint"),text_are_you_sure:this.I18n.t("js.text_are_you_sure"),notice_successful_create:this.I18n.t("js.notice_successful_create"),notice_successful_delete:this.I18n.t("js.notice_successful_delete")},this.galleryOptions=[{width:"100%",height:"400px",startIndex:0,image:!1,thumbnailsColumns:1,thumbnailsAutoHide:!1,thumbnailSize:"contain",imageAnimation:"",previewAnimation:!1,previewCloseOnEsc:!0,previewKeyboardNavigation:!0,imageSize:"contain",imageArrowsAutoHide:!0,thumbnailsMargin:5,thumbnailMargin:5,previewDownload:!0,previewCloseOnClick:!0,arrowPrevIcon:"icon-arrow-left2",arrowNextIcon:"icon-arrow-right2",closeIcon:"icon-close",downloadIcon:"icon-download",thumbnailActions:this.actions(),actions:this.actions()},{breakpoint:800,width:"100%",height:"400px",imagePercent:80,thumbnailsPercent:20,thumbnailsMargin:5,thumbnailMargin:5},{breakpoint:680,height:"200px",thumbnailsColumns:3,thumbnailsMargin:5,thumbnailMargin:5}],this.viewpoints=[],this.galleryImages=[],this.viewAllowed=!1,this.createAllowed=!1,this.viewerVisible=this.viewerBridge.viewerVisible()}ngAfterViewInit(){this.observeChanges()}observeChanges(){this.wpCache.observe(this.workPackage.id).pipe(this.untilDestroyed()).subscribe(e=>Object(c.b)(this,void 0,void 0,(function*(){this.workPackage=e,this.projectId||(yield this.initialize(this.workPackage)),e.bcfViewpoints&&this.refreshViewpoints(e.bcfViewpoints)})))}initialize(e){return Object(c.b)(this,void 0,void 0,(function*(){this.projectId=e.project.idFromLink,this.viewAllowed=yield this.bcfAuthorization.isAllowedTo(this.projectId,"project_actions","viewTopic"),this.createAllowed=yield this.bcfAuthorization.isAllowedTo(this.projectId,"topic_actions","createViewpoint"),this.loadViewpointFromRoute(e),this.cdRef.detectChanges()}))}refreshViewpoints(e){this.viewpoints=e.map(e=>({href:e.href,snapshotURL:`${e.href}/snapshot`})),this.setViewpointsOnGallery(this.viewpoints)}showViewpoint(e,t){this.viewerBridge.showViewpoint(e,t)}deleteViewpoint(e,t){window.confirm(this.text.text_are_you_sure)&&this.viewpointsService.deleteViewPoint$(e,t).subscribe(e=>{this.notifications.addSuccess(this.text.notice_successful_delete),this.gallery.preview.close()})}saveViewpoint(e){this.viewpointsService.saveViewpoint$(e).subscribe(e=>{this.notifications.addSuccess(this.text.notice_successful_create),this.showIndex=this.viewpoints.length})}loadViewpointFromRoute(e){if("number"==typeof this.state.params.viewpoint){const t=this.state.params.viewpoint;this.showViewpoint(e,t),this.showIndex=t,this.selectViewpointInGallery(),this.state.go(".",Object.assign(Object.assign({},this.state.params),{viewpoint:void 0}),{reload:!1})}}shouldShowGroup(){return this.viewAllowed&&(this.viewpoints.length>0||this.createAllowed&&this.viewerVisible)}actions(){return[{icon:"icon-view-model",onClick:(e,t)=>this.showViewpoint(this.workPackage,t),titleText:this.text.show_viewpoint},{icon:"icon-delete",onClick:(e,t)=>this.deleteViewpoint(this.workPackage,t),titleText:this.text.delete_viewpoint}]}galleryPreviewOpen(){jQuery("#top-menu").addClass("-no-z-index")}galleryPreviewClose(){jQuery("#top-menu").removeClass("-no-z-index")}selectViewpointInGallery(){setTimeout(()=>{var e;return null===(e=this.gallery)||void 0===e?void 0:e.show(this.showIndex)},250)}onGalleryChanged(e){this.showIndex=e.index}set showIndex(e){const t=[...this.galleryOptions];t[0].startIndex=e,this.galleryOptions=t}get showIndex(){return this.galleryOptions[0].startIndex}setViewpointsOnGallery(e){const t=e.length;this.setThumbnailProperties(t),this.showIndex<0||t<1?this.showIndex=0:this.showIndex>=t&&(this.showIndex=t-1),this.galleryImages=e.map(e=>({small:e.snapshotURL,medium:e.snapshotURL,big:e.snapshotURL})),this.cdRef.detectChanges()}setThumbnailProperties(e){const t=[...this.galleryOptions];t[0].thumbnailsColumns=e<5?e:4,t[1].thumbnailsColumns=e<5?e:4,t[2].thumbnailsColumns=e<4?e:3,t[0].height=`${this.dynamicThumbnailHeight(e)}px`,t[1].height=`${this.dynamicThumbnailHeight(e)}px`,t[2].height=`${this.dynamicThumbnailHeight(e)}px`,this.galleryOptions=t}dynamicThumbnailHeight(e){return Math.max(Math.round(300/e),120)}}N.\u0275fac=function(e){return new(e||N)(n.gc(P.G),n.gc(A),n.gc(C.a),n.gc(O.a),n.gc(E.a),n.gc(B.a),n.gc(n.i),n.gc(I.a),n.gc(f.a))},N.\u0275cmp=n.ac({type:N,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.fd(a.a,!0),2&e)&&(n.Nc(i=n.vc())&&(t.gallery=i.first))},inputs:{workPackage:"workPackage"},features:[n.Sb([f.a]),n.Qb],decls:1,vars:1,consts:[[4,"ngIf"],[1,"attributes-group","description-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],["class","bcf--viewpoints",4,"ngIf"],["class","button",3,"title","click",4,"ngIf"],[1,"bcf--viewpoints"],[3,"options","images","change","imagesReady","previewOpen","previewClose"],[1,"button",3,"title","click"],["icon-classes","button--icon icon-add"],[1,"button--text"]],template:function(e,t){1&e&&n.Yc(0,$,7,3,"ng-container",0),2&e&&n.Bc("ngIf",t.shouldShowGroup())},directives:[g.q,a.a,D.a],styles:[".bcf--viewpoints[_ngcontent-%COMP%]{clear:both}ngx-gallery[_ngcontent-%COMP%]{display:inline-block}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-thumbnails .ngx-gallery-arrow{color:var(--content-link-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-arrow.ngx-gallery-disabled{display:none}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper{background:hsla(0,0%,100%,.5);padding:5px}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper .ngx-gallery-icon{margin-top:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper ngx-gallery-action:last-of-type .ngx-gallery-icon{margin-right:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail.ngx-gallery-clickable .ngx-gallery-icon{font-size:1.25rem;color:var(--content-link-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-active, ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{border:1px solid #e7e7e7!important}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-preview-img{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview{background:rgba(0,0,0,.8)!important}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview a:hover{color:#fff}"],changeDetection:0});var Q=i("eIep"),V=i("cp0P");function H(e,t){if(1&e){const e=n.nc();n.mc(0,"div",7),n.mc(1,"ngx-gallery",8),n.uc("change",(function(t){return n.Qc(e),n.wc(2).onGalleryChanged(t)}))("imagesReady",(function(){return n.Qc(e),n.wc(2).selectViewpointInGallery()}))("previewOpen",(function(){return n.Qc(e),n.wc(2).galleryPreviewOpen()}))("previewClose",(function(){return n.Qc(e),n.wc(2).galleryPreviewClose()})),n.lc(),n.lc()}if(2&e){const e=n.wc(2);n.Tb(1),n.Bc("options",e.galleryOptions)("images",e.galleryImages)}}function z(e,t){if(1&e){const e=n.nc();n.mc(0,"a",9),n.uc("click",(function(){n.Qc(e);const t=n.wc(2);return t.saveViewpoint(t.workPackage)})),n.hc(1,"op-icon",10),n.mc(2,"span",11),n.ad(3),n.lc(),n.lc()}if(2&e){const e=n.wc(2);n.Bc("title",e.text.add_viewpoint),n.Tb(3),n.cd(" ",e.text.viewpoint," ")}}function Y(e,t){if(1&e&&(n.kc(0),n.mc(1,"div",1),n.mc(2,"div",2),n.mc(3,"div",3),n.hc(4,"h3",4),n.lc(),n.lc(),n.Yc(5,H,2,2,"div",5),n.Yc(6,z,4,2,"a",6),n.lc(),n.jc()),2&e){const e=n.wc();n.Tb(4),n.Bc("textContent",e.text.bcf),n.Tb(1),n.Bc("ngIf",e.galleryImages.length>0),n.Tb(1),n.Bc("ngIf",e.viewerVisible&&e.createAllowed)}}class W extends N{constructor(){super(...arguments),this.galleryViewpoints=[]}ngAfterViewInit(){this.viewerVisible&&(super.ngAfterViewInit(),this.workPackage.isNew&&this.observeCreation())}observeCreation(){this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed(),Object(F.a)(1),Object(Q.a)(e=>this.viewpointsService.setBcfTopic$(e),e=>e),Object(Q.a)(e=>{this.workPackage=e;const t=this.galleryViewpoints.filter(e=>!e.href&&e.viewpoint).map(e=>this.viewpointsService.saveViewpoint$(this.workPackage,e.viewpoint));return Object(V.a)(t)})).subscribe(e=>{this.showIndex=this.galleryViewpoints.length-1})}showViewpoint(e,t){}deleteViewpoint(e,t){this.galleryViewpoints=this.galleryViewpoints.filter((e,i)=>i!==t),this.setViewpointsOnGallery(this.galleryViewpoints)}saveViewpoint(){this.viewerBridge.getViewpoint$().subscribe(e=>{const t={snapshotURL:e.snapshot.snapshot_data,viewpoint:e};this.galleryViewpoints=[...this.galleryViewpoints,t],this.setViewpointsOnGallery(this.galleryViewpoints),this.showIndex=this.galleryViewpoints.length-1,this.selectViewpointInGallery()})}shouldShowGroup(){return this.createAllowed&&this.viewerVisible}actions(){return super.actions().filter(e=>"icon-delete"===e.icon)}}W.\u0275fac=function(e){return U(e||W)},W.\u0275cmp=n.ac({type:W,selectors:[["ng-component"]],features:[n.Qb],decls:1,vars:1,consts:[[4,"ngIf"],[1,"attributes-group","description-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],["class","bcf--viewpoints",4,"ngIf"],["class","button",3,"title","click",4,"ngIf"],[1,"bcf--viewpoints"],[3,"options","images","change","imagesReady","previewOpen","previewClose"],[1,"button",3,"title","click"],["icon-classes","button--icon icon-add"],[1,"button--text"]],template:function(e,t){1&e&&n.Yc(0,Y,7,3,"ng-container",0),2&e&&n.Bc("ngIf",t.shouldShowGroup())},directives:[g.q,a.a,D.a],styles:[".bcf--viewpoints[_ngcontent-%COMP%]{clear:both}ngx-gallery[_ngcontent-%COMP%]{display:inline-block}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-thumbnails .ngx-gallery-arrow{color:var(--content-link-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-arrow.ngx-gallery-disabled{display:none}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper{background:hsla(0,0%,100%,.5);padding:5px}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper .ngx-gallery-icon{margin-top:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper ngx-gallery-action:last-of-type .ngx-gallery-icon{margin-right:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail.ngx-gallery-clickable .ngx-gallery-icon{font-size:1.25rem;color:var(--content-link-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-active, ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{border:1px solid #e7e7e7!important}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-preview-img{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview{background:rgba(0,0,0,.8)!important}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview a:hover{color:#fff}"],changeDetection:0});const U=n.oc(W);class G{constructor(e){G.bootstrap(e)}static bootstrap(e){if(this.bootstrapCalled)return;this.bootstrapCalled=!0,e.get(r.a).addFieldType(u,"bcfThumbnail",["BCF Thumbnail"]),e.get(_.a).register("prependedAttributeGroups",e=>{if(window.OpenProject.isBimEdition)return e.isNew?W:N})}}G.bootstrapCalled=!1,G.\u0275mod=n.ec({type:G}),G.\u0275inj=n.dc({factory:function(e){return new(e||G)(n.qc(n.A))},providers:[{provide:h.a,useClass:p.a,multi:!0},{provide:C.a,useFactory:e=>window.navigator.userAgent.search("Revit")>-1?new T(e):e.get(S.a,new S.a(e)),deps:[n.A]},m,d.a,f.a],imports:[[s.a,a.b]]})},wEvd:function(e,t){jQuery((function(e){var t=e.datepicker.regional,i=t[I18n.locale]||t[""];"number"==typeof I18n.firstDayOfWeek&&(i.firstDay=I18n.firstDayOfWeek),e.datepicker.setDefaults(i);var n=e.datepicker._gotoToday;e.datepicker._gotoToday=function(t){n.call(this,t);var i=e(t),s=this._getInst(i[0]),a=e.datepicker._formatDate(s);i.val(a),i.blur(),e.datepicker._hideDatepicker()};var s={showWeek:!0,changeMonth:!0,changeYear:!0,yearRange:"c-100:c+10",dateFormat:"yy-mm-dd",showButtonPanel:!0,calculateWeek:function(t){var i=new Date(+t);return 1!=t.getDay()&&i.setDate(t.getDate()-t.getDay()+1),e.datepicker.iso8601Week(i)}};e.datepicker.setDefaults(s),e.extend(e.datepicker,{_originalGotoToday:e.datepicker._gotoToday,_gotoToday:function(t){var i=e(t),n=this._getInst(i[0]),s=new Date,a=this._formatDate(n,s.getDate(),s.getMonth(),s.getFullYear());this._originalGotoToday(t),this._selectDate(t,a)},_inlineDatepicker2:e.datepicker._inlineDatepicker,_inlineDatepicker:function(t,i){this._inlineDatepicker2(t,i);var n=e.datepicker._get(i,"beforeShow");n&&n.apply(t,[t,i])},_checkOffsetOriginal:e.datepicker._checkOffset,_checkOffset:function(t,i,n){var s=e.datepicker._checkOffsetOriginal(t,i,n),a=this._get(t,"alterOffset");if(a){var r=t.input?t.input[0]:null;return a.apply(r,[s])}return s}})}))},wOIT:function(e,t,i){"use strict";i.d(t,"b",(function(){return d})),i.d(t,"a",(function(){return u}));var n=i("wZYP"),s=i("fXoL"),a=i("3Pt+"),r=i("ofXK"),c=i("ecJW");function o(e,t){if(1&e&&s.hc(0,"option",6),2&e){const e=t.$implicit;s.Bc("textContent",e.label)("ngValue",e)}}function l(e,t){if(1&e){const e=s.nc();s.mc(0,"span",7),s.mc(1,"op-date-picker",8),s.uc("onChange",(function(t){return s.Qc(e),s.wc().updateField(t)})),s.lc(),s.lc()}if(2&e){const e=s.wc();s.Tb(1),s.Bc("id",e.fieldId+"_visible")("name",e.fieldId+"_input")("initialDate",e.fieldValue)}}const d="custom-date-action-admin";class u{constructor(e,t,i,n){this.elementRef=e,this.cdRef=t,this.appRef=i,this.I18n=n,this.valueVisible=!1,this.onKey="on",this.currentKey="current",this.currentFieldValue="%CURRENT_DATE%",this.operators=[{key:this.onKey,label:this.I18n.t("js.custom_actions.date.specific")},{key:this.currentKey,label:this.I18n.t("js.custom_actions.date.current_date")}]}ngOnInit(){const e=this.elementRef.nativeElement;this.fieldName=e.dataset.fieldName,this.fieldValue=e.dataset.fieldValue,this.fieldValue===this.currentFieldValue?this.selectedOperator=this.operators[1]:(this.selectedOperator=this.operators[0],this.visibleValue=this.fieldValue),this.toggleValueVisibility()}toggleValueVisibility(){this.valueVisible=this.selectedOperator.key===this.onKey,this.fieldValue===this.currentFieldValue&&(this.fieldValue=""),this.updateDbValue()}updateDbValue(){this.selectedOperator.key===this.currentKey&&(this.fieldValue=this.currentFieldValue)}get fieldId(){return this.fieldName.replace(/\[|\]/g,"_").replace("__","_").replace(/_$/,"")}updateField(e){this.fieldValue=e,this.cdRef.detectChanges()}}u.\u0275fac=function(e){return new(e||u)(s.gc(s.q),s.gc(s.i),s.gc(s.f),s.gc(n.a))},u.\u0275cmp=s.ac({type:u,selectors:[["custom-date-action-admin"]],decls:6,vars:6,consts:[[1,"form--field-container"],[1,"form--select-container"],[1,"form--select",3,"ngModel","ngModelChange","change"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],["class","form--text-field-container -slim",4,"ngIf"],["type","hidden",3,"name","value"],[3,"textContent","ngValue"],[1,"form--text-field-container","-slim"],["classes","form--text-field",3,"id","name","initialDate","onChange"]],template:function(e,t){1&e&&(s.mc(0,"div",0),s.mc(1,"span",1),s.mc(2,"select",2),s.uc("ngModelChange",(function(e){return t.selectedOperator=e}))("change",(function(){return t.toggleValueVisibility()})),s.Yc(3,o,1,2,"option",3),s.lc(),s.lc(),s.Yc(4,l,2,3,"span",4),s.hc(5,"input",5),s.lc()),2&e&&(s.Tb(2),s.Bc("ngModel",t.selectedOperator),s.Ub("id",t.fieldId),s.Tb(1),s.Bc("ngForOf",t.operators),s.Tb(1),s.Bc("ngIf",t.valueVisible),s.Tb(1),s.Bc("name",t.fieldName)("value",t.fieldValue))},directives:[a.y,a.m,a.p,r.p,r.q,a.r,a.B,c.a],encapsulation:2})},wZYP:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this._i18n=window.I18n,this.toNumber=this._i18n.toNumber.bind(this._i18n),this.toPercentage=this._i18n.toPercentage.bind(this._i18n),this.toCurrency=this._i18n.toCurrency.bind(this._i18n),this.strftime=this._i18n.strftime.bind(this._i18n),this.toHumanSize=this._i18n.toHumanSize.bind(this._i18n)}get locale(){return this._i18n.locale}t(e,t){return this._i18n.t(e,t)}lookup(e){return this._i18n.lookup(e)}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.cc({token:s,factory:s.\u0275fac,providedIn:"root"})},wyKs:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("zqrF");class s{constructor(e){this.isVisible=!1,this.last=null,this.collapsed={},this.isVisible=e}}var a=i("fXoL");class r extends n.a{valueFromQuery(e){const t=new s(e.showHierarchies),i=this.current;return i&&(t.collapsed=i.collapsed),t}hasChanged(e){return e.showHierarchies!==this.isEnabled}applyToQuery(e){return e.showHierarchies=this.isEnabled,this.isEnabled}get isEnabled(){return!(!this.current||!this.current.isVisible)}setEnabled(e=!0){const t=Object.assign(Object.assign({collapsed:{}},this.current),{isVisible:e,last:null});this.update(t)}toggleState(){return this.setEnabled(!this.isEnabled),this.isEnabled}collapsed(e){return this.current.collapsed[e]}collapse(e){this.setState(e,!0)}expand(e){this.setState(e,!1)}toggle(e){this.setState(e,!this.collapsed(e))}setState(e,t){const i=Object.assign(Object.assign({},this.current),{last:e});i.collapsed[e]=t,this.update(i)}get current(){const e=this.lastUpdatedState.value;return void 0===e?this.initialState:(e.collapsed||(e.collapsed={}),e)}get initialState(){return new s(!1)}}r.\u0275fac=function(e){return c(e||r)},r.\u0275prov=a.cc({token:r,factory:r.\u0275fac});const c=a.oc(r)},x5It:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this.causedUpdates=[]}includes(e){return this.causedUpdates.includes(this.cacheValue(e))}add(e){this.causedUpdates.length>100&&this.causedUpdates.splice(0,90),this.causedUpdates.push(this.cacheValue(e))}cacheValue(e){return e.updatedAt+e.$href}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.cc({token:s,factory:s.\u0275fac})},xFOf:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("Qs0b"),s=i("wZYP"),a=i("fXoL"),r=i("ofXK");const c=function(e){return{"-left-margin":e}};class o{constructor(e){this.I18n=e,this.leftMargin=!1,this.text={enterpriseFeature:this.I18n.t("js.upsale.ee_only")}}eeLink(){return this.opReferrer?n.b+"&op_referrer="+this.opReferrer:n.b}}o.\u0275fac=function(e){return new(e||o)(a.gc(s.a))},o.\u0275cmp=a.ac({type:o,selectors:[["enterprise-banner"]],inputs:{leftMargin:"leftMargin",textMessage:"textMessage",linkMessage:"linkMessage",opReferrer:"opReferrer"},decls:5,vars:7,consts:[[1,"notification-box","-ee-upsale",3,"ngClass"],[1,"notification-box--content"],[1,"-bold",3,"textContent"],[3,"textContent"],["target","blank",3,"href","textContent"]],template:function(e,t){1&e&&(a.mc(0,"div",0),a.mc(1,"div",1),a.hc(2,"p",2),a.hc(3,"p",3),a.hc(4,"a",4),a.lc(),a.lc()),2&e&&(a.Bc("ngClass",a.Gc(5,c,t.leftMargin)),a.Tb(2),a.Bc("textContent",t.text.enterpriseFeature),a.Tb(1),a.Bc("textContent",t.textMessage),a.Tb(1),a.Bc("href",t.eeLink(),a.Tc)("textContent",t.linkMessage))},directives:[r.n],styles:[".notification-box.-left-margin[_ngcontent-%COMP%]{margin-left:1.25rem}.notification-box[_ngcontent-%COMP%]   .notification-box--content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:10px}"]})},xLNn:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("AEvm");class s extends n.a{constructor(e){super(),this.I18n=e,this.isActive=!1,this.text={activate:this.I18n.t("js.label_activate"),deactivate:this.I18n.t("js.label_deactivate"),label:this.labelKey?this.I18n.t(this.labelKey):"",buttonText:this.textKey?this.I18n.t(this.textKey):""}}get label(){return this.text.label}get buttonText(){return this.text.buttonText}get labelKey(){return""}get textKey(){return""}get activationPrefix(){return this.isActive?"":this.text.activate+" "}get deactivationPrefix(){return this.isActive?this.text.deactivate+" ":""}get prefix(){return this.activationPrefix||this.deactivationPrefix}isToggle(){return!1}}},xQCb:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("IaZ+"),s=i("kTsZ"),a=i("wZYP"),r=i("IzEk"),c=i("j/Ak"),o=i("SKFm"),l=i("xkGU"),d=i("fXoL"),u=i("Zb8V"),h=i("ofXK"),p=i("N5AO");function g(e,t){if(1&e){const e=d.nc();d.mc(0,"button",12),d.uc("click",(function(){return d.Qc(e),d.wc().saveEntry()})),d.hc(1,"op-icon",13),d.hc(2,"span",14),d.lc()}if(2&e){const e=d.wc();d.Ub("title",e.saveText),d.Tb(2),d.Bc("textContent",e.saveText)}}function m(e,t){if(1&e){const e=d.nc();d.mc(0,"button",15),d.uc("click",(function(t){return d.Qc(e),d.wc().closeMe(t)})),d.hc(1,"op-icon",16),d.hc(2,"span",14),d.lc()}if(2&e){const e=d.wc();d.Ub("title",e.text.cancel),d.Tb(2),d.Bc("textContent",e.text.cancel)}}function f(e,t){if(1&e){const e=d.nc();d.mc(0,"button",15),d.uc("click",(function(){return d.Qc(e),d.wc().destroy()})),d.hc(1,"op-icon",17),d.hc(2,"span",14),d.lc()}if(2&e){const e=d.wc();d.Ub("title",e.text.delete),d.Tb(2),d.Bc("textContent",e.text.delete)}}class b extends l.a{get deleteAllowed(){return!1}setModifiedEntry(e){this.createdEntry=e.savedResource}get saveText(){return this.i18n.t("js.label_create")}}b.\u0275fac=function(e){return w(e||b)},b.\u0275cmp=d.ac({type:b,selectors:[["ng-component"]],features:[d.Sb([o.a]),d.Qb],decls:13,vars:7,consts:[[1,"op-modal--portal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","confirm-dialog--modal","loading-indicator--location"],[1,"op-modal--modal-header"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[1,"icon-context","icon-log_time",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[3,"entry","showWorkPackageField","modifiedEntry"],["editForm",""],[1,"op-modal--modal-footer"],["class","button -highlight",3,"click",4,"ngIf"],["class","button",3,"click",4,"ngIf"],[1,"button","-highlight",3,"click"],["icon-classes","button--icon icon-checkmark"],["aria-hidden","true",1,"button--text",3,"textContent"],[1,"button",3,"click"],["icon-classes","button--icon icon-close"],["icon-classes","button--icon icon-delete"]],template:function(e,t){1&e&&(d.mc(0,"div",0),d.mc(1,"div",1),d.mc(2,"div",2),d.mc(3,"a",3),d.mc(4,"i",4),d.uc("click",(function(e){return t.closeMe(e)})),d.lc(),d.lc(),d.hc(5,"h3",5),d.lc(),d.mc(6,"div",6),d.mc(7,"te-form",7,8),d.uc("modifiedEntry",(function(e){return t.setModifiedEntry(e)})),d.lc(),d.lc(),d.mc(9,"div",9),d.Yc(10,g,3,2,"button",10),d.Yc(11,m,3,2,"button",11),d.Yc(12,f,3,2,"button",11),d.lc(),d.lc(),d.lc()),2&e&&(d.Tb(4),d.Ub("title",t.text.close),d.Tb(1),d.Bc("textContent",t.text.title),d.Tb(2),d.Bc("entry",t.entry)("showWorkPackageField",t.showWorkPackageField),d.Tb(3),d.Bc("ngIf",t.saveAllowed),d.Tb(1),d.Bc("ngIf",t.saveAllowed),d.Tb(1),d.Bc("ngIf",t.deleteAllowed))},directives:[u.a,h.q,p.a],styles:[".op-modal--modal-container[_ngcontent-%COMP%]{max-width:90vw;width:800px}.op-modal--modal-footer[_ngcontent-%COMP%]{margin-top:2em}.op-modal--modal-footer[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin-bottom:0}.icon-log_time[_ngcontent-%COMP%]:before{padding-right:6px}"],changeDetection:0});const w=d.oc(b);class v{constructor(e,t,i,n,s,a){this.opModalService=e,this.injector=t,this.halResource=i,this.timeEntryDm=n,this.halEditing=s,this.i18n=a}create(e,t,i=!0){return new Promise((n,s)=>{this.createNewTimeEntry(e,t).then(e=>{const t=this.opModalService.show(b,this.injector,{entry:e.pristineResource,showWorkPackageField:i});t.closingEvent.pipe(Object(r.a)(1)).subscribe(()=>{t.createdEntry?n({entry:t.createdEntry,action:"create"}):s()})})})}createNewTimeEntry(e,t){let i={spentOn:e.format("YYYY-MM-DD")};return t&&(i._links={workPackage:{href:t.href}}),this.timeEntryDm.createForm(i).then(e=>this.fromCreateForm(e))}fromCreateForm(e){let t=this.initializeNewResource(e);return this.halEditing.edit(t,e)}initializeNewResource(e){let t=this.halResource.createHalResourceOfType("TimeEntry",e.payload.$plain());return t.$links.schema=e.schema,t.overriddenSchema=e.schema,t._type="TimeEntry",t.id="new",t.hours="PT1H",t.update=t.$links.update=e.$links.self,t.updateImmediately=t.$links.updateImmediately=e=>this.timeEntryDm.create(e),t.state.putValue(t),t}}v.\u0275fac=function(e){return new(e||v)(d.qc(n.b),d.qc(d.A),d.qc(s.a),d.qc(c.a),d.qc(o.a),d.qc(a.a))},v.\u0275prov=d.cc({token:v,factory:v.\u0275fac})},xRac:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("u4T9"),s=i("fXoL");class a{}a.\u0275mod=s.ec({type:a}),a.\u0275inj=s.dc({factory:function(e){return new(e||a)},imports:[[n.a]]})},"xV+i":function(e,t,i){"use strict";i.d(t,"c",(function(){return l})),i.d(t,"b",(function(){return d})),i.d(t,"a",(function(){return u}));var n=i("mrSG"),s=i("6XbZ"),a=i("iMRi"),r=i("CBsm"),c=i("wyKs"),o=i("r0MM");const l="-hierarchy-collapsed",d="wp-table--hierarchy-aditional-row";class u extends s.a{constructor(e,t){super(e,t),this.injector=e,this.workPackageTable=t,this.text={leaf:e=>this.I18n.t("js.work_packages.hierarchy.leaf",{level:e}),expanded:e=>this.I18n.t("js.work_packages.hierarchy.children_expanded",{level:e}),collapsed:e=>this.I18n.t("js.work_packages.hierarchy.children_collapsed",{level:e})}}refreshRow(e,t){const i=super.refreshRow(e,t);return i.find(".wp-table--hierarchy-span").remove(),this.appendHierarchyIndicator(e,i),i}buildEmpty(e){let[t,i]=super.buildEmpty(e),[n,s]=this.ancestorRowData(e);return t.classList.add(...n),this.appendHierarchyIndicator(e,jQuery(t)),[t,s]}ancestorRowData(e){const t=this.wpTableHierarchies.current,i=[];let n=!1;return this.parentsWithVisibleChildren[e.id]&&i.push(Object(r.d)(e.id)),_.isArray(e.ancestors)&&e.ancestors.forEach(e=>{i.push(Object(r.c)(e.id)),t.collapsed[e.id]&&(n=!0,i.push(Object(r.b)(e.id)))}),[i,n]}buildAncestorRow(e,t,i){const n=this.states.workPackages.get(e.id).value,[s,a]=this.buildEmpty(n);return s.classList.add(d),[s,a]}appendHierarchyIndicator(e,t,i){const n=void 0===i?e.ancestors.length:i,s=this.buildHierarchyIndicator(e,t,n);t.find("td.subject").addClass("-with-hierarchy").prepend(s),t.find("td.subject").css("minWidth",125+20*n+"px"),t.find("td.subject .wp-table--cell-container").css("width","calc(100% - 25px - "+20*n+"px)")}buildHierarchyIndicator(e,t,i){const n=document.createElement("span"),s=this.wpTableHierarchies.collapsed(e.id),a=25+20*i+"px";if(n.classList.add("wp-table--hierarchy-span"),n.style.width=a,n.dataset.indentation=a,this.parentsWithVisibleChildren[e.id]){const e=s?l:"";n.innerHTML=`\n            <a href tabindex="0" role="button" class="wp-table--hierarchy-indicator ${e}">\n              <span class="wp-table--hierarchy-indicator-icon" aria-hidden="true"></span>\n              <span class="wp-table--hierarchy-indicator-expanded hidden-for-sighted">${this.text.expanded(i)}</span>\n              <span class="wp-table--hierarchy-indicator-collapsed hidden-for-sighted">${this.text.collapsed(i)}</span>\n            </a>\n        `}else n.innerHTML=`\n            <span tabindex="0" class="wp-table--leaf-indicator">\n              <span class="hidden-for-sighted">${this.text.leaf(i)}</span>\n            </span>\n        `;return n}}Object(n.c)([Object(o.a)(),Object(n.e)("design:type",c.a)],u.prototype,"wpTableHierarchies",void 0),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",a.a)],u.prototype,"states",void 0)},xiBa:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("wZYP"),s=i("sjKJ"),a=i("07mJ"),r=i("fXoL"),c=i("N5AO");class o{constructor(e,t,i){this.I18n=e,this.currentProject=t,this.bcfPathHelper=i,this.text={import:this.I18n.t("js.bcf.import")}}handleClick(){var e=this.currentProject.identifier;if(e){var t=this.bcfPathHelper.projectImportIssuePath(e);window.location.href=t}}}o.\u0275fac=function(e){return new(e||o)(r.gc(n.a),r.gc(s.a),r.gc(a.a))},o.\u0275cmp=r.ac({type:o,selectors:[["bcf-import-button"]],decls:4,vars:2,consts:[[1,"button","import-bcf-button",3,"title","click"],["icon-classes","button--icon icon-import"],[1,"button--text"]],template:function(e,t){1&e&&(r.mc(0,"a",0),r.uc("click",(function(){return t.handleClick()})),r.hc(1,"op-icon",1),r.mc(2,"span",2),r.ad(3),r.lc(),r.lc()),2&e&&(r.Bc("title",t.text.import),r.Tb(3),r.cd(" ",t.text.import," "))},directives:[c.a],encapsulation:2})},xkGU:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("mrSG"),s=i("SqdZ"),a=i("IaZ+"),r=i("wZYP"),c=(i("Zb8V"),i("r0MM")),o=i("ug4p"),l=i("fXoL");const d=["editForm"];class u extends s.a{constructor(e,t,i,n,s){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.i18n=n,this.injector=s,this.text={title:this.i18n.t("js.time_entry.title"),cancel:this.i18n.t("js.button_cancel"),close:this.i18n.t("js.button_close"),delete:this.i18n.t("js.button_delete"),areYouSure:this.i18n.t("js.text_are_you_sure")},this.closeOnEscape=!1,this.closeOnOutsideClick=!1}get entry(){return this.locals.entry}get showWorkPackageField(){return void 0===this.locals.showWorkPackageField||this.locals.showWorkPackageField}saveEntry(){this.editForm.save().then(()=>{this.entry.workPackage&&this.workPackageCacheService.require(this.entry.workPackage.id,!0),this.service.close()})}get saveText(){return this.i18n.t("js.button_save")}get saveAllowed(){return!0}get deleteAllowed(){return!0}}u.\u0275fac=function(e){return new(e||u)(l.gc(l.q),l.gc(a.a),l.gc(l.i),l.gc(r.a),l.gc(l.A))},u.\u0275dir=l.bc({type:u,viewQuery:function(e,t){var i;(1&e&&l.Wc(d,!0),2&e)&&(l.Nc(i=l.vc())&&(t.editForm=i.first))},features:[l.Qb]}),Object(n.c)([Object(c.a)(),Object(n.e)("design:type",o.a)],u.prototype,"workPackageCacheService",void 0)},y2Tr:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{static get active_user_statuses(){return["active","registered"]}get state(){return this.states.users.get(this.href)}get showUserPath(){return this.showUser?this.showUser.$link.href:null}get isActive(){return s.active_user_statuses.indexOf(this.status)>=0}}},yCBR:function(e,t,i){"use strict";i.d(t,"b",(function(){return w})),i.d(t,"a",(function(){return v}));var n=i("XV4z"),s=i("Wi9d"),a=i("4EDS"),r=i("K018"),c=i("lJxs"),o=i("sjKJ"),l=i("AEvm"),d=i("fXoL"),u=i("ofXK"),h=i("0loS");const p=function(){return{reload:!0}},g=function(e,t){return{board_id:e,query_props:"",projects:"projects",projectPath:t}},m=function(e){return{selected:e}};function f(e,t){if(1&e&&(d.mc(0,"li"),d.hc(1,"a",3),d.lc()),2&e){const e=t.$implicit,i=d.wc(2);d.Tb(1),d.Bc("textContent",e.name)("uiOptions",d.Fc(4,p))("uiParams",d.Hc(5,g,e.id,i.currentProjectIdentifier))("ngClass",d.Gc(8,m,i.selectedBoardId===e.id))}}function b(e,t){if(1&e&&(d.mc(0,"div"),d.mc(1,"ul",1),d.Yc(2,f,2,10,"li",2),d.lc(),d.lc()),2&e){const e=t.ngIf,i=d.wc();d.Tb(2),d.Bc("ngForOf",e)("ngForTrackBy",i.trackById)}}const w="boards-menu";class v extends l.a{constructor(e,t,i,n){super(),this.boardService=e,this.boardCache=t,this.currentProject=i,this.mainMenuService=n,this.trackById=a.a.compareByAttribute("id"),this.currentProjectIdentifier=this.currentProject.identifier,this.boards$=this.boardCache.observeAll().pipe(Object(c.a)(e=>e.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}))))}ngOnInit(){this.mainMenuService.onActivate("board_view").subscribe(()=>{this.focusBackArrow(),this.boardService.loadAllBoards()}),this.boardService.currentBoard$.pipe(this.untilDestroyed()).subscribe(e=>{this.selectedBoardId=e||""})}focusBackArrow(){jQuery('*[data-name="board_view"] .main-menu--arrow-left-to-project').focus()}}v.\u0275fac=function(e){return new(e||v)(d.gc(n.a),d.gc(s.a),d.gc(o.a),d.gc(r.a))},v.\u0275cmp=d.ac({type:v,selectors:[["boards-menu"]],features:[d.Qb],decls:2,vars:3,consts:[[4,"ngIf"],[1,"main-menu--children","boards--menu-items"],[4,"ngFor","ngForOf","ngForTrackBy"],["uiSref","boards.partitioned.show",1,"main-menu--children-sub-item","ellipsis",3,"textContent","uiOptions","uiParams","ngClass"]],template:function(e,t){1&e&&(d.Yc(0,b,3,2,"div",0),d.xc(1,"async")),2&e&&d.Bc("ngIf",d.yc(1,1,t.boards$))},directives:[u.q,u.p,h.AnchorUISref,h.UISref,u.n],pipes:[u.a],encapsulation:2})},yIst:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("mrSG"),s=i("eyhC"),a=i("cd/7"),r=i("qHU1"),c=i("WW/2"),o=i("4lR/"),l=i("qtzK"),d=i("r0MM");class u{constructor(e,t){this.injector=e}get EVENT(){return"contextmenu.cardView.rightclick"}get SELECTOR(){return".wp-card"}eventScope(e){return jQuery(e.container.nativeElement)}handleEvent(e,t){let i=jQuery(t.target);if(i.closest(`.${a.c}`).length)return Object(r.a)("Allowing original context menu on state link"),!0;t.preventDefault(),t.stopPropagation();const n=i.closest("wp-single-card"),s=n.data("workPackageId");if(!s)return!0;{let i=n.data("classIdentifier"),a=this.wpCardView.findRenderedCard(i);this.wpTableSelection.isSelected(s)||this.wpTableSelection.setSelection(s,a);const r=new l.a(this.injector,s,jQuery(t.target),{},e.showInfoButton);this.opContextMenu.show(r,t)}return!1}}Object(n.c)([Object(d.a)(),Object(n.e)("design:type",s.a)],u.prototype,"wpTableSelection",void 0),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",c.a)],u.prototype,"wpCardView",void 0),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",o.a)],u.prototype,"opContextMenu",void 0)},yOxh:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var n=i("mrSG"),s=i("fXoL"),a=i("SqdZ"),r=i("r0MM"),c=i("wZYP"),o=i("IaZ+"),l=i("juWA"),d=i("PBJw"),u=i("SKFm");class h{mappedDate(e){return""===e?null:e}parseDate(e){return e instanceof Date?e:""===e?"":new Date(e)}validDate(e){return e instanceof Date||""===e||!!new Date(e).valueOf()}setCurrentActivatedField(e){this.currentlyActivatedDateField=e}toggleCurrentActivatedField(e,t){this.currentlyActivatedDateField="start"===this.currentlyActivatedDateField?"end":"start",this.setDatepickerRestrictions(e,t)}isStateOfCurrentActivatedField(e){return this.currentlyActivatedDateField===e}setDatepickerRestrictions(e,t){this.isStateOfCurrentActivatedField("start")?(t.datepickerInstance.set("minDate",null),t.datepickerInstance.set("maxDate",e.end)):(t.datepickerInstance.set("minDate",e.start),t.datepickerInstance.set("maxDate",null))}setRangeClasses(e,t){if(e.start&&e.end){var i=document.getElementsByClassName("flatpickr-day selected");if(2===i.length)i[0].classList.add("startRange"),i[1].classList.add("endRange"),this.selectRangeFromUntil(i[0],i[1]);else if(1===i.length){if(this.datepickerShowsDate(e.start,t))i[0].classList.add("startRange"),this.selectRangeFromUntil(i[0],"");else if(this.datepickerShowsDate(e.end,t)){i[0].classList.add("endRange");let e=jQuery(".flatpickr-days .flatpickr-day")[0];e.classList.add("inRange"),this.selectRangeFromUntil(e,i[0])}}else this.datepickerIsInDateRange(e,t)&&jQuery(".dayContainer .flatpickr-day").addClass("inRange")}}datepickerShowsDate(e,t){return t.datepickerInstance.currentMonth===new Date(e).getMonth()&&t.datepickerInstance.currentYear===new Date(e).getFullYear()}datepickerIsInDateRange(e,t){return t.datepickerInstance.currentYear<=new Date(e.end).getFullYear()&&t.datepickerInstance.currentMonth<new Date(e.end).getMonth()&&t.datepickerInstance.currentYear>=new Date(e.start).getFullYear()&&t.datepickerInstance.currentMonth>new Date(e.start).getMonth()}selectRangeFromUntil(e,t){jQuery(e).nextUntil(t).addClass("inRange")}}h.\u0275fac=function(e){return new(e||h)},h.\u0275prov=s.cc({token:h,factory:h.\u0275fac,providedIn:"root"});var p=i("3Pt+"),g=i("ofXK");const m=function(e){return{"-current":e}};function f(e,t){if(1&e){const e=s.nc();s.kc(0),s.mc(1,"div",7),s.hc(2,"label",13),s.mc(3,"div",14),s.mc(4,"div",15),s.mc(5,"input",16),s.uc("ngModelChange",(function(t){return s.Qc(e),s.wc().updateDate("date",t)}))("click",(function(){return s.Qc(e),s.wc().datepickerHelper.setCurrentActivatedField("date")})),s.lc(),s.lc(),s.lc(),s.lc(),s.jc()}if(2&e){const e=s.wc();s.Tb(2),s.Bc("textContent",e.text.date),s.Tb(3),s.Bc("ngClass",s.Gc(3,m,e.datepickerHelper.isStateOfCurrentActivatedField("date")))("ngModel",e.dates.date)}}function b(e,t){if(1&e){const e=s.nc();s.kc(0),s.mc(1,"div",7),s.hc(2,"label",13),s.mc(3,"div",14),s.mc(4,"div",15),s.mc(5,"input",17),s.uc("ngModelChange",(function(t){return s.Qc(e),s.wc().updateDate("start",t)}))("click",(function(){return s.Qc(e),s.wc().datepickerHelper.setCurrentActivatedField("start")})),s.lc(),s.lc(),s.lc(),s.lc(),s.mc(6,"div",7),s.hc(7,"label",13),s.mc(8,"div",14),s.mc(9,"div",15),s.mc(10,"input",18),s.uc("ngModelChange",(function(t){return s.Qc(e),s.wc().updateDate("end",t)}))("click",(function(){return s.Qc(e),s.wc().datepickerHelper.setCurrentActivatedField("end")})),s.lc(),s.lc(),s.lc(),s.lc(),s.jc()}if(2&e){const e=s.wc();s.Tb(2),s.Bc("textContent",e.text.startDate),s.Tb(3),s.Bc("ngClass",s.Gc(6,m,e.datepickerHelper.isStateOfCurrentActivatedField("start")))("ngModel",e.dates.start),s.Tb(2),s.Bc("textContent",e.text.endDate),s.Tb(3),s.Bc("ngClass",s.Gc(8,m,e.datepickerHelper.isStateOfCurrentActivatedField("end")))("ngModel",e.dates.end)}}class w extends a.a{constructor(e,t,i,n){super(t,i,n),this.injector=e,this.locals=t,this.cdRef=i,this.elementRef=n,this.text={save:this.I18n.t("js.button_save"),cancel:this.I18n.t("js.button_cancel"),clear:this.I18n.t("js.modals.button_clear_all"),manualScheduling:this.I18n.t("js.scheduling.manual"),date:this.I18n.t("js.work_packages.properties.date"),startDate:this.I18n.t("js.work_packages.properties.startDate"),endDate:this.I18n.t("js.work_packages.properties.dueDate"),placeholder:this.I18n.t("js.placeholders.default")},this.onDataUpdated=new s.s,this.singleDate=!1,this.scheduleManually=!1,this.htmlId="",this.dates={date:"",start:"",end:""},this.changeset=t.changeset,this.htmlId=`wp-datepicker-${t.fieldName}`,this.singleDate=this.changeset.isWritable("date"),this.scheduleManually=this.changeset.value("scheduleManually"),this.singleDate?(this.dates.date=this.changeset.value("date"),this.datepickerHelper.setCurrentActivatedField("date")):(this.dates.start=this.changeset.value("startDate"),this.dates.end=this.changeset.value("dueDate"),this.datepickerHelper.setCurrentActivatedField("dueDate"===this.locals.fieldName?"end":"start"))}ngAfterViewInit(){this.initializeDatepicker(),this.datepickerHelper.setDatepickerRestrictions(this.dates,this.datePickerInstance),this.datepickerHelper.setRangeClasses(this.dates,this.datePickerInstance),this.onDataChange()}changeSchedulingMode(){this.scheduleManually=!this.scheduleManually,this.cdRef.detectChanges()}save(){this.singleDate?this.changeset.setValue("date",this.datepickerHelper.mappedDate(this.dates.date)):(this.changeset.setValue("startDate",this.datepickerHelper.mappedDate(this.dates.start)),this.changeset.setValue("dueDate",this.datepickerHelper.mappedDate(this.dates.end))),this.changeset.setValue("scheduleManually",this.scheduleManually),this.closeMe()}cancel(){this.closeMe()}clear(){this.dates={date:"",start:"",end:""},this.datePickerInstance.clear()}updateDate(e,t){this.dates[e]=t,this.datepickerHelper.validDate(t)&&this.datePickerInstance&&this.setDatesToDatepicker()}reposition(e,t){e.position({my:"left top",at:"left bottom",of:t,collision:"flipfit"})}initializeDatepicker(){this.datePickerInstance=new d.a("#flatpickr-input",this.singleDate?this.dates.date:[this.dates.start,this.dates.end],{mode:this.singleDate?"single":"multiple",inline:!0,onChange:e=>{this.onDatePickerChange(e),this.onDataChange()},onMonthChange:()=>{this.datepickerHelper.setRangeClasses(this.dates,this.datePickerInstance)},onYearChange:()=>{this.datepickerHelper.setRangeClasses(this.dates,this.datePickerInstance)}})}setDatesToDatepicker(){if(this.singleDate){let e=this.datepickerHelper.parseDate(this.dates.date);this.datePickerInstance.setDates(e)}else{let e=[this.datepickerHelper.parseDate(this.dates.start),this.datepickerHelper.parseDate(this.dates.end)];this.datePickerInstance.setDates(e)}}onDatePickerChange(e){switch(e.length){case 0:break;case 1:this.singleDate?this.dates.date=this.timezoneService.formattedISODate(e[0]):this.dates.start&&this.dates.end?this.dates[this.datepickerHelper.currentlyActivatedDateField]="":(this.dates[this.datepickerHelper.currentlyActivatedDateField]=this.timezoneService.formattedISODate(e[0]),this.datepickerHelper.toggleCurrentActivatedField(this.dates,this.datePickerInstance));break;case 2:if(!this.dates.end&&this.datepickerHelper.isStateOfCurrentActivatedField("start")||!this.dates.start&&this.datepickerHelper.isStateOfCurrentActivatedField("end"))this.datePickerInstance.setDates([e[1]]),this.onDatePickerChange([e[1]]);else{e[0]>e[1]&&(e.sort((function(e,t){return e.getTime()-t.getTime()})),this.datePickerInstance.setDates([e[0],e[1]]));let t=this.datepickerHelper.isStateOfCurrentActivatedField("start")?0:1;this.dates[this.datepickerHelper.currentlyActivatedDateField]=this.timezoneService.formattedISODate(e[t]),this.datepickerHelper.toggleCurrentActivatedField(this.dates,this.datePickerInstance),this.datepickerHelper.setRangeClasses(this.dates,this.datePickerInstance)}break;default:this.datepickerHelper.isStateOfCurrentActivatedField("start")?(this.datePickerInstance.setDates([e[2],e[1]]),this.onDatePickerChange([e[2],e[1]])):(this.datePickerInstance.setDates([e[0],e[2]]),this.onDatePickerChange([e[0],e[2]]))}this.cdRef.detectChanges()}onDataChange(){let e=this.dates.date||"",t=this.dates.start||"",i=this.dates.end||"",n=this.singleDate?e:t+" - "+i;this.onDataUpdated.emit(n)}}w.\u0275fac=function(e){return new(e||w)(s.gc(s.A),s.gc(o.a),s.gc(s.i),s.gc(s.q))},w.\u0275cmp=s.ac({type:w,selectors:[["ng-component"]],features:[s.Qb],decls:17,vars:8,consts:[[1,"op-modal--portal","-transparent"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","datepicker-modal","loading-indicator--location"],[1,"op-modal--modal-body"],[1,"form","-vertical"],[1,"grid-block"],[4,"ngIf"],[1,"datepicker-modal--action",3,"textContent","click"],[1,"form--field"],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["type","checkbox","name","scheduling",1,"form--check-box","datepicker-modal--scheduling-action",3,"ngModel","ngModelChange"],["id","flatpickr-input","hidden",""],[1,"datepicker-modal--actions-container"],[1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--text-field-container","-xslim"],["type","text","name","date",1,"form--date-field",3,"ngClass","ngModel","ngModelChange","click"],["type","text","name","startDate",1,"form--date-field",3,"ngClass","ngModel","ngModelChange","click"],["type","text","name","endDate",1,"form--date-field",3,"ngClass","ngModel","ngModelChange","click"]],template:function(e,t){1&e&&(s.mc(0,"div",0),s.mc(1,"div",1),s.mc(2,"div",2),s.mc(3,"form",3),s.mc(4,"div",4),s.Yc(5,f,6,5,"ng-container",5),s.Yc(6,b,11,10,"ng-container",5),s.mc(7,"a",6),s.uc("click",(function(){return t.clear()})),s.lc(),s.lc(),s.mc(8,"div",7),s.mc(9,"label",8),s.mc(10,"div",9),s.mc(11,"input",10),s.uc("ngModelChange",(function(){return t.changeSchedulingMode()})),s.lc(),s.lc(),s.ad(12),s.lc(),s.lc(),s.lc(),s.hc(13,"input",11),s.mc(14,"div",12),s.mc(15,"a",6),s.uc("click",(function(){return t.cancel()})),s.lc(),s.mc(16,"a",6),s.uc("click",(function(){return t.save()})),s.lc(),s.lc(),s.lc(),s.lc(),s.lc()),2&e&&(s.Tb(1),s.Ub("id",t.htmlId),s.Tb(4),s.Bc("ngIf",t.singleDate),s.Tb(1),s.Bc("ngIf",!t.singleDate),s.Tb(1),s.Bc("textContent",t.text.clear),s.Tb(4),s.Bc("ngModel",t.scheduleManually),s.Tb(1),s.cd(" ",t.text.manualScheduling," "),s.Tb(3),s.Bc("textContent",t.text.cancel),s.Tb(1),s.Bc("textContent",t.text.save))},directives:[p.C,p.n,p.o,g.q,p.a,p.m,p.p,p.c,g.n],styles:[".datepicker-modal{position:relative;z-index:500;width:-moz-fit-content;width:fit-content;padding:5px 0;box-shadow:0 0 5px 2px rgba(0,0,0,.25)}.datepicker-modal .op-modal--modal-body{overflow:hidden}.datepicker-modal .grid-block{align-items:center}.datepicker-modal--actions-container{display:grid;grid-template-columns:auto auto;grid-column-gap:30px;margin-top:20px;justify-content:end}.form--date-field{margin:2px!important}.form--date-field.-current,.form--date-field.-current:hover{outline:2px solid var(--primary-color)}"],encapsulation:2,changeDetection:0}),Object(n.c)([Object(r.a)(),Object(n.e)("design:type",c.a)],w.prototype,"I18n",void 0),Object(n.c)([Object(r.a)(),Object(n.e)("design:type",l.a)],w.prototype,"timezoneService",void 0),Object(n.c)([Object(r.a)(),Object(n.e)("design:type",u.a)],w.prototype,"halEditing",void 0),Object(n.c)([Object(r.a)(),Object(n.e)("design:type",h)],w.prototype,"datepickerHelper",void 0)},yUKD:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("2Qcm"),s=i("wZYP"),a=i("iMRi"),r=i("fbLK"),c=i("E2tj"),o=i("fXoL"),l=i("ofXK"),d=i("3Pt+"),u=i("ZOsW"),h=i("xFOf");const p=["highlightedAttributesNgSelect"],g=["rowHighlightNgSelect"];function m(e,t){if(1&e&&o.hc(0,"enterprise-banner",13),2&e){const e=o.wc();o.Bc("linkMessage",e.text.upsaleCheckOutLink)("textMessage",e.text.upsaleAttributeHighlighting)}}class f{constructor(e,t,i,n,s,a){this.injector=e,this.I18n=t,this.states=i,this.querySpace=n,this.Banners=s,this.wpTableHighlight=a,this.highlightingMode="inline",this.entireRowMode=!1,this.lastEntireRowAttribute="status",this.eeShowBanners=!1,this.availableInlineHighlightedAttributes=[],this.selectedAttributes=[],this.availableRowHighlightedAttributes=[],this.text={title:this.I18n.t("js.work_packages.table_configuration.highlighting"),highlighting_mode:{description:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.description"),none:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.none"),inline:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.inline"),inline_all_attributes:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.inline_all"),status:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.status"),type:this.I18n.t("js.work_packages.properties.type"),priority:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.priority"),entire_row_by:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.entire_row_by")},upsaleAttributeHighlighting:this.I18n.t("js.work_packages.table_configuration.upsale.attribute_highlighting"),upsaleCheckOutLink:this.I18n.t("js.work_packages.table_configuration.upsale.check_out_link")}}ngOnInit(){this.availableInlineHighlightedAttributes=this.availableHighlightedAttributes,this.availableRowHighlightedAttributes=[{name:this.text.highlighting_mode.status,value:"status"},{name:this.text.highlighting_mode.priority,value:"priority"}],this.setSelectedValues(),this.eeShowBanners=this.Banners.eeShowBanners,this.updateMode(this.wpTableHighlight.current.mode),this.eeShowBanners&&this.updateMode("none")}onSave(){let e=this.highlightingMode;this.wpTableHighlight.update({mode:e,selectedAttributes:this.selectedAttributes})}updateMode(e){this.highlightingMode="entire-row"===e?this.lastEntireRowAttribute:e,-1!==["status","priority"].indexOf(this.highlightingMode)?(this.lastEntireRowAttribute=this.highlightingMode,this.entireRowMode=!0):this.entireRowMode=!1}updateHighlightingAttributes(e){this.selectedAttributes=e}disabledValue(e){return e?"disabled":null}get availableHighlightedAttributes(){return this.querySpace.queryForm.value.schema.highlightedAttributes.allowedValues}onOpen(e){setTimeout(()=>{e.dropdownPanel&&e.dropdownPanel._updatePosition()},25)}setSelectedValues(){const e=this.wpTableHighlight.current.selectedAttributes;this.selectedAttributes=void 0===e?this.availableInlineHighlightedAttributes:e}}f.\u0275fac=function(e){return new(e||f)(o.gc(o.A),o.gc(s.a),o.gc(a.a),o.gc(c.a),o.gc(r.a),o.gc(n.a))},f.\u0275cmp=o.ac({type:f,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&(o.fd(p,!0),o.fd(g,!0)),2&e)&&(o.Nc(i=o.vc())&&(t.highlightedAttributesNgSelect=i.first),o.Nc(i=o.vc())&&(t.rowHighlightNgSelect=i.first))},decls:25,vars:22,consts:[["class","ee-attribute-highlighting-upsale","opReferrer","wp-attribute-highlighting#attribute-highlighting",3,"linkMessage","textMessage",4,"ngIf"],[3,"textContent"],[1,"form--field"],[1,"form--label"],["type","radio","value","inline","name","highlighting_mode_switch",3,"ngModel","ngModelChange","change"],[1,"form--field-container"],[1,"form--select-container"],["bindLabel","name","name","highlighting_attributes","appendTo","body",1,"form--select-field","-multi-select",3,"items","ngModel","multiple","disabled","clearable","closeOnSelect","ngModelChange","open","change"],["highlightedAttributesNgSelect",""],["type","radio","name","entire_row_switch",3,"ngModel","value","ngModelChange","change"],["bindLabel","name","bindValue","value","name","selected_attribute","appendTo","body","id","selected_attribute",1,"form--select-field",3,"items","ngModel","disabled","clearable","ngModelChange","open","change"],["rowHighlightNgSelect",""],["type","radio","value","none","name","highlighting_mode_switch",3,"ngModel","ngModelChange","change"],["opReferrer","wp-attribute-highlighting#attribute-highlighting",1,"ee-attribute-highlighting-upsale",3,"linkMessage","textMessage"]],template:function(e,t){if(1&e){const e=o.nc();o.mc(0,"div"),o.Yc(1,m,1,2,"enterprise-banner",0),o.mc(2,"form"),o.hc(3,"p",1),o.mc(4,"div",2),o.mc(5,"label",3),o.mc(6,"input",4),o.uc("ngModelChange",(function(e){return t.highlightingMode=e}))("change",(function(e){return t.updateMode(e.target.value)})),o.lc(),o.hc(7,"span",1),o.ad(8,"\xa0 "),o.lc(),o.mc(9,"div",5),o.mc(10,"div",6),o.mc(11,"ng-select",7,8),o.uc("ngModelChange",(function(e){return t.selectedAttributes=e}))("open",(function(){o.Qc(e);const i=o.Oc(12);return t.onOpen(i)}))("change",(function(e){return t.updateHighlightingAttributes(e)})),o.lc(),o.lc(),o.lc(),o.lc(),o.mc(13,"div",2),o.mc(14,"label",3),o.mc(15,"input",9),o.uc("ngModelChange",(function(e){return t.entireRowMode=e}))("change",(function(){return t.updateMode("entire-row")})),o.lc(),o.hc(16,"span",1),o.lc(),o.mc(17,"div",5),o.mc(18,"div",6),o.mc(19,"ng-select",10,11),o.uc("ngModelChange",(function(e){return t.lastEntireRowAttribute=e}))("open",(function(){o.Qc(e);const i=o.Oc(20);return t.onOpen(i)}))("change",(function(e){return t.updateMode(e.value)})),o.lc(),o.lc(),o.lc(),o.lc(),o.mc(21,"div",2),o.mc(22,"label",3),o.mc(23,"input",12),o.uc("ngModelChange",(function(e){return t.highlightingMode=e}))("change",(function(e){return t.updateMode(e.target.value)})),o.lc(),o.hc(24,"span",1),o.lc(),o.lc(),o.lc(),o.lc()}2&e&&(o.Tb(1),o.Bc("ngIf",t.eeShowBanners),o.Tb(2),o.Bc("textContent",t.text.highlighting_mode.description),o.Tb(3),o.Bc("ngModel",t.highlightingMode),o.Ub("disabled",t.disabledValue(t.eeShowBanners)),o.Tb(1),o.Bc("textContent",t.text.highlighting_mode.inline),o.Tb(4),o.Bc("items",t.availableInlineHighlightedAttributes)("ngModel",t.selectedAttributes)("multiple",!0)("disabled","inline"!==t.highlightingMode)("clearable",!1)("closeOnSelect",!1),o.Tb(4),o.Bc("ngModel",t.entireRowMode)("value",!0),o.Ub("disabled",t.disabledValue(t.eeShowBanners)),o.Tb(1),o.Bc("textContent",t.text.highlighting_mode.entire_row_by),o.Tb(3),o.Bc("items",t.availableRowHighlightedAttributes)("ngModel",t.lastEntireRowAttribute)("disabled",t.disabledValue(t.eeShowBanners))("clearable",!1),o.Tb(4),o.Bc("ngModel",t.highlightingMode),o.Ub("disabled",t.disabledValue(t.eeShowBanners)),o.Tb(1),o.Bc("textContent",t.text.highlighting_mode.none))},directives:[l.q,d.C,d.n,d.o,d.u,d.c,d.m,d.p,u.a,h.a],encapsulation:2})},ylTo:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("iB+3"),s=i("Y0Nk"),a=i("ug4p"),r=i("wZYP"),c=i("VFHb"),o=i("Jui0"),l=i("4EDS"),d=i("qc15"),u=i("AEvm"),h=i("fXoL");function p(e,t){if(1&e&&(h.mc(0,"div",8),h.mc(1,"div",9),h.hc(2,"p",10),h.lc(),h.lc()),2&e){const e=h.wc();h.Tb(2),h.Bc("textContent",e.text.loadingError)}}function g(e,t){if(1&e&&h.hc(0,"wp-watcher-entry",11),2&e){const e=t.$implicit;h.Bc("watcher",e)}}const m=function(e){return{"-read-only":e}};class f extends u.a{constructor(e,t,i,n,s,a,r,c,o){super(),this.I18n=e,this.elementRef=t,this.wpWatchersService=i,this.$transition=n,this.notificationService=s,this.loadingIndicator=a,this.wpCacheService=r,this.cdRef=c,this.pathHelper=o,this.trackByHref=l.a.trackByHref,this.error=!1,this.noResults=!1,this.allowedToView=!1,this.allowedToAdd=!1,this.allowedToRemove=!1,this.watching=[],this.text={loading:this.I18n.t("js.watchers.label_loading"),loadingError:this.I18n.t("js.watchers.label_error_loading"),autocomplete:{placeholder:this.I18n.t("js.watchers.typeahead_placeholder")}}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.workPackageId=this.$transition.params("to").workPackageId,this.wpCacheService.loadWorkPackage(this.workPackageId).values$().pipe(this.untilDestroyed()).subscribe(e=>{this.workPackage=e,this.loadCurrentWatchers()}),this.availableWatchersPath=this.pathHelper.api.v3.work_packages.id(this.workPackageId).available_watchers}loadCurrentWatchers(){this.error=!1,this.allowedToView=!!this.workPackage.watchers,this.allowedToAdd=!!this.workPackage.addWatcher,this.allowedToRemove=!!this.workPackage.removeWatcher,this.allowedToView?this.wpWatchersService.require(this.workPackage).then(e=>{this.watching=e,this.cdRef.detectChanges()}).catch(e=>{this.notificationService.showError(e,this.workPackage)}):this.error=!0}set loadingPromise(e){this.loadingIndicator.wpDetails.promise=e}addWatcher(e){this.loadingPromise=this.workPackage.addWatcher.$link.$fetch({user:{href:e.href}}).then(()=>{this.wpWatchersService.require(this.workPackage,!0),this.wpCacheService.loadWorkPackage(this.workPackage.id,!0),this.cdRef.detectChanges()}).catch(e=>this.notificationService.showError(e,this.workPackage))}removeWatcher(e){this.workPackage.removeWatcher.$link.$prepare({user_id:e.id})().then(()=>{_.remove(this.watching,t=>t.href===e.href),this.wpWatchersService.require(this.workPackage,!0),this.wpCacheService.loadWorkPackage(this.workPackage.id,!0),this.cdRef.detectChanges()}).catch(e=>this.notificationService.showError(e,this.workPackage))}}f.\u0275fac=function(e){return new(e||f)(h.gc(r.a),h.gc(h.q),h.gc(c.a),h.gc(n.J),h.gc(d.a),h.gc(s.a),h.gc(a.a),h.gc(h.i),h.gc(o.a))},f.\u0275cmp=h.ac({type:f,selectors:[["wp-watchers-tab"]],features:[h.Qb],decls:8,vars:10,consts:[["id","detail-panel-watchers"],["class","notification-box -error",4,"ngIf"],[3,"hidden"],[1,"work-package--watchers","form--selected-value--list",3,"ngClass"],[3,"watcher",4,"ngFor","ngForOf","ngForTrackBy"],[1,"work-package--watchers-lookup","hide-when-print",3,"hidden"],["name","watcherForm","novalidate",""],[1,"wp-watcher--autocomplete",3,"clearAfterSelection","url","onChange"],[1,"notification-box","-error"],[1,"notification-box--content"],[3,"textContent"],[3,"watcher"]],template:function(e,t){1&e&&(h.mc(0,"div",0),h.Yc(1,p,3,1,"div",1),h.mc(2,"div",2),h.mc(3,"div",3),h.Yc(4,g,1,1,"wp-watcher-entry",4),h.lc(),h.mc(5,"div",5),h.mc(6,"form",6),h.mc(7,"user-autocompleter",7),h.uc("onChange",(function(e){return t.addWatcher(e)})),h.lc(),h.lc(),h.lc(),h.lc(),h.lc()),2&e&&(h.Tb(1),h.Bc("ngIf",t.error),h.Tb(1),h.Bc("hidden",t.error),h.Tb(1),h.Bc("ngClass",h.Gc(8,m,!t.allowedToRemove)),h.Tb(1),h.Bc("ngForOf",t.watching)("ngForTrackBy",t.trackByHref),h.Tb(1),h.Bc("hidden",!t.allowedToAdd),h.Tb(2),h.Bc("clearAfterSelection",!0)("url",t.availableWatchersPath))},encapsulation:2,changeDetection:0})},zOhy:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("iB+3"),s=i("Jui0"),a=i("iMRi"),r=i("ug4p"),c=i("4n9w"),o=i("GJmQ"),l=i("9cVk"),d=i("dfy/"),u=i("wZYP"),h=i("F5Dh"),p=i("Y/CA"),g=i("711n"),m=i("qc15"),f=i("yQm5"),b=i("AEvm"),w=i("2G+H"),v=i("fXoL");class y extends b.a{constructor(e,t,i,n,s,a,r,c,o,l,d,u,h,p){super(),this.injector=e,this.$transition=t,this.$state=i,this.I18n=n,this.titleService=s,this.notificationService=a,this.states=r,this.wpCreate=c,this.wpViewFocus=o,this.wpTableFilters=l,this.wpCacheService=d,this.pathHelper=u,this.cdRef=h,this.RootDm=p,this.successState=Object(w.a)(this.$state),this.cancelState=this.$state.current.data.baseRoute,this.copying=!1,this.stateParams=this.$transition.params("to"),this.text={button_settings:this.I18n.t("js.button_settings")},this.destroyed=!1}ngOnInit(){this.closeEditFormWhenNewWorkPackageSaved(),this.showForm()}ngOnDestroy(){super.ngOnDestroy()}switchToFullscreen(){this.$state.go("work-packages.new",this.$state.params)}onSaved(e){var t;let{savedResource:i,isInitial:n}=e;null===(t=this.editForm)||void 0===t||t.cancel(!1),this.successState&&this.$state.go(this.successState,{workPackageId:i.id}).then(()=>{this.wpViewFocus.updateFocus(i.id),this.notificationService.showSave(i,n)})}showForm(){this.createdWorkPackage().then(e=>{this.change=e,this.newWorkPackage=e.pristineResource,this.cdRef.detectChanges(),this.setTitle(),this.stateParams.parent_id&&e.setValue("parent",{href:this.pathHelper.api.v3.work_packages.id(this.stateParams.parent_id).path}),this.stateParams.parent_id&&this.wpCacheService.loadWorkPackage(this.stateParams.parent_id).values$().pipe(this.untilDestroyed()).subscribe(e=>{this.parentWorkPackage=e,this.cdRef.detectChanges()})}).catch(e=>{"urn:openproject-org:api:v3:errors:MissingPermission"===e.errorIdentifier&&(this.RootDm.load().then(e=>{if(!e.user){let e=f(this.pathHelper.loginPath());e.search({back_url:e}),window.location.href=e.toString()}}),this.notificationService.handleRawError(e))})}setTitle(){this.titleService.setFirstPart(this.I18n.t("js.work_packages.create.title"))}cancelAndBackToList(){this.wpCreate.cancelCreation(),this.$state.go(this.cancelState,this.$state.params)}createdWorkPackage(){const e=this.stateParams.type?parseInt(this.stateParams.type):void 0,t=this.stateParams.projectPath;return this.wpCreate.createOrContinueWorkPackage(t,e)}closeEditFormWhenNewWorkPackageSaved(){this.wpCreate.onNewWorkPackage().pipe(Object(o.a)(()=>!this.componentDestroyed)).subscribe(e=>{this.onSaved({savedResource:e,isInitial:!0})})}}y.\u0275fac=function(e){return new(e||y)(v.gc(v.A),v.gc(n.J),v.gc(n.G),v.gc(u.a),v.gc(d.a),v.gc(m.a),v.gc(a.a),v.gc(c.a),v.gc(p.a),v.gc(h.a),v.gc(r.a),v.gc(s.a),v.gc(v.i),v.gc(l.a))},y.\u0275dir=v.bc({type:y,viewQuery:function(e,t){var i;(1&e&&v.fd(g.a,!0),2&e)&&(v.Nc(i=v.vc())&&(t.editForm=i.first))},features:[v.Qb]})},zTuL:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("wZYP"),s=i("sjKJ"),a=i("07mJ"),r=i("E2tj"),c=i("pL6k"),o=i("iB+3"),l=i("AEvm"),d=i("F3Jm"),u=i("IaZ+"),h=i("fXoL"),p=i("N5AO");class g extends l.a{constructor(e,t,i,n,s,a,r,c){super(),this.I18n=e,this.currentProject=t,this.bcfPathHelper=i,this.querySpace=n,this.queryUrlParamsHelper=s,this.opModalService=a,this.injector=r,this.state=c,this.text={export:this.I18n.t("js.bcf.export")}}ngOnInit(){this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.query=e;let t=this.currentProject.identifier,i=this.queryUrlParamsHelper.buildV3GetFilters(this.query.filters);this.exportLink=this.bcfPathHelper.projectExportIssuesPath(t,JSON.stringify(i))})}showDelayedExport(e){this.opModalService.show(d.a,this.injector,{link:this.exportLink}),e.preventDefault()}}g.\u0275fac=function(e){return new(e||g)(h.gc(n.a),h.gc(s.a),h.gc(a.a),h.gc(r.a),h.gc(c.a),h.gc(u.b),h.gc(h.A),h.gc(o.G))},g.\u0275cmp=h.ac({type:g,selectors:[["bcf-export-button"]],features:[h.Qb],decls:4,vars:3,consts:[[1,"button","export-bcf-button",3,"title","click"],["icon-classes","button--icon icon-export"],[1,"button--text"]],template:function(e,t){1&e&&(h.mc(0,"a",0),h.uc("click",(function(e){return t.showDelayedExport(e)})),h.hc(1,"op-icon",1),h.mc(2,"span",2),h.ad(3),h.lc(),h.lc()),2&e&&(h.Bc("title",t.text.export),h.Ub("href",t.exportLink,h.Tc),h.Tb(3),h.cd(" ",t.text.export," "))},directives:[p.a],encapsulation:2})},zUnb:function(e,t,i){"use strict";i.r(t);var n=i("fXoL"),s=i("EVdn"),a=i("AytR"),r=i("1Wj6");var c=i("qHU1"),o=i("FnNU"),l=i("3Pt+"),d=i("8VVp"),u=i("iMRi"),h=i("kt6C"),p=i("oJ+N"),g=i("CK39"),m=i("DvFC"),f=i("oT5z"),b=i("u4T9"),w=i("RuUM"),v=i("g1AQ"),y=i("mrSG"),k=i("d/TE"),C=i("wZYP"),j=i("kTsZ"),x=i("8aTQ");const T=["passwordConfirmationField"];class S extends x.a{constructor(){super(...arguments),this.password_confirmation=null}ngOnInit(){super.ngOnInit(),this.text.title=I18n.t("js.password_confirmation.title"),this.text.field_description=I18n.t("js.password_confirmation.field_description"),this.text.confirm_button=I18n.t("js.button_confirm"),this.text.password=I18n.t("js.label_password"),this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.showClose=!1}confirmAndClose(e){this.passwordValuePresent()&&super.confirmAndClose(e)}onOpen(e){super.onOpen(e),this.passwordConfirmationField.nativeElement.focus()}passwordValuePresent(){return null!==this.password_confirmation&&this.password_confirmation.length>0}}S.\u0275fac=function(e){return P(e||S)},S.\u0275cmp=n.ac({type:S,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(T,!0),2&e)&&(n.Nc(i=n.vc())&&(t.passwordConfirmationField=i.first))},features:[n.Qb],decls:16,vars:8,consts:[[1,"op-modal--portal","confirm-form-submit--modal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","password-confirm-dialog--modal","loading-indicator--location"],[1,"op-modal--modal-header"],[1,"icon-context","icon-locked",3,"textContent"],[1,"op-modal--modal-body"],[1,"request-for-confirmation--form","form","-vertical",3,"submit"],[1,"form--field","-required"],["for","request_for_confirmation_password",1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--text-field-container"],["type","password","id","request_for_confirmation_password","name","request_for_confirmation_password",1,"form--text-field",3,"ngModel","ngModelChange"],["passwordConfirmationField",""],[1,"form--field-instructions",3,"textContent"],[1,"op-modal--modal-footer"],[1,"confirm-form-submit--continue","button",3,"textContent","disabled","click"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.hc(3,"h3",3),n.lc(),n.mc(4,"div",4),n.mc(5,"form",5),n.uc("submit",(function(e){return t.confirmAndClose(e)})),n.mc(6,"div",6),n.hc(7,"label",7),n.mc(8,"div",8),n.mc(9,"div",9),n.mc(10,"input",10,11),n.uc("ngModelChange",(function(e){return t.password_confirmation=e})),n.lc(),n.lc(),n.lc(),n.hc(12,"div",12),n.lc(),n.lc(),n.lc(),n.mc(13,"div",13),n.mc(14,"button",14),n.uc("click",(function(e){return t.confirmAndClose(e)})),n.ad(15,' [attr.title]="text.button_cancel"> '),n.lc(),n.lc(),n.lc(),n.lc()),2&e&&(n.Tb(3),n.Bc("textContent",t.text.title),n.Tb(4),n.Bc("textContent",t.text.password),n.Ub("aria-label",t.text.field_description),n.Tb(3),n.Bc("ngModel",t.password_confirmation),n.Tb(2),n.Bc("textContent",t.text.field_description),n.Tb(2),n.Bc("textContent",t.text.confirm_button)("disabled",!t.passwordValuePresent()),n.Ub("title",t.text.confirm_button))},directives:[l.C,l.n,l.o,l.c,l.m,l.p],encapsulation:2});const P=n.oc(S);var I=i("IaZ+"),O=i("Ul5t"),R=i("nfBx"),B=i("YIAj"),E=i("5Lfy"),M=i("4rda"),F=i("Mo6U"),A=i("ug4p"),D=i("J30J"),q=i("5btT"),L=i("ZsX/"),$=i("Tac9"),N=i("jhN1");class Q{constructor(e){this.sanitizer=e}sanitize(e){return this.sanitizer.sanitize(n.W.HTML,e)||""}}Q.\u0275fac=function(e){return new(e||Q)(n.qc(N.b))},Q.\u0275prov=n.cc({token:Q,factory:Q.\u0275fac,providedIn:"root"});var V=i("Jui0"),H=i("E+lO"),z=i("GLdX"),Y=i("r0MM");class W{constructor(e){this.injector=e,this._knownHookNames=["workPackageTableContextMenu","workPackageSingleContextMenu","workPackageNewInitialization"],this.services={confirmDialog:this.injector.get(m.a),externalQueryConfiguration:this.injector.get(p.a),externalRelationQueryConfiguration:this.injector.get(g.a),halResource:this.injector.get(j.a),hooks:this.injector.get(v.a),i18n:this.injector.get(C.a),notifications:this.injector.get(k.a),opModalService:this.injector.get(I.b),opFileUpload:this.injector.get(L.a),helpTextDm:this.injector.get(O.a),attributeHelpTexts:this.injector.get(R.a),displayField:this.injector.get(D.a),editField:this.injector.get(q.a),wpCache:this.injector.get(A.a),macros:this.injector.get($.a),htmlSanitizeService:this.injector.get(Q),ckEditorPreview:this.injector.get(z.a),pathHelperService:this.injector.get(V.a),states:this.injector.get(u.a)},this.classes={modals:{passwordConfirmation:S,attributeHelpTexts:B.a,dynamicContent:E.a},HalResource:F.a,DisplayField:M.a},this.hooks={},this._knownHookNames.forEach(e=>{this.hooks[e]=t=>this.services.hooks.register(e,t)})}runInZone(e){this.zone.run(e)}bootstrap(e){H.DynamicBootstrapper.bootstrapOptionalEmbeddable(this.injector.get(n.f),e)}}Object(y.c)([Object(Y.a)(),Object(y.e)("design:type",n.K)],W.prototype,"zone",void 0);class U{constructor(e){Object(c.a)("Registering OpenProject plugin context");const t=new W(e);window.OpenProject.pluginContext.putValue(t)}}U.\u0275mod=n.ec({type:U}),U.\u0275inj=n.dc({factory:function(e){return new(e||U)(n.qc(n.A))},providers:[v.a]});var G,X=i("ofXK");!function(e){function t(e,t){const n=document.createElement("canvas"),s=n.getContext("2d");let a=t.width,r=t.height;a>r?a>e&&(r*=e/a,a=e):r>e&&(a*=e/r,r=e),n.width=a,n.height=r,s.drawImage(t,0,0,a,r);let c=n.toDataURL("image/jpeg");return[c,i(c)]}function i(e){const t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],n=t.length,s=new Uint8Array(n);for(var a=0;a<n;a++)s[a]=t.charCodeAt(a);return new Blob([s],{type:i})}e.resizeFile=function(e,i){return new Promise((n,s)=>{const a=new FileReader;a.onload=i=>{const s=new Image;s.onload=()=>n(t(e,s)),s.src=i.target.result},a.readAsDataURL(i)})},e.resizeImage=t}(G||(G={}));const K=["avatarFilePicker"];function Z(e,t){if(1&e&&n.hc(0,"span",6),2&e){const e=n.wc();n.Bc("textContent",e.text.wrong_file_format)}}function J(e,t){if(1&e&&(n.mc(0,"fieldset",11),n.hc(1,"legend",12),n.hc(2,"img",13),n.lc()),2&e){const e=n.wc();n.Tb(1),n.Bc("textContent",e.text.preview),n.Tb(1),n.Bc("src",e.avatarPreviewUrl,n.Tc)}}const ee=function(e){return{"-error":e}};class te{constructor(e,t,i,n){this.I18n=e,this.elementRef=t,this.notificationsService=i,this.opFileUpload=n,this.busy=!1,this.fileInvalid=!1,this.text={label_choose_avatar:this.I18n.t("js.avatars.label_choose_avatar"),upload_instructions:this.I18n.t("js.avatars.text_upload_instructions"),error_too_large:this.I18n.t("js.avatars.error_image_too_large"),wrong_file_format:this.I18n.t("js.avatars.wrong_file_format"),button_update:this.I18n.t("js.button_update"),uploading:this.I18n.t("js.avatars.uploading_avatar"),preview:this.I18n.t("js.label_preview")}}ngOnInit(){const e=this.elementRef.nativeElement;this.target=e.getAttribute("target"),this.method=e.getAttribute("method")}onFilePickerChanged(e){const t=Array.from(this.avatarFilePicker.nativeElement.files);if(0===t.length)return;const i=t[0];-1!==["image/jpeg","image/png","image/gif"].indexOf(i.type)?G.resizeFile(128,i).then(([e,t])=>{t.name=i.name,this.avatarFile=t,this.avatarPreviewUrl=e}):this.fileInvalid=!0}uploadAvatar(e){e.preventDefault(),this.busy=!0;const t=this.opFileUpload.uploadSingle(this.target,this.avatarFile,this.method,"text");this.notificationsService.addAttachmentUpload(this.text.uploading,[t]),t[1].subscribe(e=>{switch(e.type){case 0:return;case 4:return this.avatarFile.progress=100,this.busy=!1,void window.location.reload();default:return}},e=>{this.notificationsService.addError(e.error),this.busy=!1})}}te.\u0275fac=function(e){return new(e||te)(n.gc(C.a),n.gc(n.q),n.gc(k.a),n.gc(L.a))},te.\u0275cmp=n.ac({type:te,selectors:[["avatar-upload-form"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(K,!0),2&e)&&(n.Nc(i=n.vc())&&(t.avatarFilePicker=i.first))},decls:11,vars:9,consts:[[1,"form--field"],["for","avatar_file_input",1,"form--label",3,"ngClass","textContent"],[1,"form--field-container"],["type","file","accept","image/jpeg,image/png,image/gif","id","avatar_file_input","name","avatar_file_input",3,"change"],["avatarFilePicker",""],[1,"form--field-instructions"],[3,"textContent"],[1,"avatars--error-pane"],[3,"textContent",4,"ngIf"],["class","preview",4,"ngIf"],["type","submit",1,"button","-highlight","-with-icon","icon-checkmark",3,"textContent","click"],[1,"preview"],[1,"preview--legend",3,"textContent"],[1,"avatars--local-avatar-preview",3,"src"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.hc(1,"label",1),n.mc(2,"div",2),n.mc(3,"input",3,4),n.uc("change",(function(e){return t.onFilePickerChanged(e)})),n.lc(),n.lc(),n.mc(5,"div",5),n.hc(6,"span",6),n.mc(7,"div",7),n.Yc(8,Z,1,1,"span",8),n.lc(),n.lc(),n.lc(),n.Yc(9,J,3,2,"fieldset",9),n.mc(10,"button",10),n.uc("click",(function(e){return t.uploadAvatar(e)})),n.lc()),2&e&&(n.Tb(1),n.Bc("ngClass",n.Gc(7,ee,t.fileInvalid))("textContent",t.text.label_choose_avatar),n.Tb(5),n.Bc("textContent",t.text.upload_instructions),n.Tb(2),n.Bc("ngIf",t.fileInvalid),n.Tb(1),n.Bc("ngIf",t.avatarPreviewUrl),n.Tb(1),n.Bc("textContent",t.text.button_update),n.Ub("disabled",!t.avatarFile||t.busy||void 0))},directives:[X.n,X.q],encapsulation:2});class ie{constructor(e){e.get(v.a).register("openProjectAngularBootstrap",()=>[{selector:"avatar-upload-form",cls:te}])}}ie.\u0275mod=n.ec({type:ie}),ie.\u0275inj=n.dc({factory:function(e){return new(e||ie)(n.qc(n.A))},imports:[[X.b]]});class ne extends M.a{apply(e,t){super.apply(e,t),this.wpCacheService=this.injector.get(A.a),this.loadIfNecessary()}loadIfNecessary(){this.value&&!1===this.value.$loaded&&this.value.$load().then(()=>{"WorkPackage"===this.resource.$source._type&&this.wpCacheService.touch(this.resource.id)})}get title(){return""}render(e,t){this.isEmpty()?e.textContent=this.placeholder:this.value.elements.forEach((t,i)=>{this.resource.showCosts?this.renderCostAsLink(t,e,i):this.renderCostAsText(t,e,i)})}isEmpty(){return!this.value||!this.value.elements||0===this.value.elements.length}renderCostAsLink(e,t,i){const n=this.resource.showCosts,s=document.createElement("a");s.href=n.href+"?cost_type_id="+e.costObjectId,s.setAttribute("target","_blank"),s.textContent=e.spentUnits+" "+e.costType.name,t.appendChild(s),this.addSeparator(t,i)}renderCostAsText(e,t,i){document.createElement("span").textContent=e.spentUnits+" "+e.costType.name,this.addSeparator(t,i)}addSeparator(e,t){if(t<this.value.elements.length-1){const t=document.createElement("span");t.textContent=", ",e.appendChild(t)}}}class se extends M.a{isEmpty(){return!this.value||!parseFloat(this.value.match(/\d+/g)[0])}}var ae=i("LrpJ");class re extends F.a{}const ce=Object(ae.a)(re);class oe{constructor(){jQuery("costs-subform").each((e,t)=>{let i=jQuery(t);const n=i.find(".subform-container"),s=i.find(".subform-row-template");s.detach();const a=s[0].outerHTML;let r=parseInt(i.attr("item-count"));i.on("click",".delete-row-button,.delete-budget-item",e=>(jQuery(e.target).closest(".subform-row").remove(),!1)),i.find(".add-row-button,.wp-inline-create--add-link").click(e=>{e.preventDefault();let t=jQuery(a.replace(/INDEX/g,r.toString()));return t.show(),t.removeClass("subform-row-template"),n.append(t),r+=1,n.find(".subform-row:last-child input:first").focus(),!1})})}}oe.\u0275fac=function(e){return new(e||oe)},oe.\u0275prov=n.cc({token:oe,factory:oe.\u0275fac});class le{constructor(e){this.$element=e,this.objId=this.$element.attr("obj-id"),this.objName=this.$element.attr("obj-name"),this.obj=jQuery(`#${this.objId}_costs`),this.makeEditable()}static listen(){jQuery(document).on("click",".costs--edit-planned-costs-btn",e=>{const t=jQuery(e.target).closest("cost-unit-subform");new le(t)})}makeEditable(){this.edit_and_focus()}edit_and_focus(){this.edit(),jQuery("#"+this.objId+"_costs_edit").trigger("focus"),jQuery("#"+this.objId+"_costs_edit").trigger("select")}getCurrency(){return jQuery("#"+this.objId+"_currency").val()}getValue(){return jQuery("#"+this.objId+"_cost_value").val()}edit(){this.obj.hide();let e=this.obj[0].id,t=this.getCurrency(),i=this.getValue(),n=this.objName;jQuery(`\n      <section class="form--section" id="${e}_section">\n        <div class="form--field">\n          <div class="form--field-container">\n            <div id="${e}_cancel" class="form--field-affix -transparent icon icon-close"></div>\n            <div id="${e}_editor" class="form--text-field-container">\n                <input id="${e}_edit" class="form--text-field" name="${n}" value="${i}" class="currency" type="text" />\n            </div>\n            <div class="form--field-affix" id="${e}_affix">${t}</div>\n          </div>\n        </div>\n      </section>\n    `).insertAfter(this.obj);let s=this;jQuery("#"+e+"_cancel").on("click",(function(){return jQuery("#"+e+"_section").remove(),s.obj.show(),!1}))}}var de=i("POAS"),ue=i("tk/3");class he{constructor(e,t){this.halNotification=e,this.http=t}listen(){jQuery("costs-budget-subform").each((e,t)=>{let i=jQuery(t);const n=i.find(".budget-item-container"),s=i.find(".budget-row-template");s.detach();const a=s[0].outerHTML;let r=parseInt(i.attr("item-count"));i.on("change",".budget-item-value",e=>{let t=jQuery(e.target).closest(".cost_entry");this.refreshRow(i,t.attr("id"))}),i.on("click",".delete-budget-item",e=>(e.preventDefault(),jQuery(e.target).closest(".cost_entry").remove(),!1)),i.find(".budget-add-row").click(e=>{e.preventDefault();let t=jQuery(a.replace(/INDEX/g,r.toString()));return t.show(),t.removeClass("budget-row-template"),n.append(t),r+=1,!1})})}refreshRow(e,t){let i=e.find("#"+t),n=this.buildRefreshRequest(i,t);this.http.post(e.attr("update-url"),n,{headers:{Accept:"application/json"},withCredentials:!0}).subscribe(e=>{_.each(e,(e,t)=>{let i=document.getElementById(t);i instanceof HTMLInputElement?i.value=e:i&&(i.textContent=e)})},e=>this.halNotification.handleRawError(e))}buildRefreshRequest(e,t){let i={element_id:t,fixed_date:jQuery("#cost_object_fixed_date").val()};return e.find(".budget-item-value").each((e,t)=>{let n=jQuery(t);i[n.data("requestKey")]=n.val()||"0"}),i}}he.\u0275fac=function(e){return new(e||he)(n.qc(de.a),n.qc(ue.b))},he.\u0275prov=n.cc({token:he,factory:he.\u0275fac});class pe{constructor(e){!function(e){window.OpenProject.getPluginContext().then(t=>{t.services.editField.extendFieldType("select",["Budget"]);let i=t.services.displayField;i.extendFieldType("resource",["Budget"]),i.addFieldType(ne,"costs",["costsByType"]),i.addFieldType(se,"currency",["laborCosts","materialCosts","overallCosts"]),t.services.halResource.registerResource("Budget",{cls:ce}),t.hooks.workPackageSingleContextMenu((function(e){return{key:"log_costs",icon:"icon-projects",indexBy:function(e){var t=_.findIndex(e,{key:"log_time"});return-1!==t?t+1:e.length},resource:"workPackage",link:"logCosts"}})),t.hooks.workPackageTableContextMenu((function(e){return{key:"log_costs",icon:"icon-projects",link:"logCosts",indexBy:function(e){var t=_.findIndex(e,{link:"logTime"});return-1!==t?t+1:e.length},text:I18n.t("js.button_log_costs")}})),t.services.states.add("budgets",Object(o.g)()),new oe,le.listen(),e.get(he).listen()})}(e)}}pe.\u0275mod=n.ec({type:pe}),pe.\u0275inj=n.dc({factory:function(e){return new(e||pe)(n.qc(n.A))},providers:[he]});class ge extends F.a{constructor(){super(...arguments),this.attachmentsBackend=!1}}const me=Object(ae.a)(ge);class fe{constructor(){window.OpenProject.getPluginContext().then(e=>{e.services.halResource.registerResource("Document",{cls:me}),e.services.states.add("documents",Object(o.g)())})}}fe.\u0275mod=n.ec({type:fe}),fe.\u0275inj=n.dc({factory:function(e){return new(e||fe)}});class be{}be.\u0275mod=n.ec({type:be}),be.\u0275inj=n.dc({factory:function(e){return new(e||be)},imports:[[ie,pe,fe]]});var we=i("tG68"),ve=i("VpST"),ye=i("xRac"),ke=i("Xmgp"),Ce=i("CS/5"),je=i("5+WD"),xe=i("CejQ"),Te=i("sjKJ");class Se{constructor(e,t,i,n){this.startRow=e,this.endRow=t,this.startColumn=i,this.endColumn=n}get gridStartRow(){return 2*this.startRow}get gridEndRow(){return 2*this.endRow-1}get gridStartColumn(){return 2*this.startColumn}get gridEndColumn(){return 2*this.endColumn-1}get guid(){return this.storedGuid||(this.storedGuid=this.newGuid()),this.storedGuid}newGuid(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}class _e extends Se{constructor(e){super(e.startRow,e.endRow,e.startColumn,e.endColumn),this.widget=e}reset(){this.startRow=this.widget.startRow,this.endRow=this.widget.endRow,this.startColumn=this.widget.startColumn,this.endColumn=this.widget.endColumn}moveRight(){this.startColumn++,this.endColumn++}moveLeft(){this.startColumn--,this.endColumn--}growColumn(){this.endColumn++}overlaps(e){return this.rowOverlaps(e)&&this.columnOverlaps(e)}rowOverlaps(e){return this.startRow<e.endRow&&this.endRow>=e.endRow||this.startRow<=e.startRow&&this.endRow>e.startRow||this.startRow>e.startRow&&this.endRow<e.endRow}columnOverlaps(e){return this.startColumn<e.endColumn&&this.endColumn>=e.endColumn||this.startColumn<=e.startColumn&&this.endColumn>e.startColumn||this.startColumn>e.startColumn&&this.endColumn<e.endColumn}startColumnOverlaps(e){return this.startColumn<e.startColumn&&this.endColumn>e.startColumn&&this.rowOverlaps(e)}get unchangedSize(){return this.startColumn===this.widget.startColumn&&this.endColumn===this.widget.endColumn&&this.startRow===this.widget.startRow&&this.endRow===this.widget.endRow}writeAreaChangeToWidget(){this.widget.startRow=this.startRow,this.widget.endRow=this.endRow,this.widget.startColumn=this.startColumn,this.widget.endColumn=this.endColumn}copyDimensionsTo(e){e.startRow=this.startRow,e.startColumn=this.startColumn,e.endRow=this.endRow,e.endColumn=this.endColumn}}class Pe extends Se{constructor(e,t,i,n,s){super(e,t,i,n),this.type=s}get gridStartRow(){return this.isRow?2*this.startRow-1:2*this.startRow}get gridEndRow(){return this.isRow?2*this.endRow-2:2*this.endRow-1}get gridStartColumn(){return this.isRow?2*this.startColumn:2*this.startColumn-1}get gridEndColumn(){return this.isRow?2*this.endColumn-1:2*this.endColumn-2}get isRow(){return"row"===this.type}get isColumn(){return"column"===this.type}}var Ie=i("n9mQ"),Oe=i("2Vo4");class Re{constructor(e,t,i){this.gridDm=e,this.notification=t,this.i18n=i,this.numColumns=0,this.numRows=0,this.mousedOverArea=null,this.$mousedOverArea=new Oe.a(this.mousedOverArea),this.helpMode=!1}set gridResource(e){this.resource=e,this.fetchSchema(),this.numRows=this.resource.rowCount,this.numColumns=this.resource.columnCount,this.buildAreas(!0)}get gridResource(){return this.resource}setMousedOverArea(e){this.mousedOverArea=e,this.$mousedOverArea.next(e)}cleanupUnusedAreas(){let e=_.range(this.numRows,0,-1);this.widgetAreas.forEach(t=>{e=e.filter(e=>e!==t.startRow)}),e.forEach(e=>{this.numRows>1&&this.removeRow(e)});let t=_.range(this.numColumns,0,-1);this.widgetAreas.forEach(e=>{t=t.filter(t=>t!==e.startColumn)}),t.forEach(e=>{this.numColumns>1&&this.removeColumn(e)})}buildAreas(e=!1){this.gridAreas=this.buildGridAreas(),this.gridGaps=this.buildGridGaps(),this.gridAreaIds=this.buildGridAreaIds(),e&&(this.widgetAreas=this.buildGridWidgetAreas())}rebuildAndPersist(){this.persist(),this.buildAreas(!1)}persist(){this.resource.rowCount=this.numRows=(this.widgetAreas.map(e=>e.endRow).sort().pop()||2)-1,this.resource.columnCount=this.numColumns,this.writeAreaChangesToWidgets(),this.saveGrid(this.resource,this.schema)}saveWidgetChangeset(e){let t=this.gridDm.extractPayload(this.resource,this.schema),i=t.widgets.find(t=>t.id===e.pristineResource.id);Object.assign(i,e.changes),t.id=this.resource.id,this.saveGrid(t)}isGap(e){return e instanceof Pe}get isSingleCell(){return 1===this.numRows&&1===this.numColumns&&0===this.widgetResources.length}get inHelpMode(){return this.helpMode||this.isSingleCell}toggleHelpMode(){this.helpMode=!this.helpMode}scrollPlaceholderIntoView(){let e=jQuery(".grid--area.-placeholder");e[0].scrollIntoViewIfNeeded&&setTimeout(()=>e[0].scrollIntoViewIfNeeded())}saveGrid(e,t){this.gridDm.update(e,t).then(e=>{this.assignAreasWidget(e),this.notification.addSuccess(this.i18n.t("js.notice_successful_update"))})}assignAreasWidget(e){this.resource.widgets=e.widgets;let t=this.widgetAreas.map(e=>e.widget.id);this.widgetAreas.forEach(i=>{let n;n=i.widget.id?e.widgets.find(e=>e.id===i.widget.id):e.widgets.find(e=>!t.includes(e.id)&&e.identifier===i.widget.identifier&&e.startRow===i.widget.startRow&&e.startColumn===i.widget.startColumn),i.widget=n})}buildGridAreas(){let e=[];for(let t=1;t<=this.numRows+1;t++)e.push(...this.buildGridAreasRow(t));return e}buildGridGaps(){let e=[];if(this.isSingleCell)return e;for(let t=1;t<=this.numRows+1;t++)e.push(...this.buildGridGapRow(t));return e}buildGridAreasRow(e){let t=[];for(let i=1;i<=this.numColumns;i++){let n=new Se(e,e+1,i,i+1);t.push(n)}return t}buildGridGapRow(e){let t=[];for(let i=1;i<=this.numColumns;i++)t.push(new Pe(e,e+1,i,i+1,"row"));if(e<=this.numRows)for(let i=1;i<=this.numColumns+1;i++)t.push(new Pe(e,e+1,i,i+1,"column"));return t}buildGridWidgetAreas(){return this.widgetResources.map(e=>new _e(e))}writeAreaChangesToWidgets(){this.widgetAreas.forEach(e=>{e.writeAreaChangeToWidget()})}addColumn(e,t){this.numColumns++;let i=[];for(let n=1;n<=this.numRows;n++){if(n===t)continue;let s=this.rowWidgets(n).sort((e,t)=>e.startColumn-t.startColumn).find(i=>!(i.startRow<t&&i.endRow>t)&&(i.startColumn===e+1||i.endColumn===e+1||i.startColumn<=e&&i.endColumn>e));s&&(i.push(s),s.endColumn++)}this.moveSubsequentRowWidgets(this.widgetAreas.filter(e=>!i.includes(e)),e)}addRow(e,t){this.numRows++;let i=[];for(let n=1;n<=this.numColumns;n++){if(n===t)continue;let s=this.columnWidgets(n).sort((e,t)=>e.startRow-t.startRow).find(i=>!(i.startColumn<t&&i.endColumn>t)&&(i.startRow===e+1||i.endRow===e+1||i.startRow<=e&&i.endRow>e));s&&(i.push(s),s.endRow++)}this.moveSubsequentColumnWidgets(this.widgetAreas.filter(e=>!i.includes(e)),e)}removeColumn(e){this.numColumns--,this.widgetAreas.forEach(t=>{t.startColumn<=e&&t.endColumn>=e+1&&t.endColumn--}),this.widgetAreas.filter(t=>t.startColumn>e).forEach(e=>{e.startColumn--,e.endColumn--})}removeRow(e){this.numRows--,this.widgetAreas.forEach(t=>{t.startRow<=e&&t.endRow>=e+1&&t.endRow--}),this.widgetAreas.filter(t=>t.startRow>e).forEach(e=>{e.startRow--,e.endRow--})}resetAreas(e=null){this.widgetAreas.filter(t=>!e||t.guid!==e.guid).forEach(e=>e.reset()),this.numRows=this.resource.rowCount,this.numColumns=this.resource.columnCount}get isEditable(){return void 0!==this.gridResource.updateImmediately}buildGridAreaIds(){return this.gridAreas.filter(e=>!this.isGap(e)).map(e=>e.guid)}fetchSchema(){this.gridDm.updateForm(this.resource).then(e=>{this.schema=e.schema})}removeWidget(e){let t=this.resource.widgets.findIndex(t=>t.id===e.id);this.resource.widgets.splice(t,1),t=this.widgetAreas.findIndex(t=>t.widget.id===e.id),this.widgetAreas.splice(t,1),this.cleanupUnusedAreas(),this.rebuildAndPersist()}get widgetResources(){return this.resource&&this.resource.widgets||[]}rowWidgets(e){return this.widgetAreas.filter(t=>t.startRow===e)}moveSubsequentRowWidgets(e,t){e.forEach(e=>{e.startColumn>t&&(e.startColumn++,e.endColumn++)})}columnWidgets(e){return this.widgetAreas.filter(t=>t.startColumn===e)}moveSubsequentColumnWidgets(e,t){e.forEach(e=>{e.startRow>t&&(e.startRow++,e.endRow++)})}}Re.\u0275fac=function(e){return new(e||Re)(n.qc(Ie.a),n.qc(k.a),n.qc(C.a))},Re.\u0275prov=n.cc({token:Re,factory:Re.\u0275fac});var Be=i("CV67");const Ee=function(e){return{"-editable":e}};class Me{constructor(e){this.layout=e,this.editable=!0,this.onRenamed=new n.s}renamed(e){this.onRenamed.emit(e)}get isRenameable(){return this.editable&&this.layout.isEditable}}Me.\u0275fac=function(e){return new(e||Me)(n.gc(Re))},Me.\u0275cmp=n.ac({type:Me,selectors:[["widget-header"]],inputs:{name:"name",editable:"editable"},outputs:{onRenamed:"onRenamed"},ngContentSelectors:["*"],decls:3,vars:5,consts:[[1,"widget-box--header",3,"ngClass"],[1,"widget-box--header-title",3,"title","editable","onSave"]],template:function(e,t){1&e&&(n.Ac(),n.mc(0,"h3",0),n.mc(1,"editable-toolbar-title",1),n.uc("onSave",(function(e){return t.renamed(e)})),n.lc(),n.zc(2),n.lc()),2&e&&(n.Bc("ngClass",n.Gc(3,Ee,t.isRenameable)),n.Tb(1),n.Bc("title",t.name)("editable",t.isRenameable))},directives:[X.n,Be.a],styles:[".widget-box--header.-editable[_ngcontent-%COMP%]{margin-top:0}.widget-box--header-title[_ngcontent-%COMP%]{padding-right:5px}"],changeDetection:0});i("PHo6");class Fe{constructor(e){this.layout=e}area(e){this.widget(e.widget)}widget(e){this.layout.removeWidget(e)}}Fe.\u0275fac=function(e){return new(e||Fe)(n.qc(Re))},Fe.\u0275prov=n.cc({token:Fe,factory:Fe.\u0275fac});class Ae{constructor(e,t,i){this.i18n=e,this.remove=t,this.layout=i,this.menuItemList=[this.removeItem]}get menuItems(){return()=>Object(y.b)(this,void 0,void 0,(function*(){return this.menuItemList}))}get removeItem(){return{linkText:this.i18n.t("js.grid.remove"),onClick:()=>(this.remove.widget(this.resource),!0)}}get hasMenu(){return this.layout.isEditable}}Ae.\u0275fac=function(e){return new(e||Ae)(n.gc(C.a),n.gc(Fe),n.gc(Re))},Ae.\u0275dir=n.bc({type:Ae,inputs:{resource:"resource"}});var De=i("AdL0");function qe(e,t){if(1&e&&n.hc(0,"icon-triggered-context-menu",1),2&e){const e=n.wc();n.Bc("menu-items",e.menuItems)}}class Le extends Ae{}Le.\u0275fac=function(e){return $e(e||Le)},Le.\u0275cmp=n.ac({type:Le,selectors:[["widget-menu"]],features:[n.Qb],decls:1,vars:1,consts:[[3,"menu-items",4,"ngIf"],[3,"menu-items"]],template:function(e,t){1&e&&n.Yc(0,qe,1,1,"icon-triggered-context-menu",0),2&e&&n.Bc("ngIf",t.hasMenu)},directives:[X.q,De.a],styles:["[_nghost-%COMP%]{align-self:center}"]});const $e=n.oc(Le);var Ne=i("HEQ6"),Qe=i("IvIE"),Ve=i("E2tj"),He=i("F5Dh"),ze=i("wd/R"),Ye=i("DhiE"),We=i("iB+3"),Ue=i("W6hW"),Ge=i("dfy/"),Xe=i("iOEq"),Ke=i("IzEk"),Ze=i("8zkO"),Je=i("AEvm");function et(e,t){if(1&e&&n.hc(0,"div",4),2&e){const e=n.wc();n.Bc("textContent",e.tooManyResultsText)}}class tt extends Je.a{constructor(e,t,i,n,s,a,r,c,o,l,d,u){super(),this.states=e,this.$state=t,this.wpTableFilters=i,this.wpListService=n,this.querySpace=s,this.wpListChecksumService=a,this.titleService=r,this.element=c,this.i18n=o,this.notificationsService=l,this.sanitizer=d,this.configuration=u,this.static=!1,this.calendarPlugins=[Xe.d],this.alreadyLoaded=!1}ngOnInit(){this.querySpace.stopAllSubscriptions.next(),this.setupWorkPackagesListener(),this.initializeCalendar()}ngAfterViewInit(){this.ucCalendar.getApi().setOption("eventRender",e=>{this.addTooltip(e)}),this.ucCalendar.getApi().setOption("eventClick",e=>{this.toWPFullView(e)})}calendarEventsFunction(e,t,i){if(this.alreadyLoaded){this.alreadyLoaded=!1;let e=this.updateResults(this.querySpace.results.value);t(e)}else this.querySpace.results.values$().pipe(Object(Ke.a)(1)).subscribe(e=>{let i=this.updateResults(e);t(i)});this.updateTimeframe(e)}initializeCalendar(){this.calendarEvents=this.calendarEventsFunction.bind(this),this.setCalendarHeight(),this.setCalendarHeader()}updateTimeframe(e){let t=this.wpTableFilters.isEmpty;if(t&&this.querySpace.query.value)return;let i=ze(e.start).format("YYYY-MM-DD"),n=ze(e.end).format("YYYY-MM-DD");if(t){let e=this.defaultQueryProps(i,n);this.$state.params.query_props&&(e=decodeURIComponent(this.$state.params.query_props||"")),this.wpListService.fromQueryParams({query_props:e},this.projectIdentifier).toPromise()}else{this.$state.params;this.wpTableFilters.modify("datesInterval",e=>{e.values[0]=i,e.values[1]=n})}}addTooltip(e){jQuery(e.el).tooltip({content:this.tooltipContentString(e.event.extendedProps.workPackage),items:".fc-event",close:function(){jQuery(".ui-helper-hidden-accessible").remove()},track:!0})}toWPFullView(e){let t=e.event.extendedProps.workPackage;e.el&&this.removeTooltip(e.el),this.wpListChecksumService.clear(),window.history.pushState({},this.titleService.current,window.location.href),this.$state.go("work-packages.show",{workPackageId:t.id},{inherit:!1})}get calendarEditable(){return!1}get calendarEventLimit(){return!1}get calendarLocale(){return this.i18n.locale}get calendarFixedWeekCount(){return!1}get calendarDefaultView(){return this.static?"dayGridWeek":null}get calendarFirstDay(){return this.configuration.startOfWeek()}get calendarElement(){return jQuery(this.element.nativeElement).find(".fc-view-container")}setCalendarHeight(){this.static?this.calendarHeight=()=>{let e=jQuery(this.element.nativeElement);for(;!e.height()&&e.parent();)e=e.parent();let t=jQuery(this.element.nativeElement).position().top,i=e.position().top;return e.height()-(t-i)}:this.calendarHeight=()=>jQuery(window).height()-this.calendarElement.offset().top-12}setCalendarHeader(){this.static?this.calendarHeader=!1:this.calendarHeader={right:"dayGridMonth,dayGridWeek",center:"title",left:"prev,next today"}}setCalendarsDate(){const e=this.querySpace.query.value;if(!e)return;let t=_.find(e.filters||[],{id:"datesInterval"}),i=null,n="dayGridMonth";if(t){let e=ze(t.values[0]),s=ze(t.values[1]).diff(e,"days");i=e.add(s/2,"days"),7===s&&(n="dayGridWeek")}i?this.ucCalendar.getApi().changeView(n,i.toDate()):this.ucCalendar.getApi().changeView(n)}setupWorkPackagesListener(){this.querySpace.results.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.alreadyLoaded=!0,this.setCalendarsDate(),this.ucCalendar.getApi().refetchEvents()})}updateResults(e){return this.warnOnTooManyResults(e),this.mapToCalendarEvents(e.elements)}mapToCalendarEvents(e){return e.map(e=>{let t=this.eventDate(e,"start"),i=this.eventDate(e,"due"),n=ze(i).add(1,"days").format("YYYY-MM-DD");return{title:e.subject,start:t,end:n,allDay:!0,className:`__hl_background_type_${e.type.id}`,workPackage:e}})}warnOnTooManyResults(e){e.count<e.total?this.tooManyResultsText=this.i18n.t("js.calendar.too_many",{count:e.total,max:tt.MAX_DISPLAYED}):this.tooManyResultsText=null,this.tooManyResultsText&&!this.static&&this.notificationsService.addNotice(this.tooManyResultsText)}defaultQueryProps(e,t){let i={c:["id"],t:"id:asc",f:[{n:"status",o:"o",v:[]},{n:"datesInterval",o:"<>d",v:[e,t]}],pp:tt.MAX_DISPLAYED};return JSON.stringify(i)}eventDate(e,t){return e.isMilestone?e.date:e[`${t}Date`]}tooltipContentString(e){return`\n        ${this.sanitizedValue(e,"type")} #${e.id}: ${this.sanitizedValue(e,"subject",null)}\n        <ul class="tooltip--map">\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.work_packages.properties.projectName")}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(e,"project")}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.work_packages.properties.status")}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(e,"status")}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.work_packages.properties.startDate")}:</span>\n            <span class="tooltip--map--value">${this.eventDate(e,"start")}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.work_packages.properties.dueDate")}:</span>\n            <span class="tooltip--map--value">${this.eventDate(e,"due")}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.work_packages.properties.assignee")}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(e,"assignee")}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.work_packages.properties.priority")}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(e,"priority")}</span>\n          </li>\n        </ul>\n        `}sanitizedValue(e,t,i="name"){let s=e[t];return s=i&&s?s[i]:s,s=s||this.i18n.t("js.placeholders.default"),this.sanitizer.sanitize(n.W.HTML,s)}removeTooltip(e){jQuery(e).tooltip({close:function(){jQuery(".ui-helper-hidden-accessible").remove()},disabled:!0})}}tt.MAX_DISPLAYED=100,tt.\u0275fac=function(e){return new(e||tt)(n.gc(u.a),n.gc(We.G),n.gc(He.a),n.gc(Ye.a),n.gc(Ve.a),n.gc(Ue.a),n.gc(Ge.a),n.gc(n.q),n.gc(C.a),n.gc(k.a),n.gc(N.b),n.gc(Ze.a))},tt.\u0275cmp=n.ac({type:tt,selectors:[["wp-calendar"]],viewQuery:function(e,t){var i;(1&e&&n.fd(Qe.a,!0),2&e)&&(n.Nc(i=n.vc())&&(t.ucCalendar=i.first))},inputs:{projectIdentifier:"projectIdentifier",static:"static"},features:[n.Qb],decls:4,vars:12,consts:[[1,"wp-calendar--container","loading-indicator--location",2,"position","relative"],[3,"editable","eventLimit","locale","fixedWeekCount","height","header","defaultView","firstDay","events","plugins"],["ucCalendar",""],["class","wp-calendar--notification",3,"textContent",4,"ngIf"],[1,"wp-calendar--notification",3,"textContent"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.hc(1,"full-calendar",1,2),n.Yc(3,et,1,1,"div",3),n.lc()),2&e&&(n.Ub("data-indicator-name","table"),n.Tb(1),n.Bc("editable",t.calendarEditable)("eventLimit",t.calendarEventLimit)("locale",t.calendarLocale)("fixedWeekCount",t.calendarFixedWeekCount)("height",t.calendarHeight)("header",t.calendarHeader)("defaultView",t.calendarDefaultView)("firstDay",t.calendarFirstDay)("events",t.calendarEvents)("plugins",t.calendarPlugins),n.Tb(2),n.Bc("ngIf",t.static))},directives:[Qe.a,X.q],styles:[".wp-calendar--container[_ngcontent-%COMP%]{min-height:200px}.wp-calendar--notification[_ngcontent-%COMP%]{font-style:italic;margin-top:.5rem}"]});class it extends xe.a{constructor(e,t,i){super(e,t),this.i18n=e,this.injector=t,this.currentProject=i}get projectIdentifier(){return this.currentProject.identifier}}it.\u0275fac=function(e){return new(e||it)(n.gc(C.a),n.gc(n.A),n.gc(Te.a))},it.\u0275cmp=n.ac({type:it,selectors:[["ng-component"]],features:[n.Qb],decls:4,vars:4,consts:[[3,"name","onRenamed"],[3,"resource"],["wp-isolated-query-space",""],[3,"static","projectIdentifier"]],template:function(e,t){1&e&&(n.mc(0,"widget-header",0),n.uc("onRenamed",(function(e){return t.renameWidget(e)})),n.hc(1,"widget-menu",1),n.lc(),n.kc(2,2),n.hc(3,"wp-calendar",3),n.jc()),2&e&&(n.Bc("name",t.widgetName),n.Tb(1),n.Bc("resource",t.resource),n.Tb(2),n.Bc("static",!0)("projectIdentifier",t.projectIdentifier))},directives:[Me,Le,Ne.a,tt],encapsulation:2});var nt=i("juWA"),st=i("SqdZ"),at=i("Y0Nk"),rt=i("qc15");function ct(e,t){if(1&e){const e=n.nc();n.mc(0,"div",11),n.hc(1,"label",12),n.mc(2,"span",13),n.mc(3,"span",14),n.mc(4,"input",15),n.uc("ngModelChange",(function(i){n.Qc(e);const s=t.index;return n.wc().days[s]=i})),n.lc(),n.lc(),n.lc(),n.lc()}if(2&e){const e=t.$implicit,i=t.index,s=n.wc();n.Tb(1),n.Bc("textContent",e)("htmlFor","day_"+i),n.Tb(3),n.Bc("id","day_"+i)("ngModel",s.days[i])}}class ot extends st.a{constructor(e,t,i,n,s,a,r,c,o){super(e,r,o),this.locals=e,this.I18n=t,this.injector=i,this.appRef=n,this.loadingIndicator=s,this.notificationService=a,this.cdRef=r,this.configuration=c,this.elementRef=o,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.text={displayedDays:this.I18n.t("js.grid.widgets.time_entries_current_user.displayed_days"),closePopup:this.I18n.t("js.close_popup_title"),applyButton:this.I18n.t("js.modals.button_apply"),cancelButton:this.I18n.t("js.modals.button_cancel"),weekdays:moment.weekdays()},this.firstDayOffset=this.configuration.startOfWeek()}ngOnInit(){this.days=this.locals.options.days||Array.from({length:7},()=>!0);let e=1+moment.localeData().firstDayOfWeek()%7;this.text.weekdays=moment.localeData().weekdays().slice(e).concat(moment.localeData().weekdays().slice(0,e))}saveChanges(){this.options={days:this.days},this.service.close()}}function lt(e,t){if(1&e&&n.hc(0,"icon-triggered-context-menu",1),2&e){const e=n.wc();n.Bc("menu-items",e.menuItems)}}ot.\u0275fac=function(e){return new(e||ot)(n.gc(I.a),n.gc(C.a),n.gc(n.A),n.gc(n.f),n.gc(at.a),n.gc(rt.a),n.gc(n.i),n.gc(Ze.a),n.gc(n.q))},ot.\u0275cmp=n.ac({type:ot,selectors:[["ng-component"]],features:[n.Qb],decls:11,vars:5,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container"],[1,"op-modal--modal-header"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[3,"textContent"],["class","form--field -trailing-label",4,"ngFor","ngForOf"],[1,"tab-content"],[1,"modal--form-actions"],[1,"button","-highlight",3,"textContent","click"],[1,"button",3,"textContent","click"],[1,"form--field","-trailing-label"],[1,"form--label",3,"textContent","htmlFor"],[1,"form--field-container"],[1,"form--check-box-container"],["type","checkbox","name","days",1,"form--check-box",3,"id","ngModel","ngModelChange"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.mc(3,"a",3),n.mc(4,"i",4),n.uc("click",(function(e){return t.closeMe(e)})),n.lc(),n.lc(),n.lc(),n.hc(5,"h3",5),n.Yc(6,ct,5,4,"div",6),n.hc(7,"div",7),n.mc(8,"div",8),n.mc(9,"button",9),n.uc("click",(function(){return t.saveChanges()})),n.lc(),n.mc(10,"button",10),n.uc("click",(function(e){return t.closeMe(e)})),n.lc(),n.lc(),n.lc(),n.lc()),2&e&&(n.Tb(4),n.Ub("title",t.text.closePopup),n.Tb(1),n.Bc("textContent",t.text.displayedDays),n.Tb(1),n.Bc("ngForOf",t.text.weekdays),n.Tb(3),n.Bc("textContent",t.text.applyButton),n.Tb(1),n.Bc("textContent",t.text.cancelButton))},directives:[X.p,l.a,l.m,l.p],encapsulation:2});class dt extends Ae{constructor(e,t,i,s,a){super(i,s,a),this.injector=e,this.opModalService=t,this.i18n=i,this.remove=s,this.layout=a,this.onConfigured=new n.s,this.menuItemList=[this.removeItem,this.configureItem]}get configureItem(){return{linkText:this.i18n.t("js.grid.configure"),onClick:()=>(this.opModalService.show(ot,this.injector,this.locals).closingEvent.subscribe(e=>{e.options&&this.onConfigured.emit(e.options)}),!0)}}get locals(){return{options:this.resource.options}}}dt.\u0275fac=function(e){return new(e||dt)(n.gc(n.A),n.gc(I.b),n.gc(C.a),n.gc(Fe),n.gc(Re))},dt.\u0275cmp=n.ac({type:dt,selectors:[["widget-time-entries-current-user-menu"]],outputs:{onConfigured:"onConfigured"},features:[n.Qb],decls:1,vars:1,consts:[[3,"menu-items",4,"ngIf"],[3,"menu-items"]],template:function(e,t){1&e&&n.Yc(0,lt,1,1,"icon-triggered-context-menu",0),2&e&&n.Bc("ngIf",t.hasMenu)},directives:[X.q,De.a],encapsulation:2});var ut=i("p8AH"),ht=i("j/Ak"),pt=i("UD+K"),gt=i("dMmB");class mt extends pt.a{constructor(e,t,i){super(),this.states=e,this.schemaCacheService=t,this.timeEntryDm=i}loadAll(e){return Promise.all(e.map(e=>this.load(e))).then(e=>{})}updateValue(e,t){this.schemaCacheService.ensureLoaded(t).then(()=>{super.updateValue(e,t)})}load(e){return this.timeEntryDm.one(parseInt(e)).then(e=>this.schemaCacheService.ensureLoaded(e).then(()=>e))}get multiState(){return this.states.timeEntries}}mt.\u0275fac=function(e){return new(e||mt)(n.qc(u.a),n.qc(gt.a),n.qc(ht.a))},mt.\u0275prov=n.cc({token:mt,factory:mt.\u0275fac,providedIn:"root"});var ft=i("Gbwi"),bt=i("SKFm"),wt=i("xkGU"),vt=i("Zb8V"),yt=i("N5AO");function kt(e,t){if(1&e){const e=n.nc();n.mc(0,"button",12),n.uc("click",(function(){return n.Qc(e),n.wc().saveEntry()})),n.hc(1,"op-icon",13),n.hc(2,"span",14),n.lc()}if(2&e){const e=n.wc();n.Ub("title",e.saveText),n.Tb(2),n.Bc("textContent",e.saveText)}}function Ct(e,t){if(1&e){const e=n.nc();n.mc(0,"button",15),n.uc("click",(function(t){return n.Qc(e),n.wc().closeMe(t)})),n.hc(1,"op-icon",16),n.hc(2,"span",14),n.lc()}if(2&e){const e=n.wc();n.Ub("title",e.text.cancel),n.Tb(2),n.Bc("textContent",e.text.cancel)}}function jt(e,t){if(1&e){const e=n.nc();n.mc(0,"button",15),n.uc("click",(function(){return n.Qc(e),n.wc().destroy()})),n.hc(1,"op-icon",17),n.hc(2,"span",14),n.lc()}if(2&e){const e=n.wc();n.Ub("title",e.text.delete),n.Tb(2),n.Bc("textContent",e.text.delete)}}class xt extends wt.a{setModifiedEntry(e){this.modifiedEntry=e.savedResource}get saveAllowed(){return!!this.entry.update}get deleteAllowed(){return!!this.entry.delete}destroy(){window.confirm(this.text.areYouSure)&&(this.destroyedEntry=this.entry,this.service.close())}}xt.\u0275fac=function(e){return Tt(e||xt)},xt.\u0275cmp=n.ac({type:xt,selectors:[["ng-component"]],features:[n.Sb([bt.a]),n.Qb],decls:13,vars:7,consts:[[1,"op-modal--portal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","confirm-dialog--modal","loading-indicator--location"],[1,"op-modal--modal-header"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[1,"icon-context","icon-log_time",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[3,"entry","showWorkPackageField","modifiedEntry"],["editForm",""],[1,"op-modal--modal-footer"],["class","button -highlight",3,"click",4,"ngIf"],["class","button",3,"click",4,"ngIf"],[1,"button","-highlight",3,"click"],["icon-classes","button--icon icon-checkmark"],["aria-hidden","true",1,"button--text",3,"textContent"],[1,"button",3,"click"],["icon-classes","button--icon icon-close"],["icon-classes","button--icon icon-delete"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.mc(3,"a",3),n.mc(4,"i",4),n.uc("click",(function(e){return t.closeMe(e)})),n.lc(),n.lc(),n.hc(5,"h3",5),n.lc(),n.mc(6,"div",6),n.mc(7,"te-form",7,8),n.uc("modifiedEntry",(function(e){return t.setModifiedEntry(e)})),n.lc(),n.lc(),n.mc(9,"div",9),n.Yc(10,kt,3,2,"button",10),n.Yc(11,Ct,3,2,"button",11),n.Yc(12,jt,3,2,"button",11),n.lc(),n.lc(),n.lc()),2&e&&(n.Tb(4),n.Ub("title",t.text.close),n.Tb(1),n.Bc("textContent",t.text.title),n.Tb(2),n.Bc("entry",t.entry)("showWorkPackageField",t.showWorkPackageField),n.Tb(3),n.Bc("ngIf",t.saveAllowed),n.Tb(1),n.Bc("ngIf",t.saveAllowed),n.Tb(1),n.Bc("ngIf",t.deleteAllowed))},directives:[vt.a,X.q,yt.a],styles:[".op-modal--modal-container[_ngcontent-%COMP%]{max-width:90vw;width:800px}.op-modal--modal-footer[_ngcontent-%COMP%]{margin-top:2em}.op-modal--modal-footer[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin-bottom:0}.icon-log_time[_ngcontent-%COMP%]:before{padding-right:6px}"],changeDetection:0});const Tt=n.oc(xt);class St{constructor(e,t,i,n){this.opModalService=e,this.injector=t,this.halResource=i,this.i18n=n}edit(e){return new Promise((t,i)=>{const n=this.opModalService.show(xt,this.injector,{entry:e});n.closingEvent.pipe(Object(Ke.a)(1)).subscribe(()=>{n.destroyedEntry?n.destroyedEntry.delete().then(()=>{t({entry:n.destroyedEntry,action:"destroy"})}):n.modifiedEntry?t({entry:n.modifiedEntry,action:"update"}):i()})})}}St.\u0275fac=function(e){return new(e||St)(n.qc(I.b),n.qc(n.A),n.qc(j.a),n.qc(C.a))},St.\u0275prov=n.cc({token:St,factory:St.\u0275fac});var _t=i("xQCb"),Pt=i("PvNn"),It=i("buwf");function Ot(e,t){if(1&e){const e=n.nc();n.mc(0,"button",4),n.uc("click",(function(){return n.Qc(e),n.wc().addEventToday()})),n.hc(1,"op-icon",5),n.hc(2,"span",6),n.lc()}if(2&e){const e=n.wc();n.Ub("aria-label",e.text.logTime),n.Tb(2),n.Bc("textContent",e.text.logTime)}}class Rt{constructor(e,t,i,s,a,r,c,o,l,d,u,h,p,g,m){this.states=e,this.timeEntryDm=t,this.$state=i,this.element=s,this.i18n=a,this.injector=r,this.notifications=c,this.sanitizer=o,this.configuration=l,this.timezone=d,this.timeEntryEdit=u,this.timeEntryCreate=h,this.timeEntryCache=p,this.colors=g,this.browserDetector=m,this.static=!1,this.entries=new n.s,this.minHour=1,this.maxHour=12,this.labelIntervalHours=2,this.scaleRatio=1,this.calendarPlugins=[ut.a,ft.a],this.calendarHeader={right:"",center:"title",left:"prev,next today"},this.calendarSlotLabelFormat=e=>(this.maxHour-e.date.hour)/this.scaleRatio,this.calendarSlotLabelInterval=`${this.labelIntervalHours}:00:00`,this.calendarContentHeight=605,this.calendarAllDaySlot=!1,this.calendarDisplayEventTime=!1,this.calendarSlotEventOverlap=!1,this.calendarEditable=!1,this.calendarMinTime=`${this.minHour-1}:00:00`,this.calendarMaxTime=`${this.maxHour}:00:00`,this.calendarEventOverlap=e=>!e.classNames.includes("te-calendar--time-entry"),this.memoizedCreateAllowed=!1,this.hiddenDays=[],this.text={logTime:this.i18n.t("js.button_log_time")}}set displayedDays(e){this.setHiddenDays(e)}ngOnInit(){this.initializeCalendar()}ngAfterViewInit(){this.ucCalendar.getApi().setOption("eventRender",e=>{this.alterEventEntry(e)}),this.ucCalendar.getApi().setOption("eventDestroy",e=>{this.beforeEventRemove(e)}),this.ucCalendar.getApi().setOption("eventClick",e=>{this.dispatchEventClick(e)}),this.ucCalendar.getApi().setOption("eventDrop",e=>{this.moveEvent(e)})}calendarEventsFunction(e,t,i){this.fetchTimeEntries(e.start,e.end).then(i=>{this.entries.emit(i),t(this.buildEntries(i.elements,e))})}fetchTimeEntries(e,t){if(!this.memoizedTimeEntries||this.memoizedTimeEntries.start.getTime()!==e.getTime()||this.memoizedTimeEntries.end.getTime()!==t.getTime()){let i=this.timeEntryDm.list({filters:this.dmFilters(e,t),pageSize:500}).then(e=>(this.memoizedCreateAllowed=!!e.createTimeEntry,e.elements.forEach(e=>this.timeEntryCache.updateValue(e.id,e)),e));this.memoizedTimeEntries={start:e,end:t,entries:i}}return this.memoizedTimeEntries.entries}buildEntries(e,t){return this.setRatio(e),this.buildTimeEntryEntries(e).concat(this.buildAuxEntries(e,t))}setRatio(e){let t=this.calculateDateSums(e),i=Math.max(...Object.values(t),0),n=this.scaleRatio;i>this.maxHour-this.minHour?this.scaleRatio=this.smallerSuitableRatio((this.maxHour-this.minHour)/i):this.scaleRatio=1,n!==this.scaleRatio&&this.ucCalendar.getApi().setOption("slotLabelFormat",e=>(this.maxHour-e.date.hour)/this.scaleRatio)}buildTimeEntryEntries(e){let t={};return e.map(e=>{let i,n,s=this.timezone.toHours(e.hours)*this.scaleRatio;t[e.spentOn]?(i=t[e.spentOn].clone().subtract(s,"h"),n=t[e.spentOn].clone()):(i=ze(e.spentOn).add(this.maxHour-s,"h"),n=ze(e.spentOn).add(this.maxHour,"h")),t[e.spentOn]=i;this.colors.toHsl(this.entryName(e));return this.timeEntry(e,s,i,n)})}buildAuxEntries(e,t){let i=this.calculateDateSums(e),n=[];for(let s=ze(t.start);s.diff(t.end,"days")<=0;s.add(1,"days")){let e=i[s.format("YYYY-MM-DD")]||0;n.push(this.sumEntry(s,e)),this.memoizedCreateAllowed&&n.push(this.addEntry(s,e))}return n}calculateDateSums(e){let t={};return e.forEach(e=>{let i=this.timezone.toHours(e.hours);t[e.spentOn]?t[e.spentOn]+=i:t[e.spentOn]=i}),t}timeEntry(e,t,i,n){const s=this.colors.toHsl(this.entryName(e));let a=["te-calendar--time-entry"],r=n.diff(i,"m");return r<40&&a.push("-no-fadeout"),{title:r<20?"":this.entryName(e),startEditable:!!e.update,start:i.format(),end:n.format(),backgroundColor:s,borderColor:s,classNames:a,entry:e}}sumEntry(e,t){return{start:e.clone().add(this.maxHour-Math.min(t*this.scaleRatio,this.maxHour-.5)-.5,"h").format(),end:e.clone().add(this.maxHour-Math.min((t+.05)*this.scaleRatio,this.maxHour-.5),"h").format(),classNames:"te-calendar--day-sum",rendering:"background",sum:this.i18n.t("js.units.hour",{count:this.formatNumber(t)})}}addEntry(e,t){let i=["te-calendar--add-entry"];return t>=24&&i.push("-prohibited"),{start:e.clone().format(),end:e.clone().add(this.maxHour-Math.min(t*this.scaleRatio,this.maxHour-1)-.5,"h").format(),rendering:"background",classNames:i}}dmFilters(e,t){return[["spentOn","<>d",[ze(e).format("YYYY-MM-DD"),ze(t).subtract(1,"d").format("YYYY-MM-DD")]],["user_id","=",["me"]]]}initializeCalendar(){this.calendarEvents=this.calendarEventsFunction.bind(this)}get calendarEventLimit(){return!1}get calendarLocale(){return this.i18n.locale}get calendarFixedWeekCount(){return!1}get calendarDefaultView(){return"timeGridWeek"}get calendarFirstDay(){return this.configuration.startOfWeek()}get calendarElement(){return jQuery(this.element.nativeElement).find(".fc-view-container")}dispatchEventClick(e){e.event.extendedProps.entry?this.editEvent(e.event.extendedProps.entry):e.el.classList.contains("te-calendar--add-entry")&&!e.el.classList.contains("-prohibited")&&this.addEvent(ze(e.event.start))}editEvent(e){this.timeEntryEdit.edit(e).then(e=>{this.updateEventSet(e.entry,e.action)}).catch(()=>{})}moveEvent(e){let t=e.event.extendedProps.entry;t.spentOn=ze(e.event.end).format("YYYY-MM-DD"),this.timeEntryDm.update(t,t.schema).then(e=>{this.updateEventSet(e,"update")}).catch(t=>{this.notifications.handleRawError(t),e.revert()})}addEventToday(){this.addEvent(ze(new Date))}addEvent(e){this.memoizedCreateAllowed&&this.timeEntryCreate.create(e).then(e=>{this.updateEventSet(e.entry,e.action)}).catch(()=>{})}updateEventSet(e,t){this.memoizedTimeEntries.entries.then(i=>{let n=i.elements.findIndex(t=>t.id===e.id);switch(t){case"update":i.elements[n]=e;break;case"destroy":i.elements.splice(n,1);break;case"create":this.timeEntryCache.updateValue(e.id,e),i.elements.push(e)}this.ucCalendar.getApi().refetchEvents()})}alterEventEntry(e){this.appendAddIcon(e),this.appendSum(e),e.event.extendedProps.entry&&(this.addTooltip(e),this.prependDuration(e),this.appendFadeout(e))}appendAddIcon(e){if(!e.el.classList.contains("te-calendar--add-entry"))return;let t=document.createElement("div");t.classList.add("te-calendar--add-icon"),t.innerText="+",e.el.append(t)}appendSum(e){e.event.extendedProps.sum&&e.el.append(e.event.extendedProps.sum)}addTooltip(e){this.browserDetector.isMobile||jQuery(e.el).tooltip({content:this.tooltipContentString(e.event.extendedProps.entry),items:".fc-event",close:function(){jQuery(".ui-helper-hidden-accessible").remove()},track:!0})}removeTooltip(e){jQuery(e.el).tooltip("disable")}prependDuration(e){let t=this.timezone.formattedDuration(e.event.extendedProps.entry.hours);jQuery(e.el).find(".fc-title").prepend(`<div class="fc-duration">${t}</div>`)}appendFadeout(e){let t=e.event.extendedProps.entry;if(this.timezone.toHours(t.hours)<.5)return;let i=jQuery(e.el),n=jQuery('<div class="fc-fadeout"></div>'),s=this.colors.toHsla(this.entryName(t),0),a=this.colors.toHsla(this.entryName(t),100);n.css("background",`-webkit-linear-gradient(${s} 0%, ${a} 100%`),["-moz-linear-gradient","-o-linear-gradient","linear-gradient","-ms-linear-gradient"].forEach(e=>{n.css("background-image",`${e}(${s} 0%, ${a} 100%`)}),i.append(n)}beforeEventRemove(e){e.event.extendedProps.entry&&this.removeTooltip(e)}entryName(e){let t=e.project.name;return e.workPackage&&(t+=` - ${this.workPackageName(e)}`),t||"-"}workPackageName(e){return`#${e.workPackage.idFromLink}: ${e.workPackage.name}`}tooltipContentString(e){return`\n        <ul class="tooltip--map">\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.project")}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(e.project.name)}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.work_package")}:</span>\n            <span class="tooltip--map--value">${e.workPackage?this.sanitizedValue(this.workPackageName(e)):this.i18n.t("js.placeholders.default")}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.activity")}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(e.activity.name)}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.hours")}:</span>\n            <span class="tooltip--map--value">${this.timezone.formattedDuration(e.hours)}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.comment")}:</span>\n            <span class="tooltip--map--value">${e.comment.raw||this.i18n.t("js.placeholders.default")}</span>\n          </li>\n        `}sanitizedValue(e){return this.sanitizer.sanitize(n.W.HTML,e)}formatNumber(e){return this.i18n.toNumber(e,{precision:2})}smallerSuitableRatio(e){for(let t=this.labelIntervalHours+1;t<100;t++){let i=this.labelIntervalHours/t;if(e>=i)return i}return 1}setHiddenDays(e){this.hiddenDays=Array.from(e,(e,t)=>e?null:(t+1)%7).filter(e=>null!==e)}}Rt.\u0275fac=function(e){return new(e||Rt)(n.gc(u.a),n.gc(ht.a),n.gc(We.G),n.gc(n.q),n.gc(C.a),n.gc(n.A),n.gc(de.a),n.gc(N.b),n.gc(Ze.a),n.gc(nt.a),n.gc(St),n.gc(_t.a),n.gc(mt),n.gc(Pt.a),n.gc(It.a))},Rt.\u0275cmp=n.ac({type:Rt,selectors:[["te-calendar"]],viewQuery:function(e,t){var i;(1&e&&n.fd(Qe.a,!0),2&e)&&(n.Nc(i=n.vc())&&(t.ucCalendar=i.first))},inputs:{projectIdentifier:"projectIdentifier",static:"static",displayedDays:"displayedDays"},outputs:{entries:"entries"},features:[n.Sb([St,_t.a,bt.a])],decls:4,vars:21,consts:[[1,"te-calendar--container","loading-indicator--location",2,"position","relative"],["class","button te-calendar--create-button",3,"click",4,"ngIf"],[3,"editable","eventLimit","locale","fixedWeekCount","header","defaultView","firstDay","hiddenDays","contentHeight","slotEventOverlap","slotLabelInterval","slotLabelFormat","allDaySlot","displayEventTime","minTime","maxTime","events","eventOverlap","plugins"],["ucCalendar",""],[1,"button","te-calendar--create-button",3,"click"],["icon-classes","button--icon icon-log_time"],["aria-hidden","true",1,"button--text",3,"textContent"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.Yc(1,Ot,3,2,"button",1),n.hc(2,"full-calendar",2,3),n.lc()),2&e&&(n.Ub("data-indicator-name","table"),n.Tb(1),n.Bc("ngIf",t.memoizedCreateAllowed),n.Tb(1),n.Bc("editable",t.calendarEditable)("eventLimit",t.calendarEventLimit)("locale",t.calendarLocale)("fixedWeekCount",t.calendarFixedWeekCount)("header",t.calendarHeader)("defaultView",t.calendarDefaultView)("firstDay",t.calendarFirstDay)("hiddenDays",t.hiddenDays)("contentHeight",t.calendarContentHeight)("slotEventOverlap",t.calendarSlotEventOverlap)("slotLabelInterval",t.calendarSlotLabelInterval)("slotLabelFormat",t.calendarSlotLabelFormat)("allDaySlot",t.calendarAllDaySlot)("displayEventTime",t.calendarDisplayEventTime)("minTime",t.calendarMinTime)("maxTime",t.calendarMaxTime)("events",t.calendarEvents)("eventOverlap",t.calendarEventOverlap)("plugins",t.calendarPlugins))},directives:[X.q,Qe.a,yt.a],styles:[".fc-view-container{overflow-x:auto}.fc-view-container .fc-view{min-width:800px}.fc-view-container .fc-head{display:table-footer-group}.fc-view-container .fc-bgevent,.fc-view-container .fc-event{border-radius:0;margin-right:8px;margin-left:8px}.fc-view-container .fc-head-container{border-color:#fff}.fc-view-container .fc-day-header{padding-top:5px}.fc-view-container .fc-widget-content{border-left-color:#fff}.fc-view-container .fc-widget-content .fc-day{border-left:0;border-right:0}.fc-view-container .fc-timeGrid-view .fc-day-grid .fc-row{min-height:1em}.fc-view-container .fc-timeGrid-view .fc-day-grid .fc-row .fc-content-skeleton{padding-bottom:0}.fc-view-container .fc-time-grid .fc-slats .fc-minor td{border-top:0}.fc-view-container .te-calendar--day-sum{border:none;background-color:initial;color:#000;text-align:center;font-size:.875em;font-weight:700;line-height:22px;opacity:1}.fc-view-container .te-calendar--add-entry{text-align:center;font-weight:700;opacity:0;background:none;border:none;display:flex;align-items:center}.fc-view-container .te-calendar--add-entry:hover{opacity:1;transition:opacity 1s ease;background:#eaeaea}.fc-view-container .te-calendar--add-entry .te-calendar--add-icon{color:#000;width:100%;font-weight:400;font-size:1.5rem}.fc-view-container .te-calendar--add-entry.-prohibited{cursor:not-allowed}.fc-view-container .te-calendar--add-entry.-prohibited .te-calendar--add-icon{display:none}.fc-view-container .te-calendar--time-entry .fc-content{height:100%}.fc-view-container .te-calendar--time-entry .fc-fadeout{position:relative;bottom:2em;height:2em;z-index:5}.fc-view-container .te-calendar--time-entry.-no-fadeout .fc-fadeout{display:none}.fc-view-container .fc-duration{border-right:1px solid #fff;border-bottom:1px solid #fff;margin-left:-1px;padding-left:1px;display:inline-block;margin-right:5px;padding-right:5px;font-weight:700}.te-calendar--create-button{float:right;margin-right:0;margin-top:4px;height:34px}"],encapsulation:2,changeDetection:0});class Bt extends xe.a{constructor(e,t,i,n,s){super(i,e),this.injector=e,this.timezone=t,this.i18n=i,this.pathHelper=n,this.cdr=s,this.entries=[]}ngOnInit(){this.displayedDays=this.resource.options.days}updateEntries(e){this.entries=e.elements,this.cdr.detectChanges()}get total(){let e=this.entries.reduce((e,t)=>e+this.timezone.toHours(t.hours),0);return e>0?this.i18n.t("js.units.hour",{count:this.formatNumber(e)}):this.i18n.t("js.placeholders.default")}get isEditable(){return!1}updateConfiguration(e){this.resourceChanged.emit(this.setChangesetOptions(e)),this.displayedDays=[...e.days]}formatNumber(e){return this.i18n.toNumber(e,{precision:2})}}Bt.\u0275fac=function(e){return new(e||Bt)(n.gc(n.A),n.gc(nt.a),n.gc(C.a),n.gc(V.a),n.gc(n.i))},Bt.\u0275cmp=n.ac({type:Bt,selectors:[["ng-component"]],features:[n.Qb],decls:8,vars:5,consts:[[3,"name","editable"],[3,"resource","onConfigured"],[3,"displayedDays","entries"],[1,"total-hours"],[3,"textContent"]],template:function(e,t){1&e&&(n.mc(0,"widget-header",0),n.mc(1,"widget-time-entries-current-user-menu",1),n.uc("onConfigured",(function(e){return t.updateConfiguration(e)})),n.lc(),n.lc(),n.mc(2,"te-calendar",2),n.uc("entries",(function(e){return t.updateEntries(e)})),n.lc(),n.kc(3),n.mc(4,"div",3),n.mc(5,"p"),n.ad(6,"Total: "),n.hc(7,"span",4),n.lc(),n.lc(),n.jc()),2&e&&(n.Bc("name",t.widgetName)("editable",t.isEditable),n.Tb(1),n.Bc("resource",t.resource),n.Tb(1),n.Bc("displayedDays",t.displayedDays),n.Tb(5),n.Bc("textContent",t.total))},directives:[Me,dt,Rt],encapsulation:2,changeDetection:0});class Et{constructor(e){this.Hook=e}get registered(){let e=[];return _.each(this.Hook.call("gridWidgets"),t=>{e=e.concat(t)}),e}}Et.\u0275fac=function(e){return new(e||Et)(n.qc(v.a))},Et.\u0275prov=n.cc({token:Et,factory:Et.\u0275fac});var Mt=i("Dp3K"),Ft=i("p5fp"),At=i("qvi4"),Dt=i("eaMR");class qt extends Mt.a{set loadingIndicator(e){this.loadingIndicatorService.indicator("calendar-entry").promise=e}refresh(e,t){return this.loadingIndicator=this.wpListService.loadCurrentQueryFromParams(this.projectIdentifier)}}qt.\u0275fac=function(e){return Lt(e||qt)},qt.\u0275cmp=n.ac({type:qt,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(tt,!0),2&e)&&(n.Nc(i=n.vc())&&(t.calendarElement=i.first))},features:[n.Qb],decls:13,vars:2,consts:[["data-indicator-name","calendar-entry",1,"work-packages-calendar-view--container","loading-indicator--location"],[1,"toolbar-container","-editable"],[1,"toolbar"],[1,"title-container"],[1,"toolbar-items","hide-when-print"],[1,"toolbar-item","hidden-for-mobile"],[3,"projectIdentifier"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.mc(3,"div",3),n.mc(4,"h2"),n.ad(5),n.lc(),n.lc(),n.mc(6,"ul",4),n.mc(7,"li",5),n.hc(8,"wp-filter-button"),n.lc(),n.mc(9,"li",5),n.hc(10,"zen-mode-toggle-button"),n.lc(),n.lc(),n.lc(),n.lc(),n.hc(11,"filter-container"),n.hc(12,"wp-calendar",6),n.lc()),2&e&&(n.Tb(5),n.cd(" ",t.I18n.t("js.calendar.title")," "),n.Tb(7),n.Bc("projectIdentifier",t.projectIdentifier))},directives:[Ft.a,At.a,Dt.a,tt],encapsulation:2});const Lt=n.oc(qt);var $t=i("0loS");class Nt{}Nt.\u0275mod=n.ec({type:Nt}),Nt.\u0275inj=n.dc({factory:function(e){return new(e||Nt)},providers:[St],imports:[[b.a,f.a]]});const Qt=[{name:"work-packages.calendar",url:"/calendar",component:qt,reloadOnSearch:!1,data:{bodyClasses:"router--work-packages-calendar",menuItem:"calendar-menu-item",parent:"work-packages"}}];class Vt{}Vt.\u0275mod=n.ec({type:Vt}),Vt.\u0275inj=n.dc({factory:function(e){return new(e||Vt)},imports:[[b.a,$t.UIRouterModule.forChild({states:Qt}),ve.a,Nt,f.a,Qe.b]]});var Ht=i("8h6p");function zt(e,t){if(1&e&&n.hc(0,"no-results",5),2&e){const e=n.wc();n.Bc("title",e.text.noResults)}}function Yt(e,t){if(1&e&&(n.kc(0),n.mc(1,"h4",6),n.hc(2,"a",7),n.lc(),n.mc(3,"p",8),n.hc(4,"em",9),n.lc(),n.hc(5,"div",10),n.jc()),2&e){const e=t.$implicit,i=n.wc();n.Tb(2),n.Bc("href",i.documentPath(e),n.Tc)("textContent",e.title),n.Tb(2),n.Bc("textContent",i.documentCreated(e)),n.Tb(1),n.Bc("innerHtml",i.documentDescription(e),n.Rc)}}class Wt extends xe.a{constructor(e,t,i,n,s,a,r,c){super(i,a),this.halResource=e,this.pathHelper=t,this.i18n=i,this.timezone=n,this.domSanitizer=s,this.injector=a,this.currentProject=r,this.cdr=c,this.text={noResults:this.i18n.t("js.grid.widgets.documents.no_results")},this.entries=[],this.entriesLoaded=!1}ngOnInit(){this.halResource.get(this.documentsUrl).toPromise().then(e=>{this.entries=e.elements,this.entriesLoaded=!0,this.cdr.detectChanges()})}get isEditable(){return!1}documentPath(e){return`${this.pathHelper.appBasePath}/documents/${e.id}`}documentCreated(e){return this.timezone.formattedDatetime(e.createdAt)}documentDescription(e){return this.domSanitizer.sanitize(n.W.HTML,e.description.html)}get noEntries(){return!this.entries.length&&this.entriesLoaded}get documentsUrl(){let e=JSON.stringify([["updated_at","desc"]]),t=`${this.pathHelper.api.v3.apiV3Base}/documents?sortBy=${e}&pageSize=10`;if(this.currentProject.id){t+=`&filters=${JSON.stringify([{project_id:{operator:"=",values:[this.currentProject.id.toString()]}}])}`}return t}}Wt.\u0275fac=function(e){return new(e||Wt)(n.gc(j.a),n.gc(V.a),n.gc(C.a),n.gc(nt.a),n.gc(N.b),n.gc(n.A),n.gc(Te.a),n.gc(n.i))},Wt.\u0275cmp=n.ac({type:Wt,selectors:[["ng-component"]],features:[n.Qb],decls:5,vars:5,consts:[[3,"name","editable"],[3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"title"],[1,"document-category-elements--header"],[3,"href","textContent"],[1,"document-category-elements--date"],[3,"textContent"],[1,"wiki","grid--widget-limited-text",3,"innerHtml"]],template:function(e,t){1&e&&(n.mc(0,"widget-header",0),n.hc(1,"widget-menu",1),n.lc(),n.mc(2,"div",2),n.Yc(3,zt,1,1,"no-results",3),n.Yc(4,Yt,6,4,"ng-container",4),n.lc()),2&e&&(n.Bc("name",t.widgetName)("editable",t.isEditable),n.Tb(1),n.Bc("resource",t.resource),n.Tb(2),n.Bc("ngIf",t.noEntries),n.Tb(1),n.Bc("ngForOf",t.entries))},directives:[Me,Le,X.q,X.p,Ht.a],encapsulation:2,changeDetection:0});var Ut=i("DDsP"),Gt=i("u8Ab");function Xt(e,t){if(1&e&&n.hc(0,"no-results",6),2&e){const e=n.wc();n.Bc("title",e.text.noResults)}}function Kt(e,t){if(1&e&&n.hc(0,"user-avatar",13),2&e){const e=n.wc().$implicit;n.Bc("user",e.author)}}function Zt(e,t){if(1&e&&(n.mc(0,"div",14),n.hc(1,"span",15),n.lc()),2&e){const e=n.wc().$implicit,t=n.wc();n.Tb(1),n.Bc("innerHTML",t.text.addedBy(e),n.Rc)}}function Jt(e,t){if(1&e&&n.hc(0,"p",16),2&e){const e=n.wc().$implicit;n.Bc("textContent",e.summary)}}function ei(e,t){if(1&e&&(n.mc(0,"li",7),n.mc(1,"div",8),n.Yc(2,Kt,1,1,"user-avatar",9),n.mc(3,"div"),n.hc(4,"a",10),n.ad(5,": "),n.hc(6,"a",10),n.lc(),n.Yc(7,Zt,2,1,"div",11),n.mc(8,"div"),n.Yc(9,Jt,1,1,"p",12),n.lc(),n.lc(),n.lc()),2&e){const e=t.$implicit,i=n.wc();n.Tb(2),n.Bc("ngIf",e.author),n.Tb(2),n.Bc("href",i.newsProjectPath(e),n.Tc)("textContent",i.newsProjectName(e)),n.Tb(2),n.Bc("href",i.newsPath(e),n.Tc)("textContent",e.title),n.Tb(1),n.Bc("ngIf",e.author),n.Tb(2),n.Bc("ngIf",e.summary)}}class ti extends xe.a{constructor(e,t,i,n,s,a,r){super(t,i),this.pathHelper=e,this.i18n=t,this.injector=i,this.timezone=n,this.newsDm=s,this.currentProject=a,this.cdr=r,this.text={at:this.i18n.t("js.grid.widgets.news.at"),noResults:this.i18n.t("js.grid.widgets.news.no_results"),addedBy:e=>this.i18n.t("js.label_added_time_by",{author:this.newsAuthorName(e),age:this.newsCreated(e),authorLink:this.newsAuthorPath(e)})},this.entries=[],this.entriesLoaded=!1}ngOnInit(){this.newsDm.list(this.newsDmParams).then(e=>this.setupNews(e.elements))}setupNews(e){this.entries=e,this.entriesLoaded=!0,this.cdr.detectChanges()}get isEditable(){return!1}newsPath(e){return this.pathHelper.newsPath(e.id)}newsProjectPath(e){var t;return this.pathHelper.projectPath(null===(t=e.project)||void 0===t?void 0:t.idFromLink)}newsProjectName(e){var t;return null===(t=e.project)||void 0===t?void 0:t.name}newsAuthorName(e){var t;return null===(t=e.author)||void 0===t?void 0:t.name}newsAuthorPath(e){var t;return this.pathHelper.userPath(null===(t=e.author)||void 0===t?void 0:t.id)}newsCreated(e){return this.timezone.formattedDatetime(e.createdAt)}get noEntries(){return!this.entries.length&&this.entriesLoaded}get newsDmParams(){let e={sortBy:[["created_at","desc"]],pageSize:3};return this.currentProject.id&&(e.filters=[["project_id","=",[this.currentProject.id]]]),e}}ti.\u0275fac=function(e){return new(e||ti)(n.gc(V.a),n.gc(C.a),n.gc(n.A),n.gc(nt.a),n.gc(Ut.a),n.gc(Te.a),n.gc(n.i))},ti.\u0275cmp=n.ac({type:ti,selectors:[["ng-component"]],features:[n.Qb],decls:6,vars:5,consts:[[3,"name","editable"],[3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[1,"widget-box--arrow-links"],["class","-widget-box--arrow-multiline",4,"ngFor","ngForOf"],[3,"title"],[1,"-widget-box--arrow-multiline"],[1,"news-project"],["data-class-list","avatar news-author-avatar hidden-for-mobile",3,"user",4,"ngIf"],[3,"href","textContent"],["class","news-author",4,"ngIf"],["class","widget-box--additional-info",3,"textContent",4,"ngIf"],["data-class-list","avatar news-author-avatar hidden-for-mobile",3,"user"],[1,"news-author"],[3,"innerHTML"],[1,"widget-box--additional-info",3,"textContent"]],template:function(e,t){1&e&&(n.mc(0,"widget-header",0),n.hc(1,"widget-menu",1),n.lc(),n.mc(2,"div",2),n.Yc(3,Xt,1,1,"no-results",3),n.mc(4,"ul",4),n.Yc(5,ei,10,7,"li",5),n.lc(),n.lc()),2&e&&(n.Bc("name",t.widgetName)("editable",t.isEditable),n.Tb(1),n.Bc("resource",t.resource),n.Tb(2),n.Bc("ngIf",t.noEntries),n.Tb(2),n.Bc("ngForOf",t.entries))},directives:[Me,Le,X.q,X.p,Ht.a,Gt.a],encapsulation:2,changeDetection:0});class ii{constructor(e,t){this.gridDm=e,this.halResourceService=t}initialize(e){return this.gridDm.list({filters:[["scope","=",[e]]]}).then(t=>0===t.total?this.myPageForm(e):t.elements[0])}myPageForm(e){return new Promise((t,i)=>{let n={_links:{scope:{href:e}}};this.gridDm.createForm(n).then(e=>{let n=e.payload.$source,s=this.halResourceService.createHalResource(n);0===s.widgets.length&&(s.rowCount=1,s.columnCount=1),this.gridDm.create(s,e.schema).then(e=>{t(e)}).catch(()=>{i()})})})}}ii.\u0275fac=function(e){return new(e||ii)(n.qc(Ie.a),n.qc(j.a))},ii.\u0275prov=n.cc({token:ii,factory:ii.\u0275fac});const ni=["tabInner"];class si{onSave(){this.tabInner.onSave()}}si.\u0275fac=function(e){return new(e||si)},si.\u0275cmp=n.ac({type:si,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(ni,!0),2&e)&&(n.Nc(i=n.vc())&&(t.tabInner=i.first))},decls:3,vars:0,consts:[["wp-isolated-query-space",""],["tabInner",""]],template:function(e,t){1&e&&(n.kc(0,0),n.hc(1,"settings-tab-inner",null,1),n.jc())},encapsulation:2});const ai=["tabInner"];class ri{onSave(){this.tabInner.onSave()}}ri.\u0275fac=function(e){return new(e||ri)},ri.\u0275cmp=n.ac({type:ri,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(ai,!0),2&e)&&(n.Nc(i=n.vc())&&(t.tabInner=i.first))},decls:3,vars:0,consts:[["wp-isolated-query-space",""],["tabInner",""]],template:function(e,t){1&e&&(n.kc(0,0),n.hc(1,"filters-tab-inner",null,1),n.jc())},encapsulation:2});var ci=i("OGNV"),oi=i("0bag");class li{constructor(e,t,i){this.queryParams=e,this.chartOptions=t,this.chartType=i,this.queries=[],this.chartType=this.chartType||"horizontalBar"}static queryCreationParams(e,t){return{hidden:!0,public:t,name:e.t("js.grid.widgets.work_packages_graph.title"),showHierarchies:!1,_links:{groupBy:{href:"/api/v3/queries/group_bys/status"}}}}}class di{constructor(e,t,i,n,s){this.I18n=e,this.queryFormDm=t,this.queryDm=i,this.notificationService=n,this.currentProject=s,this._forms={}}persistAndReload(){return new Promise((e,t)=>{this.persistChanges().then(()=>{this.reloadQueries().then(()=>e())})})}persistChanges(){let e=this.queries.map(e=>this.saveQuery(e));return Promise.all(e)}get datasets(){return this.queries.map(e=>({groups:e.results.groups,queryProps:"",label:e.name}))}reloadQueries(){return this.configuration.queries.length=0,this.loadQueries()}ensureQueryAndLoad(){return 0===this.queryParams.length?this.createInitial().then(e=>(this.queryParams.push({id:e.id}),this.loadQueries())):this.loadQueries()}createInitial(){return this.queryFormDm.loadWithParams({pageSize:0},void 0,this.currentProject.identifier,li.queryCreationParams(this.I18n,!!this.currentProject.identifier)).then(e=>{const t=this.queryFormDm.buildQueryResource(e);return this.queryDm.create(t,e)})}loadQueries(){let e=this.queryParams.map(e=>this.loadQuery(e));return Promise.all(e)}loadQuery(e){return this.queryDm.find(Object.assign({pageSize:0},e.props),e.id,this.currentProject.identifier).then(t=>{e.name&&(t.name=e.name),this.configuration.queries.push(t)})}saveQuery(e){return Object(y.b)(this,void 0,void 0,(function*(){return this.formFor(e).then(t=>this.queryDm.update(e,t).toPromise())}))}get configuration(){return this._configuration}set configuration(e){this._configuration=e,this._formsPromise=null}formFor(e){return Object(y.b)(this,void 0,void 0,(function*(){return this.loadForms().then(()=>this._forms[e.id])}))}get tabs(){let e=[{name:"graph-settings",title:this.I18n.t("js.chart.tabs.graph_settings"),componentClass:si}],t=this.configuration.queries.map(e=>({name:e.id,title:this.I18n.t("js.work_packages.query.filters"),componentClass:ri}));return e.concat(t)}loadForms(){if(!this._formsPromise){let e=this.configuration.queries.map(e=>this.queryFormDm.load(e).then(t=>{this._forms[e.id]=t}).catch(e=>this.notificationService.handleRawError(e)));this._formsPromise=Promise.all(e)}return this._formsPromise}get chartType(){return this._configuration.chartType}set chartType(e){this._configuration.chartType=e}get queries(){return this._configuration.queries}get chartOptions(){return this._configuration.chartOptions}get queryParams(){return this._configuration.queryParams}}di.\u0275fac=function(e){return new(e||di)(n.qc(C.a),n.qc(ci.a),n.qc(oi.a),n.qc(rt.a),n.qc(Te.a))},di.\u0275prov=n.cc({token:di,factory:di.\u0275fac});var ui=i("H3ou");const hi=["tabContentOutlet"];function pi(e,t){1&e&&n.ic(0)}function gi(e,t){if(1&e&&(n.kc(0),n.Yc(1,pi,1,0,"ng-container",13),n.jc()),2&e){const e=n.wc();n.Tb(1),n.Bc("ngComponentOutlet",e.prependModalComponent)("ngComponentOutletInjector",e.injector)}}const mi=function(e,t){return{selected:e,"-disabled":t}},fi=function(e){return{selected:e}};function bi(e,t){if(1&e){const e=n.nc();n.mc(0,"li",17),n.mc(1,"a",18),n.uc("click",(function(){n.Qc(e);const i=t.$implicit;return n.wc(2).switchTo(i.name)})),n.lc(),n.lc()}if(2&e){const e=t.$implicit,i=n.wc(2);n.Bc("ngClass",n.Hc(4,mi,i.currentTab&&e.name===i.currentTab.name,null!=e.disableBecause)),n.Tb(1),n.Bc("ngClass",n.Gc(7,fi,i.currentTab&&e.name===i.currentTab.name))("textContent",e.title),n.Ub("title",e.disableBecause||e.title)}}function wi(e,t){if(1&e&&(n.mc(0,"div",14),n.mc(1,"ul",15),n.Yc(2,bi,2,9,"li",16),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(2),n.Bc("ngForOf",e.availableTabs)}}const vi=new n.z("WpTableConfigurationModalPrependComponent");class yi extends st.a{constructor(e,t,i,n,s,a,r,c,o,l,d,u){super(e,o,d),this.locals=e,this.prependModalComponent=t,this.I18n=i,this.injector=n,this.appRef=s,this.componentFactoryResolver=a,this.loadingIndicator=r,this.notificationService=c,this.cdRef=o,this.ConfigurationService=l,this.elementRef=d,this.graphConfiguration=u,this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.text={title:this.I18n.t("js.chart.modal_title"),closePopup:this.I18n.t("js.close_popup_title"),applyButton:this.I18n.t("js.modals.button_apply"),cancelButton:this.I18n.t("js.modals.button_cancel")}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.loadingIndicator.indicator("modal").promise=this.graphConfiguration.loadForms().then(()=>{this.tabPortalHost=new ui.a(this.graphConfiguration.tabs,this.tabContentOutlet.nativeElement,this.componentFactoryResolver,this.appRef,this.injector);const e=this.locals.initialTab||this.availableTabs[0].name;this.switchTo(e)})}ngOnDestroy(){this.tabPortalHost.dispose()}get availableTabs(){return this.tabPortalHost.availableTabs}get currentTab(){return this.tabPortalHost.currentTab}switchTo(e){this.tabPortalHost.switchTo(e)}saveChanges(){this.tabPortalHost.activeComponents.forEach(e=>{e.onSave()}),this.configuration=this.graphConfiguration.configuration,this.service.close()}onClose(){return this.afterFocusOn.focus(),!0}get afterFocusOn(){return this.$element}}yi.\u0275fac=function(e){return new(e||yi)(n.gc(I.a),n.gc(vi,8),n.gc(C.a),n.gc(n.A),n.gc(n.f),n.gc(n.l),n.gc(at.a),n.gc(rt.a),n.gc(n.i),n.gc(Ze.a),n.gc(n.q),n.gc(di))},yi.\u0275cmp=n.ac({type:yi,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(hi,!0),2&e)&&(n.Nc(i=n.vc())&&(t.tabContentOutlet=i.first))},features:[n.Qb],decls:13,vars:6,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","-wide","wp-table--configuration-modal","loading-indicator--location"],[1,"op-modal--modal-header"],[3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[4,"ngIf"],["class","content--tabs scrollable-tabs",4,"ngIf"],[1,"tab-content"],["tabContentOutlet",""],[1,"modal--form-actions"],[1,"button","-highlight",3,"textContent","click"],[1,"button",3,"textContent","click"],[4,"ngComponentOutlet","ngComponentOutletInjector"],[1,"content--tabs","scrollable-tabs"],[1,"tabrow"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["role","button","href","",1,"tab-show",3,"ngClass","textContent","click"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.hc(3,"h3",3),n.mc(4,"a",4),n.mc(5,"i",5),n.uc("click",(function(e){return t.closeMe(e)})),n.lc(),n.lc(),n.lc(),n.Yc(6,gi,2,2,"ng-container",6),n.Yc(7,wi,3,1,"div",7),n.hc(8,"div",8,9),n.mc(10,"div",10),n.mc(11,"button",11),n.uc("click",(function(){return t.saveChanges()})),n.lc(),n.mc(12,"button",12),n.uc("click",(function(e){return t.closeMe(e)})),n.lc(),n.lc(),n.lc(),n.lc()),2&e&&(n.Tb(3),n.Bc("textContent",t.text.title),n.Tb(2),n.Ub("title",t.text.closePopup),n.Tb(1),n.Bc("ngIf",!!t.prependModalComponent),n.Tb(1),n.Bc("ngIf",!!t.tabPortalHost),n.Tb(4),n.Bc("textContent",t.text.applyButton),n.Tb(1),n.Bc("textContent",t.text.cancelButton))},directives:[X.q,X.o,Ce.a,X.p,X.n],encapsulation:2});class ki extends Ae{constructor(e,t,i,s,a){super(i,s,a),this.injector=e,this.opModalService=t,this.i18n=i,this.remove=s,this.layout=a,this.onConfigured=new n.s,this.menuItemList=[this.removeItem,this.configureItem]}get configureItem(){return{linkText:this.i18n.t("js.toolbar.settings.configure_view"),onClick:()=>(this.opModalService.show(this.configurationComponent,this.injector,this.locals).closingEvent.subscribe(e=>{this.onConfigured.emit(e.configuration)}),!0)}}get locals(){return{}}}function Ci(e,t){if(1&e&&n.hc(0,"icon-triggered-context-menu",1),2&e){const e=n.wc();n.Bc("menu-items",e.menuItems)}}ki.\u0275fac=function(e){return new(e||ki)(n.gc(n.A),n.gc(I.b),n.gc(C.a),n.gc(Fe),n.gc(Re))},ki.\u0275dir=n.bc({type:ki,outputs:{onConfigured:"onConfigured"},features:[n.Qb]});class ji extends ki{constructor(){super(...arguments),this.configurationComponent=yi}}ji.\u0275fac=function(e){return xi(e||ji)},ji.\u0275cmp=n.ac({type:ji,selectors:[["widget-wp-graph-menu"]],features:[n.Qb],decls:1,vars:1,consts:[[3,"menu-items",4,"ngIf"],[3,"menu-items"]],template:function(e,t){1&e&&n.Yc(0,Ci,1,1,"icon-triggered-context-menu",0),2&e&&n.Bc("ngIf",t.hasMenu)},directives:[X.q,De.a],encapsulation:2});const xi=n.oc(ji);var Ti=i("LPYB");function Si(e,t){if(1&e&&n.hc(0,"canvas",4),2&e){const e=n.wc();n.Bc("datasets",e.chartData)("labels",e.chartLabels)("chartType",e.chartType)("options",e.chartOptions)}}function _i(e,t){if(1&e&&n.hc(0,"no-results",5),2&e){const e=n.wc();n.Bc("title",e.text.noResults)}}const Pi=function(e){return{height:e}};class Ii{constructor(e){this.i18n=e,this.chartType="horizontalBar",this.error=null,this.chartHeight="100%",this.chartLabels=[],this.chartData=[],this.initialized=!1,this.text={noResults:this.i18n.t("js.work_packages.no_results.title")}}ngOnChanges(e){e.datasets?(this.setChartOptions(),this.updateChartData(),e.datasets.firstChange||(this.initialized=!0)):e.chartType&&this.setChartOptions()}updateChartData(){let e=_.uniq(this.datasets.reduce((e,t)=>{let i=(t.groups||[]).map(e=>e.value);return e.concat(i)},[])),t=this.datasets.map(t=>{let i=(t.groups||[]).reduce((e,t)=>(e[t.value]=t.count,e),{});return{label:t.label,data:e.map(e=>i[e]||0)}});e=e.map(e=>e||this.i18n.t("js.placeholders.default")),this.setHeight(),this.chartLabels.length=0,this.chartLabels.push(...e),this.chartData.length=0,this.chartData.push(...t)}setChartOptions(){let e={responsive:!0,maintainAspectRatio:!1,legend:{display:this.datasets.length>1},plugins:{datalabels:{align:"bar"===this.chartType?"top":"center"}}},t={scales:{}};"horizontalBar"!==this.chartType&&"bar"!==this.chartType||this.setChartAxesValues(t),this.chartOptions=Object.assign({},e,t,this.inputChartOptions)}get hasDataToDisplay(){return this.chartData.length>0&&this.chartData.some(e=>e.data.length>0)}setHeight(){if("horizontalBar"===this.chartType&&this.datasets&&this.datasets[0]){let e=[];this.datasets.forEach(t=>t.groups.forEach(t=>{e.includes(t.value)||e.push(t.value)}));let t=40*e.length;this.datasets.length>1&&(t+=40),t+=40,this.chartHeight=`${t}px`}else this.chartHeight="100%"}setChartAxesValues(e){let t=[{stacked:!0,ticks:{callback:e=>Math.floor(e)===e?e:null}}],i=[{stacked:!0}];e.scales&&("bar"===this.chartType?(e.scales.yAxes=t,e.scales.xAxes=i):"horizontalBar"===this.chartType&&(e.scales.xAxes=t,e.scales.yAxes=i))}}Ii.\u0275fac=function(e){return new(e||Ii)(n.gc(C.a))},Ii.\u0275cmp=n.ac({type:Ii,selectors:[["wp-embedded-graph"]],inputs:{datasets:"datasets",inputChartOptions:["chartOptions","inputChartOptions"],chartType:"chartType"},features:[n.Rb],decls:4,vars:5,consts:[[1,"work-packages-embedded-view--container","loading-indicator--location",3,"ngStyle"],["graphContainer",""],["baseChart","",3,"datasets","labels","chartType","options",4,"ngIf"],[3,"title",4,"ngIf"],["baseChart","",3,"datasets","labels","chartType","options"],[3,"title"]],template:function(e,t){1&e&&(n.mc(0,"div",0,1),n.Yc(2,Si,1,4,"canvas",2),n.Yc(3,_i,1,1,"no-results",3),n.lc()),2&e&&(n.Bc("ngStyle",n.Gc(3,Pi,t.chartHeight)),n.Tb(2),n.Bc("ngIf",t.hasDataToDisplay),n.Tb(1),n.Bc("ngIf",!t.hasDataToDisplay&&t.initialized))},directives:[X.t,X.q,Ti.a,Ht.a],styles:[".work-packages-embedded-view--container[_ngcontent-%COMP%]{height:100%;max-height:500px;position:relative}"]});class Oi extends xe.a{constructor(e,t,i,n){super(e,t),this.i18n=e,this.injector=t,this.cdr=i,this.graphConfiguration=n,this.datasets=[]}ngOnInit(){this.initializeConfiguration(),this.loadQueriesInitially()}set chartType(e){this.resource.options.chartType=e}updateGraph(e){this.graphConfiguration.persistAndReload().then(()=>{if(this.repaint(),this.resource.options.chartType!==this.graphConfiguration.chartType){let e=this.setChangesetOptions({chartType:this.graphConfiguration.chartType});this.resourceChanged.emit(e)}})}repaint(){this.datasets=this.graphConfiguration.datasets,this.cdr.detectChanges()}initializeConfiguration(){let e=[];this.resource.options.queryId&&e.push({id:this.resource.options.queryId}),this.graphConfiguration.configuration=new li(e,this.resource.options.chartOptions,this.resource.options.chartType)}loadQueriesInitially(){this.graphConfiguration.ensureQueryAndLoad().then(()=>{if(!this.resource.options.queryId){let e=this.setChangesetOptions({queryId:this.graphConfiguration.queryParams[0].id});this.resourceChanged.emit(e)}this.repaint()})}get chartOptions(){return this.graphConfiguration.chartOptions}get chartType(){return this.graphConfiguration.chartType}}Oi.\u0275fac=function(e){return new(e||Oi)(n.gc(C.a),n.gc(n.A),n.gc(n.i),n.gc(di))},Oi.\u0275cmp=n.ac({type:Oi,selectors:[["widget-wp-graph"]],features:[n.Sb([di]),n.Qb],decls:3,vars:4,consts:[[3,"name","onRenamed"],[3,"resource","onConfigured"],[1,"grid--widget-content",3,"datasets","chartType"]],template:function(e,t){1&e&&(n.mc(0,"widget-header",0),n.uc("onRenamed",(function(e){return t.renameWidget(e)})),n.mc(1,"widget-wp-graph-menu",1),n.uc("onConfigured",(function(e){return t.updateGraph(e)})),n.lc(),n.lc(),n.hc(2,"wp-embedded-graph",2)),2&e&&(n.Bc("name",t.widgetName),n.Tb(1),n.Bc("resource",t.resource),n.Tb(1),n.Bc("datasets",t.datasets)("chartType",t.chartType))},directives:[Me,ji,Ii],styles:["wp-embedded-table[_ngcontent-%COMP%]{overflow:auto}"],changeDetection:0});var Ri=i("pL6k"),Bi=i("zP0r"),Ei=i("sngl");function Mi(e,t){if(1&e&&n.hc(0,"icon-triggered-context-menu",1),2&e){const e=n.wc();n.Bc("menu-items",e.menuItems)}}class Fi extends ki{constructor(){super(...arguments),this.configurationComponent=Ei.a}}Fi.\u0275fac=function(e){return Ai(e||Fi)},Fi.\u0275cmp=n.ac({type:Fi,selectors:[["widget-wp-table-menu"]],features:[n.Qb],decls:1,vars:1,consts:[[3,"menu-items",4,"ngIf"],[3,"menu-items"]],template:function(e,t){1&e&&n.Yc(0,Mi,1,1,"icon-triggered-context-menu",0),2&e&&n.Bc("ngIf",t.hasMenu)},directives:[X.q,De.a],encapsulation:2});const Ai=n.oc(Fi);var Di=i("72oW");function qi(e,t){if(1&e&&n.hc(0,"wp-embedded-table",3),2&e){const e=n.wc();n.Bc("queryId",e.queryId)("configuration",e.configuration)}}class Li extends xe.a{constructor(e,t,i,n,s,a,r){super(e,t),this.i18n=e,this.injector=t,this.urlParamsHelper=i,this.state=n,this.queryDm=s,this.querySpace=a,this.queryFormDm=r,this.inFlight=!1,this.configuration={actionsColumnEnabled:!1,columnMenuEnabled:!1,hierarchyToggleEnabled:!0,contextMenuEnabled:!1}}ngOnInit(){this.resource.options.queryId?this.queryId=this.resource.options.queryId:this.createInitial().then(e=>{let t=this.setChangesetOptions({queryId:e.id});this.resourceChanged.emit(t),this.queryId=e.id}),this.query$=this.querySpace.query.values$(),this.query$.pipe(Object(Bi.a)(2),this.untilDestroyed()).subscribe(e=>{this.ensureFormAndSaveQuery(e)})}get widgetName(){return this.resource.options.name}static get identifier(){return"work_packages_table"}ensureFormAndSaveQuery(e){this.queryForm?this.saveQuery(e):this.queryFormDm.load(e).then(t=>{this.queryForm=t,this.saveQuery(e)})}saveQuery(e){this.inFlight=!0,this.queryDm.update(e,this.queryForm).toPromise().then(e=>(this.inFlight=!1,e)).catch(()=>this.inFlight=!1)}createInitial(){const e=this.state.params.projectPath;let t=this.resource.options.queryProps,i=Object.assign({pageSize:0},t);return this.queryFormDm.loadWithParams(i,void 0,e,this.queryCreationParams()).then(e=>{const t=this.queryFormDm.buildQueryResource(e);return this.queryDm.create(t,e).then(e=>(delete this.resource.options.queryProps,e))})}queryCreationParams(){return{hidden:!0,public:!!this.state.params.projectPath}}}Li.\u0275fac=function(e){return new(e||Li)(n.gc(C.a),n.gc(n.A),n.gc(Ri.a),n.gc(We.G),n.gc(oi.a),n.gc(Ve.a),n.gc(ci.a))},Li.\u0275cmp=n.ac({type:Li,selectors:[["widget-wp-table"]],features:[n.Qb],decls:3,vars:3,consts:[[3,"name","onRenamed"],[3,"resource"],[3,"queryId","configuration",4,"ngIf"],[3,"queryId","configuration"]],template:function(e,t){1&e&&(n.mc(0,"widget-header",0),n.uc("onRenamed",(function(e){return t.renameWidget(e)})),n.hc(1,"widget-wp-table-menu",1),n.lc(),n.Yc(2,qi,1,2,"wp-embedded-table",2)),2&e&&(n.Bc("name",t.widgetName),n.Tb(1),n.Bc("resource",t.resource),n.Tb(1),n.Bc("ngIf",t.queryId))},directives:[Me,Fi,X.q,Di.a],styles:["wp-embedded-table[_ngcontent-%COMP%]{overflow:auto}"],changeDetection:0});class $i extends xe.a{onResourceChanged(e){this.resourceChanged.emit(e)}}$i.\u0275fac=function(e){return Ni(e||$i)},$i.\u0275cmp=n.ac({type:$i,selectors:[["ng-component"]],features:[n.Qb],decls:2,vars:1,consts:[["wp-isolated-query-space",""],[3,"resource","resourceChanged"]],template:function(e,t){1&e&&(n.kc(0,0),n.mc(1,"widget-wp-table",1),n.uc("resourceChanged",(function(e){return t.onResourceChanged(e)})),n.lc(),n.jc()),2&e&&(n.Tb(1),n.Bc("resource",t.resource))},directives:[Ne.a,Li],styles:["widget-wp-table[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}"]});const Ni=n.oc($i);var Qi=i("l08T"),Vi=i("+oAL");class Hi{constructor(e,t,i){this.I18n=e,this.wpStatesInitialization=t,this.wpGraphConfiguration=i}initializeQuerySpace(){return this.wpGraphConfiguration.formFor(this.query).then(e=>{this.wpStatesInitialization.initialize(this.query,this.query.results),this.wpStatesInitialization.updateStatesFromForm(this.query,e)})}}var zi=i("70hh");function Yi(e,t){if(1&e){const e=n.nc();n.mc(0,"query-filters",1),n.uc("filtersChanged",(function(t){return n.Qc(e),n.wc().filters=t})),n.lc()}if(2&e){const e=n.wc();n.Bc("filters",e.filters)}}class Wi extends Hi{constructor(e,t,i,n,s){super(e,n,s),this.I18n=e,this.wpTableFilters=t,this.wpFiltersService=i,this.wpStatesInitialization=n,this.wpGraphConfiguration=s,this.filters=[],this.text={multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect")}}ngOnInit(){this.initializeQuerySpace().then(()=>{this.wpTableFilters.onReady().then(()=>{this.filters=this.wpTableFilters.current})})}onSave(){this.filters&&(this.wpTableFilters.replaceIfComplete(this.filters),this.wpTableFilters.applyToQuery(this.wpGraphConfiguration.queries[0]))}get query(){return this.wpGraphConfiguration.queries[0]}}Wi.\u0275fac=function(e){return new(e||Wi)(n.gc(C.a),n.gc(He.a),n.gc(Qi.a),n.gc(Vi.a),n.gc(di))},Wi.\u0275cmp=n.ac({type:Wi,selectors:[["filters-tab-inner"]],features:[n.Qb],decls:1,vars:1,consts:[[3,"filters","filtersChanged",4,"ngIf"],[3,"filters","filtersChanged"]],template:function(e,t){1&e&&n.Yc(0,Yi,1,1,"query-filters",0),2&e&&n.Bc("ngIf",!!t.filters)},directives:[X.q,zi.a],encapsulation:2});var Ui=i("AeZM");function Gi(e,t){if(1&e&&n.hc(0,"option",9),2&e){const e=t.$implicit;n.Bc("ngValue",e)("textContent",e.name)}}function Xi(e,t){if(1&e&&n.hc(0,"option",9),2&e){const e=t.$implicit;n.Bc("ngValue",e)("textContent",e.label)}}const Ki=function(){return{standalone:!0}};class Zi extends Hi{constructor(e,t,i,n){super(e,i,n),this.I18n=e,this.wpTableGroupBy=t,this.wpStatesInitialization=i,this.wpGraphConfiguration=n,this.availableGroups=[],this.text={group_by:this.I18n.t("js.chart.axis_criteria"),chart_type:this.I18n.t("js.chart.type")}}onSave(){this.wpGraphConfiguration.chartType=this.currentChartType.identifier,this.wpGraphConfiguration.queries.forEach(e=>{this.wpTableGroupBy.applyToQuery(e)})}get currentGroup(){return this.wpTableGroupBy.current}set currentGroup(e){this.wpTableGroupBy.update(e)}ngOnInit(){this.initializeQuerySpace().then(()=>{this.wpTableGroupBy.onReady().then(()=>{this.initializeAvailableGroups(),this.initializeAvailableChartType()})})}initializeAvailableGroups(){let e=this.wpTableGroupBy.available,t=this.wpTableGroupBy.current;t&&(e=e.filter(e=>e.id!==t.id),e=e.concat(t)),this.availableGroups=_.sortBy(e,"name")}initializeAvailableChartType(){this.availableChartTypes=_.sortBy([{identifier:"horizontalBar",label:this.I18n.t("js.chart.types.horizontal_bar")},{identifier:"bar",label:this.I18n.t("js.chart.types.bar")},{identifier:"line",label:this.I18n.t("js.chart.types.line")},{identifier:"pie",label:this.I18n.t("js.chart.types.pie")},{identifier:"doughnut",label:this.I18n.t("js.chart.types.doughnut")},{identifier:"radar",label:this.I18n.t("js.chart.types.radar")},{identifier:"polarArea",label:this.I18n.t("js.chart.types.polar_area")}],"label"),this.currentChartType=this.availableChartTypes.find(e=>e.identifier===this.wpGraphConfiguration.configuration.chartType)||this.availableChartTypes[0]}get query(){return this.wpGraphConfiguration.queries[0]}}Zi.\u0275fac=function(e){return new(e||Zi)(n.gc(C.a),n.gc(Ui.a),n.gc(Vi.a),n.gc(di))},Zi.\u0275cmp=n.ac({type:Zi,selectors:[["settings-tab-inner"]],features:[n.Qb],decls:14,vars:10,consts:[[1,"form"],[1,"form--field"],["for","selected_grouping",1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--select-container","-middle"],["id","selected_grouping",1,"form--select",3,"ngModel","ngModelOptions","ngModelChange"],[3,"ngValue","textContent",4,"ngFor","ngForOf"],["for","selected_chart_type",1,"form--label",3,"textContent"],["id","selected_chart_type",3,"ngModel","ngModelOptions","ngModelChange"],[3,"ngValue","textContent"]],template:function(e,t){1&e&&(n.mc(0,"div"),n.mc(1,"form",0),n.mc(2,"div",1),n.hc(3,"label",2),n.mc(4,"div",3),n.mc(5,"div",4),n.mc(6,"select",5),n.uc("ngModelChange",(function(e){return t.currentGroup=e})),n.Yc(7,Gi,1,2,"option",6),n.lc(),n.lc(),n.lc(),n.lc(),n.mc(8,"div",1),n.hc(9,"label",7),n.mc(10,"div",3),n.mc(11,"div",4),n.mc(12,"select",8),n.uc("ngModelChange",(function(e){return t.currentChartType=e})),n.Yc(13,Xi,1,2,"option",6),n.lc(),n.lc(),n.lc(),n.lc(),n.lc(),n.lc()),2&e&&(n.Tb(3),n.Bc("textContent",t.text.group_by),n.Tb(3),n.Bc("ngModel",t.currentGroup)("ngModelOptions",n.Fc(8,Ki)),n.Tb(1),n.Bc("ngForOf",t.availableGroups),n.Tb(2),n.Bc("textContent",t.text.chart_type),n.Tb(3),n.Bc("ngModel",t.currentChartType)("ngModelOptions",n.Fc(9,Ki)),n.Tb(1),n.Bc("ngForOf",t.availableChartTypes))},directives:[l.C,l.n,l.o,l.y,l.m,l.p,X.p,l.r,l.B],encapsulation:2});const Ji=["wpEmbeddedGraphMulti"],en=["wpEmbeddedGraphSingle"];function tn(e,t){if(1&e&&(n.mc(0,"option",4),n.ad(1),n.lc()),2&e){const e=t.$implicit;n.Bc("ngValue",e.key),n.Tb(1),n.bd(e.label)}}function nn(e,t){if(1&e&&(n.mc(0,"div",5),n.hc(1,"div",6),n.lc()),2&e){const e=n.wc();n.Tb(1),n.Bc("textContent",e.error)}}function sn(e,t){if(1&e&&n.hc(0,"wp-embedded-graph",7,8),2&e){const e=n.wc();n.Bc("datasets",e.datasets)("chartOptions",e.chartOptions)}}function an(e,t){if(1&e&&n.hc(0,"wp-embedded-graph",7,9),2&e){const e=n.wc();n.Bc("datasets",e.datasets)("chartOptions",e.chartOptions)}}class rn{constructor(e,t,i,n){this.elementRef=e,this.I18n=t,this.graphConfigurationService=i,this.cdr=n,this.groupBy="status",this.chartOptions={maintainAspectRatio:!1},this.datasets=[],this.displayModeSingle=!0,this.error=null,this.availableGroupBy=[{label:t.t("js.work_packages.properties.category"),key:"category"},{label:t.t("js.work_packages.properties.type"),key:"type"},{label:t.t("js.work_packages.properties.status"),key:"status"},{label:t.t("js.work_packages.properties.priority"),key:"priority"},{label:t.t("js.work_packages.properties.author"),key:"author"},{label:t.t("js.work_packages.properties.assignee"),key:"assignee"}]}ngOnInit(){const e=this.elementRef.nativeElement;this.additionalFilter=JSON.parse(e.getAttribute("additional-filter")),this.setQueryProps()}setQueryProps(){this.datasets=[];let e=this.graphParams;this.graphConfigurationService.configuration=new li(e,{},"horizontalBar"),this.graphConfigurationService.reloadQueries().then(()=>{this.datasets=this.sortedDatasets(this.graphConfigurationService.datasets,e),this.cdr.detectChanges()}).catch(()=>{this.error=this.I18n.t("js.chart.errors.could_not_load"),this.cdr.detectChanges()})}get graphParams(){let e=[];return"status"===this.groupBy?(this.displayModeSingle=!0,e.push({name:this.I18n.t("js.label_all"),props:this.propsBoth})):(this.displayModeSingle=!1,e.push({name:this.I18n.t("js.label_open_work_packages"),props:this.propsOpen}),e.push({name:this.I18n.t("js.label_closed_work_packages"),props:this.propsClosed})),e}sortedDatasets(e,t){let i=t.map(e=>e.name);return e.slice().sort((e,t)=>i.indexOf(e.label)-i.indexOf(t.label))}get propsBoth(){return this.baseProps()}get propsOpen(){return this.baseProps({status:{operator:"o",values:[]}})}get propsClosed(){return this.baseProps({status:{operator:"c",values:[]}})}baseProps(e){let t=[{subprojectId:{operator:"*",values:[]}}];return e&&t.push(e),this.additionalFilter&&t.push(this.additionalFilter),{"columns[]":[],filters:JSON.stringify(t),group_by:this.groupBy,pageSize:0}}get displaySingle(){return this.displayModeSingle}get displayMulti(){return!this.displayModeSingle}get currentGraph(){return this.displaySingle?this.embeddedGraphSingle:this.embeddedGraphMulti}}rn.\u0275fac=function(e){return new(e||rn)(n.gc(n.q),n.gc(C.a),n.gc(di),n.gc(n.i))},rn.\u0275cmp=n.ac({type:rn,selectors:[["wp-overview-graph"]],viewQuery:function(e,t){var i;(1&e&&(n.fd(Ji,!0),n.fd(en,!0)),2&e)&&(n.Nc(i=n.vc())&&(t.embeddedGraphMulti=i.first),n.Nc(i=n.vc())&&(t.embeddedGraphSingle=i.first))},inputs:{additionalFilter:"additionalFilter",groupBy:"groupBy",chartOptions:"chartOptions"},features:[n.Sb([di])],decls:5,vars:5,consts:[[3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],["class","notification-box -error",4,"ngIf"],[3,"datasets","chartOptions",4,"ngIf"],[3,"ngValue"],[1,"notification-box","-error"],[1,"notification-box--content",3,"textContent"],[3,"datasets","chartOptions"],["wpEmbeddedGraphMulti",""],["wpEmbeddedGraphSingle",""]],template:function(e,t){1&e&&(n.mc(0,"select",0),n.uc("ngModelChange",(function(e){return t.groupBy=e}))("ngModelChange",(function(){return t.setQueryProps()})),n.Yc(1,tn,2,2,"option",1),n.lc(),n.Yc(2,nn,2,1,"div",2),n.Yc(3,sn,2,2,"wp-embedded-graph",3),n.Yc(4,an,2,2,"wp-embedded-graph",3)),2&e&&(n.Bc("ngModel",t.groupBy),n.Tb(1),n.Bc("ngForOf",t.availableGroupBy),n.Tb(1),n.Bc("ngIf",t.error),n.Tb(1),n.Bc("ngIf",t.displayMulti),n.Tb(1),n.Bc("ngIf",t.displaySingle))},directives:[l.y,l.m,l.p,X.p,X.q,l.r,l.B,Ii],styles:["wp-embedded-graph[_ngcontent-%COMP%]{margin-top:20px;display:block}"],changeDetection:0});i("qb46");var cn=i("+rOU"),on=i("kor4"),ln=i("1EAr"),dn=i("/Rze"),un=i("ZOsW"),hn=i("ximh"),pn=i("ecJW"),gn=i("QihR"),mn=i("RN/J"),fn=i("CX+C"),bn=i("th4C"),wn=i("oUDv"),vn=i("2hMx"),yn=i("+1L4"),kn=i("cJ7v"),Cn=i("lmKF"),jn=i("HN1l"),xn=i("v9+U"),Tn=i("mRSd"),Sn=i("X4Sm"),_n=i("lfQJ"),Pn=i("IYP9"),In=i("upbp"),On=i("xFOf"),Rn=i("gh2L"),Bn=i("jQQo"),En=i("9hh2"),Mn=i("lmDM"),Fn=i("CVKj"),An=i("hvpr"),Dn=i("SIjI"),qn=i("ZTEj"),Ln=i("f24R"),$n=i("2orT"),Nn=i("Eofd"),Qn=i("m3nR"),Vn=i("ZAVI"),Hn=i("9pt+"),zn=i("S2zE"),Yn=i("eJFM"),Wn=i("byj5"),Un=i("2TbE"),Gn=i("XZlt"),Xn=i("2bW2"),Kn=i("aveh"),Zn=i("PwL/"),Jn=i("DLfB");class es{constructor(){}}es.\u0275mod=n.ec({type:es}),es.\u0275inj=n.dc({factory:function(e){return new(e||es)},imports:[[b.a,ve.a,Ti.b]]}),n.Uc(ri,[$t.UISref,$t.AnchorUISref,$t.UIView,$t.UISrefActive,$t.UISrefStatus,X.n,X.o,X.p,X.q,X.x,X.t,X.u,X.v,X.w,X.r,X.s,l.C,l.r,l.B,l.c,l.s,l.v,l.a,l.y,l.z,l.u,l.m,l.n,l.x,l.k,l.j,l.t,l.b,l.d,l.p,l.q,l.o,cn.a,cn.b,cn.h,cn.e,je.e,je.f,je.a,je.b,je.d,je.c,on.a,ln.a,dn.a,un.a,un.n,un.d,un.c,un.e,un.f,un.g,un.h,un.i,un.j,un.k,un.l,un.m,hn.a,pn.a,gn.a,yt.a,mn.a,fn.a,B.a,bn.a,wn.a,vn.a,yn.a,kn.a,Cn.a,jn.a,xn.a,Tn.a,Sn.a,At.a,_n.a,De.a,Ht.a,Pn.a,In.a,Be.a,Gt.a,On.a,Ce.c,Ce.d,Ce.a,Ce.b,Ce.e,Rn.a,Bn.a,En.a,Mn.a,Di.a,Fn.a,An.a,Dn.a,Ft.a,Dt.a,Ne.a,qn.a,zi.a,Ln.a,$n.a,Nn.a,Qn.a,Vn.a,Hn.a,zn.a,Yn.a,Ei.a,Wn.a,Un.a,Gn.a,Xn.a,Kn.a,Zn.a,Jn.a,Ti.a,yi,ri,Wi,si,Zi,Ii,rn],[X.a,X.C,X.m,X.j,X.A,X.f,X.z,X.B,X.c,X.e,X.h,X.i,X.k]),n.Uc(si,[$t.UISref,$t.AnchorUISref,$t.UIView,$t.UISrefActive,$t.UISrefStatus,X.n,X.o,X.p,X.q,X.x,X.t,X.u,X.v,X.w,X.r,X.s,l.C,l.r,l.B,l.c,l.s,l.v,l.a,l.y,l.z,l.u,l.m,l.n,l.x,l.k,l.j,l.t,l.b,l.d,l.p,l.q,l.o,cn.a,cn.b,cn.h,cn.e,je.e,je.f,je.a,je.b,je.d,je.c,on.a,ln.a,dn.a,un.a,un.n,un.d,un.c,un.e,un.f,un.g,un.h,un.i,un.j,un.k,un.l,un.m,hn.a,pn.a,gn.a,yt.a,mn.a,fn.a,B.a,bn.a,wn.a,vn.a,yn.a,kn.a,Cn.a,jn.a,xn.a,Tn.a,Sn.a,At.a,_n.a,De.a,Ht.a,Pn.a,In.a,Be.a,Gt.a,On.a,Ce.c,Ce.d,Ce.a,Ce.b,Ce.e,Rn.a,Bn.a,En.a,Mn.a,Di.a,Fn.a,An.a,Dn.a,Ft.a,Dt.a,Ne.a,qn.a,zi.a,Ln.a,$n.a,Nn.a,Qn.a,Vn.a,Hn.a,zn.a,Yn.a,Ei.a,Wn.a,Un.a,Gn.a,Xn.a,Kn.a,Zn.a,Jn.a,Ti.a,yi,ri,Wi,si,Zi,Ii,rn],[X.a,X.C,X.m,X.j,X.A,X.f,X.z,X.B,X.c,X.e,X.h,X.i,X.k]);var ts=i("RhL0"),is=i("NNMa"),ns=i("711n"),ss=i("80WE");function as(e,t){if(1&e&&(n.mc(0,"edit-form",1),n.hc(1,"editable-attribute-field",4),n.lc()),2&e){const e=t.ngIf;n.Bc("resource",e),n.Tb(1),n.Bc("resource",e)("fieldName","description")}}class rs extends xe.a{constructor(e,t,i,n,s){super(e,t),this.i18n=e,this.injector=t,this.projectCache=i,this.currentProject=n,this.cdRef=s}ngOnInit(){this.project$=this.projectCache.requireAndStream(this.currentProject.id),this.cdRef.detectChanges()}get isEditable(){return!1}}rs.\u0275fac=function(e){return new(e||rs)(n.gc(C.a),n.gc(n.A),n.gc(is.a),n.gc(Te.a),n.gc(n.i))},rs.\u0275cmp=n.ac({type:rs,selectors:[["ng-component"]],features:[n.Sb([bt.a]),n.Qb],decls:5,vars:6,consts:[[3,"name","editable"],[3,"resource"],[1,"grid--widget-content","-allow-inner-overflow"],[3,"resource",4,"ngIf"],[3,"resource","fieldName"]],template:function(e,t){1&e&&(n.mc(0,"widget-header",0),n.hc(1,"widget-menu",1),n.lc(),n.mc(2,"div",2),n.Yc(3,as,2,3,"edit-form",3),n.xc(4,"async"),n.lc()),2&e&&(n.Bc("name",t.widgetName)("editable",t.isEditable),n.Tb(1),n.Bc("resource",t.resource),n.Tb(2),n.Bc("ngIf",n.yc(4,4,t.project$)))},directives:[Me,Le,X.q,ns.a,ss.a],pipes:[X.a],encapsulation:2,changeDetection:0});class cs extends xe.a{}cs.\u0275fac=function(e){return os(e||cs)},cs.\u0275cmp=n.ac({type:cs,selectors:[["ng-component"]],features:[n.Qb],decls:3,vars:3,consts:[[3,"name","onRenamed"],[3,"resource"],[1,"grid--widget-content",3,"groupBy"]],template:function(e,t){1&e&&(n.mc(0,"widget-header",0),n.uc("onRenamed",(function(e){return t.renameWidget(e)})),n.hc(1,"widget-menu",1),n.lc(),n.hc(2,"wp-overview-graph",2)),2&e&&(n.Bc("name",t.widgetName),n.Tb(1),n.Bc("resource",t.resource),n.Tb(1),n.Bc("groupBy","type"))},directives:[Me,Le,rn],encapsulation:2,changeDetection:0});const os=n.oc(cs);var ls=i("kgyZ"),ds=i("GntA");class us extends ds.a{}class hs extends ls.a{constructor(e,t){super(),this.elementRef=e,this.injector=t,this.fieldName="text",this.inEdit=!1,this.inEditMode=!1,this.inFlight=!1}onFocusOut(){}initialize(e){this.changeset=new us(this.newEditResource(e)),this.valueChanged$=new Oe.a(e.options.text)}reinitialize(e){this.changeset=new us(this.newEditResource(e))}handleUserSubmit(){return this.update()}reset(e=""){e.length>0&&(e+="\n"),this.changeset.setValue("text",{raw:e})}get schema(){return{name:I18n.t("js.grid.widgets.custom_text.title"),writable:!0,required:!1,type:"Formattable",hasDefault:!1}}update(){return Object(y.b)(this,void 0,void 0,(function*(){return this.onSubmit().then(()=>{this.valueChanged$.next(this.rawText),this.deactivate()})}))}get rawText(){return _.get(this.textValue,"raw","")}get htmlText(){return _.get(this.textValue,"html","")}get textValue(){return this.changeset.value("text")}handleUserCancel(){this.deactivate()}get active(){return this.inEdit}activate(e){this.inEdit=!0}deactivate(){this.changeset.clear(),this.inEdit=!1}focus(){const e=this.elementRef.nativeElement.querySelector(".inplace-editing--trigger-container");e&&e.focus()}setErrors(e){}handleUserKeydown(e,t){}isChanged(){return!this.changeset.isEmpty()}stopPropagation(e){return!1}newEditResource(e){return{text:e.options.text,getEditorTypeFor:()=>"full",canAddAttachments:e.grid.canAddAttachments,uploadAttachments:t=>e.grid.uploadAttachments(t)}}}hs.\u0275fac=function(e){return new(e||hs)(n.qc(n.q),n.qc(n.A))},hs.\u0275prov=n.cc({token:hs,factory:hs.\u0275fac});var ps=i("pLZG"),gs=i("7MH/"),ms=i("jEcX");const fs=["displayContainer"];function bs(e,t){if(1&e&&n.hc(0,"span",11),2&e){const e=n.wc(2);n.Bc("innerHTML",e.customText,n.Rc)}}function ws(e,t){if(1&e&&n.hc(0,"span",11),2&e){const e=n.wc(2);n.Bc("innerHTML",e.placeholderText,n.Rc)}}function vs(e,t){if(1&e&&(n.mc(0,"span",8,9),n.Yc(2,bs,1,1,"span",10),n.Yc(3,ws,1,1,"span",10),n.lc()),2&e){const e=n.wc();n.Tb(2),n.Bc("ngIf",!e.textEmpty),n.Tb(1),n.Bc("ngIf",e.textEmpty)}}function ys(e,t){if(1&e&&n.hc(0,"edit-form-portal",12),2&e){const e=n.wc();n.Bc("schemaInput",e.schema)("changeInput",e.changeset)("editFieldHandler",e.handler)}}function ks(e,t){if(1&e&&n.hc(0,"attachments",13),2&e){const e=n.wc();n.Bc("resource",e.resource.grid)}}function Cs(e,t){1&e&&n.ic(0)}function js(e,t){if(1&e){const e=n.nc();n.mc(0,"div",17),n.uc("accessibleClick",(function(t){return n.Qc(e),n.wc(2).activate(t)})),n.Yc(1,Cs,1,0,"ng-container",18),n.lc()}if(2&e){const e=n.wc(2),t=n.Oc(3);n.Bc("accessibleClickStopEvent",!1)("ngClass",e.inplaceEditClasses),n.Tb(1),n.Bc("ngTemplateOutlet",t)}}function xs(e,t){1&e&&n.ic(0)}function Ts(e,t){if(1&e&&(n.kc(0),n.Yc(1,xs,1,0,"ng-container",18),n.jc()),2&e){n.wc(2);const e=n.Oc(3);n.Tb(1),n.Bc("ngTemplateOutlet",e)}}const Ss=function(e){return{"inline-edit--container":e}};function _s(e,t){if(1&e&&(n.mc(0,"div",14),n.Yc(1,js,2,3,"div",15),n.Yc(2,Ts,2,1,"ng-container",16),n.lc()),2&e){const e=n.wc();n.Bc("ngClass",n.Gc(3,Ss,e.isTextEditable)),n.Tb(1),n.Bc("ngIf",e.isTextEditable),n.Tb(1),n.Bc("ngIf",!e.isTextEditable)}}class Ps extends xe.a{constructor(e,t,i,n,s,a){super(e,t),this.i18n=e,this.injector=t,this.handler=i,this.cdr=n,this.sanitization=s,this.layout=a}ngOnInit(){this.setupVariables(!0),this.handler.valueChanged$.pipe(this.untilDestroyed(),Object(ps.a)(e=>e!==this.resource.options.text)).subscribe(e=>{let t=this.setChangesetOptions({text:{raw:e}});this.resourceChanged.emit(t)})}ngOnChanges(e){e.resource.currentValue.options.text.raw!==this.currentRawText&&(this.setupVariables(),this.cdr.detectChanges())}activate(e){this.clickedElementIsLinkWithinDisplayContainer(e)||this.resource.grid.updateAttachments().then(()=>{this.handler.activate()})}get placeholderText(){return this.i18n.t("js.grid.widgets.work_packages_overview.placeholder")}get inplaceEditClasses(){let e="inplace-editing--container inline-edit--display-field -editable";return this.textEmpty&&(e+=" -placeholder"),e}get schema(){return this.handler.schema}get changeset(){return this.handler.changeset}get active(){return this.handler.active}get textEmpty(){return!this.currentRawText.length}get isTextEditable(){return this.layout.isEditable}setupVariables(e=!1){this.memorizeRawText(),e?this.handler.initialize(this.resource):this.handler.reinitialize(this.resource),this.memorizeCustomText()}memorizeRawText(){this.currentRawText=this.resource.options.text.raw}memorizeCustomText(){this.customText=this.sanitization.bypassSecurityTrustHtml(this.handler.htmlText)}clickedElementIsLinkWithinDisplayContainer(e){return this.displayContainer.nativeElement.contains(e.target.closest("a,macro"))}}Ps.\u0275fac=function(e){return new(e||Ps)(n.gc(C.a),n.gc(n.A),n.gc(hs),n.gc(n.i),n.gc(N.b),n.gc(Re))},Ps.\u0275cmp=n.ac({type:Ps,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.fd(fs,!0),2&e)&&(n.Nc(i=n.vc())&&(t.displayContainer=i.first))},features:[n.Sb([hs]),n.Qb,n.Rb],decls:9,vars:5,consts:[[3,"name","onRenamed"],[3,"resource"],["text",""],[1,"grid--widget-content","-custom-text","-allow-inner-overflow"],[1,"inline-edit--container","inplace-edit"],[3,"schemaInput","changeInput","editFieldHandler",4,"ngIf"],["data-allow-uploading","true",3,"resource",4,"ngIf"],["class","inplace-edit--read wiki -no-label",3,"ngClass",4,"ngIf"],[1,"inline-edit--formattable-display-text","-default"],["displayContainer",""],[3,"innerHTML",4,"ngIf"],[3,"innerHTML"],[3,"schemaInput","changeInput","editFieldHandler"],["data-allow-uploading","true",3,"resource"],[1,"inplace-edit--read","wiki","-no-label",3,"ngClass"],[3,"accessibleClickStopEvent","ngClass","accessibleClick",4,"ngIf"],[4,"ngIf"],[3,"accessibleClickStopEvent","ngClass","accessibleClick"],[4,"ngTemplateOutlet"]],template:function(e,t){1&e&&(n.mc(0,"widget-header",0),n.uc("onRenamed",(function(e){return t.renameWidget(e)})),n.hc(1,"widget-menu",1),n.lc(),n.Yc(2,vs,4,2,"ng-template",null,2,n.Zc),n.mc(4,"div",3),n.mc(5,"div",4),n.Yc(6,ys,1,3,"edit-form-portal",5),n.Yc(7,ks,1,1,"attachments",6),n.Yc(8,_s,3,5,"div",7),n.lc(),n.lc()),2&e&&(n.Bc("name",t.widgetName),n.Tb(1),n.Bc("resource",t.resource),n.Tb(5),n.Bc("ngIf",t.active),n.Tb(1),n.Bc("ngIf",t.active),n.Tb(1),n.Bc("ngIf",!t.active))},directives:[Me,Le,X.q,gs.a,ms.a,X.n,on.a,X.x],encapsulation:2,changeDetection:0});var Is=i("Ywds");const Os=["contentContainer"];function Rs(e,t){if(1&e&&(n.kc(0),n.mc(1,"div",6),n.ad(2),n.lc(),n.mc(3,"div",7),n.hc(4,"editable-attribute-field",8),n.lc(),n.jc()),2&e){const e=t.$implicit,i=n.wc().ngIf;n.Tb(2),n.cd(" ",e.label," "),n.Tb(2),n.Bc("resource",i)("fieldName",e.key)}}function Bs(e,t){if(1&e&&(n.mc(0,"edit-form",1),n.mc(1,"div",4),n.Yc(2,Rs,5,3,"ng-container",5),n.lc(),n.lc()),2&e){const e=t.ngIf,i=n.wc();n.Bc("resource",e),n.Tb(2),n.Bc("ngForOf",i.customFields)}}class Es extends xe.a{constructor(e,t,i,n,s,a){super(e,t),this.i18n=e,this.injector=t,this.projectDm=i,this.projectCache=n,this.currentProject=s,this.cdRef=a,this.customFields=[]}ngOnInit(){this.loadAndRender(),this.project$=this.projectCache.requireAndStream(this.currentProject.id)}get isEditable(){return!1}loadAndRender(){Promise.all([this.loadProjectSchema()]).then(([e])=>{this.setCustomFields(e)})}loadProjectSchema(){return this.projectDm.schema()}setCustomFields(e){Object.entries(e).forEach(([e,t])=>{e.match(/customField\d+/)&&this.customFields.push({key:e,label:t.name})}),this.cdRef.detectChanges()}}Es.\u0275fac=function(e){return new(e||Es)(n.gc(C.a),n.gc(n.A),n.gc(Is.a),n.gc(is.a),n.gc(Te.a),n.gc(n.i))},Es.\u0275cmp=n.ac({type:Es,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(Os,!0),2&e)&&(n.Nc(i=n.vc())&&(t.contentContainer=i.first))},features:[n.Sb([bt.a]),n.Qb],decls:5,vars:6,consts:[[3,"name","editable"],[3,"resource"],[1,"grid--widget-content"],[3,"resource",4,"ngIf"],[1,"attributes-map"],[4,"ngFor","ngForOf"],[1,"attributes-map--key"],[1,"attributes-map--value"],[3,"resource","fieldName"]],template:function(e,t){1&e&&(n.mc(0,"widget-header",0),n.hc(1,"widget-menu",1),n.lc(),n.mc(2,"div",2),n.Yc(3,Bs,3,2,"edit-form",3),n.xc(4,"async"),n.lc()),2&e&&(n.Bc("name",t.widgetName)("editable",t.isEditable),n.Tb(1),n.Bc("resource",t.resource),n.Tb(2),n.Bc("ngIf",n.yc(4,4,t.project$)))},directives:[Me,Le,X.q,ns.a,X.p,ss.a],pipes:[X.a],encapsulation:2,changeDetection:0});class Ms extends xe.a{constructor(e,t,i,n,s,a,r){super(n,t),this.timeEntryDm=e,this.injector=t,this.timezone=i,this.i18n=n,this.pathHelper=s,this.confirmDialog=a,this.cdr=r,this.text={activity:this.i18n.t("js.time_entry.activity"),comment:this.i18n.t("js.time_entry.comment"),hour:this.i18n.t("js.time_entry.hours"),workPackage:this.i18n.t("js.label_work_package"),edit:this.i18n.t("js.button_edit"),delete:this.i18n.t("js.button_delete"),confirmDelete:{text:this.i18n.t("js.modals.destroy_time_entry.text"),title:this.i18n.t("js.modals.destroy_time_entry.title")},noResults:this.i18n.t("js.grid.widgets.time_entries_list.no_results")},this.entries=[],this.entriesLoaded=!1,this.rows=[]}ngOnInit(){this.timeEntryDm.list({filters:this.dmFilters(),pageSize:500}).then(e=>{this.buildEntries(e.elements),this.entriesLoaded=!0,this.cdr.detectChanges()})}get total(){let e=this.entries.reduce((e,t)=>e+this.timezone.toHours(t.hours),0);return this.i18n.t("js.units.hour",{count:this.formatNumber(e)})}get anyEntries(){return!!this.entries.length}activityName(e){return e.activity.name}projectName(e){return e.project.name}workPackageName(e){return`#${e.workPackage.id}: ${e.workPackage.name}`}workPackageId(e){return e.workPackage.id}comment(e){return e.comment&&e.comment.raw}hours(e){return this.formatNumber(this.timezone.toHours(e.hours))}workPackagePath(e){return this.pathHelper.workPackagePath(e.workPackage.idFromLink)}get isEditable(){return!1}editTimeEntry(e){this.timeEntryCache.require(e.id).then(e=>{this.timeEntryEditService.edit(e).then(e=>{let t=this.entries.findIndex(t=>t.id===e.entry.id),i=this.entries;i[t]=e.entry,this.buildEntries(i)}).catch(()=>{})})}deleteIfConfirmed(e,t){var i,n,s;e.preventDefault(),this.confirmDialog.confirm({text:this.text.confirmDelete,closeByEscape:!0,showClose:!0,closeByDocument:!0,passedData:["#"+(null===(i=t.workPackage)||void 0===i?void 0:i.idFromLink)+" "+(null===(n=t.workPackage)||void 0===n?void 0:n.name),this.i18n.t("js.units.hour",{count:this.timezone.toHours(t.hours)})+" ("+(null===(s=t.activity)||void 0===s?void 0:s.name)+")"],dangerHighlighting:!0}).then(()=>{t.delete().then(()=>{let e=this.entries.filter(e=>t.id!==e.id);this.buildEntries(e)})}).catch(()=>{})}buildEntries(e){this.entries=e;let t={};e.forEach(e=>{let i=e.spentOn;t[i]||(t[i]=0),t[i]=t[i]+this.timezone.toHours(e.hours)});let i=e.sort((e,t)=>t.spentOn.localeCompare(e.spentOn));this.rows=[];let n=null;i.forEach(e=>{e.spentOn!==n&&(n=e.spentOn,this.rows.push({date:this.timezone.formattedDate(n),sum:this.formatNumber(t[n])})),this.rows.push({date:n,entry:e})})}formatNumber(e){return this.i18n.toNumber(e,{precision:2})}get noEntries(){return!this.entries.length&&this.entriesLoaded}}function Fs(e,t){if(1&e&&n.hc(0,"no-results",4),2&e){const e=n.wc();n.Bc("title",e.text.noResults)}}function As(e,t){if(1&e&&n.hc(0,"td",26),2&e){const e=n.wc().$implicit,t=n.wc(3);n.Bc("textContent",t.activityName(e.entry))}}function Ds(e,t){if(1&e&&(n.mc(0,"td",27),n.hc(1,"strong",6),n.lc()),2&e){const e=n.wc().$implicit;n.Tb(1),n.Bc("textContent",e.date)}}function qs(e,t){if(1&e&&(n.mc(0,"td",28),n.ad(1),n.hc(2,"a",29),n.lc()),2&e){const e=n.wc().$implicit,t=n.wc(3);n.Tb(1),n.cd(" ",t.projectName(e.entry)," - "),n.Tb(1),n.Bc("href",t.workPackagePath(e.entry),n.Tc)("textContent",t.workPackageName(e.entry))}}function Ls(e,t){if(1&e&&n.hc(0,"td",30),2&e){const e=n.wc().$implicit,t=n.wc(3);n.Bc("textContent",t.projectName(e.entry))}}function $s(e,t){if(1&e&&n.hc(0,"td",31),2&e){const e=n.wc().$implicit,t=n.wc(3);n.Bc("textContent",t.comment(e.entry))}}function Ns(e,t){if(1&e&&n.hc(0,"td",32),2&e){const e=n.wc().$implicit,t=n.wc(3);n.Bc("textContent",t.hours(e.entry))}}function Qs(e,t){if(1&e&&(n.mc(0,"td",33),n.hc(1,"em",6),n.lc()),2&e){const e=n.wc().$implicit;n.Tb(1),n.Bc("textContent",e.sum)}}function Vs(e,t){if(1&e){const e=n.nc();n.mc(0,"a",34),n.uc("click",(function(){n.Qc(e);const t=n.wc().$implicit;return n.wc(3).editTimeEntry(t.entry)})),n.hc(1,"op-icon",35),n.lc()}if(2&e){const e=n.wc(4);n.Bc("title",e.text.edit)}}function Hs(e,t){if(1&e){const e=n.nc();n.mc(0,"a",34),n.uc("click",(function(t){n.Qc(e);const i=n.wc().$implicit;return n.wc(3).deleteIfConfirmed(t,i.entry)})),n.hc(1,"op-icon",36),n.lc()}if(2&e){const e=n.wc(4);n.Bc("title",e.text.delete)}}function zs(e,t){if(1&e&&(n.mc(0,"tr",16),n.Yc(1,As,1,1,"td",17),n.Yc(2,Ds,2,1,"td",18),n.Yc(3,qs,3,3,"td",19),n.Yc(4,Ls,1,1,"td",20),n.Yc(5,$s,1,1,"td",21),n.Yc(6,Ns,1,1,"td",22),n.Yc(7,Qs,2,1,"td",23),n.mc(8,"td",24),n.Yc(9,Vs,2,1,"a",25),n.Yc(10,Hs,2,1,"a",25),n.lc(),n.lc()),2&e){const e=t.$implicit;n.Tb(1),n.Bc("ngIf",e.entry),n.Tb(1),n.Bc("ngIf",e.sum),n.Tb(1),n.Bc("ngIf",e.entry&&e.entry.workPackage),n.Tb(1),n.Bc("ngIf",e.entry&&!e.entry.workPackage),n.Tb(1),n.Bc("ngIf",e.entry),n.Tb(1),n.Bc("ngIf",e.entry),n.Tb(1),n.Bc("ngIf",e.sum),n.Tb(2),n.Bc("ngIf",e.entry&&e.entry.updateImmediately),n.Tb(1),n.Bc("ngIf",e.entry&&e.entry.delete)}}function Ys(e,t){if(1&e&&(n.mc(0,"div",8),n.mc(1,"table",9),n.mc(2,"colgroup"),n.hc(3,"col",10),n.hc(4,"col",10),n.hc(5,"col",10),n.hc(6,"col",10),n.hc(7,"col"),n.lc(),n.mc(8,"thead",11),n.mc(9,"tr"),n.mc(10,"th"),n.mc(11,"div",12),n.mc(12,"div",13),n.hc(13,"span",6),n.lc(),n.lc(),n.lc(),n.mc(14,"th"),n.mc(15,"div",12),n.mc(16,"div",13),n.hc(17,"span",6),n.lc(),n.lc(),n.lc(),n.mc(18,"th"),n.mc(19,"div",12),n.mc(20,"div",13),n.hc(21,"span",6),n.lc(),n.lc(),n.lc(),n.mc(22,"th"),n.mc(23,"div",12),n.mc(24,"div",13),n.hc(25,"span",6),n.lc(),n.lc(),n.lc(),n.mc(26,"th"),n.hc(27,"div",14),n.lc(),n.lc(),n.lc(),n.mc(28,"tbody"),n.Yc(29,zs,11,9,"tr",15),n.lc(),n.lc(),n.lc()),2&e){const e=n.wc(2);n.Tb(13),n.Bc("textContent",e.text.activity),n.Tb(4),n.Bc("textContent",e.text.workPackage),n.Tb(4),n.Bc("textContent",e.text.comment),n.Tb(4),n.Bc("textContent",e.text.hour),n.Tb(4),n.Bc("ngForOf",e.rows)}}function Ws(e,t){if(1&e&&(n.kc(0),n.mc(1,"div",5),n.mc(2,"p"),n.ad(3,"Total: "),n.hc(4,"span",6),n.lc(),n.lc(),n.Yc(5,Ys,30,5,"div",7),n.jc()),2&e){const e=n.wc();n.Tb(4),n.Bc("textContent",e.total),n.Tb(1),n.Bc("ngIf",e.anyEntries)}}Ms.\u0275fac=function(e){return new(e||Ms)(n.gc(ht.a),n.gc(n.A),n.gc(nt.a),n.gc(C.a),n.gc(V.a),n.gc(m.a),n.gc(n.i))},Ms.\u0275dir=n.bc({type:Ms,features:[n.Qb]}),Object(y.c)([Object(Y.a)(),Object(y.e)("design:type",St)],Ms.prototype,"timeEntryEditService",void 0),Object(y.c)([Object(Y.a)(),Object(y.e)("design:type",mt)],Ms.prototype,"timeEntryCache",void 0);class Us extends Ms{constructor(e,t,i,n,s,a,r,c){super(e,t,i,n,s,a,r),this.timeEntryDm=e,this.injector=t,this.timezone=i,this.i18n=n,this.pathHelper=s,this.confirmDialog=a,this.cdr=r,this.currentProject=c}dmFilters(){return[["spentOn",">t-",["7"]],["project_id","=",[this.currentProject.id]]]}}function Gs(e,t){if(1&e&&n.hc(0,"no-results",5),2&e){const e=n.wc();n.Bc("title",e.text.noResults)}}function Xs(e,t){1&e&&(n.mc(0,"span"),n.ad(1,", "),n.lc())}function Ks(e,t){if(1&e&&(n.mc(0,"span"),n.hc(1,"a",6),n.Yc(2,Xs,2,0,"span",7),n.lc()),2&e){const e=t.$implicit,i=t.last,s=n.wc();n.Tb(1),n.Bc("href",s.projectPath(e),n.Tc)("textContent",s.projectName(e)),n.Tb(1),n.Bc("ngIf",!i)}}Us.\u0275fac=function(e){return new(e||Us)(n.gc(ht.a),n.gc(n.A),n.gc(nt.a),n.gc(C.a),n.gc(V.a),n.gc(m.a),n.gc(n.i),n.gc(Te.a))},Us.\u0275cmp=n.ac({type:Us,selectors:[["ng-component"]],features:[n.Qb],decls:4,vars:5,consts:[[3,"name","editable"],[3,"resource"],[3,"title",4,"ngIf"],[4,"ngIf"],[3,"title"],[1,"total-hours"],[3,"textContent"],["class","generic-table--results-container",4,"ngIf"],[1,"generic-table--results-container"],[1,"generic-table","time-entries"],["highlight-col",""],[1,"-sticky"],[1,"generic-table--sort-header-outer"],[1,"generic-table--sort-header"],[1,"generic-table--empty-header"],["class","time-entry",4,"ngFor","ngForOf"],[1,"time-entry"],["class","activity",3,"textContent",4,"ngIf"],["colspan","3",4,"ngIf"],["class","subject",4,"ngIf"],["class","subject",3,"textContent",4,"ngIf"],["class","comments",3,"textContent",4,"ngIf"],["class","hours",3,"textContent",4,"ngIf"],["class","hours",4,"ngIf"],[1,"buttons"],[3,"title","click",4,"ngIf"],[1,"activity",3,"textContent"],["colspan","3"],[1,"subject"],[3,"href","textContent"],[1,"subject",3,"textContent"],[1,"comments",3,"textContent"],[1,"hours",3,"textContent"],[1,"hours"],[3,"title","click"],["icon-classes","icon-context icon-edit"],["icon-classes","icon-context icon-delete"]],template:function(e,t){1&e&&(n.mc(0,"widget-header",0),n.hc(1,"widget-menu",1),n.lc(),n.Yc(2,Fs,1,1,"no-results",2),n.Yc(3,Ws,6,2,"ng-container",3)),2&e&&(n.Bc("name",t.widgetName)("editable",t.isEditable),n.Tb(1),n.Bc("resource",t.resource),n.Tb(1),n.Bc("ngIf",t.noEntries),n.Tb(1),n.Bc("ngIf",!t.noEntries))},directives:[Me,Le,X.q,Ht.a,jn.a,X.p,yt.a],encapsulation:2});class Zs extends xe.a{constructor(e,t,i,n,s,a,r,c){super(i,n),this.halResource=e,this.pathHelper=t,this.i18n=i,this.injector=n,this.timezone=s,this.projectDm=a,this.currentProject=r,this.cdr=c,this.text={noResults:this.i18n.t("js.grid.widgets.subprojects.no_results")}}ngOnInit(){this.projectDm.list(this.projectDmParams).then(e=>{this.projects=e.elements,this.cdr.detectChanges()})}get isEditable(){return!1}projectPath(e){return this.pathHelper.projectPath(e.identifier)}projectName(e){return e.name}get noEntries(){return this.projects&&!this.projects.length}get projectDmParams(){return{sortBy:[["name","asc"]],filters:[["parent_id","=",[this.currentProject.id]]]}}}Zs.\u0275fac=function(e){return new(e||Zs)(n.gc(j.a),n.gc(V.a),n.gc(C.a),n.gc(n.A),n.gc(nt.a),n.gc(Is.a),n.gc(Te.a),n.gc(n.i))},Zs.\u0275cmp=n.ac({type:Zs,selectors:[["ng-component"]],features:[n.Qb],decls:5,vars:5,consts:[[3,"name","editable"],[3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"title"],[3,"href","textContent"],[4,"ngIf"]],template:function(e,t){1&e&&(n.mc(0,"widget-header",0),n.hc(1,"widget-menu",1),n.lc(),n.mc(2,"div",2),n.Yc(3,Gs,1,1,"no-results",3),n.Yc(4,Ks,3,3,"span",4),n.lc()),2&e&&(n.Bc("name",t.widgetName)("editable",t.isEditable),n.Tb(1),n.Bc("resource",t.resource),n.Tb(2),n.Bc("ngIf",t.noEntries),n.Tb(1),n.Bc("ngForOf",t.projects))},directives:[Me,Le,X.q,X.p,Ht.a],encapsulation:2,changeDetection:0});var Js=i("PSqx");function ea(e,t){if(1&e&&n.hc(0,"no-results",10),2&e){const e=n.wc();n.Bc("title",e.text.noResults)}}function ta(e,t){if(1&e&&(n.kc(0),n.hc(1,"span",14),n.jc()),2&e){const e=n.wc().$implicit,t=n.wc(2);n.Tb(1),n.Bc("textContent",t.userName(e))}}function ia(e,t){if(1&e&&(n.kc(0),n.hc(1,"user-avatar",15),n.hc(2,"a",16),n.jc()),2&e){const e=n.wc().$implicit,t=n.wc(2);n.Tb(1),n.Bc("user",e),n.Tb(1),n.Bc("href",t.userPath(e),n.Tc)("textContent",t.userName(e))}}function na(e,t){1&e&&(n.kc(0),n.ad(1,", "),n.jc())}function sa(e,t){if(1&e&&(n.mc(0,"span"),n.Yc(1,ta,2,1,"ng-container",13),n.Yc(2,ia,3,3,"ng-container",13),n.Yc(3,na,2,0,"ng-container",13),n.lc()),2&e){const e=t.$implicit,i=t.last,s=n.wc(2);n.Tb(1),n.Bc("ngIf",s.isGroup(e)),n.Tb(1),n.Bc("ngIf",!s.isGroup(e)),n.Tb(1),n.Bc("ngIf",!i)}}function aa(e,t){if(1&e&&(n.kc(0),n.mc(1,"div",11),n.ad(2),n.lc(),n.mc(3,"div",12),n.Yc(4,sa,4,3,"span",5),n.lc(),n.jc()),2&e){const e=t.$implicit;n.Tb(2),n.cd(" ",e.role.name," "),n.Tb(2),n.Bc("ngForOf",e.users)}}function ra(e,t){if(1&e&&(n.mc(0,"div",17),n.ad(1),n.lc()),2&e){const e=n.wc();n.Tb(1),n.cd(" ",e.moreMembersText," ")}}function ca(e,t){if(1&e&&(n.mc(0,"a",18),n.hc(1,"i",19),n.hc(2,"span",20),n.lc()),2&e){const e=n.wc();n.Bc("href",e.projectMembershipsPath+"?show_add_members=true",n.Tc),n.Tb(2),n.Bc("textContent",e.text.add)}}function oa(e,t){if(1&e&&(n.mc(0,"a",21),n.hc(1,"i",22),n.hc(2,"span",20),n.lc()),2&e){const e=n.wc();n.Bc("href",e.projectMembershipsPath,n.Tc),n.Tb(2),n.Bc("textContent",e.text.viewAll)}}class la extends xe.a{constructor(e,t,i,n,s,a){super(t,i),this.pathHelper=e,this.i18n=t,this.injector=i,this.membershipDm=n,this.currentProject=s,this.cdr=a,this.text={add:this.i18n.t("js.grid.widgets.members.add"),noResults:this.i18n.t("js.grid.widgets.members.no_results"),viewAll:this.i18n.t("js.grid.widgets.members.view_all_members")},this.entriesByRoles={},this.entriesLoaded=!1,this.membersAddable=!1}ngOnInit(){this.membershipDm.list(this.listMembersParams).then(e=>{this.partitionEntriesByRole(e.elements),this.sortUsersByName(),this.totalMembers=e.total,this.entriesLoaded=!0,this.cdr.detectChanges()}),this.membershipDm.listAvailableProjects(this.listAvailableProjectsParams).then(e=>{this.membersAddable=e.total>0}).catch(()=>{})}get isEditable(){return!1}userPath(e){return this.pathHelper.userPath(e.id)}userName(e){return e.name}get noMembers(){return this.entriesLoaded&&!Object.keys(this.entriesByRoles).length}get moreMembers(){return this.entriesLoaded&&this.totalMembers>100}get moreMembersText(){return I18n.t("js.grid.widgets.members.too_many",{count:100,total:this.totalMembers})}get projectMembershipsPath(){return this.pathHelper.projectMembershipsPath(this.currentProject.identifier)}get usersByRole(){return Object.values(this.entriesByRoles)}isGroup(e){return this.pathHelper.api.v3.groups.id(e.id).toString()===e.href}partitionEntriesByRole(e){e.forEach(e=>{e.roles.forEach(t=>{this.entriesByRoles[t.id]||(this.entriesByRoles[t.id]={role:t,users:[]}),this.entriesByRoles[t.id].users.push(e.principal)})})}sortUsersByName(){Object.values(this.entriesByRoles).forEach(e=>{e.users.sort((e,t)=>this.userName(e).localeCompare(this.userName(t)))})}get listMembersParams(){let e={sortBy:[["created_on","desc"]],pageSize:100};return this.currentProject.id&&(e.filters=[["project_id","=",[this.currentProject.id]]]),e}get listAvailableProjectsParams(){let e={};return this.currentProject.id&&(e.filters=[["id","=",[this.currentProject.id]]]),e}}la.\u0275fac=function(e){return new(e||la)(n.gc(V.a),n.gc(C.a),n.gc(n.A),n.gc(Js.a),n.gc(Te.a),n.gc(n.i))},la.\u0275cmp=n.ac({type:la,selectors:[["ng-component"]],features:[n.Qb],decls:10,vars:8,consts:[[3,"name","editable"],[3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[1,"attributes-map","-minimal-keys"],[4,"ngFor","ngForOf"],["class","members-widget--notification",4,"ngIf"],[1,"grid--widget-footer"],["class","button -alt-highlight",3,"href",4,"ngIf"],["class","button -highlight-inverted",3,"href",4,"ngIf"],[3,"title"],[1,"attributes-map--key"],[1,"attributes-map--value"],[4,"ngIf"],[3,"textContent"],["data-class-list","avatar avatar-mini -spaced",3,"user"],[3,"href","textContent"],[1,"members-widget--notification"],[1,"button","-alt-highlight",3,"href"],["aria-hidden","true",1,"button--icon","icon-add"],[1,"button--text",3,"textContent"],[1,"button","-highlight-inverted",3,"href"],["aria-hidden","true",1,"button--icon","icon-group"]],template:function(e,t){1&e&&(n.mc(0,"widget-header",0),n.hc(1,"widget-menu",1),n.lc(),n.mc(2,"div",2),n.Yc(3,ea,1,1,"no-results",3),n.mc(4,"div",4),n.Yc(5,aa,5,2,"ng-container",5),n.lc(),n.Yc(6,ra,2,1,"div",6),n.lc(),n.mc(7,"div",7),n.Yc(8,ca,3,2,"a",8),n.Yc(9,oa,3,2,"a",9),n.lc()),2&e&&(n.Bc("name",t.widgetName)("editable",t.isEditable),n.Tb(1),n.Bc("resource",t.resource),n.Tb(2),n.Bc("ngIf",t.noMembers),n.Tb(2),n.Bc("ngForOf",t.usersByRole),n.Tb(1),n.Bc("ngIf",t.moreMembers),n.Tb(2),n.Bc("ngIf",t.membersAddable),n.Tb(1),n.Bc("ngIf",!t.noMembers))},directives:[Me,Le,X.q,X.p,Ht.a,Gt.a],styles:[".members-widget--notification[_ngcontent-%COMP%]{font-style:italic;margin-top:.5rem}.grid--widget-footer[_ngcontent-%COMP%]{margin-top:.5rem}.grid--widget-footer[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin-bottom:0}.attributes-map[_ngcontent-%COMP%]{padding-bottom:.875rem;line-height:1.5rem}"],changeDetection:0});var da=i("2Qcm");const ua=["contentContainer"];function ha(e,t){if(1&e&&(n.mc(0,"edit-form",1),n.mc(1,"div",4),n.hc(2,"editable-attribute-field",5),n.lc(),n.mc(3,"div",6),n.hc(4,"editable-attribute-field",7),n.lc(),n.lc()),2&e){const e=t.ngIf;n.Bc("resource",e),n.Tb(2),n.Bc("resource",e),n.Tb(2),n.Bc("resource",e)}}class pa extends xe.a{constructor(e,t,i,n,s,a){super(e,t),this.i18n=e,this.injector=t,this.projectDm=i,this.projectCache=n,this.currentProject=s,this.cdRef=a,this.currentStatusCode="not set",this.explanation=""}ngOnInit(){this.project$=this.projectCache.requireAndStream(this.currentProject.id),this.cdRef.detectChanges()}get isEditable(){return!1}}pa.\u0275fac=function(e){return new(e||pa)(n.gc(C.a),n.gc(n.A),n.gc(Is.a),n.gc(is.a),n.gc(Te.a),n.gc(n.i))},pa.\u0275cmp=n.ac({type:pa,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(ua,!0),2&e)&&(n.Nc(i=n.vc())&&(t.contentContainer=i.first))},features:[n.Sb([da.a,Ve.a,bt.a]),n.Qb],decls:5,vars:6,consts:[[3,"name","editable"],[3,"resource"],[1,"grid--widget-content","-allow-inner-overflow"],[3,"resource",4,"ngIf"],[1,"project-status--container"],["fieldName","status","wrapperClasses","project-status--display-field",3,"resource"],[1,"project-status-explanation--container"],["fieldName","statusExplanation",3,"resource"]],template:function(e,t){1&e&&(n.mc(0,"widget-header",0),n.hc(1,"widget-menu",1),n.lc(),n.mc(2,"div",2),n.Yc(3,ha,5,3,"edit-form",3),n.xc(4,"async"),n.lc()),2&e&&(n.Bc("name",t.widgetName)("editable",t.isEditable),n.Tb(1),n.Bc("resource",t.resource),n.Tb(2),n.Bc("ngIf",n.yc(4,4,t.project$)))},directives:[Me,Le,X.q,ns.a,ss.a],pipes:[X.a],encapsulation:2,changeDetection:0});class ga{constructor(e){!function(e){const t=e.get(v.a),i=e.get(C.a);t.register("gridWidgets",()=>{let e=["id","project","type","subject"],t=new ts.a;t.add("assignee","=",["me"]),t.add("status","o",[]);let n={"columns[]":e,filters:t.toJson()},s=new ts.a;s.add("responsible","=",["me"]),s.add("status","o",[]);let a={"columns[]":e,filters:s.toJson()},r=new ts.a;r.add("author","=",["me"]),r.add("status","o",[]);let c={"columns[]":e,filters:r.toJson()},o=new ts.a;o.add("watcher","=",["me"]),o.add("status","o",[]);let l={"columns[]":e,filters:o.toJson()};return[{identifier:"work_packages_assigned",component:$i,title:i.t("js.grid.widgets.work_packages_assigned.title"),properties:{queryProps:n,name:i.t("js.grid.widgets.work_packages_assigned.title")}},{identifier:"work_packages_accountable",component:$i,title:i.t("js.grid.widgets.work_packages_accountable.title"),properties:{queryProps:a,name:i.t("js.grid.widgets.work_packages_accountable.title")}},{identifier:"work_packages_created",component:$i,title:i.t("js.grid.widgets.work_packages_created.title"),properties:{queryProps:c,name:i.t("js.grid.widgets.work_packages_created.title")}},{identifier:"work_packages_watched",component:$i,title:i.t("js.grid.widgets.work_packages_watched.title"),properties:{queryProps:l,name:i.t("js.grid.widgets.work_packages_watched.title")}},{identifier:"work_packages_table",component:$i,title:i.t("js.grid.widgets.work_packages_table.title"),properties:{name:i.t("js.grid.widgets.work_packages_table.title")}},{identifier:"work_packages_graph",component:Oi,title:i.t("js.grid.widgets.work_packages_graph.title"),properties:{name:i.t("js.grid.widgets.work_packages_graph.title")}},{identifier:"work_packages_calendar",component:it,title:i.t("js.grid.widgets.work_packages_calendar.title"),properties:{name:i.t("js.grid.widgets.work_packages_calendar.title")}},{identifier:"work_packages_overview",component:cs,title:i.t("js.grid.widgets.work_packages_overview.title"),properties:{name:i.t("js.grid.widgets.work_packages_overview.title")}},{identifier:"time_entries_current_user",component:Bt,title:i.t("js.grid.widgets.time_entries_current_user.title"),properties:{name:i.t("js.grid.widgets.time_entries_current_user.title"),days:[!0,!0,!0,!0,!0,!0,!0]}},{identifier:"time_entries_project",component:Us,title:i.t("js.grid.widgets.time_entries_list.title"),properties:{name:i.t("js.grid.widgets.time_entries_list.title")}},{identifier:"documents",component:Wt,title:i.t("js.grid.widgets.documents.title"),properties:{name:i.t("js.grid.widgets.documents.title")}},{identifier:"members",component:la,title:i.t("js.grid.widgets.members.title"),properties:{name:i.t("js.grid.widgets.members.title")}},{identifier:"news",component:ti,title:i.t("js.grid.widgets.news.title"),properties:{name:i.t("js.grid.widgets.news.title")}},{identifier:"project_description",component:rs,title:i.t("js.grid.widgets.project_description.title"),properties:{name:i.t("js.grid.widgets.project_description.title")}},{identifier:"custom_text",component:Ps,title:i.t("js.grid.widgets.custom_text.title"),properties:{name:i.t("js.grid.widgets.custom_text.title"),text:{raw:""}}},{identifier:"project_details",component:Es,title:i.t("js.grid.widgets.project_details.title"),properties:{name:i.t("js.grid.widgets.project_details.title")}},{identifier:"project_status",component:pa,title:i.t("js.grid.widgets.project_status.title"),properties:{name:i.t("js.grid.widgets.project_status.title")}},{identifier:"subprojects",component:Zs,title:i.t("js.grid.widgets.subprojects.title"),properties:{name:i.t("js.grid.widgets.subprojects.title")}}]})}(e)}}ga.\u0275mod=n.ec({type:ga}),ga.\u0275inj=n.dc({factory:function(e){return new(e||ga)(n.qc(n.A))},providers:[Et,ii],imports:[[N.a,l.i,je.g,b.a,ve.a,es,Vt,Nt,ye.a,Ce.f.withComponents([Ps,Wt,la,ti,$i,Oi,it,cs,rs,Es,pa,Zs,Bt,Us]),f.a]]});var ma=i("oqKi");class fa{}fa.\u0275fac=function(e){return new(e||fa)},fa.\u0275cmp=n.ac({type:fa,selectors:[["openproject-base"]],decls:2,vars:0,consts:[[1,"openproject-base--ui-view"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.hc(1,"ui-view"),n.lc())},directives:[$t.UIView],encapsulation:2});var ba=i("pQre");const wa=[{name:"root",url:"/{projects}/{projectPath}",component:fa,abstract:!0,params:{projectPath:{type:"path",value:null,squash:!0},projects:{type:"path",value:null,squash:!0},flash_message:{dynamic:!0,value:null,inherit:!1}}},{name:"boards.**",parent:"root",url:"/boards",loadChildren:()=>i.e(10).then(i.bind(null,"lrTx")).then(e=>e.OpenprojectBoardsModule)},{name:"bim.**",parent:"root",url:"/bcf",loadChildren:()=>i.e(9).then(i.bind(null,"5VZj")).then(e=>e.OpenprojectIFCModelsModule)}];function va(e,t="add"){e&&(Array.isArray(e)?e.forEach(e=>{document.body.classList[t](e)}):document.body.classList[t](e))}function ya(e,t="add"){if(!e)return;let i=jQuery("#main-menu ."+e)[0];if(!i)return;i.classList[t]("selected");let n=(i.getAttribute("title")||"").split(":").slice(-1)[0];"add"===t&&(n=I18n.t("js.description_current_position")+n),i.setAttribute("title",n)}class ka{constructor(e){!function(e){const t=e.get(We.O),i=e.get(We.G),n=e.get(k.a),s=e.get(Te.a),a=e.get(ma.a),r=e.get(ba.a);let c=document.querySelector("openproject-base");t.onEnter({},(function(e,t){va(_.get(t,"data.bodyClasses"),"add"),e.from().data&&_.get(t,"data.menuItem")!==e.from().data.menuItem&&ya(_.get(t,"data.menuItem"),"add"),window.scrollTo(0,0)})),t.onExit({},(function(e,t){va(_.get(t,"data.bodyClasses"),"remove"),e.to().data&&_.get(t,"data.menuItem")!==e.to().data.menuItem&&ya(_.get(t,"data.menuItem"),"remove")})),t.onStart({},(function(e){const t=e.router.stateService,o=e.params("to"),l=(e.from(),e.to());if(o.start_onboarding_tour&&"work-packages.partitioned.list"!==l.name){const i=Object.assign({},e.params());return i.start_onboarding_tour=void 0,t.target(e.to(),i)}r.sync(e);const d=window.MiniProfiler;d&&d.pageTransition();const u=o.projectPath||s.identifier;if(!o.projects&&u){const e=_.clone(o);return _.assign(e,{projectPath:u,projects:"projects"}),t.target(l,e,{location:"replace"})}if(null===c){e.options().source;const t=window.location.pathname,n=i.href(l,o);if(n&&t!==n)return window.location.href=n,!1}return va(_.get(l,"data.bodyClasses"),"add"),a.setIfFirst(l.name,o),e.to().name!==e.from().name&&n.clear(),o.flash_message&&n.add(o.flash_message),!0}))}(e)}}ka.\u0275mod=n.ec({type:ka}),ka.\u0275inj=n.dc({factory:function(e){return new(e||ka)(n.qc(n.A))},providers:[ma.a],imports:[[$t.UIRouterModule.forRoot({states:wa,useHash:!1,config:function(e,t,i){e.urlService.config.strictMode(!1),e.urlService.config.type("opQueryString",{encode:encodeURIComponent,decode:decodeURIComponent,raw:!0,dynamic:!0,is:e=>"string"==typeof e,equals:(e,t)=>_.isEqual(e,t)})}})]]});var Ca=i("ODu2"),ja=i("qs3h"),xa=i("ylTo"),Ta=i("kZPr"),Sa=i("VYxi"),_a=i("rJ6b"),Pa=i("YefF"),Ia=i("fdeW"),Oa=i("hxzR"),Ra=i("/qfM");const Ba=[{name:"work-packages",parent:"root",component:Pa.a,url:"/work_packages?query_id&query_props&start_onboarding_tour",redirectTo:"work-packages.partitioned.list",data:{bodyClasses:"router--work-packages-base",menuItem:"work-packages-menu-item"},params:{query_id:{type:"query",dynamic:!0},query_props:{type:"opQueryString"},start_onboarding_tour:{type:"query",squash:!0,value:void 0}}},{name:"work-packages.new",url:"/new?type&parent_id",component:Ta.a,reloadOnSearch:!1,data:{baseRoute:"work-packages",allowMovingInEditMode:!0,bodyClasses:"router--work-packages-full-create",menuItem:"work-packages-menu-item"}},{name:"work-packages.copy",url:"/{copiedFromWorkPackageId:[0-9]+}/copy",component:Sa.a,reloadOnSearch:!1,data:{baseRoute:"work-packages",allowMovingInEditMode:!0,bodyClasses:"router--work-packages-full-create",menuItem:"work-packages-menu-item"}},{name:"work-packages.show",url:"/{workPackageId:[0-9]+}",redirectTo:"work-packages.show.activity",component:_a.a,data:{baseRoute:"work-packages",bodyClasses:"router--work-packages-full-view",newRoute:"work-packages.new",menuItem:"work-packages-menu-item"}},{name:"work-packages.show.activity",url:"/activity",component:Ca.a,data:{parent:"work-packages.show",menuItem:"work-packages-menu-item"}},{name:"work-packages.show.activity.details",url:"/activity/details/#{activity_no:d+}",component:Ca.a,data:{parent:"work-packages.show",menuItem:"work-packages-menu-item"}},{name:"work-packages.show.relations",url:"/relations",component:ja.a,data:{parent:"work-packages.show",menuItem:"work-packages-menu-item"}},{name:"work-packages.show.watchers",url:"/watchers",component:xa.a,data:{parent:"work-packages.show",menuItem:"work-packages-menu-item"}},{name:"work-packages.partitioned",component:Oa.a,url:"",data:{bodyClasses:""}},{name:"work-packages.partitioned.list",url:"",reloadOnSearch:!1,views:{"content-left":{component:Ia.a}},data:{bodyClasses:"router--work-packages-partitioned-split-view",menuItem:"work-packages-menu-item",partition:"-left-only"}},...Object(Ra.a)("work-packages.partitioned.list","work-packages-menu-item",Zn.a)];class Ea{}Ea.\u0275mod=n.ec({type:Ea}),Ea.\u0275inj=n.dc({factory:function(e){return new(e||Ea)},imports:[[ve.a,$t.UIRouterModule.forChild({states:Ba})]]});class Ma{constructor(e,t,i,n){this.I18n=e,this.injector=t,this.PathHelper=i,this.currentProjectService=n,this._searchTerm=new Oe.a(""),this.searchTerm$=this._searchTerm.asObservable(),this._currentTab=new Oe.a("work_packages"),this.currentTab$=this._currentTab.asObservable(),this._projectScope=new Oe.a(""),this.projectScope$=this._projectScope.asObservable(),this._tabs=new Oe.a([]),this.tabs$=this._tabs.asObservable(),this._resultsHidden=new Oe.a(!1),this.resultsHidden$=this._resultsHidden.asObservable(),this.initialize()}initialize(){let e=this.loadGonData();e&&(e.available_search_types&&this._tabs.next(e.available_search_types),e.search_term&&this._searchTerm.next(e.search_term),e.current_tab&&this._currentTab.next(e.current_tab),e.project_scope?this._projectScope.next(e.project_scope):this.currentProjectService.path||this._projectScope.next("all"))}loadGonData(){try{return window.gon.global_search}catch(e){return null}}submitSearch(){window.location.href=this.searchPath()}searchPath(){let e=this.PathHelper.staticBase;return this.currentProjectService.path&&"all"!==this.projectScope&&(e=this.currentProjectService.path),e+=`/search?${this.searchQueryParams()}`,e}set searchTerm(e){this._searchTerm.next(e)}get searchTerm(){return this._searchTerm.value}get tabs(){return this._tabs.value}get currentTab(){return this._currentTab.value}set currentTab(e){this._currentTab.next(e)}get projectScope(){return this._projectScope.value}set projectScope(e){this._projectScope.next(e)}get resultsHidden(){return this._resultsHidden.value}set resultsHidden(e){this._resultsHidden.next(e)}searchQueryParams(){let e;return e=`q=${encodeURIComponent(this.searchTerm)}`,this.currentTab.length>0&&"all"!==this.currentTab&&(e=`${e}&${this.currentTab}=1`),this.projectScope.length>0&&(e=`${e}&scope=${this.projectScope}`),e}isAfterSearch(){return jQuery("body.controller-search").length>0}}Ma.\u0275fac=function(e){return new(e||Ma)(n.qc(C.a),n.qc(n.A),n.qc(V.a),n.qc(Te.a))},Ma.\u0275prov=n.cc({token:Ma,factory:Ma.\u0275fac});class Fa{}Fa.\u0275mod=n.ec({type:Fa}),Fa.\u0275inj=n.dc({factory:function(e){return new(e||Fa)},providers:[Ma],imports:[[b.a,ve.a]]});var Aa=i("K018"),Da=i("fbLK");class qa extends Da.a{constructor(e,t,i){super(e),this.documentElement=e,this.confirmDialog=t,this.I18n=i}showEEOnlyHint(){this.confirmDialog.confirm({text:{title:this.I18n.t("js.types.attribute_groups.upgrade_to_ee"),text:this.I18n.t("js.types.attribute_groups.upgrade_to_ee_text"),button_continue:this.I18n.t("js.types.attribute_groups.more_information"),button_cancel:this.I18n.t("js.types.attribute_groups.nevermind")}}).then(()=>{window.location.href="https://www.openproject.org/enterprise-edition/?utm_source=unknown&utm_medium=community-edition&utm_campaign=form-configuration"})}}qa.\u0275fac=function(e){return new(e||qa)(n.qc(X.d),n.qc(m.a),n.qc(C.a))},qa.\u0275prov=n.cc({token:qa,factory:qa.\u0275fac});var La=i("OW6k"),$a=i("DHgU"),Na=i("9Ejp");function Qa(e,t){if(1&e){const e=n.nc();n.mc(0,"type-form-attribute-group",25),n.uc("removeAttribute",(function(t){return n.Qc(e),n.wc(2).deactivateAttribute(t)}))("deleteGroup",(function(){n.Qc(e);const t=n.wc().$implicit;return n.wc().deleteGroup(t)})),n.lc()}if(2&e){const e=n.wc().$implicit;n.Bc("group",e)}}function Va(e,t){if(1&e){const e=n.nc();n.mc(0,"type-form-query-group",26),n.uc("editQuery",(function(){n.Qc(e);const t=n.wc().$implicit;return n.wc().editQuery(t)}))("deleteGroup",(function(){n.Qc(e);const t=n.wc().$implicit;return n.wc().deleteGroup(t)})),n.lc()}if(2&e){const e=n.wc().$implicit;n.Bc("group",e)}}function Ha(e,t){if(1&e&&(n.kc(0),n.Yc(1,Qa,1,1,"type-form-attribute-group",23),n.Yc(2,Va,1,1,"type-form-query-group",24),n.jc()),2&e){const e=t.$implicit;n.Tb(1),n.Bc("ngIf","attribute"===e.type),n.Tb(1),n.Bc("ngIf","query"===e.type)}}function za(e,t){if(1&e&&n.hc(0,"span",31),2&e){const e=n.wc(2);n.Bc("textContent",e.text.custom_field)}}function Ya(e,t){if(1&e&&(n.mc(0,"div",27),n.hc(1,"span",28),n.mc(2,"span",29),n.ad(3),n.Yc(4,za,1,1,"span",30),n.lc(),n.lc()),2&e){const e=t.$implicit;n.Ub("data-key",e.key),n.Tb(3),n.cd(" ",e.translation," "),n.Tb(1),n.Bc("ngIf",e.is_cf)}}class Wa extends Je.a{constructor(e,t,i,n,s,a,r){super(),this.elementRef=e,this.I18n=t,this.Gon=i,this.dragula=n,this.confirmDialog=s,this.notificationsService=a,this.externalRelationQuery=r,this.text={drag_to_activate:this.I18n.t("js.admin.type_form.drag_to_activate"),reset:this.I18n.t("js.admin.type_form.reset_to_defaults"),label_group:this.I18n.t("js.label_group"),new_group:this.I18n.t("js.admin.type_form.new_group"),label_inactive:this.I18n.t("js.admin.type_form.inactive"),custom_field:this.I18n.t("js.admin.type_form.custom_field"),add_group:this.I18n.t("js.admin.type_form.add_group"),add_table:this.I18n.t("js.admin.type_form.add_table")},this.groups=[],this.inactives=[]}ngOnInit(){this.element=this.elementRef.nativeElement,this.no_filter_query=this.element.dataset.noFilterQuery,this.form=jQuery(this.element).closest("form"),this.submit=this.form.find(".form-configuration--save");let e=!1;this.form.on("submit",t=>{e=!0}),this.submit.on("mousedown",t=>(setTimeout(()=>{e||this.form.trigger("submit")},50),!0)),this.form.on("submit.typeformupdater",()=>(this.updateHiddenFields(),!0)),this.dragula.createGroup("groups",{moves:(e,t,i)=>i.classList.contains("group-handle")}),this.dragula.createGroup("attributes",{moves:(e,t,i)=>i.classList.contains("attribute-handle")}),this.dragula.dropModel("attributes").pipe(this.untilDestroyed()).subscribe(e=>{console.log(e)}),this.groups=JSON.parse(this.element.dataset.activeGroups),this.inactives=JSON.parse(this.element.dataset.inactiveAttributes);const t=this;this.autoscroll=new La.a([document.getElementById("content-wrapper")],{margin:25,maxSpeed:10,scrollWhenOutside:!0,autoScroll:function(){const e=t.groupsDrake&&t.groupsDrake.dragging,i=t.attributeDrake&&t.attributeDrake.dragging;return this.down&&(e||i)}})}deactivateAttribute(e){this.updateInactives(this.inactives.concat(e))}addGroupAndOpenQuery(){let e=this.createGroup("query");this.editQuery(e)}editQuery(e){const t={"display-settings":I18n.t("js.work_packages.table_configuration.embedded_tab_disabled"),timelines:I18n.t("js.work_packages.table_configuration.embedded_tab_disabled")};this.externalRelationQuery.show(JSON.parse(e.query),t=>e.query=JSON.stringify(t),t)}deleteGroup(e){return"attribute"===e.type&&this.updateInactives(this.inactives.concat(e.attributes)),this.groups=this.groups.filter(t=>t!==e),e}createGroup(e,t=""){let i={type:e,name:"",key:null,query:this.no_filter_query,attributes:[]};return this.groups.unshift(i),i}resetToDefault(e){return this.confirmDialog.confirm({text:{title:this.I18n.t("js.types.attribute_groups.reset_title"),text:this.I18n.t("js.types.attribute_groups.confirm_reset"),button_continue:this.I18n.t("js.label_reset")}}).then(()=>{this.form.find("input#type_attribute_groups").val(JSON.stringify([])),this.form.off("submit.typeformupdater"),this.form.trigger("submit")}),e.preventDefault(),!1}updateInactives(e){this.inactives=[...e].sort((e,t)=>e.translation.localeCompare(t.translation))}updateHiddenFields(){this.form.find(".admin-type-form--hidden-field").val(JSON.stringify(this.groups))}}function Ua(e,t){if(1&e){const e=n.nc();n.mc(0,"div",2),n.uc("click",(function(){return n.Qc(e),n.wc().startEditing()})),n.lc()}if(2&e){const e=n.wc();n.Bc("textContent",e.name)}}function Ga(e,t){if(1&e){const e=n.nc();n.mc(0,"input",3,4),n.uc("ngModelChange",(function(t){return n.Qc(e),n.wc().editedName=t}))("blur",(function(t){return n.Qc(e),n.wc().saveEdition(t)}))("keydown.escape",(function(){return n.Qc(e),n.wc().reset()}))("keydown.enter",(function(t){return n.Qc(e),n.wc().saveEdition(t)})),n.lc()}if(2&e){const e=n.wc();n.Bc("ngModel",e.editedName),n.Ub("placeholder",e.placeholder)}}Wa.\u0275fac=function(e){return new(e||Wa)(n.gc(n.q),n.gc(C.a),n.gc($a.a),n.gc(Na.c),n.gc(m.a),n.gc(k.a),n.gc(g.a))},Wa.\u0275cmp=n.ac({type:Wa,selectors:[["admin-type-form-configuration"]],features:[n.Sb([qa]),n.Qb],decls:29,vars:10,consts:[[1,"toolbar-container","-with-dropdown"],[1,"toolbar"],[1,"toolbar-items"],[1,"toolbar-item"],["type","button -alt-highlight",1,"form-configuration--reset","button",3,"click"],["icon-classes","button--icon icon-undo"],[1,"button--text",3,"textContent"],[1,"toolbar-item","drop-down"],["ng-click","showGroupsContextMenu($event)","aria-haspopup","true",1,"form-configuration--add-group","button","-alt-highlight"],["icon-classes","button--icon icon-add"],["icon-classes","button--dropdown-indicator"],[1,"menu-drop-down-container"],[1,"form-configuration--add-group",3,"textContent","accessibleClick"],[1,"grid-block","wrap"],[1,"grid-content","small-12","medium-6"],["id","draggable-groups","dragula","groups",3,"dragulaModel","dragulaModelChange"],[4,"ngFor","ngForOf"],["id","type-form-conf-inactive-group"],[1,"group-head"],[1,"group-name",3,"textContent"],[1,"advice",3,"textContent"],["dragula","attributes",1,"attributes",3,"dragulaModel","dragulaModelChange"],["class","type-form-conf-attribute",4,"ngFor","ngForOf"],[3,"group","removeAttribute","deleteGroup",4,"ngIf"],[3,"group","editQuery","deleteGroup",4,"ngIf"],[3,"group","removeAttribute","deleteGroup"],[3,"group","editQuery","deleteGroup"],[1,"type-form-conf-attribute"],[1,"attribute-handle","icon-drag-handle"],[1,"attribute-name"],["class","attribute-cf-label",3,"textContent",4,"ngIf"],[1,"attribute-cf-label",3,"textContent"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"ul",2),n.mc(3,"li",3),n.mc(4,"button",4),n.uc("click",(function(e){return t.resetToDefault(e)})),n.hc(5,"op-icon",5),n.hc(6,"span",6),n.lc(),n.lc(),n.mc(7,"li",7),n.mc(8,"a",8),n.hc(9,"op-icon",9),n.hc(10,"span",6),n.hc(11,"op-icon",10),n.lc(),n.mc(12,"ul",11),n.mc(13,"li"),n.mc(14,"a",12),n.uc("accessibleClick",(function(){return t.createGroup("attribute","")})),n.lc(),n.lc(),n.mc(15,"li"),n.mc(16,"a",12),n.uc("accessibleClick",(function(){return t.addGroupAndOpenQuery()})),n.lc(),n.lc(),n.lc(),n.lc(),n.lc(),n.lc(),n.lc(),n.mc(17,"div",13),n.mc(18,"div",14),n.mc(19,"div",15),n.uc("dragulaModelChange",(function(e){return t.groups=e})),n.Yc(20,Ha,3,2,"ng-container",16),n.lc(),n.lc(),n.mc(21,"div",14),n.mc(22,"div",17),n.mc(23,"div",18),n.hc(24,"span",19),n.ad(25," "),n.hc(26,"span",20),n.lc(),n.mc(27,"div",21),n.uc("dragulaModelChange",(function(e){return t.inactives=e})),n.Yc(28,Ya,5,3,"div",22),n.lc(),n.lc(),n.lc(),n.lc()),2&e&&(n.Tb(6),n.Bc("textContent",t.text.reset),n.Tb(4),n.Bc("textContent",t.text.label_group),n.Tb(4),n.Bc("textContent",t.text.add_group),n.Tb(2),n.Bc("textContent",t.text.add_table),n.Tb(3),n.Bc("dragulaModel",t.groups),n.Tb(1),n.Bc("ngForOf",t.groups),n.Tb(4),n.Bc("textContent",t.text.label_inactive),n.Tb(2),n.Bc("textContent",t.text.drag_to_activate),n.Tb(1),n.Bc("dragulaModel",t.inactives),n.Tb(1),n.Bc("ngForOf",t.inactives))},encapsulation:2});class Xa{constructor(e,t){this.bannerService=e,this.cdRef=t,this.placeholder="",this.onValueChange=new n.s,this.editing=!1}ngOnInit(){this.editedName=this.name,this.name&&0!==this.name.length||this.startEditing()}startEditing(){this.bannerService.conditional(()=>this.bannerService.showEEOnlyHint(),()=>{this.editing=!0})}saveEdition(e){return this.leaveEditingMode(),this.name=this.editedName.trim(),this.cdRef.detectChanges(),""!==this.name&&this.onValueChange.emit(this.name),e.preventDefault(),e.stopPropagation(),!1}reset(){this.editing=!1,this.editedName=this.name}leaveEditingMode(){null!=this.editedName&&this.editedName.trim().length>0&&(this.editing=!1)}}function Ka(e,t){if(1&e&&n.hc(0,"span",12),2&e){const e=n.wc(2);n.Bc("textContent",e.text.custom_field)}}function Za(e,t){if(1&e){const e=n.nc();n.mc(0,"div",7),n.hc(1,"span",8),n.mc(2,"span",9),n.ad(3),n.Yc(4,Ka,1,1,"span",10),n.lc(),n.mc(5,"span",11),n.uc("click",(function(){n.Qc(e);const i=t.$implicit;return n.wc().removeFromGroup(i)})),n.lc(),n.lc()}if(2&e){const e=t.$implicit;n.Ub("data-key",e.key),n.Tb(3),n.cd(" ",e.translation," "),n.Tb(1),n.Bc("ngIf",e.is_cf)}}Xa.\u0275fac=function(e){return new(e||Xa)(n.gc(qa),n.gc(n.i))},Xa.\u0275cmp=n.ac({type:Xa,selectors:[["group-edit-in-place"]],inputs:{placeholder:"placeholder",name:"name"},outputs:{onValueChange:"onValueChange"},decls:2,vars:2,consts:[["class","group-edit-handler",3,"textContent","click",4,"ngIf"],["class","group-edit-in-place--input","type","text","autoFocus","",3,"ngModel","ngModelChange","blur","keydown.escape","keydown.enter",4,"ngIf"],[1,"group-edit-handler",3,"textContent","click"],["type","text","autoFocus","",1,"group-edit-in-place--input",3,"ngModel","ngModelChange","blur","keydown.escape","keydown.enter"],["nameInput",""]],template:function(e,t){1&e&&(n.Yc(0,Ua,1,1,"div",0),n.Yc(1,Ga,2,2,"input",1)),2&e&&(n.Bc("ngIf",!t.editing),n.Tb(1),n.Bc("ngIf",t.editing))},directives:[X.q,l.c,mn.a,l.m,l.p],encapsulation:2,changeDetection:0});class Ja{constructor(e,t){this.I18n=e,this.cdRef=t,this.deleteGroup=new n.s,this.removeAttribute=new n.s,this.text={custom_field:this.I18n.t("js.admin.type_form.custom_field")}}rename(e){this.group.name=e,delete this.group.key,this.cdRef.detectChanges()}removeFromGroup(e){this.group.attributes=this.group.attributes.filter(t=>t!==e),this.removeAttribute.emit(e)}}Ja.\u0275fac=function(e){return new(e||Ja)(n.gc(C.a),n.gc(n.i))},Ja.\u0275cmp=n.ac({type:Ja,selectors:[["type-form-attribute-group"]],inputs:{group:"group"},outputs:{deleteGroup:"deleteGroup",removeAttribute:"removeAttribute"},decls:7,vars:3,consts:[[1,"type-form-conf-group"],[1,"group-head"],[1,"group-handle","icon-drag-handle"],[1,"group-name",3,"name","onValueChange"],[1,"delete-group","icon-small","icon-close",3,"click"],["dragula","attributes",1,"attributes",3,"dragulaModel","dragulaModelChange"],["class","type-form-conf-attribute",4,"ngFor","ngForOf"],[1,"type-form-conf-attribute"],[1,"attribute-handle","icon-drag-handle"],[1,"attribute-name"],["class","attribute-cf-label",3,"textContent",4,"ngIf"],[1,"delete-attribute","icon-small","icon-close",3,"click"],[1,"attribute-cf-label",3,"textContent"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.hc(2,"span",2),n.mc(3,"group-edit-in-place",3),n.uc("onValueChange",(function(e){return t.rename(e)})),n.lc(),n.mc(4,"span",4),n.uc("click",(function(){return t.deleteGroup.emit()})),n.lc(),n.lc(),n.mc(5,"div",5),n.uc("dragulaModelChange",(function(e){return t.group.attributes=e})),n.Yc(6,Za,6,3,"div",6),n.lc(),n.lc()),2&e&&(n.Tb(3),n.Bc("name",t.group.name),n.Tb(2),n.Bc("dragulaModel",t.group.attributes),n.Tb(1),n.Bc("ngForOf",t.group.attributes))},directives:[Xa,Na.a,X.p,X.q],encapsulation:2,changeDetection:0});class er{constructor(e,t){this.I18n=e,this.cdRef=t,this.text={edit_query:this.I18n.t("js.admin.type_form.edit_query")},this.editQuery=new n.s,this.deleteGroup=new n.s}rename(e){this.group.name=e,this.cdRef.detectChanges()}}er.\u0275fac=function(e){return new(e||er)(n.gc(C.a),n.gc(n.i))},er.\u0275cmp=n.ac({type:er,selectors:[["type-form-query-group"]],inputs:{group:"group"},outputs:{editQuery:"editQuery",deleteGroup:"deleteGroup"},decls:9,vars:2,consts:[[1,"type-form-conf-group","type-form-query-group"],[1,"group-head"],[1,"group-handle","icon-drag-handle"],[1,"group-name",3,"name","onValueChange"],[1,"delete-group","icon-small","icon-close",3,"click"],[1,"type-form-query"],[1,"type-form-query-group--edit-button",3,"click"],["icon-classes","button--icon icon-edit"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.hc(2,"span",2),n.mc(3,"group-edit-in-place",3),n.uc("onValueChange",(function(e){return t.rename(e)})),n.lc(),n.mc(4,"span",4),n.uc("click",(function(){return t.deleteGroup.emit()})),n.lc(),n.lc(),n.mc(5,"div",5),n.mc(6,"span",6),n.uc("click",(function(){return t.editQuery.emit()})),n.hc(7,"op-icon",7),n.ad(8),n.lc(),n.lc(),n.lc()),2&e&&(n.Tb(3),n.Bc("name",t.group.name),n.Tb(5),n.cd(" ",t.text.edit_query," "))},directives:[Xa,yt.a],encapsulation:2,changeDetection:0});class tr{}function ir(e,t){if(1&e){const e=n.nc();n.mc(0,"div",9),n.uc("click",(function(i){n.Qc(e);const s=t.$implicit;return n.wc().select(i,s)})),n.lc()}if(2&e){const e=t.$implicit;n.Bc("id",e.identifier)("textContent",e.title)}}function nr(e,t){if(1&e&&n.hc(0,"enterprise-banner",10),2&e){const e=n.wc();n.Bc("linkMessage",e.text.upsale_link)("textMessage",e.text.upsale_text)}}tr.\u0275mod=n.ec({type:tr}),tr.\u0275inj=n.dc({factory:function(e){return new(e||tr)},providers:[],imports:[[Na.b.forRoot(),b.a]]}),n.Uc(Wa,[Na.a,$t.UISref,$t.AnchorUISref,$t.UIView,$t.UISrefActive,$t.UISrefStatus,X.n,X.o,X.p,X.q,X.x,X.t,X.u,X.v,X.w,X.r,X.s,l.C,l.r,l.B,l.c,l.s,l.v,l.a,l.y,l.z,l.u,l.m,l.n,l.x,l.k,l.j,l.t,l.b,l.d,l.p,l.q,l.o,cn.a,cn.b,cn.h,cn.e,je.e,je.f,je.a,je.b,je.d,je.c,on.a,ln.a,dn.a,un.a,un.n,un.d,un.c,un.e,un.f,un.g,un.h,un.i,un.j,un.k,un.l,un.m,hn.a,pn.a,gn.a,yt.a,mn.a,fn.a,B.a,bn.a,wn.a,vn.a,yn.a,kn.a,Cn.a,jn.a,xn.a,Tn.a,Sn.a,At.a,_n.a,De.a,Ht.a,Pn.a,In.a,Be.a,Gt.a,On.a,Ce.c,Ce.d,Ce.a,Ce.b,Ce.e,Rn.a,Bn.a,Ja,er,Wa,Xa],[X.a,X.C,X.m,X.j,X.A,X.f,X.z,X.B,X.c,X.e,X.h,X.i,X.k]);class sr extends st.a{constructor(e,t,i,n,s,a){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.widgetsService=n,this.i18n=s,this.bannerService=a,this.text={title:this.i18n.t("js.grid.add_widget"),close_popup:this.i18n.t("js.button_close"),upsale_link:this.i18n.t("js.grid.upsale.link"),upsale_text:this.i18n.t("js.grid.upsale.text")},this.eeShowBanners=!1}ngOnInit(){super.ngOnInit(),this.eeShowBanners=this.bannerService.eeShowBanners}get selectable(){return this.eligibleWidgets.sort((e,t)=>e.title.localeCompare(t.title))}select(e,t){this.chosenWidget=t,this.closeMe(e)}trackWidgetBy(e){return e.identifier}get eligibleWidgets(){let e=this.locals.schema.widgets.allowedValues.map(e=>e.identifier);return this.widgetsService.registered.filter(t=>e.includes(t.identifier))}}sr.\u0275fac=function(e){return new(e||sr)(n.gc(n.q),n.gc(I.a),n.gc(n.i),n.gc(Et),n.gc(C.a),n.gc(Da.a))},sr.\u0275cmp=n.ac({type:sr,selectors:[["ng-component"]],features:[n.Qb],decls:9,vars:5,consts:[[1,"op-modal--portal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","confirm-dialog--modal","loading-indicator--location"],[1,"op-modal--modal-header"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[1,"icon-context","icon-attention",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],["class","grid--addable-widget",3,"id","textContent","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--add-widget-ee","opReferrer","grids#add-widget",3,"linkMessage","textMessage",4,"ngIf"],[1,"grid--addable-widget",3,"id","textContent","click"],["opReferrer","grids#add-widget",1,"grid--add-widget-ee",3,"linkMessage","textMessage"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.mc(3,"a",3),n.mc(4,"i",4),n.uc("click",(function(e){return t.closeMe(e)})),n.lc(),n.lc(),n.hc(5,"h3",5),n.lc(),n.mc(6,"div",6),n.Yc(7,ir,1,2,"div",7),n.Yc(8,nr,1,2,"enterprise-banner",8),n.lc(),n.lc(),n.lc()),2&e&&(n.Tb(4),n.Ub("title",t.text.close_popup),n.Tb(1),n.Bc("textContent",t.text.title),n.Tb(2),n.Bc("ngForOf",t.selectable)("ngForTrackBy",t.trackWidgetBy),n.Tb(1),n.Bc("ngIf",t.eeShowBanners))},directives:[X.p,X.q,On.a],encapsulation:2});class ar{constructor(e){this.layout=e}down(e,t){let i=[],n=this.layout.widgetAreas.slice(0);for(t&&(n=n.filter(e=>e.guid!==t.guid)),n.sort((e,t)=>t.startRow-e.startRow);null!==e;)i.push(e),n=n.filter(t=>t.guid!==e.guid),e=this.moveOneDown(i,n)}moveOneDown(e,t){let i=this.firstAreaToMove(e,t);if(i){let e=i[0],t=i[1],n=e.widget.height;return e.startRow=t.endRow,e.endRow=e.startRow+n,this.layout.numRows<e.endRow-1&&(this.layout.numRows=e.endRow-1),e}return null}firstAreaToMove(e,t){let i=null,n=null;if(t.forEach(t=>{e.forEach(e=>{if(e.overlaps(t))return i=e,void(n=t)})}),null!==n){let t=i;return e.forEach(e=>{e.endRow>t.endRow&&n.columnOverlaps(e)&&(t=e)}),[n,t]}return null}}ar.\u0275fac=function(e){return new(e||ar)(n.qc(Re))},ar.\u0275prov=n.cc({token:ar,factory:ar.\u0275fac});var rr=i("gcYM"),cr=i("/uUt");class or{constructor(e,t){this.layout=e,this.move=t,this.setupMousedOverAreaSubscription()}ngOnDestroy(){this.mousedOverAreaObserver.unsubscribe()}setupMousedOverAreaSubscription(){this.mousedOverAreaObserver=this.layout.$mousedOverArea.pipe(Object(rr.a)(10),Object(cr.a)(),Object(ps.a)(e=>this.currentlyDragging&&!!e&&!this.layout.isGap(e)&&(this.placeholderArea.startRow!==e.startRow||this.placeholderArea.startColumn!==e.startColumn))).subscribe(e=>{this.updateArea(e),this.layout.scrollPlaceholderIntoView()})}updateArea(e){this.layout.resetAreas(this.draggedArea),this.moveAreasOnDragging(e)}moveAreasOnDragging(e){if(!this.placeholderArea)return;let t=this.draggedArea;this.copyPositionButRestrict(e,this.placeholderArea),this.move.down(this.placeholderArea,t)}get currentlyDragging(){return!!this.draggedArea}isDropOnlyArea(e){return!this.currentlyDragging&&e.endRow===this.layout.numRows+2}isDragged(e){return this.currentlyDragging&&this.draggedArea.guid===e.guid}isPassive(e){return this.currentlyDragging&&!this.isDragged(e)}get isDraggable(){return this.layout.isEditable}start(e){this.placeholderArea=new _e(e.widget),this.draggedHeight=document.getElementById(e.guid).offsetHeight-2,this.draggedArea=e}abort(){document.dispatchEvent(new Event("mouseup")),this.draggedArea=null,this.placeholderArea=null,this.layout.resetAreas()}drop(){this.draggedArea&&(this.placeholderArea.copyDimensionsTo(this.draggedArea),this.draggedArea.unchangedSize||(this.layout.writeAreaChangesToWidgets(),this.layout.cleanupUnusedAreas(),this.layout.rebuildAndPersist()),this.draggedArea=null,this.placeholderArea=null)}copyPositionButRestrict(e,t){t.startRow=e.startRow,e.startRow===this.layout.numRows+1?t.endRow=this.layout.numRows+2:e.startRow+t.widget.height>this.layout.numRows+1?t.endRow=this.layout.numRows+1:t.endRow=e.startRow+t.widget.height,t.startColumn=e.startColumn,e.startColumn+t.widget.width>this.layout.numColumns+1?t.endColumn=this.layout.numColumns+1:t.endColumn=e.startColumn+t.widget.width}}or.\u0275fac=function(e){return new(e||or)(n.qc(Re),n.qc(ar))},or.\u0275prov=n.cc({token:or,factory:or.\u0275fac});class lr{constructor(e,t,i){this.layout=e,this.move=t,this.drag=i}end(e){this.resizedArea&&(this.resizedArea=null,e.unchangedSize||(this.layout.writeAreaChangesToWidgets(),this.layout.cleanupUnusedAreas(),this.layout.rebuildAndPersist()))}abort(){this.resizedArea&&(this.layout.resetAreas(),this.resizedArea=null)}start(e){this.resizedArea=e;let t=this.layout.gridAreas.filter(e=>{let t=e.startRow===this.resizedArea.startRow&&e.startColumn>=this.resizedArea.startColumn,i=e.startRow>this.resizedArea.startRow&&e.startColumn>=this.resizedArea.startColumn&&this.layout.widgetAreas.some(t=>t.startRow===e.startRow&&(t.endColumn<=this.resizedArea.startColumn||t.startColumn>=e.endColumn));return t||i});this.targetIds=t.map(e=>e.guid)}moving(e){this.resizedArea&&this.layout.mousedOverArea&&this.targetIds.includes(this.layout.mousedOverArea.guid)&&(this.layout.resetAreas(),this.resizedArea.endRow=this.layout.mousedOverArea.endRow,this.resizedArea.endColumn=this.layout.mousedOverArea.endColumn,this.move.down(this.resizedArea,this.resizedArea))}isTarget(e){let t=e.guid;return this.resizedArea&&this.targetIds.includes(t)}isResized(e){return this.resizedArea&&this.resizedArea.guid===e.guid}isPassive(e){return this.currentlyResizing&&!this.isResized(e)}get currentlyResizing(){return!!this.resizedArea}get isResizable(){return!this.drag.currentlyDragging&&this.isAllowed}get isAllowed(){return this.layout.gridResource.updateImmediately}}lr.\u0275fac=function(e){return new(e||lr)(n.qc(Re),n.qc(ar),n.qc(or))},lr.\u0275prov=n.cc({token:lr,factory:lr.\u0275fac});class dr{constructor(e,t,i,n,s,a,r,c){this.opModalService=e,this.injector=t,this.halResource=i,this.layout=n,this.drag=s,this.move=a,this.resize=r,this.i18n=c,this.text={add:this.i18n.t("js.grid.add_widget")}}isAddable(e){return!this.drag.currentlyDragging&&!this.resize.currentlyResizing&&(this.layout.mousedOverArea===e||this.layout.isSingleCell||this.layout.inHelpMode)&&this.isAllowed}widget(e){this.select(e).then(t=>{this.layout.isGap(e)&&this.addLine(e);let i=new _e(t);this.setMaxWidth(i),this.persist(i)}).catch(()=>{})}get addText(){return this.text.add}select(e){return new Promise((t,i)=>{this.opModalService.show(sr,this.injector,{schema:this.layout.schema}).closingEvent.subscribe(n=>{let s=n.chosenWidget;if(!s)return void i();let a={_type:"GridWidget",identifier:s.identifier,startRow:e.startRow,endRow:e.endRow,startColumn:e.startColumn,endColumn:e.endColumn,options:s.properties||{}},r=this.halResource.createHalResource(a);r.grid=this.layout.gridResource,t(r)})})}addLine(e){e.isRow?this.layout.addRow(e.startRow-1,e.startColumn):e.isColumn&&this.layout.addColumn(e.startColumn-1,e.startRow)}setMaxWidth(e){e.endColumn=this.layout.numColumns+1,this.layout.widgetAreas.forEach(t=>{e.startColumnOverlaps(t)&&(e.endColumn=t.startColumn)})}persist(e){e.writeAreaChangeToWidget(),this.layout.widgetAreas.push(e),this.layout.widgetResources.push(e.widget),this.layout.rebuildAndPersist()}get isAllowed(){return this.layout.gridResource&&this.layout.gridResource.updateImmediately}}dr.\u0275fac=function(e){return new(e||dr)(n.qc(I.b),n.qc(n.A),n.qc(j.a),n.qc(Re),n.qc(or),n.qc(ar),n.qc(lr),n.qc(C.a))},dr.\u0275prov=n.cc({token:dr,factory:dr.\u0275fac});class ur{constructor(e,t,i,n,s,a,r,c,o){this.gridInitialization=e,this.pathHelper=t,this.currentProject=i,this.i18n=n,this.cdRef=s,this.title=a,this.addWidget=r,this.renderer=c,this.areas=o,this.text={title:this.i18n.t(`js.${this.i18nNamespace()}.label`),html_title:this.i18n.t(`js.${this.i18nNamespace()}.label`)}}ngOnInit(){this.renderer.addClass(document.body,"widget-grid-layout"),this.gridInitialization.initialize(this.gridScopePath()).then(e=>{this.grid=e,this.cdRef.detectChanges()}),this.setHtmlTitle()}ngOnDestroy(){this.renderer.removeClass(document.body,"widget-grid-layout")}setHtmlTitle(){this.title.setTitle(this.text.html_title)}}ur.\u0275fac=function(e){return new(e||ur)(n.gc(ii),n.gc(V.a),n.gc(Te.a),n.gc(C.a),n.gc(n.i),n.gc(N.e),n.gc(dr),n.gc(n.S),n.gc(Re))},ur.\u0275dir=n.bc({type:ur});i("uhGA");function hr(e,t){if(1&e&&n.hc(0,"span",10),2&e){const e=n.wc(2);n.Bc("hidden",e.isMobileDevice)}}function pr(e,t){if(1&e){const e=n.nc();n.mc(0,"resizer",11),n.uc("end",(function(){n.Qc(e);const t=n.wc().$implicit;return n.wc().resize.end(t)}))("start",(function(){n.Qc(e);const t=n.wc().$implicit;return n.wc().resize.start(t)}))("move",(function(t){return n.Qc(e),n.wc(2).resize.moving(t)})),n.mc(1,"div",12),n.hc(2,"i",13),n.lc(),n.lc()}2&e&&n.Bc("customHandler",!0)}const gr=function(e,t,i){return{"-dragged":e,"-passive":t,"-resizing":i}};function mr(e,t){if(1&e){const e=n.nc();n.mc(0,"div",5),n.mc(1,"div",6),n.uc("cdkDragStarted",(function(){n.Qc(e);const i=t.$implicit;return n.wc().drag.start(i)}))("cdkDragDropped",(function(){return n.Qc(e),n.wc().drag.drop()})),n.Yc(2,hr,1,1,"span",7),n.hc(3,"ndc-dynamic",8),n.lc(),n.Yc(4,pr,3,1,"resizer",9),n.lc()}if(2&e){const e=t.$implicit,i=n.wc();n.Xc("grid-row-start",e.gridStartRow)("grid-row-end",e.gridEndRow)("grid-column-start",e.gridStartColumn)("grid-column-end",e.gridEndColumn),n.Bc("ngClass",n.Ic(18,gr,i.drag.isDragged(e),i.drag.isPassive(e)||i.resize.isPassive(e),i.resize.isResized(e)))("id",e.guid)("cdkDropListData",e)("cdkDropListConnectedTo",i.layout.gridAreaIds),n.Tb(1),n.Bc("cdkDragDisabled",i.isMobileDevice||!i.drag.isDraggable),n.Tb(1),n.Bc("ngIf",i.drag.isDraggable),n.Tb(1),n.Bc("ndcDynamicComponent",i.widgetComponent(e))("ndcDynamicInputs",i.widgetComponentInput(e))("ndcDynamicOutputs",i.widgetComponentOutput(e)),n.Tb(1),n.Bc("ngIf",i.resize.isResizable)}}function fr(e,t){if(1&e){const e=n.nc();n.mc(0,"div",16),n.uc("click",(function(){n.Qc(e);const t=n.wc().$implicit;return n.wc().add.widget(t)})),n.lc()}if(2&e){const e=n.wc(2);n.Bc("title",e.add.addText)}}const br=function(e,t,i,n,s){return{"-drop-target":e,"-drop-only":t,"-resize-target":i,"-addable":n,"-help-mode":s}};function wr(e,t){if(1&e){const e=n.nc();n.mc(0,"div",14),n.uc("mouseover",(function(){n.Qc(e);const i=t.$implicit;return n.wc().layout.setMousedOverArea(i)})),n.Yc(1,fr,1,1,"div",15),n.lc()}if(2&e){const e=t.$implicit,i=n.wc();n.Xc("grid-row-start",e.gridStartRow)("grid-row-end",e.gridEndRow)("grid-column-start",e.gridStartColumn)("grid-column-end",e.gridEndColumn),n.Bc("ngClass",n.Kc(13,br,i.drag.currentlyDragging,i.drag.isDropOnlyArea(e),i.resize.isTarget(e),i.add.isAddable(e),i.layout.inHelpMode))("id",e.guid)("cdkDropListData",e)("cdkDropListConnectedTo",i.layout.gridAreaIds),n.Tb(1),n.Bc("ngIf",i.add.isAllowed)}}function vr(e,t){if(1&e){const e=n.nc();n.mc(0,"div",19),n.uc("click",(function(){n.Qc(e);const t=n.wc().$implicit;return n.wc().add.widget(t)})),n.lc()}if(2&e){const e=n.wc(2);n.Bc("title",e.add.addText)}}const yr=function(e,t,i,n){return{"-addable":e,"-help-mode":t,"-row":i,"-column":n}};function kr(e,t){if(1&e){const e=n.nc();n.mc(0,"div",17),n.uc("mouseover",(function(){n.Qc(e);const i=t.$implicit;return n.wc().layout.setMousedOverArea(i)})),n.Yc(1,vr,1,1,"div",18),n.lc()}if(2&e){const e=t.$implicit,i=n.wc();n.Xc("grid-row-start",e.gridStartRow)("grid-row-end",e.gridEndRow)("grid-column-start",e.gridStartColumn)("grid-column-end",e.gridEndColumn),n.Bc("ngClass",n.Jc(11,yr,i.add.isAddable(e),i.layout.inHelpMode,e.isRow,e.isColumn))("id",e.guid),n.Tb(1),n.Bc("ngIf",i.add.isAllowed)}}function Cr(e,t){if(1&e&&(n.mc(0,"div",20),n.hc(1,"div",21),n.lc()),2&e){const e=n.wc();n.Xc("grid-row-start",e.drag.placeholderArea.gridStartRow)("grid-row-end",e.drag.placeholderArea.gridEndRow)("grid-column-start",e.drag.placeholderArea.gridStartColumn)("grid-column-end",e.drag.placeholderArea.gridEndColumn)("min-height",e.drag.draggedHeight,"px")}}const jr=[Re,ar,or,lr,dr,Fe];class xr{constructor(e,t,i,n,s,a,r,c){this.sanitization=e,this.widgetsService=t,this.drag=i,this.resize=n,this.layout=s,this.add=a,this.remove=r,this.browserDetector=c,this.uiWidgets=[],this.GRID_AREA_HEIGHT="auto",this.GRID_GAP_DIMENSION="20px",this.component=Oi}ngOnInit(){this.layout.gridResource=this.grid}ngOnDestroy(){this.uiWidgets.forEach(e=>e.destroy())}handleKeyboardEvent(e){"Escape"===e.key&&(this.drag.currentlyDragging?this.drag.abort():this.resize.currentlyResizing&&this.resize.abort())}widgetComponent(e){let t=e.widget;if(!t)return null;let i=this.widgetsService.registered.find(e=>e.identifier===t.identifier);return i?i.component:null}widgetComponentInput(e){return{resource:e.widget}}widgetComponentOutput(e){return{resourceChanged:this.layout.saveWidgetChangeset.bind(this.layout)}}get gridColumnStyle(){return this.gridStyle(this.layout.numColumns,`calc((100% - ${this.GRID_GAP_DIMENSION} * ${this.layout.numColumns+1}) / ${this.layout.numColumns})`)}get gridRowStyle(){return this.gridStyle(this.layout.numRows,this.GRID_AREA_HEIGHT)}identifyGridArea(e,t){return t.guid}get isHeadersDisplayed(){return this.layout.isEditable}get isMobileDevice(){return this.browserDetector.isMobile}gridStyle(e,t){let i="";for(let n=0;n<e;n++)i+=`${this.GRID_GAP_DIMENSION} ${t} `;return i+=`${this.GRID_GAP_DIMENSION}`,this.sanitization.bypassSecurityTrustStyle(i)}}xr.\u0275fac=function(e){return new(e||xr)(n.gc(N.b),n.gc(Et),n.gc(or),n.gc(lr),n.gc(Re),n.gc(dr),n.gc(Fe),n.gc(It.a))},xr.\u0275cmp=n.ac({type:xr,selectors:[["grid"]],hostBindings:function(e,t){1&e&&n.uc("keyup",(function(e){return t.handleKeyboardEvent(e)}),!1,n.Pc)},inputs:{grid:"grid"},decls:5,vars:11,consts:[[1,"grid--container"],["class","grid--area -widgeted","cdkDropList","",3,"ngClass","grid-row-start","grid-row-end","grid-column-start","grid-column-end","id","cdkDropListData","cdkDropListConnectedTo",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--area hidden-for-mobile","cdkDropList","",3,"ngClass","grid-row-start","grid-row-end","grid-column-start","grid-column-end","id","cdkDropListData","cdkDropListConnectedTo","mouseover",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--area -gap hidden-for-mobile",3,"ngClass","grid-row-start","grid-row-end","grid-column-start","grid-column-end","id","mouseover",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--area -widgeted -placeholder",3,"grid-row-start","grid-row-end","grid-column-start","grid-column-end","min-height",4,"ngIf"],["cdkDropList","",1,"grid--area","-widgeted",3,"ngClass","id","cdkDropListData","cdkDropListConnectedTo"],["cdkDrag","",1,"grid--area-content","widget-box",3,"cdkDragDisabled","cdkDragStarted","cdkDragDropped"],["class","grid--area-drag-handle\n                   icon\n                   icon-drag-handle\n                   hidden-for-mobile","cdkDragHandle","",3,"hidden",4,"ngIf"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"],[3,"customHandler","end","start","move",4,"ngIf"],["cdkDragHandle","",1,"grid--area-drag-handle","icon","icon-drag-handle","hidden-for-mobile",3,"hidden"],[3,"customHandler","end","start","move"],[1,"grid--resizer"],["aria-hidden","true",1,"icon-resizer-bottom-right","hidden-for-mobile"],["cdkDropList","",1,"grid--area","hidden-for-mobile",3,"ngClass","id","cdkDropListData","cdkDropListConnectedTo","mouseover"],["class","grid--widget-add",3,"title","click",4,"ngIf"],[1,"grid--widget-add",3,"title","click"],[1,"grid--area","-gap","hidden-for-mobile",3,"ngClass","id","mouseover"],["class","grid--widget-add -gap",3,"title","click",4,"ngIf"],[1,"grid--widget-add","-gap",3,"title","click"],[1,"grid--area","-widgeted","-placeholder"],[1,"widget-box"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.Yc(1,mr,5,22,"div",1),n.Yc(2,wr,2,19,"div",2),n.Yc(3,kr,2,16,"div",3),n.Yc(4,Cr,2,10,"div",4),n.lc()),2&e&&(n.Xc("grid-template-columns",t.gridColumnStyle)("grid-template-rows",t.gridRowStyle),n.Tb(1),n.Bc("ngForOf",t.layout.widgetAreas)("ngForTrackBy",t.identifyGridArea),n.Tb(1),n.Bc("ngForOf",t.layout.gridAreas)("ngForTrackBy",t.identifyGridArea),n.Tb(1),n.Bc("ngForOf",t.layout.gridGaps)("ngForTrackBy",t.identifyGridArea),n.Tb(1),n.Bc("ngIf",t.drag.placeholderArea))},directives:[X.p,X.q,je.e,X.n,je.a,Ce.c,Ce.d,je.b,xn.a],encapsulation:2});const Tr=function(e){return{"-active":e}};function Sr(e,t){if(1&e){const e=n.nc();n.mc(0,"button",9),n.uc("click",(function(){return n.Qc(e),n.wc().areas.toggleHelpMode()})),n.hc(1,"op-icon",10),n.lc()}if(2&e){const e=n.wc();n.Bc("title",e.addWidget.addText)("ngClass",n.Gc(2,Tr,e.areas.inHelpMode))}}function _r(e,t){if(1&e&&n.hc(0,"grid",11),2&e){const e=n.wc();n.Bc("grid",e.grid)}}class Pr extends ur{i18nNamespace(){return"dashboards"}gridScopePath(){return this.pathHelper.projectDashboardsPath(this.currentProject.identifier)}}Pr.\u0275fac=function(e){return Ir(e||Pr)},Pr.\u0275cmp=n.ac({type:Pr,selectors:[["dashboard"]],features:[n.Sb(jr),n.Qb],decls:10,vars:3,consts:[[1,"toolbar-container"],[1,"toolbar"],[1,"title-container"],[3,"textContent"],[1,"toolbar-items","hidden-for-mobile"],[1,"toolbar-item","hidden-for-mobile"],[1,"toolbar-item"],["class","button",3,"title","ngClass","click",4,"ngIf"],[3,"grid",4,"ngIf"],[1,"button",3,"title","ngClass","click"],["icon-classes","button--icon icon-add"],[3,"grid"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.hc(3,"h2",3),n.lc(),n.mc(4,"ul",4),n.mc(5,"li",5),n.hc(6,"zen-mode-toggle-button"),n.lc(),n.mc(7,"li",6),n.Yc(8,Sr,2,4,"button",7),n.lc(),n.lc(),n.lc(),n.lc(),n.Yc(9,_r,1,1,"grid",8)),2&e&&(n.Tb(3),n.Bc("textContent",t.text.title),n.Tb(5),n.Bc("ngIf",t.addWidget.isAllowed),n.Tb(1),n.Bc("ngIf",t.grid))},directives:[At.a,X.q,X.n,yt.a,xr],styles:[".title-container[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:-5px}.toolbar-container[_ngcontent-%COMP%]{margin-bottom:0}.toolbar-items[_ngcontent-%COMP%]{padding-right:20px}@media only screen and (max-width:679px){.title-container[_ngcontent-%COMP%]{margin-left:0;margin-bottom:0}}"]});const Ir=n.oc(Pr),Or=[{name:"dashboards",parent:"root",url:"/dashboards/",data:{bodyClasses:["router--dashboards-view-base","widget-grid-layout"],menuItem:"dashboards-menu-item"},component:Pr}];class Rr{}function Br(e,t){if(1&e&&(n.mc(0,"div",1),n.hc(1,"wp-single-card",2),n.lc()),2&e){const e=n.wc();n.Tb(1),n.Bc("workPackage",e.workPackage)}}Rr.\u0275mod=n.ec({type:Rr}),Rr.\u0275inj=n.dc({factory:function(e){return new(e||Rr)},providers:[],imports:[[b.a,ga,$t.UIRouterModule.forChild({states:Or,config:function(e){e.urlService.rules.when(new RegExp("^/projects/(.*)/dashboards$"),e=>`/projects/${e[1]}/dashboards/`)}})]]});class Er extends st.a{constructor(e,t,i,n,s,a){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.i18n=n,this.wpCacheService=s,this.opModalService=a,this.text={created_by:this.i18n.t("js.label_created_by")}}ngOnInit(){super.ngOnInit();const e=this.locals.workPackageLink,t=F.a.idFromLink(e);this.wpCacheService.require(t).then(e=>{this.workPackage=e,this.cdRef.detectChanges();const t=jQuery(this.elementRef.nativeElement).find(".preview-modal--container");this.reposition(t,this.locals.event.target)})}reposition(e,t){e.position({my:"right top",at:"right bottom",of:t,collision:"flipfit"})}}Er.\u0275fac=function(e){return new(e||Er)(n.gc(n.q),n.gc(I.a),n.gc(n.i),n.gc(C.a),n.gc(A.a),n.gc(I.b))},Er.\u0275cmp=n.ac({type:Er,selectors:[["ng-component"]],features:[n.Qb],decls:1,vars:1,consts:[["class","preview-modal--container","wp-isolated-query-space","",4,"ngIf"],["wp-isolated-query-space","",1,"preview-modal--container"],["orientation","horizontal",3,"workPackage"]],template:function(e,t){1&e&&n.Yc(0,Br,2,1,"div",0),2&e&&n.Bc("ngIf",t.workPackage)},directives:[X.q,Ne.a,Dn.a],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.preview-modal--container[_ngcontent-%COMP%]{position:absolute;z-index:5000;min-width:350px;padding:0;box-shadow:0 0 5px 2px rgba(0,0,0,.25)}"],changeDetection:0});class Mr{constructor(e,t){this.opModalService=e,this.injector=t}setupListener(){jQuery(document.body).on("mouseenter",".preview-trigger",e=>{e.preventDefault(),e.stopPropagation();const t=jQuery(e.target),i=t.attr("href");i&&(this.previewModal=this.opModalService.show(Er,this.injector,{workPackageLink:i,event:e}),this.modalElement=this.previewModal.elementRef.nativeElement,this.previewModal.reposition(jQuery(this.modalElement),t),jQuery(this.modalElement).addClass("-no-width -no-height"))}),jQuery(document.body).on("mouseleave",".preview-trigger",e=>{e.preventDefault(),e.stopPropagation(),this.isMouseOverPreview(e)?jQuery(this.modalElement).on("mouseleave",()=>{this.opModalService.close()}):this.opModalService.close()})}isMouseOverPreview(e){if(!this.modalElement)return!1;const t=jQuery(this.modalElement.children[0]);if(t&&t.offset()){let i=e.pageX>=Math.floor(t.offset().left)&&e.pageX<t.offset().left+t.width(),n=e.pageY>=Math.floor(t.offset().top)&&e.pageY<t.offset().top+t.height();return i&&n}return!1}}Mr.\u0275fac=function(e){return new(e||Mr)(n.qc(I.b),n.qc(n.A))},Mr.\u0275prov=n.cc({token:Mr,factory:Mr.\u0275fac,providedIn:"root"});const Fr=function(e){return{"-active":e}};function Ar(e,t){if(1&e){const e=n.nc();n.mc(0,"button",9),n.uc("click",(function(){return n.Qc(e),n.wc().areas.toggleHelpMode()})),n.hc(1,"op-icon",10),n.lc()}if(2&e){const e=n.wc();n.Bc("title",e.addWidget.addText)("ngClass",n.Gc(2,Fr,e.areas.inHelpMode))}}function Dr(e,t){if(1&e&&n.hc(0,"grid",11),2&e){const e=n.wc();n.Bc("grid",e.grid)}}class qr extends ur{i18nNamespace(){return"overviews"}gridScopePath(){return this.pathHelper.projectPath(this.currentProject.identifier)}}qr.\u0275fac=function(e){return Lr(e||qr)},qr.\u0275cmp=n.ac({type:qr,selectors:[["overview"]],features:[n.Sb(jr),n.Qb],decls:10,vars:3,consts:[[1,"toolbar-container"],[1,"toolbar"],[1,"title-container"],[3,"textContent"],[1,"toolbar-items","hidden-for-mobile"],[1,"toolbar-item","hidden-for-mobile"],[1,"toolbar-item"],["class","button",3,"title","ngClass","click",4,"ngIf"],[3,"grid",4,"ngIf"],[1,"button",3,"title","ngClass","click"],["icon-classes","button--icon icon-add"],[3,"grid"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.hc(3,"h2",3),n.lc(),n.mc(4,"ul",4),n.mc(5,"li",5),n.hc(6,"zen-mode-toggle-button"),n.lc(),n.mc(7,"li",6),n.Yc(8,Ar,2,4,"button",7),n.lc(),n.lc(),n.lc(),n.lc(),n.Yc(9,Dr,1,1,"grid",8)),2&e&&(n.Tb(3),n.Bc("textContent",t.text.title),n.Tb(5),n.Bc("ngIf",t.addWidget.isAllowed),n.Tb(1),n.Bc("ngIf",t.grid))},directives:[At.a,X.q,X.n,yt.a,xr],styles:[".title-container[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:-5px}.toolbar-container[_ngcontent-%COMP%]{margin-bottom:0}.toolbar-items[_ngcontent-%COMP%]{padding-right:20px}@media only screen and (max-width:679px){.title-container[_ngcontent-%COMP%]{margin-left:0;margin-bottom:0}}"]});const Lr=n.oc(qr),$r=[{name:"overview",parent:"root",url:"/",data:{menuItem:"overview-menu-item"},component:qr}];class Nr{}Nr.\u0275mod=n.ec({type:Nr}),Nr.\u0275inj=n.dc({factory:function(e){return new(e||Nr)},providers:[],imports:[[b.a,ga,$t.UIRouterModule.forChild({states:$r,config:function(e){e.urlService.rules.when(new RegExp("^/projects(?!/new$)/([^/]+)$"),e=>`/projects/${e[1]}/`)}})]]});const Qr=function(e){return{"-active":e}};function Vr(e,t){if(1&e){const e=n.nc();n.mc(0,"button",9),n.uc("click",(function(){return n.Qc(e),n.wc().areas.toggleHelpMode()})),n.hc(1,"op-icon",10),n.lc()}if(2&e){const e=n.wc();n.Bc("title",e.addWidget.addText)("ngClass",n.Gc(2,Qr,e.areas.inHelpMode))}}function Hr(e,t){if(1&e&&n.hc(0,"grid",11),2&e){const e=n.wc();n.Bc("grid",e.grid)}}class zr extends ur{i18nNamespace(){return"my_page"}gridScopePath(){return this.pathHelper.myPagePath()}}zr.\u0275fac=function(e){return Yr(e||zr)},zr.\u0275cmp=n.ac({type:zr,selectors:[["ng-component"]],features:[n.Sb(jr),n.Qb],decls:10,vars:3,consts:[[1,"toolbar-container"],[1,"toolbar"],[1,"title-container"],[3,"textContent"],[1,"toolbar-items","hidden-for-mobile"],[1,"toolbar-item","hidden-for-mobile"],[1,"toolbar-item"],["class","button",3,"title","ngClass","click",4,"ngIf"],[3,"grid",4,"ngIf"],[1,"button",3,"title","ngClass","click"],["icon-classes","button--icon icon-add"],[3,"grid"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.hc(3,"h2",3),n.lc(),n.mc(4,"ul",4),n.mc(5,"li",5),n.hc(6,"zen-mode-toggle-button"),n.lc(),n.mc(7,"li",6),n.Yc(8,Vr,2,4,"button",7),n.lc(),n.lc(),n.lc(),n.lc(),n.Yc(9,Hr,1,1,"grid",8)),2&e&&(n.Tb(3),n.Bc("textContent",t.text.title),n.Tb(5),n.Bc("ngIf",t.addWidget.isAllowed),n.Tb(1),n.Bc("ngIf",t.grid))},directives:[At.a,X.q,X.n,yt.a,xr],styles:[".title-container[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:-5px}.toolbar-container[_ngcontent-%COMP%]{margin-bottom:0}.toolbar-items[_ngcontent-%COMP%]{padding-right:20px}@media only screen and (max-width:679px){.title-container[_ngcontent-%COMP%]{margin-left:0;margin-bottom:0}}"]});const Yr=n.oc(zr),Wr=[{name:"my_page",url:"/my/page",component:zr,data:{bodyClasses:["router--work-packages-my-page","widget-grid-layout"],parent:"work-packages"}}];class Ur{}Ur.\u0275mod=n.ec({type:Ur}),Ur.\u0275inj=n.dc({factory:function(e){return new(e||Ur)},imports:[[b.a,ga,$t.UIRouterModule.forChild({states:Wr})]]});var Gr=i("GZlY"),Xr=i("7ond");const Kr={preview:1,newWorkPackage:2,edit:3,quickSearch:4,projectSearch:5,help:6,moreMenu:7,details:8};class Zr{constructor(e,t,i){this.PathHelper=e,this.FocusHelper=t,this.currentProject=i,this.shortcuts={"?":()=>this.showHelpModal(),"g m":this.globalAction("myPagePath"),"g o":this.projectScoped("projectPath"),"g w p":this.projectScoped("projectWorkPackagesPath"),"g w i":this.projectScoped("projectWikiPath"),"g a":this.projectScoped("projectActivityPath"),"g c":this.projectScoped("projectCalendarPath"),"g n":this.projectScoped("projectNewsPath"),"g t":this.projectScoped("projectTimelinesPath"),"n w p":this.projectScoped("projectWorkPackageNewPath"),"g e":this.accessKey("edit"),"g p":this.accessKey("preview"),"d w p":this.accessKey("details"),m:this.accessKey("moreMenu"),p:this.accessKey("projectSearch"),s:this.accessKey("quickSearch"),k:()=>this.focusPrevItem(),j:()=>this.focusNextItem()},this.register()}register(){_.each(this.shortcuts,(e,t)=>Mousetrap.bind(t,e))}accessKey(e){var t=Kr[e];return()=>{var e=jQuery("[accesskey="+t+"]:first");e.is("input")||"global-search-input"===e.attr("id")?setTimeout(()=>this.FocusHelper.focus(e),200):e.is("[href]")?this.clickLink(e[0]):e[0].click()}}globalAction(e){return()=>{var t=this.PathHelper[e]();window.location.href=t}}projectScoped(e){return()=>{var t=this.currentProject.identifier;if(t){var i=this.PathHelper[e](t);window.location.href=i}}}clickLink(e){var t=!1;if(document.createEvent){var i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});t=!e.dispatchEvent(i)}else e.fireEvent&&(t=!e.fireEvent("onclick"));t||(window.location.href=e.href)}showHelpModal(){window.open(this.PathHelper.keyboardShortcutsHelpPath())}findListInPage(){const e=jQuery("table.keyboard-accessible-list"),t=[];return e.find("tbody tr").each((function(e,i){var n=jQuery(i).find(":visible:tabbable")[0];void 0!==n&&t.push(n)})),t}focusItemOffset(e){const t=this.findListInPage();let i;if(null===t)return;i=t.indexOf(jQuery(document.activeElement).closest("table.keyboard-accessible-list tbody tr").find(":visible:tabbable")[0]),jQuery(t[(i+e+t.length)%t.length]).focus()}focusNextItem(){this.focusItemOffset(1)}focusPrevItem(){this.focusItemOffset(-1)}}Zr.\u0275fac=function(e){return new(e||Zr)(n.qc(V.a),n.qc(Xr.a),n.qc(Te.a))},Zr.\u0275prov=n.cc({token:Zr,factory:Zr.\u0275fac,providedIn:"root"});var Jr=i("saRB"),ec=i("RGDJ");function tc(e,t){if(1&e&&(n.mc(0,"span",3),n.ad(1),n.lc()),2&e){const e=t.item,i=n.wc();n.Bc("ngClass",i.highlightColor(e)),n.Tb(1),n.bd(e.name)}}function ic(e,t){if(1&e&&(n.mc(0,"span",3),n.ad(1),n.lc()),2&e){const e=t.item,i=n.wc();n.Bc("ngClass",i.highlightColor(e)),n.Tb(1),n.bd(e.name)}}class nc{constructor(e,t){this.elementRef=e,this.I18n=t,this.highlightTextInline=!1}ngOnInit(){this.setColorOptions(),this.updateInputField=document.getElementsByName(this.elementRef.nativeElement.dataset.updateInput)[0],this.highlightTextInline=JSON.parse(this.elementRef.nativeElement.dataset.highlightTextInline)}onModelChange(e){e&&this.updateInputField&&(this.updateInputField.value=e.value)}setColorOptions(){this.options=JSON.parse(this.elementRef.nativeElement.dataset.colors),this.options.unshift({name:this.I18n.t("js.label_no_color"),value:""}),this.selectedOption=this.options.find(e=>!0===e.selected),this.selectedOption?this.selectedOption=this.selectedOption.value:(this.selectedColorId=this.elementRef.nativeElement.dataset.selectedColor,this.selectedOption=this.selectedColorId?this.selectedColorId:"")}highlightColor(e){if(""===e.value)return;let t;return t=this.highlightTextInline?"__hl_inline_type_ ":"__hl_inline_ ",t+ec.a.colorClass(this.highlightTextInline,e.value)}}nc.\u0275fac=function(e){return new(e||nc)(n.gc(n.q),n.gc(C.a))},nc.\u0275cmp=n.ac({type:nc,selectors:[["colors-autocompleter"]],decls:3,vars:4,consts:[["bindLabel","name","bindValue","value","appendTo","body",3,"items","virtualScroll","ngModel","clearable","ngModelChange","change"],["ng-label-tmp",""],["ng-option-tmp",""],[3,"ngClass"]],template:function(e,t){1&e&&(n.mc(0,"ng-select",0),n.uc("ngModelChange",(function(e){return t.selectedOption=e}))("change",(function(e){return t.onModelChange(e)})),n.Yc(1,tc,2,2,"ng-template",1),n.Yc(2,ic,2,2,"ng-template",2),n.lc()),2&e&&n.Bc("items",t.options)("virtualScroll",!0)("ngModel",t.selectedOption)("clearable",!1)},directives:[un.a,l.m,l.p,un.e,un.c,X.n],encapsulation:2});var sc=i("Kj3r"),ac=i("itXk");function rc(e,t){if(1&e&&n.hc(0,"wp-embedded-table",1),2&e){const e=n.wc();n.Bc("queryProps",e.queryProps)("configuration",e.tableConfiguration)}}class cc extends Je.a{constructor(e,t,i,n,s,a,r,c,o,l,d){super(),this.FocusHelper=e,this.elementRef=t,this.renderer=i,this.I18n=n,this.halResourceService=s,this.globalSearchService=a,this.wpTableFilters=r,this.querySpace=c,this.wpFilters=o,this.cdRef=l,this.UrlParamsHelper=d,this.resultsHidden=!1,this.tableConfiguration={actionsColumnEnabled:!1,columnMenuEnabled:!0,contextMenuEnabled:!1,inlineCreateEnabled:!1,withFilters:!0,showFilterButton:!0,filterButtonText:this.I18n.t("js.button_advanced_filter")}}ngAfterViewInit(){Object(ac.a)([this.globalSearchService.searchTerm$,this.globalSearchService.projectScope$]).pipe(Object(Bi.a)(1),Object(cr.a)(),Object(sc.a)(10),this.untilDestroyed()).subscribe(([e,t])=>{this.wpFilters.visible=!1,this.setQueryProps()}),this.globalSearchService.resultsHidden$.pipe(this.untilDestroyed()).subscribe(e=>this.resultsHidden=e)}ngOnInit(){this.setQueryProps()}setQueryProps(){let e=[],t=["id","project","subject","type","status","updatedAt"];this.globalSearchService.searchTerm.length>0&&e.push({search:{operator:"**",values:[this.globalSearchService.searchTerm]}}),"current_project"===this.globalSearchService.projectScope&&(e.push({subprojectId:{operator:"!*",values:[]}}),t=["id","subject","type","status","updatedAt"]),""===this.globalSearchService.projectScope&&e.push({subprojectId:{operator:"*",values:[]}}),this.queryProps={"columns[]":t,filters:JSON.stringify(e),sortBy:JSON.stringify([["updatedAt","desc"]]),showHierarchies:!1}}}cc.\u0275fac=function(e){return new(e||cc)(n.gc(Xr.a),n.gc(n.q),n.gc(n.S),n.gc(C.a),n.gc(j.a),n.gc(Ma),n.gc(He.a),n.gc(Ve.a),n.gc(Qi.a),n.gc(n.i),n.gc(Ri.a))},cc.\u0275cmp=n.ac({type:cc,selectors:[["global-search-work-packages"]],features:[n.Qb],decls:1,vars:1,consts:[[3,"queryProps","configuration",4,"ngIf"],[3,"queryProps","configuration"]],template:function(e,t){1&e&&n.Yc(0,rc,1,2,"wp-embedded-table",0),2&e&&n.Bc("ngIf",!t.resultsHidden)},directives:[X.q,Di.a],encapsulation:2});class oc{constructor(e,t){this.i18n=e,this.domSanitizer=t,this.text={newFeatures:this.i18n.t("js.label_new_features"),descriptionNewFeatures:this.i18n.t("js.homescreen.blocks.new_features.text_new_features"),learnAbout:this.i18n.t("js.homescreen.blocks.new_features.learn_about")},this.i18nBase="js.homescreen.blocks.new_features.",this.isStandardEdition=window.OpenProject.isStandardEdition}get teaserWebsiteUrl(){let e=this.translated("learn_about_link");return this.domSanitizer.bypassSecurityTrustResourceUrl(e)}get currentNewFeatureHtml(){return this.translated("current_new_feature_html")}translated(e){return this.i18n.t(this.i18nBase+this.i18nPrefix+"."+e,{list_styling_class:"widget-box--arrow-links",bcf_api_link:"https://github.com/opf/openproject/blob/dev/docs/api/bcf/bcf-rest-api.md"})}get i18nPrefix(){return this.isStandardEdition?"standard":"bim"}}oc.\u0275fac=function(e){return new(e||oc)(n.gc(C.a),n.gc(N.b))},oc.\u0275cmp=n.ac({type:oc,selectors:[["homescreen-new-features-block"]],decls:7,vars:4,consts:[[1,"widget-box--additional-info"],[1,"widget-box--description"],[3,"innerHtml"],[1,"widget-box--teaser-image"],["target","_blank",3,"href"]],template:function(e,t){1&e&&(n.mc(0,"p",0),n.ad(1),n.lc(),n.mc(2,"div",1),n.hc(3,"p",2),n.hc(4,"a",3),n.lc(),n.mc(5,"a",4),n.ad(6),n.lc()),2&e&&(n.Tb(1),n.cd(" ",t.text.descriptionNewFeatures," "),n.Tb(2),n.Bc("innerHtml",t.currentNewFeatureHtml,n.Rc),n.Tb(2),n.Bc("href",t.teaserWebsiteUrl,n.Tc),n.Tb(1),n.bd(t.text.learnAbout))},styles:[".widget-box--description[_ngcontent-%COMP%]   .widget-box--teaser-image[_ngcontent-%COMP%]{background-image:var(--new-feature-teaser-image);min-width:170px;background-size:contain;background-repeat:no-repeat;background-position-x:right}"]});var lc=i("wOIT"),dc=i("yCBR");class uc{}uc.\u0275fac=function(e){return new(e||uc)},uc.\u0275cmp=n.ac({type:uc,selectors:[["global-search-work-packages-entry"]],decls:2,vars:0,consts:[["wp-isolated-query-space",""]],template:function(e,t){1&e&&(n.kc(0,0),n.hc(1,"global-search-work-packages"),n.jc())},directives:[Ne.a,cc],encapsulation:2});var hc=i("feia");class pc{constructor(e){this.elementRef=e,this.isHidden=!1}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.$targetNotification=this.getTargetNotification(),this.identifier=this.$element.data("identifier"),this.isHidden="true"===window.OpenProject.guardedLocalStorage(this.identifier),this.$targetNotification.prop("hidden",!!this.isHidden),this.$element.parent().find(".persistent-toggle--click-handler").on("click",()=>this.toggle(!this.isHidden)),this.$targetNotification.find(".notification-box--close").on("click",()=>this.toggle(!0))}getTargetNotification(){return this.$element.parent().find(".persistent-toggle--notification")}toggle(e){this.isHidden=e,window.OpenProject.guardedLocalStorage(this.identifier,(!!e).toString()),e?this.$targetNotification.slideUp(400,()=>{this.$targetNotification.prop("hidden",!0)}):(this.$targetNotification.slideDown(400),this.$targetNotification.prop("hidden",!1))}}pc.\u0275fac=function(e){return new(e||pc)(n.gc(n.q))},pc.\u0275cmp=n.ac({type:pc,selectors:[["persistent-toggle"]],decls:0,vars:0,template:function(e,t){},encapsulation:2});class gc{constructor(e){this.displayed=Object(o.f)(),this.all=[];const t=e.get("hideSections");this.all=t.all,this.displayed.putValue(t.active.map(e=>(this.toggleVisibility(e.key,!0),e.key))),this.removeHiddenOnSubmit()}section(e){return document.querySelector(`section.hide-section[data-section-name="${e}"]`)}hide(e){this.displayed.doModify(t=>t.filter(t=>t!==e)),this.toggleVisibility(e,!1)}show(e){this.displayed.doModify(t=>[...t,e]),this.toggleVisibility(e,!0)}toggleVisibility(e,t){const i=this.section(e);i&&(i.hidden=!t)}removeHiddenOnSubmit(){jQuery(document.body).on("submit","form",(function(e){const t=jQuery(this),i=t.find("section.hide-section:hidden");return!(!t.data("hideSectionRemoved")&&0!==i.length)||(t.data("hideSectionRemoved",!0),i.remove(),t.trigger("submit"),e.preventDefault(),!1)}))}}gc.\u0275fac=function(e){return new(e||gc)(n.qc($a.a))},gc.\u0275prov=n.cc({token:gc,factory:gc.\u0275fac,providedIn:"root"});class mc{constructor(e,t){this.elementRef=e,this.hideSectionService=t,this.displayed=!0}ngOnInit(){this.sectionName=this.elementRef.nativeElement.dataset.sectionName}hideSection(){return this.hideSectionService.hide(this.sectionName),!1}}mc.\u0275fac=function(e){return new(e||mc)(n.gc(n.q),n.gc(gc))},mc.\u0275cmp=n.ac({type:mc,selectors:[["hide-section-link"]],decls:2,vars:0,consts:[["linkTitle","Remove","linkAriaLabel","Remove",3,"execute"],["icon-classes","icon-close icon-small","icon-title","Remove"]],template:function(e,t){1&e&&(n.mc(0,"accessible-by-keyboard",0),n.uc("execute",(function(){return t.hideSection()})),n.hc(1,"op-icon",1),n.lc())},directives:[dn.a,yt.a],encapsulation:2});class fc{constructor(e,t){this.HideSectionService=e,this.elementRef=t}ngOnInit(){const e=jQuery(this.elementRef.nativeElement);this.optValue=e.data("optValue"),this.hideSecWithName=e.data("hideSecWithName"),jQuery(this.elementRef.nativeElement).prev().on("change",e=>{jQuery("option:selected",e.target).val()!==this.optValue?this.HideSectionService.hide(this.hideSecWithName):this.HideSectionService.show(this.hideSecWithName)})}}fc.\u0275fac=function(e){return new(e||fc)(n.gc(gc),n.gc(n.q))},fc.\u0275cmp=n.ac({type:fc,selectors:[["show-section-dropdown"]],decls:0,vars:0,template:function(e,t){},encapsulation:2});var bc=i("4EDS");const wc=["fallbackOption"];function vc(e,t){if(1&e&&n.hc(0,"option",4),2&e){const e=t.$implicit;n.Bc("value",e.key)("textContent",e.label)}}class yc extends Je.a{constructor(e,t,i){super(),this.hideSectionService=e,this.elementRef=t,this.I18n=i,this.trackByKey=bc.a.trackByProperty("key"),this.selectable=[],this.active=[],this.placeholder=this.I18n.t("js.placeholders.selection")}ngOnInit(){this.htmlId=this.elementRef.nativeElement.dataset.htmlId,this.hideSectionService.displayed.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.selectable=this.hideSectionService.all.filter(t=>-1===e.indexOf(t.key)).sort((e,t)=>e.label.localeCompare(t.label)),this.option.nativeElement.selected=!0})}show(e){this.hideSectionService.show(e)}}function kc(e,t){if(1&e&&n.ad(0),2&e){const e=t.item;n.cd(" ",e.label," ")}}yc.\u0275fac=function(e){return new(e||yc)(n.gc(gc),n.gc(n.q),n.gc(C.a))},yc.\u0275cmp=n.ac({type:yc,selectors:[["add-section-dropdown"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(wc,!0),2&e)&&(n.Nc(i=n.vc())&&(t.option=i.first))},features:[n.Qb],decls:4,vars:3,consts:[[1,"form--select",3,"id","change"],["value","","selected","","disabled","",3,"textContent"],["fallbackOption",""],[3,"value","textContent",4,"ngFor","ngForTrackByKey","ngForOf"],[3,"value","textContent"]],template:function(e,t){1&e&&(n.mc(0,"select",0),n.uc("change",(function(e){return t.show(e.target.value)})),n.hc(1,"option",1,2),n.Yc(3,vc,1,2,"option",3),n.lc()),2&e&&(n.Bc("id",t.htmlId),n.Tb(1),n.Bc("textContent",t.placeholder),n.Tb(2),n.Bc("ngForOf",t.selectable))},directives:[l.r,l.B,X.p],encapsulation:2});class Cc{constructor(e){this.elementRef=e,this.multiselect=!1}ngOnInit(){const e=this.elementRef.nativeElement;this.multiselect="true"===e.dataset.multiselect,this.labelForId=e.dataset.inputId,this.syncInputFieldName=e.dataset.inputName,this.multiselect&&(this.syncInputFieldName+="[]");const t=JSON.parse(e.dataset.options);this.setInitialSelection(t),this.multiselect||(this.selected=this.selected[0]),this.options=t,e.parentElement.hidden=!1}setInitialSelection(e){this.updateSelection(e.filter(e=>e.selected))}updateSelection(e){this.selected=e,e=_.castArray(e),this.removeCurrentSyncedFields(),e.forEach(e=>{this.createSyncedField(e.value)})}createSyncedField(e){jQuery(this.elementRef.nativeElement).parent().append(`<input type="hidden" name="${this.syncInputFieldName||""}" value="${e}" />`)}removeCurrentSyncedFields(){jQuery(this.elementRef.nativeElement).parent().find(`input[name="${this.syncInputFieldName}"]`).remove()}}function jc(e,t){if(1&e){const e=n.nc();n.mc(0,"li"),n.mc(1,"a",11),n.uc("click",(function(){n.Qc(e);const i=t.$implicit;return n.wc().clickTab(i.id)})),n.lc(),n.lc()}if(2&e){const e=t.$implicit,i=n.wc();n.Xb("selected",e.id===i.currentTabId),n.Ub("tab-id",e.id),n.Tb(1),n.Bc("href",e.path,n.Tc)("textContent",e.name)}}Cc.\u0275fac=function(e){return new(e||Cc)(n.gc(n.q))},Cc.\u0275cmp=n.ac({type:Cc,selectors:[["autocomplete-select-decoration"]],viewQuery:function(e,t){var i;(1&e&&n.fd(un.a,!0),2&e)&&(n.Nc(i=n.vc())&&(t.ngSelectComponent=i.first))},decls:2,vars:5,consts:[["bindLabel","label","appendTo","body","placeholder","Please select",3,"items","labelForId","multiple","virtualScroll","ngModel","ngModelChange"],["ng-option-tmp",""]],template:function(e,t){1&e&&(n.mc(0,"ng-select",0),n.uc("ngModelChange",(function(e){return t.updateSelection(e)})),n.Yc(1,kc,1,1,"ng-template",1),n.lc()),2&e&&n.Bc("items",t.options)("labelForId",t.labelForId)("multiple",t.multiselect)("virtualScroll",!0)("ngModel",t.selected)},directives:[un.a,l.m,l.p,un.c],encapsulation:2});class xc extends In.a{constructor(e,t,i,n){super(),this.elementRef=e,this.$state=t,this.gon=i,this.I18n=n,this.classes=["content--tabs","scrollable-tabs"],this.gonTabs=JSON.parse(this.gon.get("contentTabs").tabs),this.currentTab=JSON.parse(this.gon.get("contentTabs").selected),this.tabs=this.gonTabs.map(e=>({id:e.name,name:this.I18n.t("js."+e.label),path:e.path})),this.currentTabId=this.currentTab.name}}xc.\u0275fac=function(e){return new(e||xc)(n.gc(n.q),n.gc(We.G),n.gc($a.a),n.gc(C.a))},xc.\u0275cmp=n.ac({type:xc,selectors:[["content-tabs"]],features:[n.Qb],decls:11,vars:4,consts:[[3,"ngClass"],["scrollContainer",""],[1,"tabrow",3,"scroll"],["scrollPane",""],[3,"selected",4,"ngFor","ngForOf"],[1,"scrollable-tabs--button","-left",3,"hidden","click"],["scrollLeftBtn",""],[1,"icon-arrow-left2"],[1,"scrollable-tabs--button","-right",3,"hidden","click"],["scrollRightBtn",""],[1,"icon-arrow-right2"],[3,"href","textContent","click"]],template:function(e,t){1&e&&(n.mc(0,"div",0,1),n.mc(2,"ul",2,3),n.uc("scroll",(function(e){return t.onScroll(e)})),n.Yc(4,jc,2,5,"li",4),n.lc(),n.mc(5,"div",5,6),n.uc("click",(function(){return t.scrollLeft()})),n.hc(7,"span",7),n.lc(),n.mc(8,"div",8,9),n.uc("click",(function(){return t.scrollRight()})),n.hc(10,"span",10),n.lc(),n.lc()),2&e&&(n.Bc("ngClass",t.classes),n.Tb(4),n.Bc("ngForOf",t.tabs),n.Tb(1),n.Bc("hidden",t.hideLeftButton),n.Tb(3),n.Bc("hidden",t.hideRightButton))},directives:[X.n,X.p],encapsulation:2,changeDetection:0});class Tc{constructor(e,t,i,n){this.NotificationsService=e,this.elementRef=t,this.I18n=i,this.ConfigurationService=n}ngOnInit(){const e=this.elementRef.nativeElement;this.clickTarget=e.getAttribute("click-target"),this.clipboardTarget=e.getAttribute("clipboard-target"),jQuery(this.clickTarget).on("click",e=>this.onClick(e)),e.classList.add("copy-to-clipboard"),this.target=jQuery(this.clipboardTarget?this.clipboardTarget:e)}addNotification(e,t){let i=this.NotificationsService[e](t);setTimeout(()=>this.NotificationsService.remove(i),5e3)}onClick(e){var t=document.queryCommandSupported&&document.queryCommandSupported("copy");if(e.preventDefault(),this.target.select().focus(),t)try{if(document.execCommand("copy"))return void this.addNotification("addSuccess",this.I18n.t("js.clipboard.copied_successful"))}catch(i){console.log("Your browser seems to support the clipboard API, but copying failed: "+i)}this.addNotification("addError",this.I18n.t("js.clipboard.browser_error"))}}Tc.\u0275fac=function(e){return new(e||Tc)(n.gc(k.a),n.gc(n.q),n.gc(C.a),n.gc(Ze.a))},Tc.\u0275cmp=n.ac({type:Tc,selectors:[["copy-to-clipboard"]],decls:0,vars:0,template:function(e,t){},encapsulation:2});class Sc{constructor(e,t,i){this.element=e,this.confirmDialog=t,this.I18n=i,this.confirmed=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text")}}ngOnInit(){this.$element=jQuery(this.element.nativeElement),this.$element.is("form")?this.$form=this.$element:this.$form=this.$element.closest("form"),this.$form.on("submit",e=>!!this.confirmed||(e.preventDefault(),this.openConfirmationDialog(),!1))}openConfirmationDialog(){this.confirmDialog.confirm({text:this.text,closeByEscape:!0,showClose:!0,closeByDocument:!0}).then(()=>{this.confirmed=!0,this.$form.trigger("submit")}).catch(()=>this.confirmed=!1)}}Sc.\u0275fac=function(e){return new(e||Sc)(n.gc(n.q),n.gc(m.a),n.gc(C.a))},Sc.\u0275cmp=n.ac({type:Sc,selectors:[["confirm-form-submit"]],decls:0,vars:0,template:function(e,t){},encapsulation:2});var _c=i("Sulb");const Pc=function(e){return{open:e}};class Ic extends Je.a{constructor(e,t,i){super(),this.toggleService=e,this.cdRef=t,this.elementRef=i,this.mainMenu=jQuery("#main-menu")[0],this.moving=!1}ngOnInit(){this.toggleService.titleData$.pipe(Object(cr.a)(),this.untilDestroyed()).subscribe(e=>{this.toggleTitle=e,this.cdRef.detectChanges()}),this.resizeEvent="main-menu-resize",this.localStorageKey="openProject-mainMenuWidth"}resizeStart(){this.elementWidth=this.mainMenu.clientWidth}resizeMove(e){this.toggleService.saveWidth(this.elementWidth+e.absolute.x)}resizeEnd(){const e=new Event(this.resizeEvent);window.dispatchEvent(e)}}Ic.\u0275fac=function(e){return new(e||Ic)(n.gc(_c.a),n.gc(n.i),n.gc(n.q))},Ic.\u0275cmp=n.ac({type:Ic,selectors:[["main-menu-resizer"]],features:[n.Qb],decls:4,vars:6,consts:[[1,"main-menu--resizer",3,"customHandler","cursorClass","end","start","move"],[1,"resizer-toggle-container"],[1,"main-menu--navigation-toggler",3,"ngClass","accessibleClick"],["aria-hidden","true",1,"icon-resizer-vertical-lines"]],template:function(e,t){1&e&&(n.mc(0,"resizer",0),n.uc("end",(function(){return t.resizeEnd()}))("start",(function(){return t.resizeStart()}))("move",(function(e){return t.resizeMove(e)})),n.mc(1,"div",1),n.mc(2,"i",2),n.uc("accessibleClick",(function(e){return t.toggleService.toggleNavigation(e)})),n.lc(),n.hc(3,"i",3),n.lc(),n.lc()),2&e&&(n.Bc("customHandler",!0)("cursorClass","col-resize"),n.Tb(2),n.Bc("ngClass",n.Gc(4,Pc,t.toggleService.showNavigation)),n.Ub("title",t.toggleTitle))},directives:[xn.a,X.n,on.a],encapsulation:2});var Oc=i("C21z"),Rc=i("K247"),Bc=i("LRne"),Ec=i("yrbL"),Mc=i("iuWW"),Fc=i("13ri");const Ac=["btn"];function Dc(e,t){if(1&e){const e=n.nc();n.mc(0,"a",8),n.uc("click",(function(){return n.Qc(e),n.wc().toggleMobileSearch()})),n.hc(1,"i",9),n.lc()}if(2&e){const e=n.wc();n.Cc("title",e.text.close_search)}}function qc(e,t){if(1&e){const e=n.nc();n.mc(0,"div"),n.mc(1,"div",12),n.uc("click",(function(){n.Qc(e);const t=n.wc().item;return n.wc().followItem(t)})),n.mc(2,"div",13),n.mc(3,"span",14),n.ad(4),n.lc(),n.mc(5,"span",15),n.ad(6),n.lc(),n.lc(),n.lc(),n.lc()}if(2&e){const e=n.wc().item,t=n.wc();n.Tb(4),n.cd(" ",t.currentValue," "),n.Tb(1),n.Cc("title",e.projectScope),n.Tb(1),n.cd(" ",e.text," \u21b5 ")}}function Lc(e,t){if(1&e){const e=n.nc();n.mc(0,"div",12),n.uc("click",(function(t){n.Qc(e);const i=n.wc().item;return n.wc().redirectToWp(i.id,t)})),n.mc(1,"a",16),n.mc(2,"span",17),n.ad(3),n.lc(),n.mc(4,"span",18),n.ad(5),n.lc(),n.lc(),n.lc()}if(2&e){const e=n.wc().item,t=n.wc();n.Tb(1),n.Bc("href",t.wpPath(e.id),n.Tc),n.Tb(1),n.Cc("title",e.status),n.Bc("ngOptionHighlight",t.currentValue)("ngClass",t.statusHighlighting(e.statusId)),n.Tb(1),n.cd(" #",e.id," "),n.Tb(1),n.Bc("ngOptionHighlight",t.currentValue),n.Tb(1),n.cd(" ",e.subject," ")}}function $c(e,t){if(1&e&&(n.Yc(0,qc,7,3,"div",10),n.Yc(1,Lc,6,7,"ng-template",null,11,n.Zc)),2&e){const e=t.item,i=n.Oc(2);n.Bc("ngIf",!e.id)("ngIfElse",i)}}const Nc=function(e){return{"top-menu-search--input":!0,"-markable":e}};class Qc{constructor(e,t,i,n,s,a,r,c,o){this.elementRef=e,this.I18n=t,this.PathHelperService=i,this.halResourceService=n,this.globalSearchService=s,this.currentProjectService=a,this.deviceService=r,this.cdRef=c,this.halNotification=o,this.expanded=!1,this.markable=!1,this.requests=new Mc.a(e=>this.autocompleteWorkPackages(e).pipe(Object(Ec.tap)(()=>{setTimeout(()=>this.setMarkedOption(),50)})),Object(Mc.b)(this.halNotification)),this.currentValue="",this.text={all_projects:this.I18n.t("js.global_search.all_projects"),current_project:this.I18n.t("js.global_search.current_project"),current_project_and_all_descendants:this.I18n.t("js.global_search.current_project_and_all_descendants"),search:this.I18n.t("js.global_search.search"),search_dots:this.I18n.t("js.global_search.search")+" ...",close_search:this.I18n.t("js.global_search.close_search")}}ngOnInit(){this.ngSelectComponent.searchTerm=this.currentValue=this.globalSearchService.searchTerm,this.expanded=this.ngSelectComponent.searchTerm.length>0,this.toggleTopMenuClass()}ngOnDestroy(){this.unregister()}handleClick(e){e.stopPropagation(),e.preventDefault(),Oc.a.insideOrSelf(this.btn.nativeElement,e.target)&&(this.deviceService.isMobile?(this.toggleMobileSearch(),jQuery(".ng-input input").focus()):0===this.ngSelectComponent.searchTerm.length?this.ngSelectComponent.focus():this.submitNonEmptySearch())}toggleMobileSearch(){this.expanded=!this.expanded,this.toggleTopMenuClass()}redirectToWp(e,t){return t.stopImmediatePropagation(),!!Fc.a.isClickedWithModifier(t)||(window.location.href=this.wpPath(e),t.preventDefault(),!1)}wpPath(e){return this.PathHelperService.workPackagePath(e)}search(e){this.currentValue=this.ngSelectComponent.searchTerm,this.openCloseMenu(e.term)}openCloseMenu(e){this.ngSelectComponent.isOpen=e.trim().length>0}onFocus(){this.expanded=!0,this.toggleTopMenuClass(),this.openCloseMenu(this.currentValue)}onFocusOut(){this.deviceService.isMobile||(this.expanded=this.ngSelectComponent.searchTerm.length>0,this.ngSelectComponent.isOpen=!1,this.toggleTopMenuClass())}clearSearch(){this.currentValue=this.ngSelectComponent.searchTerm="",this.openCloseMenu(this.currentValue)}onEnterBeforeResultsLoaded(){this.requests.loading$.pipe(Object(Ec.filter)(e=>!1===e),Object(Ec.take)(1)).subscribe(()=>{this.selectedItem?this.followSelectedItem():this.searchInScope(this.currentScope)})}statusHighlighting(e){return ec.a.inlineClass("status",e)}get isDirectHit(){return this.selectedItem&&this.selectedItem.hasOwnProperty("id")}followItem(e){e.hasOwnProperty("id")?window.location.href=this.wpPath(e.id):(this.globalSearchService.searchTerm=this.currentValue,this.searchInScope(e.projectScope))}followSelectedItem(){this.selectedItem&&this.followItem(this.selectedItem)}customSearchFn(e,t){return void 0===t.id||-1!==t.subject.toLowerCase().indexOf(e.toLowerCase())}autocompleteWorkPackages(e){if(!e)return Object(Bc.a)([]);this.selectedItem=null,this.markable=!1;let t=this.queryWithoutHash(e);return this.fetchSearchResults(t,t!==e).pipe(Object(Ec.map)(e=>this.searchResultsToOptions(e.elements,t)))}queryWithoutHash(e){return e.match(/^#(\d+)/)?e.substr(1):e}fetchSearchResults(e,t){let i=this.PathHelperService.api.v3.wpBySubjectOrId(e,t);return this.halResourceService.get(i)}searchResultsToOptions(e,t){let i=e.map(e=>{let i={id:e.id,subject:e.subject,status:e.status.name,statusId:e.status.idFromLink,$href:e.$href};return t===e.id.toString()&&(this.selectedItem=i),i}),n=this.detailedSearchOptions();return this.selectedItem||(this.selectedItem=n[0]),n.concat(i)}detailedSearchOptions(){let e=[];return this.currentProjectService.path&&(e.push("current_project_and_all_descendants"),e.push("current_project")),"current_project"===this.globalSearchService.projectScope&&e.reverse(),e.push("all_projects"),e.map(e=>({projectScope:e,text:this.text[e]}))}setMarkedOption(){this.markable=!0,this.ngSelectComponent.itemsList.markItem(this.ngSelectComponent.itemsList.selectedItems[0]),this.cdRef.detectChanges()}searchInScope(e){switch(e){case"all_projects":{let e=!1;"all"!==this.globalSearchService.projectScope&&(e=!0,this.globalSearchService.resultsHidden=!0),this.globalSearchService.projectScope="all",this.submitNonEmptySearch(e);break}case"current_project":this.globalSearchService.projectScope="current_project",this.submitNonEmptySearch();break;case"current_project_and_all_descendants":this.globalSearchService.projectScope="",this.submitNonEmptySearch()}}submitNonEmptySearch(e=!1){if(this.globalSearchService.searchTerm=this.currentValue,this.currentValue.length>0){if(this.ngSelectComponent.close(),!e&&this.globalSearchService.isAfterSearch()&&"work_packages"===this.globalSearchService.currentTab)return void window.history.replaceState({},`${I18n.t("global_search.search")}: ${this.ngSelectComponent.searchTerm}`,this.globalSearchService.searchPath());this.globalSearchService.submitSearch()}}blur(){this.ngSelectComponent.searchTerm="",document.activeElement.blur()}get currentScope(){let e=this.globalSearchService.projectScope;return""===e?"current_project_and_all_descendants":e}unregister(){this.unregisterGlobalListener&&(this.unregisterGlobalListener(),this.unregisterGlobalListener=void 0)}toggleTopMenuClass(){jQuery("#top-menu").toggleClass("-global-search-expanded",this.expanded)}}Qc.\u0275fac=function(e){return new(e||Qc)(n.gc(n.q),n.gc(C.a),n.gc(V.a),n.gc(j.a),n.gc(Ma),n.gc(Te.a),n.gc(Rc.a),n.gc(n.i),n.gc(de.a))},Qc.\u0275cmp=n.ac({type:Qc,selectors:[["global-search-input"]],viewQuery:function(e,t){var i;(1&e&&(n.Wc(Ac,!0),n.Wc(un.a,!0)),2&e)&&(n.Nc(i=n.vc())&&(t.btn=i.first),n.Nc(i=n.vc())&&(t.ngSelectComponent=i.first))},hostBindings:function(e,t){1&e&&n.uc("click",(function(e){return t.handleClick(e)}))},decls:10,vars:20,consts:[[1,"top-menu-search"],["class","top-menu-search--back-button","href","#",3,"title","click",4,"ngIf"],["name","global-search-input","id","global-search-input","accesskey","4",3,"items","placeholder","ngClass","ngModel","openOnEnter","searchFn","typeahead","loading","ngModelChange","focus","blur","search","open","close","change","keydown.enter","keydown.escape","clear"],["select",""],["ng-option-tmp",""],["id","top-menu-search-button","tabindex","0","role","button",1,"top-menu-search--button","search-form-normal",3,"title","accessibleClick"],["btn",""],["icon-classes","icon5 icon-search ellipsis"],["href","#",1,"top-menu-search--back-button",3,"title","click"],["aria-hidden","true",1,"icon-arrow-left1"],[4,"ngIf","ngIfElse"],["workPackageItemTemplate",""],["tabindex","-1",1,"global-search--option",3,"click"],[1,"global-search--option-wrapper"],[1,"global-search--search-term"],[1,"global-search--project-scope",3,"title"],[1,"global-search--option-wrapper",3,"href"],[1,"global-search--wp-id",3,"title","ngOptionHighlight","ngClass"],[1,"global-search--wp-subject",3,"ngOptionHighlight"]],template:function(e,t){if(1&e){const e=n.nc();n.mc(0,"div",0),n.Yc(1,Dc,2,1,"a",1),n.mc(2,"ng-select",2,3),n.uc("ngModelChange",(function(e){return t.selectedItem=e}))("focus",(function(){return t.onFocus()}))("blur",(function(){return t.onFocusOut()}))("search",(function(e){return t.search(e)}))("open",(function(){return t.openCloseMenu(t.currentValue)}))("close",(function(){return n.Qc(e),n.Oc(3).searchTerm=t.currentValue}))("change",(function(){return t.followSelectedItem()}))("keydown.enter",(function(){return t.onEnterBeforeResultsLoaded()}))("keydown.escape",(function(){return t.blur()}))("clear",(function(){return t.clearSearch()})),n.xc(4,"async"),n.xc(5,"async"),n.Yc(6,$c,3,2,"ng-template",4),n.lc(),n.mc(7,"a",5,6),n.uc("accessibleClick",(function(e){return t.handleClick(e)})),n.hc(9,"op-icon",7),n.lc(),n.lc()}2&e&&(n.Tb(1),n.Bc("ngIf",t.expanded),n.Tb(1),n.Xb("-expanded",t.expanded),n.Cc("placeholder",t.text.search_dots),n.Bc("items",n.yc(4,14,t.requests.output$))("ngClass",n.Gc(18,Nc,t.markable))("ngModel",t.selectedItem)("openOnEnter",!1)("searchFn",t.customSearchFn)("typeahead",t.requests.input$)("loading",n.yc(5,16,t.requests.loading$)),n.Tb(5),n.Xb("-input-focused",t.expanded),n.Cc("title",t.text.search))},directives:[X.q,un.a,X.n,l.m,l.p,wn.a,un.c,on.a,yt.a,hn.a],pipes:[X.a],styles:[".cdk-drag-preview{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.top-menu-search{display:flex;align-items:center;position:relative;height:var(--header-height);line-height:var(--header-height);margin:0 15px}.top-menu-search .top-menu-search--back-button{display:none}.top-menu-search .top-menu-search--button{position:absolute;right:2px;font-size:var(--header-item-font-size);color:var(--header-item-font-color)}.top-menu-search .top-menu-search--button:hover{text-decoration:none}.top-menu-search .top-menu-search--button.-input-focused{color:var(--header-search-field-font-color)}.top-menu-search .top-menu-search--loading{top:var(--header-height)-11px;height:46px;z-index:1051}.top-menu-search #global-search-input{width:calc(160px + 3vw);font-size:.9rem;transition:width .2s ease-in-out}.top-menu-search #global-search-input::-ms-clear{margin-right:5px;width:20px}.top-menu-search #global-search-input .ng-select-container{background:transparent;border-color:var(--header-item-font-color)}.top-menu-search #global-search-input .ng-arrow-wrapper{display:none}.top-menu-search #global-search-input .ng-clear-wrapper{color:var(--header-item-font-color);top:1px;width:30px;right:25px;text-align:center}.top-menu-search #global-search-input .ng-input{top:0}.top-menu-search #global-search-input .ng-input input{color:var(--header-item-font-color);height:30px;cursor:text}.top-menu-search #global-search-input .ng-placeholder{color:var(--header-item-font-color)}.top-menu-search #global-search-input.-expanded{width:calc(160px + 13vw);background:#fff;border-radius:4px;color:var(--header-search-field-font-color)}.top-menu-search #global-search-input.-expanded .ng-clear-wrapper,.top-menu-search #global-search-input.-expanded .ng-placeholder,.top-menu-search #global-search-input.-expanded input{color:var(--header-search-field-font-color)}.top-menu-search #global-search-input .scroll-host{scrollbar-color:transparent transparent;scrollbar-width:thin;max-height:80vh;height:auto}.top-menu-search #global-search-input .scroll-host::-webkit-scrollbar{height:10px;width:10px}.top-menu-search #global-search-input .scroll-host::-webkit-scrollbar-track{background:transparent}.top-menu-search #global-search-input .scroll-host::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.top-menu-search #global-search-input .scroll-host:hover{scrollbar-color:#ddd transparent}.top-menu-search #global-search-input .scroll-host:hover::-webkit-scrollbar-thumb{visibility:visible}.top-menu-search #global-search-input .ng-option{border-bottom:1px solid #eaeaea;white-space:normal;padding:5px 10px;background-color:unset}.top-menu-search #global-search-input .ng-option:last-child{border-bottom:none}.top-menu-search #global-search-input .ng-option.ng-option-marked{color:var(--header-drop-down-item-font-hover-color)}.top-menu-search #global-search-input .ng-option.ng-option-disabled{display:none}.top-menu-search #global-search-input .ng-option.ng-option-selected{color:var(--header-drop-down-item-font-hover-color)}.top-menu-search #global-search-input.-markable .ng-option.ng-option-marked{background-color:var(--drop-down-hover-bg-color)}.top-menu-search #global-search-input.-markable .ng-option.ng-option-selected{background-color:var(--drop-down-selected-bg-color)}.global-search--wp-id{color:var(--gray-dark);font-size:13px;white-space:nowrap}.top-menu-search--input .ng-spinner-loader{position:relative;right:14px}.global-search--option-wrapper{padding:5px;line-height:25px;min-height:35px;word-break:break-word}.global-search--project-scope{position:absolute;right:7px;border:1px solid var(--button--border-color);font-size:13px;background:var(--button--background-color);border-radius:2px;padding:0 4px;color:var(--body-font-color)}",".cdk-drag-preview{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}@media only screen and (max-width:679px){#top-menu.-global-search-expanded #account-nav-left,#top-menu.-global-search-expanded #account-nav-right,#top-menu.-global-search-expanded #main-menu-toggle{display:none}#top-menu.-global-search-expanded .top-menu-search{width:100vw;margin:0;padding-right:15px}#top-menu.-global-search-expanded .top-menu-search .top-menu-search--button{display:none;color:var(--header-item-font-color)}#top-menu #global-search-input{display:none}#top-menu #global-search-input.-expanded{display:block;width:calc(100vw - 50px);min-width:unset;position:unset}#top-menu #global-search-input.-expanded .scroll-host{max-height:calc(100vh - var(--header-height))}#top-menu #global-search-input.-expanded .ng-clear-wrapper{width:40px;right:0}#top-menu #global-search-input.-expanded .ng-select-bottom{height:calc(100vh - var(--header-height));overflow-y:auto;margin:0}#top-menu #global-search-input.-expanded .ng-select-container{height:36px!important;border-radius:4px}#top-menu #global-search-input.-expanded .ng-input input{height:36px}#top-menu .top-menu-search--back-button{display:initial;width:50px;text-align:center;color:var(--header-item-font-color)}#top-menu .top-menu-search--back-button:active,#top-menu .top-menu-search--back-button:focus,#top-menu .top-menu-search--back-button:hover{text-decoration:none}#top-menu .top-menu-search--loading{top:var(--header-height)1px}#top-menu .top-menu-search--button.-input-focused{color:var(--header-item-font-color)}}"],encapsulation:2,changeDetection:0});const Vc=["sectionBody"],Hc=function(e){return{"-expanded":e}};class zc{constructor(e){this.elementRef=e,this.expanded=!1}ngOnInit(){const e=this.elementRef.nativeElement;this.sectionTitle=e.getAttribute("section-title"),"true"===e.getAttribute("initially-expanded")&&(this.expanded=!0);const t=e.nextElementSibling;this.sectionBody.nativeElement.appendChild(t),t.removeAttribute("hidden")}toggle(){this.expanded=!this.expanded}}zc.\u0275fac=function(e){return new(e||zc)(n.gc(n.q))},zc.\u0275cmp=n.ac({type:zc,selectors:[["collapsible-section-augment"]],viewQuery:function(e,t){var i;(1&e&&n.Wc(Vc,!0),2&e)&&(n.Nc(i=n.vc())&&(t.sectionBody=i.first))},decls:5,vars:6,consts:[[1,"collapsible-section",3,"ngClass"],["linkClass","collapsible-section--toggle-link","spanClass","collapsible-section--legend",3,"linkAriaLabel","execute"],[3,"textContent"],[1,"collapsible-section--body","toggle-slide-animation",3,"hidden"],["sectionBody",""]],template:function(e,t){1&e&&(n.mc(0,"section",0),n.mc(1,"accessible-by-keyboard",1),n.uc("execute",(function(){return t.toggle()})),n.hc(2,"span",2),n.lc(),n.hc(3,"div",3,4),n.lc()),2&e&&(n.Bc("ngClass",n.Gc(4,Hc,t.expanded)),n.Tb(1),n.Bc("linkAriaLabel",t.sectionTitle),n.Tb(1),n.Bc("textContent",t.sectionTitle),n.Tb(1),n.Bc("hidden",!t.expanded))},directives:[X.n,dn.a],encapsulation:2});class Yc{constructor(e,t){this.elementRef=e,this.i18n=t}ngOnInit(){let e=jQuery(this.elementRef.nativeElement);this.textMessage=e.attr("text-message"),this.linkMessage=e.attr("link-message")||this.i18n.t("js.work_packages.table_configuration.upsale.check_out_link"),this.referrer=e.attr("referrer")}}Yc.\u0275fac=function(e){return new(e||Yc)(n.gc(n.q),n.gc(C.a))},Yc.\u0275cmp=n.ac({type:Yc,selectors:[["enterprise-banner-bootstrap"]],decls:1,vars:3,consts:[[3,"textMessage","linkMessage","opReferrer"]],template:function(e,t){1&e&&n.hc(0,"enterprise-banner",0),2&e&&n.Bc("textMessage",t.textMessage)("linkMessage",t.linkMessage)("opReferrer",t.referrer)},directives:[On.a],encapsulation:2});var Wc,Uc=i("/+cc");!function(e){e.register=function(e,t){jQuery.widget(`custom.${e}`,jQuery.ui.autocomplete,{_create:function(){t.currentPage=0,this._super(),this.widget().menu("option","items","> .ui-matched-item"),this._search("")},_renderMenu:function(e,t){jQuery(e).unbind("scroll"),this._renderLazyMenu(e,t)},_renderMenuPage(e,i,n=null){let s=this,a=i.length,r=i,c=t.maxItemsPerPage;if(null!==n&&(r=i.slice(n*c,n*c+c),a=Math.min(i.length,n*c+c)),jQuery.each(r,(function(t,i){s._renderItemData(e,i)})),e.css("height","auto"),a<i.length){const t=32*a;t<.55*document.body.offsetHeight&&e.css("height",t-50)}},_pages:e=>Math.ceil(e.length/t.maxItemsPerPage),_repositionMenu:function(e){const t=this.menu;t.refresh(),this._resizeMenu(),e.position(jQuery.extend({of:this.element},this.options.position)),this.options.autoFocus&&t.next(new jQuery.Event("mouseover"))},_resizeMenu:function(){this.menu.element.outerWidth(this.element.outerWidth())},_renderItem:function(e,i){const n=this.element.val(),s="disabled"===i.render,a=jQuery("<div>").addClass("ui-menu-item-wrapper");t.renderItem(i,a);const r=jQuery("<li>").toggleClass("ui-state-disabled",s).toggleClass("ui-matched-item",!s).append(a).appendTo(e);return""!==n&&r.mark(n,{className:"ui-autocomplete-match"}),r},_renderLazyMenu:function(e,i){const n=this,s=jQuery(e),a=this._pages(i);if(a<=1)return n._renderMenuPage(e,i);n._renderMenuPage(e,i,0),s.scroll((function(){if(function(e){var t=e.outerHeight(),i=e[0].scrollHeight;return e.scrollTop()>=i-t}(s)){if(++t.currentPage>=a)return;n._renderMenuPage(e,i,t.currentPage),n._repositionMenu(e)}}))}})}}(Wc||(Wc={}));var Gc=i("E5Dd");class Xc extends class{constructor(e){this.widgetName=e,Wc.register(e,this)}renderItem(e,t){t.text(e.label)}fuzzySearch(e,t){if(""===t)return e;if(t.length>=3){const i=this.literalSearch(e,t);if(i.length>0)return i}return this.fuseInstance.search(t)}literalSearch(e,t){const i=[],n=t.toLowerCase();return e.forEach(e=>{-1!==e.label.toLowerCase().indexOf(n)&&i.push(e)}),i}augmentedResultSet(e,t){const i=[];return t.forEach(e=>{i.push({label:e.label,object:e.object,render:"match"})}),i}setup(e,t){this.currentPage=0,this.input=e,this.input[this.widgetName].call(this.input,this.setupParams(t));this.fuseInstance=new Uc(t,{shouldSort:!0,tokenize:!1,threshold:.2,location:0,distance:1e4,maxPatternLength:16,minMatchCharLength:2,keys:["label"]})}setupParams(e){const t=this;return{delay:50,source:function(i,n){const s=t.fuzzySearch(e,i.term);n(t.augmentedResultSet(e,s))},select:(e,i)=>{"match"===i.item.render&&t.onItemSelected(i.item.object)},create:()=>t.input.focus(),response:(e,i)=>{t.onNoResultsFound(e,i)},autoFocus:!0,minLength:0}}}{constructor(e,t,i,n,s,a){super("projectMenuAutocomplete"),this.PathHelper=e,this.elementRef=t,this.http=i,this.cdRef=n,this.I18n=s,this.currentProject=a,this.results=null,this.loaded=!1,this.text={label:s.t("js.projects.autocompleter.label"),no_results:s.t("js.notice_no_principals_found"),loading:s.t("js.ajax.loading")}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.dropdownMenu=this.$element.parents("li.drop-down"),this.input=this.$element.find(".project-menu-autocomplete--input"),this.noResults=this.$element.find(".project-menu-autocomplete--no-results"),this.dropdownMenu.on("opened",()=>this.open()),this.dropdownMenu.on("closed",()=>this.close())}close(){try{this.input.projectMenuAutocomplete("destroy")}catch(e){console.warn("Failed to destroy autocomplete: %O",e)}this.$element.find(".project-search-results").css("visibility","hidden")}open(){this.$element.find(".project-search-results").css("visibility","visible"),this.loadProjects().then(e=>{let t=_.map(e,e=>({label:e.name,render:"match",object:e}));this.setup(this.input,t),this.addInputHandlers(),this.addClickHandler(),this.loaded=!0,this.cdRef.detectChanges(),this.scrollCurrentProjectIntoView()})}get maxItemsPerPage(){return 250}onItemSelected(e){window.location.href=this.projectLink(e.identifier)}onNoResultsFound(e,t){this.noResults.toggle(0===t.content.length)}renderItem(e,t){const i=jQuery("<a>").attr("href",this.projectLink(e.object.identifier)).text(e.label).appendTo(t);e.object.level>0&&i.text(`\xbb ${e.label}`).css("padding-left",4+16*e.object.level+"px"),e.object.identifier===this.currentProject.identifier&&t.addClass("selected")}projectLink(e){const t=jQuery('meta[name="current_menu_item"]').attr("content");let i=this.PathHelper.projectPath(e);return t&&(i+="?jump="+encodeURIComponent(t)),i}get loadingText(){return this.loaded?"":this.text.loading}loadProjects(){if(null!==this.results)return Promise.resolve(this.results);const e=this.PathHelper.projectLevelListPath();return this.http.get(e).toPromise().then(e=>this.results=this.augmentWithParents(e.projects))}augmentWithParents(e){const t=[];let i=-1;return e.map(e=>{for(;i>=e.level;)t.pop(),i--;return t.push(e),i=e.level,e.parents=t.slice(0,-1),e})}augmentedResultSet(e,t){const i=t.map(e=>e.object.identifier),n=_.flatten(t.map(e=>e.object.parents)),s=[];return e.forEach(e=>{const t=e.object.identifier;let a;if(i.indexOf(t)>=0)a="match";else{if(!_.find(n,e=>e.identifier===t))return;a="disabled"}s.push({label:e.label,object:e.object,render:a})}),s}addInputHandlers(){this.input.off("blur"),this.input.keydown(e=>e.which!==Gc.a.ESCAPE||(this.input.val(""),this.input[this.widgetName].call(this.input,"search",""),!1))}addClickHandler(){var e=!1;this.$element.find(".project-menu-autocomplete--results").on("click",".ui-menu-item a",e=>(Fc.a.isClickedWithModifier(e)&&e.stopImmediatePropagation(),!0)).on("touchend",".ui-menu-item a",(function(t){e||(window.location.href=t.target.href)})).on("touchmove",".ui-menu-item a",(function(){e=!0})).on("touchstart",".ui-menu-item a",(function(){e=!1}))}setupParams(e){const t=super.setupParams(e);return t.appendTo=".project-menu-autocomplete--wrapper",t.classes={"ui-autocomplete":"-inplace project-menu-autocomplete--results"},t.position={of:".project-menu-autocomplete--input-container"},t}scrollCurrentProjectIntoView(){let e=document.querySelector(".ui-menu-item-wrapper.selected");if(!e)return;let t=e.offsetHeight,i=document.getElementsByClassName("project-menu-autocomplete--results")[0],n=e.offsetTop-i.offsetHeight/2+t/2;i.scrollTop=n%t==0?n:n-n%t}}Xc.\u0275fac=function(e){return new(e||Xc)(n.gc(V.a),n.gc(n.q),n.gc(ue.b),n.gc(n.i),n.gc(C.a),n.gc(Te.a))},Xc.\u0275cmp=n.ac({type:Xc,selectors:[["project-menu-autocomplete"]],features:[n.Qb],decls:7,vars:3,consts:[["id","project_autocompletion_wrapper",1,"dropdown","dropdown-relative","project-search-results"],[1,"project-menu-autocomplete--wrapper"],[1,"project-menu-autocomplete--input-container"],["for","project_autocompletion_input",1,"hidden-for-sighted",3,"textContent"],["type","text","id","project_autocompletion_input","name","project_autocompletion_input",1,"ui-autocomplete--input","project-menu-autocomplete--input"],[1,"project-menu-autocomplete--search-icon","icon-search"],["hidden","",1,"project-menu-autocomplete--no-results",3,"textContent"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.hc(3,"label",3),n.hc(4,"input",4),n.hc(5,"i",5),n.lc(),n.hc(6,"p",6),n.lc(),n.lc()),2&e&&(n.Tb(3),n.Bc("textContent",t.text.label),n.Tb(1),n.Ub("placeholder",t.loadingText),n.Tb(2),n.Bc("textContent",t.text.no_results))},encapsulation:2,changeDetection:0});class Kc{constructor(e,t){this.elementRef=e,this.http=t}ngOnInit(){const e=jQuery(this.elementRef.nativeElement),t=e.parent();this.inputs=t.find(".remote-field--input"),this.target=t.find(".remote-field--target"),this.url=e.data("url"),this.htmlMode="html"===e.data("mode"),this.inputs.on("keyup change",_.debounce(e=>{let t=[Gc.a.TAB,Gc.a.ENTER,Gc.a.SHIFT];("change"===e.type||e.which&&-1===t.indexOf(e.which))&&this.updater()},500))}request(e){const t={};return this.htmlMode?t.Accept="text/html":t.Accept="application/json",this.http.get(this.url,{params:e,headers:t,responseType:this.htmlMode?"text":"json",withCredentials:!0})}updater(){let e={};this.inputs.each((t,i)=>{e[i.dataset.remoteFieldKey]=i.value}),this.request(e).subscribe(e=>{this.htmlMode?this.target.html(e):_.each(e,(e,t)=>{jQuery("#"+t).html(e)})})}}Kc.\u0275fac=function(e){return new(e||Kc)(n.gc(n.q),n.gc(ue.b))},Kc.\u0275cmp=n.ac({type:Kc,selectors:[["remote-field-updater"]],decls:0,vars:0,template:function(e,t){},encapsulation:2});var Zc=i("5gqY");class Jc extends Je.a{constructor(e,t,i,n,s){super(),this.elementRef=e,this.cdRef=t,this.globalSearchService=i,this.I18n=n,this.injector=s,this.text={all_projects:this.I18n.t("js.global_search.title.all_projects"),project_and_subprojects:this.I18n.t("js.global_search.title.project_and_subprojects"),search_for:this.I18n.t("js.global_search.title.search_for"),in:this.I18n.t("js.label_in")}}ngOnInit(){Object(ac.a)([this.globalSearchService.searchTerm$,this.globalSearchService.projectScope$]).pipe(Object(cr.a)(),this.untilDestroyed()).subscribe(([e,t])=>{this.searchTerm=e,this.project=this.projectText(t),this.searchTitle=`${this.text.search_for} ${this.searchTerm} ${""===this.project?"":this.text.in} ${this.project}`,this.cdRef.detectChanges()})}projectText(e){let t=this.currentProjectService.name?this.currentProjectService.name:"";switch(e){case"all":return this.text.all_projects;case"current_project":return t;case"":return t+" "+this.text.project_and_subprojects;default:return""}}}function eo(e,t){if(1&e){const e=n.nc();n.mc(0,"li"),n.mc(1,"a",11),n.uc("click",(function(){n.Qc(e);const i=t.$implicit;return n.wc().clickTab(i.id)})),n.lc(),n.lc()}if(2&e){const e=t.$implicit,i=n.wc();n.Xb("selected",e.id===i.currentTabId),n.Ub("tab-id",e.id),n.Tb(1),n.Bc("href",e.path,n.Tc)("textContent",e.name)}}Jc.\u0275fac=function(e){return new(e||Jc)(n.gc(n.q),n.gc(n.i),n.gc(Ma),n.gc(C.a),n.gc(n.A))},Jc.\u0275cmp=n.ac({type:Jc,selectors:[["global-search-title"]],inputs:{searchTerm:"searchTerm",project:"project",projectScope:"projectScope",searchTitle:"searchTitle"},features:[n.Qb],decls:11,vars:5,consts:[[1,"toolbar-container"],[1,"toolbar"],[1,"title-container"],[1,"toolbar-items"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.mc(3,"h2"),n.ad(4),n.mc(5,"i"),n.ad(6),n.lc(),n.ad(7),n.mc(8,"i"),n.ad(9),n.lc(),n.lc(),n.hc(10,"ul",3),n.lc(),n.lc(),n.lc()),2&e&&(n.Tb(3),n.Ub("title",t.searchTitle),n.Tb(1),n.cd(" ",t.text.search_for," "),n.Tb(2),n.cd('"',t.searchTerm,'"'),n.Tb(1),n.cd(" ",""===t.project?"":t.text.in," "),n.Tb(2),n.bd(t.project))},encapsulation:2}),Object(y.c)([Object(Y.a)(),Object(y.e)("design:type",Te.a)],Jc.prototype,"currentProjectService",void 0);class to extends In.a{constructor(e){super(),this.globalSearchService=e,this.classes=["global-search--tabs","scrollable-tabs"]}ngOnInit(){this.currentTabSub=this.globalSearchService.currentTab$.subscribe(e=>{this.currentTabId=e}),this.tabsSub=this.globalSearchService.tabs$.subscribe(e=>{this.tabs=e,this.tabs.map(e=>e.path="#")})}clickTab(e){super.clickTab(e),this.globalSearchService.currentTab=e,this.globalSearchService.submitSearch()}ngOnDestroy(){this.currentTabSub.unsubscribe(),this.tabsSub.unsubscribe()}}function io(e,t){if(1&e){const e=n.nc();n.mc(0,"div",1),n.uc("accessibleClick",(function(t){return n.Qc(e),n.wc().toggleService.toggleNavigation(t)})),n.mc(1,"a",2),n.hc(2,"i",3),n.lc(),n.lc()}if(2&e){const e=n.wc();n.Ub("title",e.toggleTitle)}}to.\u0275fac=function(e){return new(e||to)(n.gc(Ma))},to.\u0275cmp=n.ac({type:to,selectors:[["global-search-tabs"]],features:[n.Qb],decls:11,vars:4,consts:[[3,"ngClass"],["scrollContainer",""],[1,"tabrow",3,"scroll"],["scrollPane",""],[3,"selected",4,"ngFor","ngForOf"],[1,"scrollable-tabs--button","-left",3,"hidden","click"],["scrollLeftBtn",""],[1,"icon-arrow-left2"],[1,"scrollable-tabs--button","-right",3,"hidden","click"],["scrollRightBtn",""],[1,"icon-arrow-right2"],[3,"href","textContent","click"]],template:function(e,t){1&e&&(n.mc(0,"div",0,1),n.mc(2,"ul",2,3),n.uc("scroll",(function(e){return t.onScroll(e)})),n.Yc(4,eo,2,5,"li",4),n.lc(),n.mc(5,"div",5,6),n.uc("click",(function(){return t.scrollLeft()})),n.hc(7,"span",7),n.lc(),n.mc(8,"div",8,9),n.uc("click",(function(){return t.scrollRight()})),n.hc(10,"span",10),n.lc(),n.lc()),2&e&&(n.Bc("ngClass",t.classes),n.Tb(4),n.Bc("ngForOf",t.tabs),n.Tb(1),n.Bc("hidden",t.hideLeftButton),n.Tb(3),n.Bc("hidden",t.hideRightButton))},directives:[X.n,X.p],encapsulation:2});class no extends Je.a{constructor(e,t,i,n){super(),this.toggleService=e,this.cdRef=t,this.deviceService=i,this.injector=n,this.toggleTitle=""}ngOnInit(){this.toggleService.initializeMenu(),this.toggleService.titleData$.pipe(Object(cr.a)(),this.untilDestroyed()).subscribe(e=>{this.toggleTitle=e,this.cdRef.detectChanges()})}}no.\u0275fac=function(e){return new(e||no)(n.gc(_c.a),n.gc(n.i),n.gc(Rc.a),n.gc(n.A))},no.\u0275cmp=n.ac({type:no,selectors:[["main-menu-toggle"]],features:[n.Qb],decls:1,vars:1,consts:[["id","main-menu-toggle","aria-haspopup","true","tabindex","0",3,"accessibleClick",4,"ngIf"],["id","main-menu-toggle","aria-haspopup","true","tabindex","0",3,"accessibleClick"],["icon","icon-hamburger"],["aria-hidden","true",1,"icon-hamburger"]],template:function(e,t){1&e&&n.Yc(0,io,3,1,"div",0),2&e&&n.Bc("ngIf",null!==t.currentProject.id||t.deviceService.isMobile)},directives:[X.q,on.a],encapsulation:2,changeDetection:0}),Object(y.c)([Object(Y.a)(),Object(y.e)("design:type",Te.a)],no.prototype,"currentProject",void 0);var so=i("lJxs"),ao=i("Ng29");function ro(e,t){if(1&e&&n.hc(0,"user-avatar",3),2&e){const e=n.wc().item;n.Bc("user",e)}}function co(e,t){if(1&e&&(n.Yc(0,ro,1,1,"user-avatar",2),n.ad(1)),2&e){const e=t.item;n.Bc("ngIf",e&&e.id),n.Tb(1),n.cd(" ",e.name," ")}}class oo extends Pn.a{getAvailableUsers(e,t){return this.http.get(e,{params:new ue.f({encoder:new ao.a,fromObject:{q:t}}),responseType:"json",headers:{"Content-Type":"application/json; charset=utf-8"}}).pipe(Object(so.a)(e=>e.results.items.map(e=>({name:e.name,id:e.id,href:e.id}))))}}oo.\u0275fac=function(e){return lo(e||oo)},oo.\u0275cmp=n.ac({type:oo,selectors:[["members-autocompleter"]],features:[n.Qb],decls:4,vars:12,consts:[["bindLabel","name","bindValue","id",3,"items","ngModel","virtualScroll","trackByFn","typeahead","loading","appendTo","multiple","focus","change"],["ng-option-tmp",""],["data-class-list","avatar-mini",3,"user",4,"ngIf"],["data-class-list","avatar-mini",3,"user"]],template:function(e,t){1&e&&(n.mc(0,"ng-select",0),n.uc("focus",(function(){return t.onFocus()}))("change",(function(e){return t.onModelChange(e)})),n.xc(1,"async"),n.xc(2,"async"),n.Yc(3,co,2,2,"ng-template",1),n.lc()),2&e&&n.Bc("items",n.yc(1,8,t.requests.output$))("ngModel",t.initialSelection)("virtualScroll",!0)("trackByFn",t.userTracker)("typeahead",t.requests.input$)("loading",n.yc(2,10,t.requests.loading$))("appendTo",t.appendTo)("multiple",t.multiple)},directives:[un.a,l.m,l.p,wn.a,un.c,X.q,Gt.a],pipes:[X.a],encapsulation:2}),Object(y.c)([Object(Y.a)(),Object(y.e)("design:type",ue.b)],oo.prototype,"http",void 0);const lo=n.oc(oo);class uo{constructor(e,t,i,n){this.I18n=e,this.http=t,this.pathHelper=i,this.notificationsService=n,this.userData$=Object(o.f)(),this.modalOpen=!1,this.cancelled=!1,this.emailInvalid=!1,this.text={invalid_email:this.I18n.t("js.admin.enterprise.trial.form.invalid_email"),taken_email:this.I18n.t("js.admin.enterprise.trial.form.taken_email"),taken_domain:this.I18n.t("js.admin.enterprise.trial.form.taken_domain")};let s=window.gon;this.baseUrlAugur=s.augur_url,this.tokenVersion=s.token_version,window.gon.ee_trial_key&&this.setMailSubmittedStatus()}sendForm(e){const t=Object.assign(Object.assign({},e.value),{token_version:this.tokenVersion});this.http.post(this.baseUrlAugur+"/public/v1/trials",t).toPromise().then(t=>{this.userData$.putValue(e.value),this.cancelled=!1,this.trialLink=t._links.self.href,this.saveTrialKey(this.trialLink),this.retryConfirmation()}).catch(e=>{422===e.status||400===e.status?this.error=e:this.notificationsService.addWarning(e.error.description||I18n.t("js.error.internal"))})}getToken(){this.http.get(this.trialLink).toPromise().then(e=>Object(y.b)(this,void 0,void 0,(function*(){this.confirmed=!0,e.token_retrieved||(yield this.saveToken(e.token))}))).catch(e=>{422===e.status&&"waiting_for_email_verification"===e.error.identifier?(this.resendLink=e.error._links.resend.href,this.status&&!this.cancelled||this.saveTrialKey(this.resendLink),this.setMailSubmittedStatus(),this.confirmed=!1):"Error"===_.get(e,"error._type")?this.notificationsService.addError(e.error.message):this.notificationsService.addError(e.error||I18n.t("js.error.internal"))})}saveTrialKey(e){let t=e.split("/")[6];return this.http.post(this.pathHelper.api.v3.appBasePath+"/admin/enterprise/save_trial_key",{trial_key:t},{withCredentials:!0}).toPromise().catch(e=>{this.notificationsService.addError(e.error.message||e.message||e)})}saveToken(e){return this.http.post(this.pathHelper.api.v3.appBasePath+"/admin/enterprise",{enterprise_token:{encoded_token:e}},{withCredentials:!0}).toPromise().then(()=>{this.modalOpen||setTimeout(()=>{window.location.reload()},500)}).catch(e=>{this.http.delete(this.pathHelper.api.v3.appBasePath+"/admin/enterprise/delete_trial_key",{withCredentials:!0}).toPromise(),this.notificationsService.addError(e.error.description||I18n.t("js.error.internal"))})}retryConfirmation(e=5e3,t=60){this.cancelled||this.confirmed||(0===t?this.cancelled=!0:(this.getToken(),setTimeout(()=>{this.retryConfirmation(e,t-1)},e)))}setStartTrialStatus(){this.status="startTrial"}setMailSubmittedStatus(){this.status="mailSubmitted"}get trialStarted(){return"startTrial"===this.status}get mailSubmitted(){return"mailSubmitted"===this.status}get domainTaken(){return!!this.error&&"domain_taken"===this.error.error.identifier}get emailTaken(){return!!this.error&&"user_already_created_trial"===this.error.error.identifier}get emailError(){return!!this.emailInvalid||!!this.error&&this.emailTaken}get errorMsg(){let e="";return this.emailInvalid?e=this.text.invalid_email:this.domainTaken?e=this.text.taken_domain:this.emailTaken&&(e=this.text.taken_email),e}}uo.\u0275fac=function(e){return new(e||uo)(n.qc(C.a),n.qc(ue.b),n.qc(V.a),n.qc(k.a))},uo.\u0275prov=n.cc({token:uo,factory:uo.\u0275fac});var ho,po=i("vK8y");function go(e,t){if(1&e&&(n.mc(0,"div",25),n.ad(1),n.lc()),2&e){const e=n.wc();n.Tb(1),n.bd(e.eeTrialService.errorMsg)}}function mo(e,t){if(1&e&&(n.mc(0,"div",25),n.ad(1),n.lc()),2&e){const e=n.wc();n.Tb(1),n.bd(e.eeTrialService.errorMsg)}}!function(e){e.localizeLink=function(e){return e[I18n.locale]||e.en}}(ho||(ho={}));const fo=function(e){return{"-required-highlighting":e}};class bo{constructor(e,t,i,n,s){this.elementRef=e,this.I18n=t,this.formBuilder=i,this.currentUserService=n,this.eeTrialService=s,this.userData=this.eeTrialService.userData$.getValueOr({}),this.trialForm=this.formBuilder.group({company:[this.userData.company,l.A.required],first_name:[this.userData.first_name,l.A.required],last_name:[this.userData.last_name,l.A.required],email:["",[l.A.required,l.A.email]],domain:[this.userData.domain||window.location.host,l.A.required],general_consent:[null,l.A.required],newsletter_consent:null,language:this.currentUserService.language}),this.text={general_consent:this.I18n.t("js.admin.enterprise.trial.form.general_consent",{link_terms:ho.localizeLink({en:"https://www.openproject.com/terms-of-service/",de:"https://www.openproject.org/de/nutzungsbedingungen/"}),link_privacy:ho.localizeLink({en:"https://www.openproject.org/data-privacy-and-security/",de:"https://www.openproject.org/de/datenschutz/"})}),label_test_ee:this.I18n.t("js.admin.enterprise.trial.form.test_ee"),label_company:this.I18n.t("js.admin.enterprise.trial.form.label_company"),label_first_name:this.I18n.t("js.admin.enterprise.trial.form.label_first_name"),label_last_name:this.I18n.t("js.admin.enterprise.trial.form.label_last_name"),label_email:this.I18n.t("js.admin.enterprise.trial.form.label_email"),label_domain:this.I18n.t("js.admin.enterprise.trial.form.label_domain"),privacy_policy:this.I18n.t("js.admin.enterprise.trial.form.privacy_policy"),receive_newsletter:this.I18n.t("js.admin.enterprise.trial.form.receive_newsletter",{link:"https://www.openproject.com/newsletter/"}),terms_of_service:this.I18n.t("js.admin.enterprise.trial.form.terms_of_service")}}checkMailField(){""!==this.trialForm.value.email&&this.trialForm.controls.email.errors?this.eeTrialService.emailInvalid=!0:(this.eeTrialService.emailInvalid=!1,this.eeTrialService.error=void 0)}}bo.\u0275fac=function(e){return new(e||bo)(n.gc(n.q),n.gc(C.a),n.gc(l.e),n.gc(po.a),n.gc(uo))},bo.\u0275cmp=n.ac({type:bo,selectors:[["enterprise-trial-form"]],decls:45,vars:16,consts:[["id","enterprise-trial-form",1,"form",3,"formGroup"],[1,"form--field","-wide-label","-required"],["for","trial-company-name",1,"form--label"],[1,"form--field-container"],[1,"form--text-field-container"],["type","text","id","trial-company-name","formControlName","company",1,"form--text-field"],["for","trial-first-name",1,"form--label"],["type","text","id","trial-first-name","formControlName","first_name",1,"form--text-field"],["for","trial-last-name",1,"form--label"],["type","text","id","trial-last-name","formControlName","last_name",1,"form--text-field"],["for","trial-email",1,"form--label"],[1,"form--text-field-container",3,"ngClass"],["type","email","id","trial-email","formControlName","email",1,"form--text-field",3,"blur"],["class","form--field-instructions",4,"ngIf"],["for","trial-domain-name",1,"form--label"],["type","text","id","trial-domain-name","formControlName","domain","disabled","",1,"form--text-field"],[1,"form--field","-required"],["for","trial-general-consent",1,"form--label-with-check-box","-no-ellipsis"],[1,"form--check-box-container"],["type","checkbox","id","trial-general-consent","formControlName","general_consent","required","",1,"form--check-box"],[3,"innerHTML"],[1,"form--field"],["for","trial-newsletter-consent",1,"form--label-with-check-box","-no-ellipsis"],["type","checkbox","id","trial-newsletter-consent","formControlName","newsletter_consent",1,"form--check-box"],[3,"innerHtml"],[1,"form--field-instructions"]],template:function(e,t){1&e&&(n.mc(0,"form",0),n.mc(1,"div",1),n.mc(2,"label",2),n.ad(3),n.lc(),n.mc(4,"div",3),n.mc(5,"div",4),n.hc(6,"input",5),n.lc(),n.lc(),n.lc(),n.mc(7,"div",1),n.mc(8,"label",6),n.ad(9),n.lc(),n.mc(10,"div",3),n.mc(11,"div",4),n.hc(12,"input",7),n.lc(),n.lc(),n.lc(),n.mc(13,"div",1),n.mc(14,"label",8),n.ad(15),n.lc(),n.mc(16,"div",3),n.mc(17,"div",4),n.hc(18,"input",9),n.lc(),n.lc(),n.lc(),n.mc(19,"div",1),n.mc(20,"label",10),n.ad(21),n.lc(),n.mc(22,"div",3),n.mc(23,"div",11),n.mc(24,"input",12),n.uc("blur",(function(){return t.checkMailField()})),n.lc(),n.lc(),n.lc(),n.Yc(25,go,2,1,"div",13),n.lc(),n.mc(26,"div",1),n.mc(27,"label",14),n.ad(28),n.lc(),n.mc(29,"div",3),n.mc(30,"div",11),n.hc(31,"input",15),n.lc(),n.lc(),n.Yc(32,mo,2,1,"div",13),n.lc(),n.mc(33,"div",16),n.mc(34,"div",3),n.mc(35,"label",17),n.mc(36,"div",18),n.hc(37,"input",19),n.lc(),n.hc(38,"span",20),n.lc(),n.lc(),n.lc(),n.mc(39,"div",21),n.mc(40,"div",3),n.mc(41,"label",22),n.mc(42,"div",18),n.hc(43,"input",23),n.lc(),n.hc(44,"span",24),n.lc(),n.lc(),n.lc(),n.lc()),2&e&&(n.Bc("formGroup",t.trialForm),n.Tb(3),n.bd(t.text.label_company),n.Tb(6),n.bd(t.text.label_first_name),n.Tb(6),n.bd(t.text.label_last_name),n.Tb(6),n.bd(t.text.label_email),n.Tb(2),n.Bc("ngClass",n.Gc(12,fo,t.eeTrialService.emailError)),n.Tb(2),n.Bc("ngIf",t.eeTrialService.emailError),n.Tb(3),n.bd(t.text.label_domain),n.Tb(2),n.Bc("ngClass",n.Gc(14,fo,t.eeTrialService.domainTaken)),n.Tb(2),n.Bc("ngIf",t.eeTrialService.domainTaken),n.Tb(6),n.Bc("innerHTML",t.text.general_consent,n.Rc),n.Tb(6),n.Bc("innerHtml",t.text.receive_newsletter,n.Rc))},directives:[l.C,l.n,l.h,l.c,l.m,l.g,X.n,X.q,l.a,l.b],encapsulation:2});class wo extends Je.a{constructor(e){super(),this.I18n=e,this.text={label_email:this.I18n.t("js.admin.enterprise.trial.form.label_email"),label_expires_at:this.I18n.t("js.admin.enterprise.trial.form.label_expires_at"),label_maximum_users:this.I18n.t("js.admin.enterprise.trial.form.label_maximum_users"),label_company:this.I18n.t("js.admin.enterprise.trial.form.label_company"),label_domain:this.I18n.t("js.admin.enterprise.trial.form.label_domain"),label_starts_at:this.I18n.t("js.admin.enterprise.trial.form.label_starts_at"),label_subscriber:this.I18n.t("js.admin.enterprise.trial.form.label_subscriber")}}}function vo(e,t){if(1&e&&n.hc(0,"div",3),2&e){const e=n.wc();n.Bc("textContent",e.text.label_company)}}function yo(e,t){if(1&e&&(n.mc(0,"div",4),n.mc(1,"div",5),n.hc(2,"span",6),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(2),n.Bc("textContent",e.company)}}function ko(e,t){if(1&e&&n.hc(0,"div",3),2&e){const e=n.wc();n.Bc("textContent",e.text.label_domain)}}function Co(e,t){if(1&e&&(n.mc(0,"div",4),n.mc(1,"div",5),n.hc(2,"span",6),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(2),n.Bc("textContent",e.domain)}}function jo(e,t){if(1&e&&n.hc(0,"div",3),2&e){const e=n.wc();n.Bc("textContent",e.text.label_maximum_users)}}function xo(e,t){if(1&e&&(n.mc(0,"div",4),n.mc(1,"div",5),n.hc(2,"span",6),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(2),n.Bc("textContent",e.userCount)}}function To(e,t){if(1&e&&n.hc(0,"div",3),2&e){const e=n.wc();n.Bc("textContent",e.text.label_starts_at)}}function So(e,t){if(1&e&&(n.mc(0,"div",4),n.mc(1,"div",5),n.hc(2,"span",6),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(2),n.Bc("textContent",e.startsAt)}}function _o(e,t){if(1&e&&n.hc(0,"div",3),2&e){const e=n.wc();n.Bc("textContent",e.text.label_expires_at)}}function Po(e,t){if(1&e&&(n.mc(0,"div",4),n.mc(1,"div",5),n.hc(2,"span",6),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(2),n.Bc("textContent",e.expiresAt)}}class Io extends wo{constructor(e,t,i,n,s,a){super(i),this.elementRef=e,this.cdRef=t,this.I18n=i,this.http=n,this.Gon=s,this.eeTrialService=a}ngOnInit(){this.subscriber||(this.eeTrialService.userData$.values$().pipe(Object(cr.a)(),this.untilDestroyed()).subscribe(e=>{this.formatUserData(e),this.cdRef.detectChanges()}),this.initialize())}initialize(){let e=this.Gon.get("ee_trial_key");e&&!this.eeTrialService.userData$.hasValue()&&(this.eeTrialService.trialLink=this.eeTrialService.baseUrlAugur+"/public/v1/trials/"+e.value,this.getUserDataFromAugur())}getUserDataFromAugur(){this.http.get(this.eeTrialService.trialLink+"/details").toPromise().then(e=>{this.eeTrialService.userData$.putValue(e),this.eeTrialService.retryConfirmation()}).catch(e=>{this.eeTrialService.getToken()})}formatUserData(e){this.subscriber=e.first_name+" "+e.last_name,this.email=e.email,this.company=e.company,this.domain=e.domain}}function Oo(e,t){if(1&e&&(n.mc(0,"p"),n.ad(1),n.lc()),2&e){const e=n.wc(2);n.Tb(1),n.bd(e.text.session_timeout)}}function Ro(e,t){if(1&e){const e=n.nc();n.mc(0,"span",2),n.ad(1),n.mc(2,"a",3),n.uc("click",(function(){return n.Qc(e),n.wc().resendMail()})),n.ad(3),n.lc(),n.Yc(4,Oo,2,1,"p",4),n.lc()}if(2&e){const e=n.wc();n.Tb(1),n.cd(" ",e.text.status_waiting," "),n.Tb(2),n.bd(e.text.resend),n.Tb(1),n.Bc("ngIf",e.eeTrialService.cancelled)}}function Bo(e,t){if(1&e&&(n.mc(0,"span",5),n.ad(1),n.lc()),2&e){const e=n.wc();n.Tb(1),n.cd(" ",e.text.status_confirmed,"")}}Io.\u0275fac=function(e){return new(e||Io)(n.gc(n.q),n.gc(n.i),n.gc(C.a),n.gc(ue.b),n.gc($a.a),n.gc(uo))},Io.\u0275cmp=n.ac({type:Io,selectors:[["enterprise-active-trial"]],features:[n.Qb],decls:21,vars:14,consts:[[1,"enterprise--active-token"],[1,"attributes-group"],[1,"attributes-key-value"],[1,"attributes-key-value--key",3,"textContent"],[1,"attributes-key-value--value-container"],[1,"attributes-key-value--value","-text"],[3,"textContent"],["class","attributes-key-value--key",3,"textContent",4,"ngIf"],["class","attributes-key-value--value-container",4,"ngIf"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.hc(3,"div",3),n.mc(4,"div",4),n.mc(5,"div",5),n.hc(6,"span",6),n.lc(),n.lc(),n.hc(7,"div",3),n.mc(8,"div",4),n.mc(9,"div",5),n.hc(10,"span",6),n.lc(),n.lc(),n.Yc(11,vo,1,1,"div",7),n.Yc(12,yo,3,1,"div",8),n.Yc(13,ko,1,1,"div",7),n.Yc(14,Co,3,1,"div",8),n.Yc(15,jo,1,1,"div",7),n.Yc(16,xo,3,1,"div",8),n.Yc(17,To,1,1,"div",7),n.Yc(18,So,3,1,"div",8),n.Yc(19,_o,1,1,"div",7),n.Yc(20,Po,3,1,"div",8),n.lc(),n.lc(),n.lc()),2&e&&(n.Tb(3),n.Bc("textContent",t.text.label_subscriber),n.Tb(3),n.Bc("textContent",t.subscriber),n.Tb(1),n.Bc("textContent",t.text.label_email),n.Tb(3),n.Bc("textContent",t.email),n.Tb(1),n.Bc("ngIf",t.company),n.Tb(1),n.Bc("ngIf",t.company),n.Tb(1),n.Bc("ngIf",t.domain),n.Tb(1),n.Bc("ngIf",t.domain),n.Tb(1),n.Bc("ngIf",t.userCount),n.Tb(1),n.Bc("ngIf",t.userCount),n.Tb(1),n.Bc("ngIf",t.startsAt),n.Tb(1),n.Bc("ngIf",t.startsAt),n.Tb(1),n.Bc("ngIf",t.expiresAt),n.Tb(1),n.Bc("ngIf",t.expiresAt))},directives:[X.q],styles:[".attributes-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}"]});class Eo{constructor(e,t,i,n,s,a){this.elementRef=e,this.I18n=t,this.http=i,this.notificationsService=n,this.eeTrialService=s,this.timezoneService=a,this.created=this.timezoneService.formattedDate((new Date).toString()),this.email="",this.text={confirmation_info:(e,t)=>this.I18n.t("js.admin.enterprise.trial.confirmation_info",{date:e,email:t}),resend:this.I18n.t("js.admin.enterprise.trial.resend_link"),resend_success:this.I18n.t("js.admin.enterprise.trial.resend_success"),resend_warning:this.I18n.t("js.admin.enterprise.trial.resend_warning"),session_timeout:this.I18n.t("js.admin.enterprise.trial.session_timeout"),status_confirmed:this.I18n.t("js.admin.enterprise.trial.status_confirmed"),status_label:this.I18n.t("js.admin.enterprise.trial.status_label"),status_waiting:this.I18n.t("js.admin.enterprise.trial.status_waiting")}}ngOnInit(){let e=window.gon.ee_trial_key;if(e){let t=e.created.split(" ")[0];this.created=this.timezoneService.formattedDate(t)}this.eeTrialService.userData$.values$().pipe(Object(cr.a)()).subscribe(e=>{this.email=e.email})}resendMail(){this.eeTrialService.cancelled=!1,this.http.post(this.eeTrialService.resendLink,{}).toPromise().then(()=>{this.notificationsService.addSuccess(this.text.resend_success),this.eeTrialService.retryConfirmation()}).catch(()=>{this.eeTrialService.trialLink?this.eeTrialService.getToken():this.notificationsService.addError(this.text.resend_warning)})}}function Mo(e,t){if(1&e){const e=n.nc();n.mc(0,"a",10),n.mc(1,"i",11),n.uc("click",(function(t){return n.Qc(e),n.wc().closeModal(t)})),n.lc(),n.lc()}if(2&e){const e=n.wc();n.Tb(1),n.Ub("title",e.text.close_popup)}}function Fo(e,t){1&e&&(n.mc(0,"div"),n.hc(1,"enterprise-trial-form"),n.lc())}function Ao(e,t){1&e&&(n.mc(0,"div"),n.hc(1,"enterprise-trial-waiting"),n.lc())}function Do(e,t){if(1&e&&(n.mc(0,"div"),n.mc(1,"div",12),n.mc(2,"div",13),n.mc(3,"span"),n.ad(4),n.lc(),n.lc(),n.mc(5,"div",14),n.hc(6,"iframe",15),n.lc(),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(4),n.bd(e.text.quick_overview),n.Tb(2),n.Bc("src",e.trustedEEVideoURL,n.Sc)}}function qo(e,t){if(1&e){const e=n.nc();n.mc(0,"div"),n.mc(1,"button",16),n.uc("click",(function(){return n.Qc(e),n.wc().onSubmit()})),n.lc(),n.mc(2,"button",17),n.uc("click",(function(t){return n.Qc(e),n.wc().closeModal(t)})),n.lc(),n.lc()}if(2&e){const e=n.wc();n.Tb(1),n.Bc("disabled",!e.trialForm||e.trialForm.invalid)("textContent",e.text.button_submit)("hidden",e.eeTrialService.mailSubmitted&&!e.eeTrialService.cancelled),n.Ub("title",e.text.button_submit),n.Tb(1),n.Bc("textContent",e.text.button_cancel),n.Ub("title",e.text.button_cancel)}}function Lo(e,t){if(1&e){const e=n.nc();n.mc(0,"button",20),n.uc("click",(function(t){return n.Qc(e),n.wc(2).closeModal(t)})),n.lc()}if(2&e){const e=n.wc(2);n.Bc("textContent",e.text.button_continue),n.Ub("title",e.text.button_continue)}}function $o(e,t){if(1&e){const e=n.nc();n.mc(0,"button",18),n.uc("click",(function(){return n.Qc(e),n.wc().startEnterpriseTrial()})),n.lc(),n.Yc(1,Lo,1,2,"button",19)}if(2&e){const e=n.wc();n.Bc("textContent",e.text.button_continue)("disabled",!e.eeTrialService.confirmed)("hidden",e.eeTrialService.trialStarted),n.Ub("title",e.text.button_continue),n.Tb(1),n.Bc("ngIf",e.eeTrialService.trialStarted)}}Eo.\u0275fac=function(e){return new(e||Eo)(n.gc(n.q),n.gc(C.a),n.gc(ue.b),n.gc(k.a),n.gc(uo),n.gc(nt.a))},Eo.\u0275cmp=n.ac({type:Eo,selectors:[["enterprise-trial-waiting"]],decls:9,vars:4,consts:[["class","status--waiting",4,"ngIf","ngIfElse"],["confirmedStatus",""],[1,"status--waiting"],["id","resend-link",3,"click"],[4,"ngIf"],[1,"status--confirmed","icon-yes"]],template:function(e,t){if(1&e&&(n.hc(0,"enterprise-active-trial"),n.mc(1,"p"),n.ad(2),n.lc(),n.mc(3,"p"),n.mc(4,"span"),n.ad(5),n.lc(),n.Yc(6,Ro,5,3,"span",0),n.Yc(7,Bo,2,1,"ng-template",null,1,n.Zc),n.lc()),2&e){const e=n.Oc(8);n.Tb(2),n.bd(t.text.confirmation_info(t.created,t.email)),n.Tb(3),n.cd("",t.text.status_label," "),n.Tb(1),n.Bc("ngIf",!t.eeTrialService.confirmed)("ngIfElse",e)}},directives:[Io,X.q],styles:["#resend-link[_ngcontent-%COMP%]{float:right}.status--confirmed[_ngcontent-%COMP%]{color:var(--button--alt-highlight-background-color)}.status--waiting[_ngcontent-%COMP%]{color:orange}"]});class No extends st.a{constructor(e,t,i,n,s,a){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.I18n=n,this.domSanitizer=s,this.eeTrialService=a,this.showClose=!0,this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.text={button_submit:this.I18n.t("js.modals.button_submit"),button_cancel:this.I18n.t("js.modals.button_cancel"),button_continue:this.I18n.t("js.button_continue"),close_popup:this.I18n.t("js.close_popup_title"),heading_confirmation:this.I18n.t("js.admin.enterprise.trial.confirmation"),heading_next_steps:this.I18n.t("js.admin.enterprise.trial.next_steps"),heading_test_ee:this.I18n.t("js.admin.enterprise.trial.test_ee"),quick_overview:this.I18n.t("js.admin.enterprise.trial.quick_overview")},this.trustedEEVideoURL=this.trustedURL("https://www.youtube.com/embed/zLMSydhFSkw?autoplay=1")}ngAfterViewInit(){this.trialForm=this.formComponent.trialForm}onSubmit(){this.trialForm.valid&&(this.trialForm.addControl("_type",new l.f("enterprise-trial")),this.eeTrialService.sendForm(this.trialForm))}startEnterpriseTrial(){this.eeTrialService.setStartTrialStatus()}headerText(){return this.eeTrialService.mailSubmitted?this.text.heading_confirmation:this.eeTrialService.trialStarted?this.text.heading_next_steps:this.text.heading_test_ee}closeModal(e){this.closeMe(e),(this.eeTrialService.trialStarted||this.eeTrialService.confirmed)&&window.location.reload(),this.eeTrialService.modalOpen=!1}trustedURL(e){return this.domSanitizer.bypassSecurityTrustResourceUrl(e)}openWindow(){return!this.eeTrialService.status||this.eeTrialService.cancelled?1:this.eeTrialService.mailSubmitted&&!this.eeTrialService.cancelled?2:3}}function Qo(e,t){if(1&e){const e=n.nc();n.mc(0,"div"),n.mc(1,"p"),n.ad(2),n.lc(),n.mc(3,"p",2),n.ad(4),n.lc(),n.mc(5,"p"),n.mc(6,"span",2),n.ad(7),n.lc(),n.hc(8,"br"),n.mc(9,"span"),n.ad(10),n.lc(),n.lc(),n.mc(11,"button",3),n.uc("click",(function(){return n.Qc(e),n.wc().openTrialModal()})),n.ad(12),n.lc(),n.lc()}if(2&e){const e=n.wc();n.Tb(2),n.bd(e.text.enterprise_edition),n.Tb(2),n.bd(e.text.confidence),n.Tb(3),n.bd(e.text.become_hero),n.Tb(3),n.bd(e.text.you_contribute),n.Tb(2),n.cd(" ",e.text.button_trial," ")}}function Vo(e,t){if(1&e){const e=n.nc();n.hc(0,"enterprise-trial-waiting"),n.mc(1,"p",4),n.ad(2),n.mc(3,"a",5),n.uc("click",(function(){return n.Qc(e),n.wc().openTrialModal()})),n.ad(4),n.lc(),n.lc()}if(2&e){const e=n.wc();n.Tb(2),n.cd("",e.text.email_not_received," "),n.Tb(2),n.bd(e.text.try_another_email)}}No.\u0275fac=function(e){return new(e||No)(n.gc(n.q),n.gc(I.a),n.gc(n.i),n.gc(C.a),n.gc(N.b),n.gc(uo))},No.\u0275cmp=n.ac({type:No,selectors:[["enterprise-trial-modal"]],viewQuery:function(e,t){var i;(1&e&&n.fd(bo,!0),2&e)&&(n.Nc(i=n.vc())&&(t.formComponent=i.first))},inputs:{opReferrer:"opReferrer"},features:[n.Qb],decls:13,vars:8,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container"],[1,"op-modal--modal-header"],[3,"textContent"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"op-modal--modal-body",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"op-modal--modal-footer"],[4,"ngIf","ngIfElse"],["mailSubmitted",""],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[1,"onboarding--video-block"],[1,"onboarding--video-text"],[1,"onboarding--video","iframe-target-wrapper"],["frameborder","0","height","400","width","100%","allowfullscreen","",3,"src"],[1,"confirm-form-submit--continue","button","-highlight",3,"disabled","textContent","hidden","click"],[1,"confirm-form-submit--cancel","button",3,"textContent","click"],[1,"confirm-form-submit--continue","button","-highlight",3,"textContent","disabled","hidden","click"],["class","confirm-form-submit--continue button -highlight",3,"textContent","click",4,"ngIf"],[1,"confirm-form-submit--continue","button","-highlight",3,"textContent","click"]],template:function(e,t){if(1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.hc(3,"h3",3),n.Yc(4,Mo,2,1,"a",4),n.lc(),n.mc(5,"div",5),n.Yc(6,Fo,2,0,"div",6),n.Yc(7,Ao,2,0,"div",6),n.Yc(8,Do,7,2,"div",6),n.lc(),n.mc(9,"div",7),n.Yc(10,qo,3,6,"div",8),n.Yc(11,$o,2,5,"ng-template",null,9,n.Zc),n.lc(),n.lc(),n.lc()),2&e){const e=n.Oc(12);n.Tb(3),n.Bc("textContent",t.headerText()),n.Tb(1),n.Bc("ngIf",t.showClose),n.Tb(1),n.Bc("ngSwitch",t.openWindow()),n.Tb(1),n.Bc("ngSwitchCase",1),n.Tb(1),n.Bc("ngSwitchCase",2),n.Tb(1),n.Bc("ngSwitchCase",3),n.Tb(2),n.Bc("ngIf",!t.eeTrialService.status||t.eeTrialService.cancelled)("ngIfElse",e)}},directives:[X.q,X.u,X.v,bo,Eo],styles:[".op-modal--modal-body[_ngcontent-%COMP%]{padding:0}.op-modal--modal-body[_ngcontent-%COMP%]   .onboarding--video-text[_ngcontent-%COMP%]{margin-bottom:1.25rem}.op-modal--modal-footer[_ngcontent-%COMP%]{margin:0;padding:0}"]});class Ho{constructor(e,t,i,n){this.I18n=e,this.opModalService=t,this.injector=i,this.eeTrialService=n,this.text={button_trial:this.I18n.t("js.admin.enterprise.upsale.button_start_trial"),button_book:this.I18n.t("js.admin.enterprise.upsale.button_book_now"),link_quote:this.I18n.t("js.admin.enterprise.upsale.link_quote"),become_hero:this.I18n.t("js.admin.enterprise.upsale.become_hero"),you_contribute:this.I18n.t("js.admin.enterprise.upsale.you_contribute"),email_not_received:this.I18n.t("js.admin.enterprise.trial.email_not_received"),enterprise_edition:this.I18n.t("js.admin.enterprise.upsale.text"),confidence:this.I18n.t("js.admin.enterprise.upsale.confidence"),try_another_email:this.I18n.t("js.admin.enterprise.trial.try_another_email")}}openTrialModal(){this.eeTrialService.cancelled=!0,this.eeTrialService.modalOpen=!0,this.opModalService.show(No,this.injector)}get noTrialRequested(){return void 0===this.eeTrialService.status}}function zo(e,t){if(1&e&&n.hc(0,"div",3),2&e){const e=n.wc();n.Bc("textContent",e.text.label_company)}}function Yo(e,t){if(1&e&&(n.mc(0,"div",4),n.mc(1,"div",5),n.hc(2,"span",6),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(2),n.Bc("textContent",e.company)}}function Wo(e,t){if(1&e&&n.hc(0,"div",3),2&e){const e=n.wc();n.Bc("textContent",e.text.label_domain)}}function Uo(e,t){if(1&e&&(n.mc(0,"div",4),n.mc(1,"div",5),n.hc(2,"span",6),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(2),n.Bc("textContent",e.domain)}}function Go(e,t){if(1&e&&n.hc(0,"div",3),2&e){const e=n.wc();n.Bc("textContent",e.text.label_maximum_users)}}function Xo(e,t){if(1&e&&(n.mc(0,"div",4),n.mc(1,"div",5),n.hc(2,"span",6),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(2),n.Bc("textContent",e.userCount)}}function Ko(e,t){if(1&e&&n.hc(0,"div",3),2&e){const e=n.wc();n.Bc("textContent",e.text.label_starts_at)}}function Zo(e,t){if(1&e&&(n.mc(0,"div",4),n.mc(1,"div",5),n.hc(2,"span",6),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(2),n.Bc("textContent",e.startsAt)}}function Jo(e,t){if(1&e&&n.hc(0,"div",3),2&e){const e=n.wc();n.Bc("textContent",e.text.label_expires_at)}}function el(e,t){if(1&e&&(n.mc(0,"div",4),n.mc(1,"div",5),n.hc(2,"span",6),n.lc(),n.lc()),2&e){const e=n.wc();n.Tb(2),n.Bc("textContent",e.expiresAt)}}Ho.\u0275fac=function(e){return new(e||Ho)(n.gc(C.a),n.gc(I.b),n.gc(n.A),n.gc(uo))},Ho.\u0275cmp=n.ac({type:Ho,selectors:[["enterprise-base"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["alreadyRequested",""],[1,"-bold"],[1,"button","-alt-highlight",3,"click"],[1,"confirmation-hint"],[3,"click"]],template:function(e,t){if(1&e&&(n.Yc(0,Qo,13,5,"div",0),n.Yc(1,Vo,5,2,"ng-template",null,1,n.Zc)),2&e){const e=n.Oc(2);n.Bc("ngIf",t.noTrialRequested)("ngIfElse",e)}},directives:[X.q,Eo],styles:[".button[_ngcontent-%COMP%]{float:left}.confirmation-hint[_ngcontent-%COMP%]{font-size:.9em;font-style:italic;margin-bottom:2rem}"]});class tl extends wo{constructor(e,t){super(t),this.elementRef=e,this.I18n=t,this.subscriber=this.elementRef.nativeElement.dataset.subscriber,this.email=this.elementRef.nativeElement.dataset.email,this.company=this.elementRef.nativeElement.dataset.company,this.domain=this.elementRef.nativeElement.dataset.domain,this.userCount=this.elementRef.nativeElement.dataset.userCount,this.startsAt=this.elementRef.nativeElement.dataset.startsAt,this.expiresAt=this.elementRef.nativeElement.dataset.expiresAt}}tl.\u0275fac=function(e){return new(e||tl)(n.gc(n.q),n.gc(C.a))},tl.\u0275cmp=n.ac({type:tl,selectors:[["enterprise-active-saved-trial"]],features:[n.Qb],decls:21,vars:14,consts:[[1,"enterprise--active-token"],[1,"attributes-group"],[1,"attributes-key-value"],[1,"attributes-key-value--key",3,"textContent"],[1,"attributes-key-value--value-container"],[1,"attributes-key-value--value","-text"],[3,"textContent"],["class","attributes-key-value--key",3,"textContent",4,"ngIf"],["class","attributes-key-value--value-container",4,"ngIf"]],template:function(e,t){1&e&&(n.mc(0,"div",0),n.mc(1,"div",1),n.mc(2,"div",2),n.hc(3,"div",3),n.mc(4,"div",4),n.mc(5,"div",5),n.hc(6,"span",6),n.lc(),n.lc(),n.hc(7,"div",3),n.mc(8,"div",4),n.mc(9,"div",5),n.hc(10,"span",6),n.lc(),n.lc(),n.Yc(11,zo,1,1,"div",7),n.Yc(12,Yo,3,1,"div",8),n.Yc(13,Wo,1,1,"div",7),n.Yc(14,Uo,3,1,"div",8),n.Yc(15,Go,1,1,"div",7),n.Yc(16,Xo,3,1,"div",8),n.Yc(17,Ko,1,1,"div",7),n.Yc(18,Zo,3,1,"div",8),n.Yc(19,Jo,1,1,"div",7),n.Yc(20,el,3,1,"div",8),n.lc(),n.lc(),n.lc()),2&e&&(n.Tb(3),n.Bc("textContent",t.text.label_subscriber),n.Tb(3),n.Bc("textContent",t.subscriber),n.Tb(1),n.Bc("textContent",t.text.label_email),n.Tb(3),n.Bc("textContent",t.email),n.Tb(1),n.Bc("ngIf",t.company),n.Tb(1),n.Bc("ngIf",t.company),n.Tb(1),n.Bc("ngIf",t.domain),n.Tb(1),n.Bc("ngIf",t.domain),n.Tb(1),n.Bc("ngIf",t.userCount),n.Tb(1),n.Bc("ngIf",t.userCount),n.Tb(1),n.Bc("ngIf",t.startsAt),n.Tb(1),n.Bc("ngIf",t.startsAt),n.Tb(1),n.Bc("ngIf",t.expiresAt),n.Tb(1),n.Bc("ngIf",t.expiresAt))},directives:[X.q],styles:[".attributes-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}"]});class il{constructor(e){this.injector=e,this.text={edit:this.i18n.t("js.button_edit"),delete:this.i18n.t("js.button_delete"),error:this.i18n.t("js.error.internal"),areYouSure:this.i18n.t("js.text_are_you_sure")}}editTimeEntry(){this.loadEntry().then(e=>{this.timeEntryEditService.edit(e).then(()=>{window.location.reload()}).catch(()=>{})})}deleteTimeEntry(){window.confirm(this.text.areYouSure)&&this.loadEntry().then(e=>{this.timeEntryDmService.delete(e).then(()=>{window.location.reload()}).catch(e=>{this.notificationsService.addError(e||this.text.error)})})}loadEntry(){let e=this.elementRef.nativeElement.dataset.entry;return this.timeEntryCache.require(e)}}il.\u0275fac=function(e){return new(e||il)(n.gc(n.A))},il.\u0275cmp=n.ac({type:il,selectors:[["time-entry--trigger-actions-entry"]],decls:4,vars:2,consts:[[1,"no-decoration-on-hover",3,"title","click"],["icon-classes","icon-context icon-edit"],["icon-classes","icon-context icon-delete"]],template:function(e,t){1&e&&(n.mc(0,"a",0),n.uc("click",(function(){return t.editTimeEntry()})),n.hc(1,"op-icon",1),n.lc(),n.mc(2,"a",0),n.uc("click",(function(){return t.deleteTimeEntry()})),n.hc(3,"op-icon",2),n.lc()),2&e&&(n.Bc("title",t.text.edit),n.Tb(2),n.Bc("title",t.text.delete))},directives:[yt.a],encapsulation:2,changeDetection:0}),Object(y.c)([Object(Y.a)(),Object(y.e)("design:type",St)],il.prototype,"timeEntryEditService",void 0),Object(y.c)([Object(Y.a)(),Object(y.e)("design:type",mt)],il.prototype,"timeEntryCache",void 0),Object(y.c)([Object(Y.a)(),Object(y.e)("design:type",ht.a)],il.prototype,"timeEntryDmService",void 0),Object(y.c)([Object(Y.a)(),Object(y.e)("design:type",k.a)],il.prototype,"notificationsService",void 0),Object(y.c)([Object(Y.a)(),Object(y.e)("design:type",n.q)],il.prototype,"elementRef",void 0),Object(y.c)([Object(Y.a)(),Object(y.e)("design:type",C.a)],il.prototype,"i18n",void 0),Object(y.c)([Object(Y.a)(),Object(y.e)("design:type",n.i)],il.prototype,"cdRef",void 0);const nl=[{selector:"openproject-base",cls:fa},{selector:fn.b,cls:fn.a},{selector:Jr.b,cls:Jr.a,embeddable:!0},{selector:"colors-autocompleter",cls:nc},{selector:At.b,cls:At.a},{selector:ms.b,cls:ms.a,embeddable:!0},{selector:Pn.b,cls:Pn.a},{selector:"members-autocompleter",cls:oo},{selector:"global-search-tabs",cls:to},{selector:"global-search-work-packages",cls:cc},{selector:"homescreen-new-features-block",cls:oc},{selector:lc.b,cls:lc.a},{selector:dc.b,cls:dc.a},{selector:"global-search-work-packages-entry",cls:uc},{selector:yn.b,cls:yn.a},{selector:"admin-type-form-configuration",cls:Wa},{selector:hc.b,cls:hc.a,embeddable:!0},{selector:"persistent-toggle",cls:pc},{selector:Gt.b,cls:Gt.a},{selector:"hide-section-link",cls:mc},{selector:"show-section-dropdown",cls:fc},{selector:"add-section-dropdown",cls:yc},{selector:"autocomplete-select-decoration",cls:Cc},{selector:"content-tabs",cls:xc},{selector:"global-search-title",cls:Jc},{selector:"copy-to-clipboard",cls:Tc},{selector:"confirm-form-submit",cls:Sc},{selector:"main-menu-resizer",cls:Ic},{selector:"main-menu-toggle",cls:no},{selector:"global-search-input",cls:Qc},{selector:"collapsible-section-augment",cls:zc},{selector:"enterprise-banner-bootstrap",cls:Yc},{selector:"enterprise-base",cls:Ho},{selector:"enterprise-active-saved-trial",cls:tl},{selector:"project-menu-autocomplete",cls:Xc},{selector:"remote-field-updater",cls:Kc},{selector:"wp-overview-graph",cls:rn},{selector:Zc.b,cls:Zc.a},{selector:"time-entry--trigger-actions-entry",cls:il,embeddable:!0}];class sl{}sl.\u0275mod=n.ec({type:sl}),sl.\u0275inj=n.dc({factory:function(e){return new(e||sl)},imports:[[b.a,un.b]]});class al{}al.\u0275mod=n.ec({type:al}),al.\u0275inj=n.dc({factory:function(e){return new(e||al)},providers:[uo],imports:[[b.a,l.i,l.w]]});class rl{ngDoBootstrap(e){H.DynamicBootstrapper.register(...nl),H.DynamicBootstrapper.bootstrapOptionalDocument(e,document),e._injector.get(v.a).call("openProjectAngularBootstrap").forEach(t=>{H.DynamicBootstrapper.bootstrapOptionalDocument(e,document,t)})}}rl.\u0275mod=n.ec({type:rl}),rl.\u0275inj=n.dc({factory:function(e){return new(e||rl)},providers:[{provide:u.a,useValue:new u.a},{provide:n.c,useFactory:function(e){return()=>{const t=e.get(p.a),i=e.get(g.a),n=e.get(we.ModalWrapperAugmentService),s=e.get(Mr),a=e.get(Aa.a),r=e.get(Zr);a.register(),n.setupListener(),s.setupListener(),r.register(),t.setupListener(),i.setupListener()}},deps:[n.A],multi:!0},h.a,L.a,w.a,m.a],imports:[[N.a,b.a,ka,d.a,ke.a,f.a,ga,ye.a,Gr.a,ve.a,Ea,es,Vt,Rr,Nr,Ur,Fa,tr,al,U,be,sl,l.w]]}),window.global=window;window.appBasePath=s("meta[name=app_base_path]").attr("content")||"",i.p=window.appBasePath+"/assets/frontend/",window.ErrorReporter=new class{constructor(){this.contextCallbacks=[],this.messageStack=[],this.sentryConfigured=!0;const e=document.querySelector("meta[name=openproject_sentry]");e?i.e(13).then(i.bind(null,"WSEr")).then(t=>{t.init({dsn:e.dataset.dsn,debug:!a.a.production,ignoreErrors:["The transition has been superseded by a different transition","Uncaught (in promise)"],beforeSend:e=>this.filterEvent(e)}),this.sentryLoaded(t)}):(this.sentryConfigured=!1,this.messageStack=[])}sentryLoaded(e){this.client=e,e.configureScope(this.setupContext.bind(this)),this.messageStack.forEach(e=>{this[e.type].bind(this).apply(e.args)})}captureMessage(e,t="info"){if(!this.client)return this.handleOfflineMessage("captureMessage",Array.from(arguments));this.client.withScope(i=>{this.setupContext(i),this.client.captureMessage(e,r.a.fromString(t))})}captureException(e){if(!this.client||!e)throw this.handleOfflineMessage("captureException",Array.from(arguments)),e;if("string"==typeof e)return this.captureMessage(e,"error");this.client.withScope(t=>{this.setupContext(t),this.client.captureException(e)})}addContext(...e){this.contextCallbacks.push(...e),this.client&&e.forEach(e=>this.client.configureScope(e))}handleOfflineMessage(e,t){this.sentryConfigured?this.messageStack.push({type:e,args:t}):console.log("[ErrorReporter] Would queue sentry message %O %O, but is not configured.",e,t)}setupContext(e){e.setTag("locale",I18n.locale),e.setTag("domain",window.location.hostname),e.setTag("url_path",window.location.pathname),e.setExtra("url_query",window.location.search),this.contextCallbacks.forEach(t=>t(e))}filterEvent(e){return document.body.classList.contains("-unsupported-browser")?(console.warn("Browser is not supported, skipping sentry reporting completely."),null):e}},i("GDA9"),i("buKu");const cl=s("meta[name=openproject_initializer]");I18n.locale=cl.data("defaultLocale"),I18n.locale=cl.data("locale"),I18n.firstDayOfWeek=parseInt(cl.data("firstDayOfWeek"),10),a.a.production&&Object(n.jb)(),Object(c.c)(()=>{window.enableReactiveStatesLogging=()=>Object(o.e)(!0),window.disableReactiveStatesLogging=()=>Object(o.e)(!1)}),s((function(){N.f().bootstrapModule(rl).then(e=>{s("body").addClass("__ng2-bootstrap-has-run")})}))},zqrF:function(e,t,i){"use strict";i.d(t,"b",(function(){return d})),i.d(t,"a",(function(){return u}));var n=i("E2tj"),s=i("FnNU"),a=i("IzEk"),r=i("CqXF"),c=i("lJxs"),o=i("VRyK"),l=i("fXoL");class d{constructor(e){this.querySpace=e,this.updatesState=Object(s.f)(),this.pristineState=Object(s.f)()}initialize(e,t,i){const n=this.valueFromQuery(e,t);this.pristineState.putValue(n)}update(e){this.updatesState.putValue(e)}clear(e){this.pristineState.clear(e),this.updatesState.clear(e)}live$(){return Object(o.a)(this.pristineState.values$(),this.updatesState.values$())}pristine$(){return this.pristineState.values$()}updates$(){return this.updatesState.values$()}changes$(){return this.updatesState.changes$()}onReady(){return this.pristineState.values$().pipe(Object(a.a)(1),Object(r.a)(null)).toPromise()}get lastUpdatedState(){const e=Object(s.b)(this.pristineState,this.updatesState);return Object(s.d)(e,e=>e.pipe(Object(c.a)(([e,t])=>void 0===t?e:t)))}set current(e){e?this.updatesState.putValue(e):this.updatesState.clear()}get current(){return this.lastUpdatedState.value}}d.\u0275fac=function(e){return new(e||d)(l.qc(n.a))},d.\u0275prov=l.cc({token:d,factory:d.\u0275fac});class u extends d{}u.\u0275fac=function(e){return h(e||u)},u.\u0275prov=l.cc({token:u,factory:u.\u0275fac});const h=l.oc(u)}},[[0,4,15]]]);
//# sourceMappingURL=main.e73ebcaec9eec631416c.js.map